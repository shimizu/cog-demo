/*! For license information please see app.js.LICENSE.txt */
(()=>{var t,e,n,i,r={9705:(t,e,n)=>{"use strict";var i=n(5410);function r(t){var e=[1/0,1/0,-1/0,-1/0];return i.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}r.default=r,e.Z=r},2758:(t,e)=>{"use strict";function n(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function i(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,i)}function r(t,e,i){void 0===i&&(i={});for(var r=0,o=t;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function o(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,i)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,i){return void 0===i&&(i={}),n({type:"MultiLineString",coordinates:t},e,i)}function l(t,e,i){return void 0===i&&(i={}),n({type:"MultiPoint",coordinates:t},e,i)}function u(t,e,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i)}function c(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t*i}function h(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t/i}function f(t){return t%(2*Math.PI)*180/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return i(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=i,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.polygon=r,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return r(t,e)})),n)},e.lineString=o,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=u,e.geometryCollection=function(t,e,i){return void 0===i&&(i={}),n({type:"GeometryCollection",geometries:t},e,i)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=c,e.lengthToRadians=h,e.lengthToDegrees=function(t,e){return f(h(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=f,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(h(t,e),n)},e.convertArea=function(t,n,i){if(void 0===n&&(n="meters"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=e.areaFactors[n];if(!r)throw new Error("invalid original units");var o=e.areaFactors[i];if(!o)throw new Error("invalid final units");return t/r*o},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!d(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},5410:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(2758);function r(t,e,n){if(null!==t)for(var i,o,s,a,l,u,c,h,f=0,d=0,p=t.type,g="FeatureCollection"===p,m="Feature"===p,y=g?t.features.length:1,v=0;v<y;v++){l=(h=!!(c=g?t.features[v].geometry:m?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<l;_++){var b=0,x=0;if(null!==(a=h?c.geometries[_]:c)){u=a.coordinates;var w=a.type;switch(f=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(u,d,v,b,x))return!1;d++,b++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(!1===e(u[i],d,v,b,x))return!1;d++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(o=0;o<u[i].length-f;o++){if(!1===e(u[i][o],d,v,b,x))return!1;d++}"MultiLineString"===w&&b++,"Polygon"===w&&x++}"Polygon"===w&&b++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(x=0,o=0;o<u[i].length;o++){for(s=0;s<u[i][o].length-f;s++){if(!1===e(u[i][o][s],d,v,b,x))return!1;d++}x++}b++}break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===r(a.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,i,r,o,s,a,l,u,c,h,f=0,d="FeatureCollection"===t.type,p="Feature"===t.type,g=d?t.features.length:1;for(n=0;n<g;n++){for(a=d?t.features[n].geometry:p?t.geometry:t,u=d?t.features[n].properties:p?t.properties:{},c=d?t.features[n].bbox:p?t.bbox:void 0,h=d?t.features[n].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,u,c,h))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],f,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,u,c,h))return!1;f++}}function l(t,e){a(t,(function(t,n,r,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(i.feature(t,r,{bbox:o,id:s}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c={type:a,coordinates:t.coordinates[u]};if(!1===e(i.feature(c,r),n,u))return!1}}))}function u(t,e){l(t,(function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,c=0,h=0;return!1!==r(t,(function(r,a,f,d,p){if(void 0===l||n>u||d>c||p>h)return l=r,u=n,c=d,h=p,void(s=0);var g=i.lineString([l,r],t.properties);if(!1===e(g,n,o,p,s))return!1;s++,l=r}))&&void 0}}}))}function c(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,r){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,r,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(i.lineString(s[a],t.properties),n,r,a))return!1}}}))}e.coordAll=function(t){var e=[];return r(t,(function(t){e.push(t)})),e},e.coordEach=r,e.coordReduce=function(t,e,n,i){var o=n;return r(t,(function(t,i,r,s,a){o=0===i&&void 0===n?t:e(o,t,i,r,s,a)}),i),o},e.featureEach=s,e.featureReduce=function(t,e,n){var i=n;return s(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i},e.findPoint=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return i.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),i.point(u[o],l,e);case"LineString":return a<0&&(a=u.length+a),i.point(u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),i.point(u[s][a],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),i.point(u[o][a],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),i.point(u[o][s][a],l,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),i.lineString([u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),i.lineString([u[s][a],u[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),i.lineString([u[o][a],u[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),i.lineString([u[o][s][a],u[o][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.flattenEach=l,e.flattenReduce=function(t,e,n){var i=n;return l(t,(function(t,r,o){i=0===r&&0===o&&void 0===n?t:e(i,t,r,o)})),i},e.geomEach=a,e.geomReduce=function(t,e,n){var i=n;return a(t,(function(t,r,o,s,a){i=0===r&&void 0===n?t:e(i,t,r,o,s,a)})),i},e.lineEach=c,e.lineReduce=function(t,e,n){var i=n;return c(t,(function(t,r,o,s){i=0===r&&void 0===n?t:e(i,t,r,o,s)})),i},e.propEach=o,e.propReduce=function(t,e,n){var i=n;return o(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i},e.segmentEach=u,e.segmentReduce=function(t,e,n){var i=n,r=!1;return u(t,(function(t,o,s,a,l){i=!1===r&&void 0===n?t:e(i,t,o,s,a,l),r=!0})),i}},1924:(t,e,n)=>{"use strict";var i=n(210),r=n(5559),o=r(i("String.prototype.indexOf"));t.exports=function(t,e){var n=i(t,!!e);return"function"==typeof n&&o(t,".prototype.")>-1?r(n):n}},5559:(t,e,n)=>{"use strict";var i=n(8612),r=n(210),o=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),a=r("%Reflect.apply%",!0)||i.call(s,o),l=r("%Object.getOwnPropertyDescriptor%",!0),u=r("%Object.defineProperty%",!0),c=r("%Math.max%");if(u)try{u({},"a",{value:1})}catch(t){u=null}t.exports=function(t){var e=a(i,s,arguments);return l&&u&&l(e,"length").configurable&&u(e,"length",{value:1+c(0,t.length-(arguments.length-1))}),e};var h=function(){return a(i,o,arguments)};u?u(t.exports,"apply",{value:h}):t.exports.apply=h},2273:(t,e,n)=>{"use strict";var i=n(1662),r=n(3842),o=n(6960),s=n(8639).orient2d;function a(t,e,n){e=Math.max(0,void 0===e?2:e),n=n||0;var r=function(t){for(var e=t[0],n=t[0],i=t[0],r=t[0],s=0;s<t.length;s++){var a=t[s];a[0]<e[0]&&(e=a),a[0]>i[0]&&(i=a),a[1]<n[1]&&(n=a),a[1]>r[1]&&(r=a)}var l=[e,n,i,r],u=l.slice();for(s=0;s<t.length;s++)o(t[s],l)||u.push(t[s]);return function(t){t.sort(_);for(var e=[],n=0;n<t.length;n++){for(;e.length>=2&&d(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}for(var i=[],r=t.length-1;r>=0;r--){for(;i.length>=2&&d(i[i.length-2],i[i.length-1],t[r])<=0;)i.pop();i.push(t[r])}return i.pop(),e.pop(),e.concat(i)}(u)}(t),s=new i(16);s.toBBox=function(t){return{minX:t[0],minY:t[1],maxX:t[0],maxY:t[1]}},s.compareMinX=function(t,e){return t[0]-e[0]},s.compareMinY=function(t,e){return t[1]-e[1]},s.load(t);for(var a,u=[],c=0;c<r.length;c++){var h=r[c];s.remove(h),a=g(h,a),u.push(a)}var f=new i(16);for(c=0;c<u.length;c++)f.insert(p(u[c]));for(var y=e*e,v=n*n;u.length;){var b=u.shift(),x=b.p,w=b.next.p,E=m(x,w);if(!(E<v)){var S=E/y;(h=l(s,b.prev.p,x,w,b.next.next.p,S,f))&&Math.min(m(h,x),m(h,w))<=S&&(u.push(b),u.push(g(h,b)),s.remove(h),f.remove(b),f.insert(p(b)),f.insert(p(b.next)))}}b=a;var P=[];do{P.push(b.p),b=b.next}while(b!==a);return P.push(b.p),P}function l(t,e,n,i,o,s,a){for(var l=new r([],u),h=t.data;h;){for(var d=0;d<h.children.length;d++){var p=h.children[d],g=h.leaf?y(p,n,i):c(n,i,p);g>s||l.push({node:p,dist:g})}for(;l.length&&!l.peek().node.children;){var m=l.pop(),v=m.node,_=y(v,e,n),b=y(v,i,o);if(m.dist<_&&m.dist<b&&f(n,v,a)&&f(i,v,a))return v}(h=l.pop())&&(h=h.node)}return null}function u(t,e){return t.dist-e.dist}function c(t,e,n){if(h(t,n)||h(e,n))return 0;var i=v(t[0],t[1],e[0],e[1],n.minX,n.minY,n.maxX,n.minY);if(0===i)return 0;var r=v(t[0],t[1],e[0],e[1],n.minX,n.minY,n.minX,n.maxY);if(0===r)return 0;var o=v(t[0],t[1],e[0],e[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===o)return 0;var s=v(t[0],t[1],e[0],e[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===s?0:Math.min(i,r,o,s)}function h(t,e){return t[0]>=e.minX&&t[0]<=e.maxX&&t[1]>=e.minY&&t[1]<=e.maxY}function f(t,e,n){for(var i,r,o,s,a=Math.min(t[0],e[0]),l=Math.min(t[1],e[1]),u=Math.max(t[0],e[0]),c=Math.max(t[1],e[1]),h=n.search({minX:a,minY:l,maxX:u,maxY:c}),f=0;f<h.length;f++)if(i=h[f].p,r=h[f].next.p,o=t,i!==(s=e)&&r!==o&&d(i,r,o)>0!=d(i,r,s)>0&&d(o,s,i)>0!=d(o,s,r)>0)return!1;return!0}function d(t,e,n){return s(t[0],t[1],e[0],e[1],n[0],n[1])}function p(t){var e=t.p,n=t.next.p;return t.minX=Math.min(e[0],n[0]),t.minY=Math.min(e[1],n[1]),t.maxX=Math.max(e[0],n[0]),t.maxY=Math.max(e[1],n[1]),t}function g(t,e){var n={p:t,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return e?(n.next=e.next,n.prev=e,e.next.prev=n,e.next=n):(n.prev=n,n.next=n),n}function m(t,e){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i}function y(t,e,n){var i=e[0],r=e[1],o=n[0]-i,s=n[1]-r;if(0!==o||0!==s){var a=((t[0]-i)*o+(t[1]-r)*s)/(o*o+s*s);a>1?(i=n[0],r=n[1]):a>0&&(i+=o*a,r+=s*a)}return(o=t[0]-i)*o+(s=t[1]-r)*s}function v(t,e,n,i,r,o,s,a){var l,u,c,h,f=n-t,d=i-e,p=s-r,g=a-o,m=t-r,y=e-o,v=f*f+d*d,_=f*p+d*g,b=p*p+g*g,x=f*m+d*y,w=p*m+g*y,E=v*b-_*_,S=E,P=E;0===E?(u=0,S=1,h=w,P=b):(h=v*w-_*x,(u=_*w-b*x)<0?(u=0,h=w,P=b):u>S&&(u=S,h=w+_,P=b)),h<0?(h=0,-x<0?u=0:-x>v?u=S:(u=-x,S=v)):h>P&&(h=P,-x+_<0?u=0:-x+_>v?u=S:(u=-x+_,S=v));var C=(1-(c=0===h?0:h/P))*r+c*s-((1-(l=0===u?0:u/S))*t+l*n),I=(1-c)*o+c*a-((1-l)*e+l*i);return C*C+I*I}function _(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}r.default&&(r=r.default),t.exports=a,t.exports.default=a},1662:function(t){t.exports=function(){"use strict";function t(t,i,r,o,s){!function t(n,i,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,l=i-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(n,i,Math.max(r,Math.floor(i-l*c/a+h)),Math.min(o,Math.floor(i+(a-l)*c/a+h)),s)}var f=n[i],d=r,p=o;for(e(n,r,i),s(n[o],f)>0&&e(n,r,o);d<p;){for(e(n,d,p),d++,p--;s(n[d],f)<0;)d++;for(;s(n[p],f)>0;)p--}0===s(n[r],f)?e(n,r,p):e(n,++p,o),p<=i&&(r=p+1),i<=p&&(o=p-1)}}(t,i,r||0,o||t.length-1,s||n)}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,r){r||(r=p(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o=e;o<n;o++){var s=t.children[o];a(r,t.leaf?i(s):s)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,n,i,r,o){for(var s=[n,i];s.length;)if(!((i=s.pop())-(n=s.pop())<=r)){var a=n+Math.ceil((i-n)/r/2)*r;t(e,a,n,i,o),s.push(n,a,a,i)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,n=[];if(!d(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?i(s):s;d(t,a)&&(e.leaf?n.push(s):f(t,a)?this._all(s,n):r.push(s))}e=r.pop()}return n},i.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],o=e.leaf?this.toBBox(r):r;if(d(t,o)){if(e.leaf||f(t,o))return!0;n.push(r)}}e=n.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=p([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var n,i,o,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),i=l[l.length-1],n=u.pop(),o=!0),s.leaf){var c=r(t,s.children,e);if(-1!==c)return s.children.splice(c,1),l.push(s),this._condense(l),this}o||s.leaf||!f(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(l.push(s),u.push(n),n=0,i=s,s=s.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},i.prototype._build=function(t,e,n,i){var r,s=n-e+1,a=this._maxEntries;if(s<=a)return o(r=p(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),(r=p([])).leaf=!1,r.height=i;var l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));g(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);g(t,c,h,l,this.compareMinY);for(var f=c;f<=h;f+=l){var d=Math.min(f+l-1,h);r.children.push(this._build(t,f,d,i-1))}}return o(r,this.toBBox),r},i.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var l=e.children[a],u=c(l),h=(f=t,d=l,(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-u);h<o?(o=h,r=u<r?u:r,s=l):h===o&&u<r&&(r=u,s=l)}e=s||e.children[0]}var f,d;return e},i.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],o=this._chooseSubtree(i,this.data,e,r);for(o.children.push(t),a(o,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},i.prototype._split=function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var s=this._chooseSplitIndex(n,r,i),a=p(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},i.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,n){for(var i,r,o,a,l,u,h,f=1/0,d=1/0,p=e;p<=n-e;p++){var g=s(t,0,p,this.toBBox),m=s(t,p,n,this.toBBox),y=(r=g,o=m,void 0,void 0,void 0,void 0,a=Math.max(r.minX,o.minX),l=Math.max(r.minY,o.minY),u=Math.min(r.maxX,o.maxX),h=Math.min(r.maxY,o.maxY),Math.max(0,u-a)*Math.max(0,h-l)),v=c(g)+c(m);y<f?(f=y,i=p,d=v<d?v:d):y===f&&v<d&&(d=v,i=p)}return i||n-e},i.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},i.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var r=this.toBBox,o=s(t,0,e,r),l=s(t,n-e,n,r),u=h(o)+h(l),c=e;c<n-e;c++){var f=t.children[c];a(o,t.leaf?r(f):f),u+=h(o)}for(var d=n-e-1;d>=e;d--){var p=t.children[d];a(l,t.leaf?r(p):p),u+=h(l)}return u},i.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)a(e[i],t)},i.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},i}()},251:(t,e,n)=>{var i=n(2215),r=n(2584),o=n(609),s=n(8420),a=n(2847),l=n(8923),u=Date.prototype.getTime;function c(t){return null==t}function h(t){return!(!t||"object"!=typeof t||"number"!=typeof t.length||"function"!=typeof t.copy||"function"!=typeof t.slice||t.length>0&&"number"!=typeof t[0])}t.exports=function t(e,n,f){var d=f||{};return!!(d.strict?o(e,n):e===n)||(!e||!n||"object"!=typeof e&&"object"!=typeof n?d.strict?o(e,n):e==n:function(e,n,o){var f,d;if(typeof e!=typeof n)return!1;if(c(e)||c(n))return!1;if(e.prototype!==n.prototype)return!1;if(r(e)!==r(n))return!1;var p=s(e),g=s(n);if(p!==g)return!1;if(p||g)return e.source===n.source&&a(e)===a(n);if(l(e)&&l(n))return u.call(e)===u.call(n);var m=h(e),y=h(n);if(m!==y)return!1;if(m||y){if(e.length!==n.length)return!1;for(f=0;f<e.length;f++)if(e[f]!==n[f])return!1;return!0}if(typeof e!=typeof n)return!1;try{var v=i(e),_=i(n)}catch(t){return!1}if(v.length!==_.length)return!1;for(v.sort(),_.sort(),f=v.length-1;f>=0;f--)if(v[f]!=_[f])return!1;for(f=v.length-1;f>=0;f--)if(!t(e[d=v[f]],n[d],o))return!1;return!0}(e,n,d))}},4289:(t,e,n)=>{"use strict";var i=n(2215),r="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),o=Object.prototype.toString,s=Array.prototype.concat,a=Object.defineProperty,l=n(1044)(),u=a&&l,c=function(t,e,n,i){if(e in t)if(!0===i){if(t[e]===n)return}else if("function"!=typeof(r=i)||"[object Function]"!==o.call(r)||!i())return;var r;u?a(t,e,{configurable:!0,enumerable:!1,value:n,writable:!0}):t[e]=n},h=function(t,e){var n=arguments.length>2?arguments[2]:{},o=i(e);r&&(o=s.call(o,Object.getOwnPropertySymbols(e)));for(var a=0;a<o.length;a+=1)c(t,o[a],e[o[a]],n[o[a]])};h.supportsDescriptors=!!u,t.exports=h},8317:t=>{function e(t,e,n,i){this.dataset=[],this.epsilon=1,this.minPts=2,this.distance=this._euclideanDistance,this.clusters=[],this.noise=[],this._visited=[],this._assigned=[],this._datasetLength=0,this._init(t,e,n,i)}e.prototype.run=function(t,e,n,i){this._init(t,e,n,i);for(var r=0;r<this._datasetLength;r++)if(1!==this._visited[r]){this._visited[r]=1;var o=this._regionQuery(r);if(o.length<this.minPts)this.noise.push(r);else{var s=this.clusters.length;this.clusters.push([]),this._addToCluster(r,s),this._expandCluster(s,o)}}return this.clusters},e.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this.noise=[],this._datasetLength=t.length,this._visited=new Array(this._datasetLength),this._assigned=new Array(this._datasetLength)}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},e.prototype._expandCluster=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(1!==this._visited[i]){this._visited[i]=1;var r=this._regionQuery(i);r.length>=this.minPts&&(e=this._mergeArrays(e,r))}1!==this._assigned[i]&&this._addToCluster(i,t)}},e.prototype._addToCluster=function(t,e){this.clusters[e].push(t),this._assigned[t]=1},e.prototype._regionQuery=function(t){for(var e=[],n=0;n<this._datasetLength;n++)this.distance(this.dataset[t],this.dataset[n])<this.epsilon&&e.push(n);return e},e.prototype._mergeArrays=function(t,e){for(var n=e.length,i=0;i<n;i++){var r=e[i];t.indexOf(r)<0&&t.push(r)}return t},e.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=e)},3781:t=>{function e(t,e,n){this.k=3,this.dataset=[],this.assignments=[],this.centroids=[],this.init(t,e,n)}e.prototype.init=function(t,e,n){this.assignments=[],this.centroids=[],void 0!==t&&(this.dataset=t),void 0!==e&&(this.k=e),void 0!==n&&(this.distance=n)},e.prototype.run=function(t,e){this.init(t,e);for(var n=this.dataset.length,i=0;i<this.k;i++)this.centroids[i]=this.randomCentroid();for(var r=!0;r;){r=this.assign();for(var o=0;o<this.k;o++){for(var s=new Array(c),a=0,l=0;l<c;l++)s[l]=0;for(var u=0;u<n;u++){var c=this.dataset[u].length;if(o===this.assignments[u]){for(l=0;l<c;l++)s[l]+=this.dataset[u][l];a++}}if(a>0){for(l=0;l<c;l++)s[l]/=a;this.centroids[o]=s}else this.centroids[o]=this.randomCentroid(),r=!0}}return this.getClusters()},e.prototype.randomCentroid=function(){var t,e,n=this.dataset.length-1;do{e=Math.round(Math.random()*n),t=this.dataset[e]}while(this.centroids.indexOf(t)>=0);return t},e.prototype.assign=function(){for(var t,e=!1,n=this.dataset.length,i=0;i<n;i++)(t=this.argmin(this.dataset[i],this.centroids,this.distance))!=this.assignments[i]&&(this.assignments[i]=t,e=!0);return e},e.prototype.getClusters=function(){for(var t,e=new Array(this.k),n=0;n<this.assignments.length;n++)void 0===e[t=this.assignments[n]]&&(e[t]=[]),e[t].push(n);return e},e.prototype.argmin=function(t,e,n){for(var i,r=Number.MAX_VALUE,o=0,s=e.length,a=0;a<s;a++)(i=n(t,e[a]))<r&&(r=i,o=a);return o},e.prototype.distance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;){var r=t[i]-e[i];n+=r*r}return Math.sqrt(n)},t.exports&&(t.exports=e)},3763:(t,e,n)=>{if(t.exports)var i=n(7985);function r(t,e,n,i){this.epsilon=1,this.minPts=1,this.distance=this._euclideanDistance,this._reachability=[],this._processed=[],this._coreDistance=0,this._orderedList=[],this._init(t,e,n,i)}r.prototype.run=function(t,e,n,r){this._init(t,e,n,r);for(var o=0,s=this.dataset.length;o<s;o++)if(1!==this._processed[o]){this._processed[o]=1,this.clusters.push([o]);var a=this.clusters.length-1;this._orderedList.push(o);var l=new i(null,null,"asc"),u=this._regionQuery(o);void 0!==this._distanceToCore(o)&&(this._updateQueue(o,u,l),this._expandCluster(a,l))}return this.clusters},r.prototype.getReachabilityPlot=function(){for(var t=[],e=0,n=this._orderedList.length;e<n;e++){var i=this._orderedList[e],r=this._reachability[i];t.push([i,r])}return t},r.prototype._init=function(t,e,n,i){if(t){if(!(t instanceof Array))throw Error("Dataset must be of type array, "+typeof t+" given");this.dataset=t,this.clusters=[],this._reachability=new Array(this.dataset.length),this._processed=new Array(this.dataset.length),this._coreDistance=0,this._orderedList=[]}e&&(this.epsilon=e),n&&(this.minPts=n),i&&(this.distance=i)},r.prototype._updateQueue=function(t,e,n){var i=this;this._coreDistance=this._distanceToCore(t),e.forEach((function(e){if(void 0===i._processed[e]){var r=i.distance(i.dataset[t],i.dataset[e]),o=Math.max(i._coreDistance,r);void 0===i._reachability[e]?(i._reachability[e]=o,n.insert(e,o)):o<i._reachability[e]&&(i._reachability[e]=o,n.remove(e),n.insert(e,o))}}))},r.prototype._expandCluster=function(t,e){for(var n=e.getElements(),i=0,r=n.length;i<r;i++){var o=n[i];if(void 0===this._processed[o]){var s=this._regionQuery(o);this._processed[o]=1,this.clusters[t].push(o),this._orderedList.push(o),void 0!==this._distanceToCore(o)&&(this._updateQueue(o,s,e),this._expandCluster(t,e))}}},r.prototype._distanceToCore=function(t){for(var e=this.epsilon,n=0;n<e;n++)if(this._regionQuery(t,n).length>=this.minPts)return n},r.prototype._regionQuery=function(t,e){e=e||this.epsilon;for(var n=[],i=0,r=this.dataset.length;i<r;i++)this.distance(this.dataset[t],this.dataset[i])<e&&n.push(i);return n},r.prototype._euclideanDistance=function(t,e){for(var n=0,i=Math.min(t.length,e.length);i--;)n+=(t[i]-e[i])*(t[i]-e[i]);return Math.sqrt(n)},t.exports&&(t.exports=r)},7985:t=>{function e(t,e,n){this._queue=[],this._priorities=[],this._sorting="desc",this._init(t,e,n)}e.prototype.insert=function(t,e){for(var n=this._queue.length,i=n;i--;){var r=this._priorities[i];"desc"===this._sorting?e>r&&(n=i):e<r&&(n=i)}this._insertAt(t,e,n)},e.prototype.remove=function(t){for(var e=this._queue.length;e--;)if(t===this._queue[e]){this._queue.splice(e,1),this._priorities.splice(e,1);break}},e.prototype.forEach=function(t){this._queue.forEach(t)},e.prototype.getElements=function(){return this._queue},e.prototype.getElementPriority=function(t){return this._priorities[t]},e.prototype.getPriorities=function(){return this._priorities},e.prototype.getElementsWithPriorities=function(){for(var t=[],e=0,n=this._queue.length;e<n;e++)t.push([this._queue[e],this._priorities[e]]);return t},e.prototype._init=function(t,e,n){if(t&&e){if(this._queue=[],this._priorities=[],t.length!==e.length)throw new Error("Arrays must have the same length");for(var i=0;i<t.length;i++)this.insert(t[i],e[i])}n&&(this._sorting=n)},e.prototype._insertAt=function(t,e,n){this._queue.length===n?(this._queue.push(t),this._priorities.push(e)):(this._queue.splice(n,0,t),this._priorities.splice(n,0,e))},t.exports&&(t.exports=e)},2606:(t,e,n)=>{t.exports&&(t.exports={DBSCAN:n(8317),KMEANS:n(3781),OPTICS:n(3763),PriorityQueue:n(7985)})},9187:t=>{"use strict";function e(t,e,i){i=i||2;var o,s,a,l,h,f,p,g=e&&e.length,m=g?e[0]*i:t.length,y=n(t,0,m,i,!0),v=[];if(!y||y.next===y.prev)return v;if(g&&(y=function(t,e,i,r){var o,s,a,l=[];for(o=0,s=e.length;o<s;o++)(a=n(t,e[o]*r,o<s-1?e[o+1]*r:t.length,r,!1))===a.next&&(a.steiner=!0),l.push(d(a));for(l.sort(u),o=0;o<l.length;o++)i=c(l[o],i);return i}(t,e,y,i)),t.length>80*i){o=a=t[0],s=l=t[1];for(var _=i;_<m;_+=i)(h=t[_])<o&&(o=h),(f=t[_+1])<s&&(s=f),h>a&&(a=h),f>l&&(l=f);p=0!==(p=Math.max(a-o,l-s))?32767/p:0}return r(y,v,i,o,s,p,0),v}function n(t,e,n,i,r){var o,s;if(r===C(t,e,n,i)>0)for(o=e;o<n;o+=i)s=E(o,t[o],t[o+1],s);else for(o=n-i;o>=e;o-=i)s=E(o,t[o],t[o+1],s);return s&&y(s,s.next)&&(S(s),s=s.next),s}function i(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==m(i.prev,i,i.next))i=i.next;else{if(S(i),(i=e=i.prev)===i.next)break;n=!0}}while(n||i!==e);return e}function r(t,e,n,u,c,h,d){if(t){!d&&h&&function(t,e,n,i){var r=t;do{0===r.z&&(r.z=f(r.x,r.y,e,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,n,i,r,o,s,a,l,u=1;do{for(n=t,t=null,o=null,s=0;n;){for(s++,i=n,a=0,e=0;e<u&&(a++,i=i.nextZ);e++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:t=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(s>1)}(r)}(t,u,c,h);for(var p,g,m=t;t.prev!==t.next;)if(p=t.prev,g=t.next,h?s(t,u,c,h):o(t))e.push(p.i/n|0),e.push(t.i/n|0),e.push(g.i/n|0),S(t),t=g.next,m=g.next;else if((t=g)===m){d?1===d?r(t=a(i(t),e,n),e,n,u,c,h,2):2===d&&l(t,e,n,u,c,h):r(i(t),e,n,u,c,h,1);break}}}function o(t){var e=t.prev,n=t,i=t.next;if(m(e,n,i)>=0)return!1;for(var r=e.x,o=n.x,s=i.x,a=e.y,l=n.y,u=i.y,c=r<o?r<s?r:s:o<s?o:s,h=a<l?a<u?a:u:l<u?l:u,f=r>o?r>s?r:s:o>s?o:s,d=a>l?a>u?a:u:l>u?l:u,g=i.next;g!==e;){if(g.x>=c&&g.x<=f&&g.y>=h&&g.y<=d&&p(r,a,o,l,s,u,g.x,g.y)&&m(g.prev,g,g.next)>=0)return!1;g=g.next}return!0}function s(t,e,n,i){var r=t.prev,o=t,s=t.next;if(m(r,o,s)>=0)return!1;for(var a=r.x,l=o.x,u=s.x,c=r.y,h=o.y,d=s.y,g=a<l?a<u?a:u:l<u?l:u,y=c<h?c<d?c:d:h<d?h:d,v=a>l?a>u?a:u:l>u?l:u,_=c>h?c>d?c:d:h>d?h:d,b=f(g,y,e,n,i),x=f(v,_,e,n,i),w=t.prevZ,E=t.nextZ;w&&w.z>=b&&E&&E.z<=x;){if(w.x>=g&&w.x<=v&&w.y>=y&&w.y<=_&&w!==r&&w!==s&&p(a,c,l,h,u,d,w.x,w.y)&&m(w.prev,w,w.next)>=0)return!1;if(w=w.prevZ,E.x>=g&&E.x<=v&&E.y>=y&&E.y<=_&&E!==r&&E!==s&&p(a,c,l,h,u,d,E.x,E.y)&&m(E.prev,E,E.next)>=0)return!1;E=E.nextZ}for(;w&&w.z>=b;){if(w.x>=g&&w.x<=v&&w.y>=y&&w.y<=_&&w!==r&&w!==s&&p(a,c,l,h,u,d,w.x,w.y)&&m(w.prev,w,w.next)>=0)return!1;w=w.prevZ}for(;E&&E.z<=x;){if(E.x>=g&&E.x<=v&&E.y>=y&&E.y<=_&&E!==r&&E!==s&&p(a,c,l,h,u,d,E.x,E.y)&&m(E.prev,E,E.next)>=0)return!1;E=E.nextZ}return!0}function a(t,e,n){var r=t;do{var o=r.prev,s=r.next.next;!y(o,s)&&v(o,r,r.next,s)&&x(o,s)&&x(s,o)&&(e.push(o.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),S(r),S(r.next),r=t=s),r=r.next}while(r!==t);return i(r)}function l(t,e,n,o,s,a){var l=t;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&g(l,u)){var c=w(l,u);return l=i(l,l.next),c=i(c,c.next),r(l,e,n,o,s,a,0),void r(c,e,n,o,s,a,0)}u=u.next}l=l.next}while(l!==t)}function u(t,e){return t.x-e.x}function c(t,e){var n=function(t,e){var n,i=e,r=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s&&(s=a,n=i.x<i.next.x?i:i.next,a===r))return n}i=i.next}while(i!==e);if(!n)return null;var l,u=n,c=n.x,f=n.y,d=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&p(o<f?r:s,o,c,f,o<f?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),x(i,t)&&(l<d||l===d&&(i.x>n.x||i.x===n.x&&h(n,i)))&&(n=i,d=l)),i=i.next}while(i!==u);return n}(t,e);if(!n)return e;var r=w(n,t);return i(r,r.next),i(n,n.next)}function h(t,e){return m(t.prev,t,e.prev)<0&&m(e.next,t,t.next)<0}function f(t,e,n,i,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*r|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*r|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function p(t,e,n,i,r,o,s,a){return(r-s)*(e-a)>=(t-s)*(o-a)&&(t-s)*(i-a)>=(n-s)*(e-a)&&(n-s)*(o-a)>=(r-s)*(i-a)}function g(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&v(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}(t,e)&&(x(t,e)&&x(e,t)&&function(t,e){var n=t,i=!1,r=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}(t,e)&&(m(t.prev,t,e.prev)||m(t,e.prev,e))||y(t,e)&&m(t.prev,t,t.next)>0&&m(e.prev,e,e.next)>0)}function m(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function y(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,n,i){var r=b(m(t,e,n)),o=b(m(t,e,i)),s=b(m(n,i,t)),a=b(m(n,i,e));return r!==o&&s!==a||!(0!==r||!_(t,n,e))||!(0!==o||!_(t,i,e))||!(0!==s||!_(n,t,i))||!(0!==a||!_(n,e,i))}function _(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function b(t){return t>0?1:t<0?-1:0}function x(t,e){return m(t.prev,t,t.next)<0?m(t,e,t.next)>=0&&m(t,t.prev,e)>=0:m(t,e,t.prev)<0||m(t,t.next,e)<0}function w(t,e){var n=new P(t.i,t.x,t.y),i=new P(e.i,e.x,e.y),r=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function E(t,e,n,i){var r=new P(t,e,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function S(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function P(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function C(t,e,n,i){for(var r=0,o=e,s=n-i;o<n;o+=i)r+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return r}t.exports=e,t.exports.default=e,e.deviation=function(t,e,n,i){var r=e&&e.length,o=r?e[0]*n:t.length,s=Math.abs(C(t,0,o,n));if(r)for(var a=0,l=e.length;a<l;a++){var u=e[a]*n,c=a<l-1?e[a+1]*n:t.length;s-=Math.abs(C(t,u,c,n))}var h=0;for(a=0;a<i.length;a+=3){var f=i[a]*n,d=i[a+1]*n,p=i[a+2]*n;h+=Math.abs((t[f]-t[p])*(t[d+1]-t[f+1])-(t[f]-t[d])*(t[p+1]-t[f+1]))}return 0===s&&0===h?0:Math.abs((h-s)/s)},e.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,r=0;r<t.length;r++){for(var o=0;o<t[r].length;o++)for(var s=0;s<e;s++)n.vertices.push(t[r][o][s]);r>0&&(i+=t[r-1].length,n.holes.push(i))}return n}},7648:t=>{"use strict";var e="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,i=Object.prototype.toString,r="[object Function]";t.exports=function(t){var o=this;if("function"!=typeof o||i.call(o)!==r)throw new TypeError(e+o);for(var s,a=n.call(arguments,1),l=Math.max(0,o.length-a.length),u=[],c=0;c<l;c++)u.push("$"+c);if(s=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this,arguments); }")((function(){if(this instanceof s){var e=o.apply(this,a.concat(n.call(arguments)));return Object(e)===e?e:this}return o.apply(t,a.concat(n.call(arguments)))})),o.prototype){var h=function(){};h.prototype=o.prototype,s.prototype=new h,h.prototype=null}return s}},8612:(t,e,n)=>{"use strict";var i=n(7648);t.exports=Function.prototype.bind||i},5972:t=>{"use strict";var e=function(){return"string"==typeof function(){}.name},n=Object.getOwnPropertyDescriptor;if(n)try{n([],"length")}catch(t){n=null}e.functionsHaveConfigurableNames=function(){if(!e()||!n)return!1;var t=n((function(){}),"name");return!!t&&!!t.configurable};var i=Function.prototype.bind;e.boundFunctionsHaveNames=function(){return e()&&"function"==typeof i&&""!==function(){}.bind().name},t.exports=e},9657:(t,e,n)=>{var i=n(251),r=function(t){this.precision=t&&t.precision?t.precision:17,this.direction=!(!t||!t.direction)&&t.direction,this.pseudoNode=!(!t||!t.pseudoNode)&&t.pseudoNode,this.objectComparator=t&&t.objectComparator?t.objectComparator:a};function o(t){return t.coordinates.map((function(e){return{type:t.type.replace("Multi",""),coordinates:e}}))}function s(t,e){return t.hasOwnProperty("coordinates")?t.coordinates.length===e.coordinates.length:t.length===e.length}function a(t,e){return i(t,e,{strict:!0})}r.prototype.compare=function(t,e){if(t.type!==e.type||!s(t,e))return!1;switch(t.type){case"Point":return this.compareCoord(t.coordinates,e.coordinates);case"LineString":return this.compareLine(t.coordinates,e.coordinates,0,!1);case"Polygon":return this.comparePolygon(t,e);case"Feature":return this.compareFeature(t,e);default:if(0===t.type.indexOf("Multi")){var n=this,i=o(t),r=o(e);return i.every((function(t){return this.some((function(e){return n.compare(t,e)}))}),r)}}return!1},r.prototype.compareCoord=function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toFixed(this.precision)!==e[n].toFixed(this.precision))return!1;return!0},r.prototype.compareLine=function(t,e,n,i){if(!s(t,e))return!1;var r=this.pseudoNode?t:this.removePseudo(t),o=this.pseudoNode?e:this.removePseudo(e);if(!i||this.compareCoord(r[0],o[0])||(o=this.fixStartIndex(o,r))){var a=this.compareCoord(r[n],o[n]);return this.direction||a?this.comparePath(r,o):!!this.compareCoord(r[n],o[o.length-(1+n)])&&this.comparePath(r.slice().reverse(),o)}},r.prototype.fixStartIndex=function(t,e){for(var n,i=-1,r=0;r<t.length;r++)if(this.compareCoord(t[r],e[0])){i=r;break}return i>=0&&(n=[].concat(t.slice(i,t.length),t.slice(1,i+1))),n},r.prototype.comparePath=function(t,e){var n=this;return t.every((function(t,e){return n.compareCoord(t,this[e])}),e)},r.prototype.comparePolygon=function(t,e){if(this.compareLine(t.coordinates[0],e.coordinates[0],1,!0)){var n=t.coordinates.slice(1,t.coordinates.length),i=e.coordinates.slice(1,e.coordinates.length),r=this;return n.every((function(t){return this.some((function(e){return r.compareLine(t,e,1,!0)}))}),i)}return!1},r.prototype.compareFeature=function(t,e){return!(t.id!==e.id||!this.objectComparator(t.properties,e.properties)||!this.compareBBox(t,e))&&this.compare(t.geometry,e.geometry)},r.prototype.compareBBox=function(t,e){return!!(!t.bbox&&!e.bbox||t.bbox&&e.bbox&&this.compareCoord(t.bbox,e.bbox))},r.prototype.removePseudo=function(t){return t},t.exports=r},1787:(t,e,n)=>{var i=n(4056),r=n(9500),o=n(9181),s=n(9705).Z,a=o.featureEach,l=(o.coordEach,r.polygon,r.featureCollection);function u(t){var e=new i(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),i.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})):a(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:s(t),e.push(t)})),i.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:s(t),i.prototype.remove.call(this,t,e)},e.clear=function(){return i.prototype.clear.call(this)},e.search=function(t){var e=i.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return i.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=i.prototype.all.call(this);return l(t)},e.toJSON=function(){return i.prototype.toJSON.call(this)},e.fromJSON=function(t){return i.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=s(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=s(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=u,t.exports.default=u},9500:(t,e)=>{"use strict";function n(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function i(t,e,i){if(void 0===i&&(i={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!d(t[0])||!d(t[1]))throw new Error("coordinates must contain numbers");return n({type:"Point",coordinates:t},e,i)}function r(t,e,i){void 0===i&&(i={});for(var r=0,o=t;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<s[s.length-1].length;a++)if(s[s.length-1][a]!==s[0][a])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function o(t,e,i){if(void 0===i&&(i={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return n({type:"LineString",coordinates:t},e,i)}function s(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function a(t,e,i){return void 0===i&&(i={}),n({type:"MultiLineString",coordinates:t},e,i)}function l(t,e,i){return void 0===i&&(i={}),n({type:"MultiPoint",coordinates:t},e,i)}function u(t,e,i){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i)}function c(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t*i}function h(t,n){void 0===n&&(n="kilometers");var i=e.factors[n];if(!i)throw new Error(n+" units is invalid");return t/i}function f(t){return t%(2*Math.PI)*180/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:1.0936*e.earthRadius},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=n,e.geometry=function(t,e,n){switch(void 0===n&&(n={}),t){case"Point":return i(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return r(e).geometry;case"MultiPoint":return l(e).geometry;case"MultiLineString":return a(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=i,e.points=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return i(t,e)})),n)},e.polygon=r,e.polygons=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return r(t,e)})),n)},e.lineString=o,e.lineStrings=function(t,e,n){return void 0===n&&(n={}),s(t.map((function(t){return o(t,e)})),n)},e.featureCollection=s,e.multiLineString=a,e.multiPoint=l,e.multiPolygon=u,e.geometryCollection=function(t,e,i){return void 0===i&&(i={}),n({type:"GeometryCollection",geometries:t},e,i)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n},e.radiansToLength=c,e.lengthToRadians=h,e.lengthToDegrees=function(t,e){return f(h(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=f,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,n){if(void 0===e&&(e="kilometers"),void 0===n&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(h(t,e),n)},e.convertArea=function(t,n,i){if(void 0===n&&(n="meters"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=e.areaFactors[n];if(!r)throw new Error("invalid original units");var o=e.areaFactors[i];if(!o)throw new Error("invalid final units");return t/r*o},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!d(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}},9181:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=n(9500);function r(t,e,n){if(null!==t)for(var i,o,s,a,l,u,c,h,f=0,d=0,p=t.type,g="FeatureCollection"===p,m="Feature"===p,y=g?t.features.length:1,v=0;v<y;v++){l=(h=!!(c=g?t.features[v].geometry:m?t.geometry:t)&&"GeometryCollection"===c.type)?c.geometries.length:1;for(var _=0;_<l;_++){var b=0,x=0;if(null!==(a=h?c.geometries[_]:c)){u=a.coordinates;var w=a.type;switch(f=!n||"Polygon"!==w&&"MultiPolygon"!==w?0:1,w){case null:break;case"Point":if(!1===e(u,d,v,b,x))return!1;d++,b++;break;case"LineString":case"MultiPoint":for(i=0;i<u.length;i++){if(!1===e(u[i],d,v,b,x))return!1;d++,"MultiPoint"===w&&b++}"LineString"===w&&b++;break;case"Polygon":case"MultiLineString":for(i=0;i<u.length;i++){for(o=0;o<u[i].length-f;o++){if(!1===e(u[i][o],d,v,b,x))return!1;d++}"MultiLineString"===w&&b++,"Polygon"===w&&x++}"Polygon"===w&&b++;break;case"MultiPolygon":for(i=0;i<u.length;i++){for(x=0,o=0;o<u[i].length;o++){for(s=0;s<u[i][o].length-f;s++){if(!1===e(u[i][o][s],d,v,b,x))return!1;d++}x++}b++}break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===r(a.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function o(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&!1!==e(t.features[n].properties,n);n++);break;case"Feature":e(t.properties,0)}}function s(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function a(t,e){var n,i,r,o,s,a,l,u,c,h,f=0,d="FeatureCollection"===t.type,p="Feature"===t.type,g=d?t.features.length:1;for(n=0;n<g;n++){for(a=d?t.features[n].geometry:p?t.geometry:t,u=d?t.features[n].properties:p?t.properties:{},c=d?t.features[n].bbox:p?t.bbox:void 0,h=d?t.features[n].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,u,c,h))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],f,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,u,c,h))return!1;f++}}function l(t,e){a(t,(function(t,n,r,o,s){var a,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(i.feature(t,r,{bbox:o,id:s}),n,0)&&void 0}switch(l){case"MultiPoint":a="Point";break;case"MultiLineString":a="LineString";break;case"MultiPolygon":a="Polygon"}for(var u=0;u<t.coordinates.length;u++){var c={type:a,coordinates:t.coordinates[u]};if(!1===e(i.feature(c,r),n,u))return!1}}))}function u(t,e){l(t,(function(t,n,o){var s=0;if(t.geometry){var a=t.geometry.type;if("Point"!==a&&"MultiPoint"!==a){var l,u=0,c=0,h=0;return!1!==r(t,(function(r,a,f,d,p){if(void 0===l||n>u||d>c||p>h)return l=r,u=n,c=d,h=p,void(s=0);var g=i.lineString([l,r],t.properties);if(!1===e(g,n,o,p,s))return!1;s++,l=r}))&&void 0}}}))}function c(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,n,r){if(null!==t.geometry){var o=t.geometry.type,s=t.geometry.coordinates;switch(o){case"LineString":if(!1===e(t,n,r,0,0))return!1;break;case"Polygon":for(var a=0;a<s.length;a++)if(!1===e(i.lineString(s[a],t.properties),n,r,a))return!1}}}))}e.coordAll=function(t){var e=[];return r(t,(function(t){e.push(t)})),e},e.coordEach=r,e.coordReduce=function(t,e,n,i){var o=n;return r(t,(function(t,i,r,s,a){o=0===i&&void 0===n?t:e(o,t,i,r,s,a)}),i),o},e.featureEach=s,e.featureReduce=function(t,e,n){var i=n;return s(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i},e.findPoint=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":return i.point(u,l,e);case"MultiPoint":return o<0&&(o=u.length+o),i.point(u[o],l,e);case"LineString":return a<0&&(a=u.length+a),i.point(u[a],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a),i.point(u[s][a],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a),i.point(u[o][a],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a),i.point(u[o][s][a],l,e)}throw new Error("geojson is invalid")},e.findSegment=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var n,r=e.featureIndex||0,o=e.multiFeatureIndex||0,s=e.geometryIndex||0,a=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":r<0&&(r=t.features.length+r),l=l||t.features[r].properties,n=t.features[r].geometry;break;case"Feature":l=l||t.properties,n=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":n=t;break;default:throw new Error("geojson is invalid")}if(null===n)return null;var u=n.coordinates;switch(n.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=u.length+a-1),i.lineString([u[a],u[a+1]],l,e);case"Polygon":return s<0&&(s=u.length+s),a<0&&(a=u[s].length+a-1),i.lineString([u[s][a],u[s][a+1]],l,e);case"MultiLineString":return o<0&&(o=u.length+o),a<0&&(a=u[o].length+a-1),i.lineString([u[o][a],u[o][a+1]],l,e);case"MultiPolygon":return o<0&&(o=u.length+o),s<0&&(s=u[o].length+s),a<0&&(a=u[o][s].length-a-1),i.lineString([u[o][s][a],u[o][s][a+1]],l,e)}throw new Error("geojson is invalid")},e.flattenEach=l,e.flattenReduce=function(t,e,n){var i=n;return l(t,(function(t,r,o){i=0===r&&0===o&&void 0===n?t:e(i,t,r,o)})),i},e.geomEach=a,e.geomReduce=function(t,e,n){var i=n;return a(t,(function(t,r,o,s,a){i=0===r&&void 0===n?t:e(i,t,r,o,s,a)})),i},e.lineEach=c,e.lineReduce=function(t,e,n){var i=n;return c(t,(function(t,r,o,s){i=0===r&&void 0===n?t:e(i,t,r,o,s)})),i},e.propEach=o,e.propReduce=function(t,e,n){var i=n;return o(t,(function(t,r){i=0===r&&void 0===n?t:e(i,t,r)})),i},e.segmentEach=u,e.segmentReduce=function(t,e,n){var i=n,r=!1;return u(t,(function(t,o,s,a,l){i=!1===r&&void 0===n?t:e(i,t,o,s,a,l),r=!0})),i}},4056:function(t){t.exports=function(){"use strict";function t(t,i,r,o,s){!function t(n,i,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,l=i-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(n,i,Math.max(r,Math.floor(i-l*c/a+h)),Math.min(o,Math.floor(i+(a-l)*c/a+h)),s)}var f=n[i],d=r,p=o;for(e(n,r,i),s(n[o],f)>0&&e(n,r,o);d<p;){for(e(n,d,p),d++,p--;s(n[d],f)<0;)d++;for(;s(n[p],f)>0;)p--}0===s(n[r],f)?e(n,r,p):e(n,++p,o),p<=i&&(r=p+1),i<=p&&(o=p-1)}}(t,i,r||0,o||t.length-1,s||n)}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}var i=function(t){void 0===t&&(t=9),this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,n,i,r){r||(r=p(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o=e;o<n;o++){var s=t.children[o];a(r,t.leaf?i(s):s)}return r}function a(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function l(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function h(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function p(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,n,i,r,o){for(var s=[n,i];s.length;)if(!((i=s.pop())-(n=s.pop())<=r)){var a=n+Math.ceil((i-n)/r/2)*r;t(e,a,n,i,o),s.push(n,a,a,i)}}return i.prototype.all=function(){return this._all(this.data,[])},i.prototype.search=function(t){var e=this.data,n=[];if(!d(t,e))return n;for(var i=this.toBBox,r=[];e;){for(var o=0;o<e.children.length;o++){var s=e.children[o],a=e.leaf?i(s):s;d(t,a)&&(e.leaf?n.push(s):f(t,a)?this._all(s,n):r.push(s))}e=r.pop()}return n},i.prototype.collides=function(t){var e=this.data;if(!d(t,e))return!1;for(var n=[];e;){for(var i=0;i<e.children.length;i++){var r=e.children[i],o=e.leaf?this.toBBox(r):r;if(d(t,o)){if(e.leaf||f(t,o))return!0;n.push(r)}}e=n.pop()}return!1},i.prototype.load=function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0;e<t.length;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var i=this.data;this.data=n,n=i}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},i.prototype.insert=function(t){return t&&this._insert(t,this.data.height-1),this},i.prototype.clear=function(){return this.data=p([]),this},i.prototype.remove=function(t,e){if(!t)return this;for(var n,i,o,s=this.data,a=this.toBBox(t),l=[],u=[];s||l.length;){if(s||(s=l.pop(),i=l[l.length-1],n=u.pop(),o=!0),s.leaf){var c=r(t,s.children,e);if(-1!==c)return s.children.splice(c,1),l.push(s),this._condense(l),this}o||s.leaf||!f(s,a)?i?(n++,s=i.children[n],o=!1):s=null:(l.push(s),u.push(n),n=0,i=s,s=s.children[0])}return this},i.prototype.toBBox=function(t){return t},i.prototype.compareMinX=function(t,e){return t.minX-e.minX},i.prototype.compareMinY=function(t,e){return t.minY-e.minY},i.prototype.toJSON=function(){return this.data},i.prototype.fromJSON=function(t){return this.data=t,this},i.prototype._all=function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},i.prototype._build=function(t,e,n,i){var r,s=n-e+1,a=this._maxEntries;if(s<=a)return o(r=p(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(s)/Math.log(a)),a=Math.ceil(s/Math.pow(a,i-1))),(r=p([])).leaf=!1,r.height=i;var l=Math.ceil(s/a),u=l*Math.ceil(Math.sqrt(a));g(t,e,n,u,this.compareMinX);for(var c=e;c<=n;c+=u){var h=Math.min(c+u-1,n);g(t,c,h,l,this.compareMinY);for(var f=c;f<=h;f+=l){var d=Math.min(f+l-1,h);r.children.push(this._build(t,f,d,i-1))}}return o(r,this.toBBox),r},i.prototype._chooseSubtree=function(t,e,n,i){for(;i.push(e),!e.leaf&&i.length-1!==n;){for(var r=1/0,o=1/0,s=void 0,a=0;a<e.children.length;a++){var l=e.children[a],u=c(l),h=(f=t,d=l,(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-u);h<o?(o=h,r=u<r?u:r,s=l):h===o&&u<r&&(r=u,s=l)}e=s||e.children[0]}var f,d;return e},i.prototype._insert=function(t,e,n){var i=n?t:this.toBBox(t),r=[],o=this._chooseSubtree(i,this.data,e,r);for(o.children.push(t),a(o,i);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(i,r,e)},i.prototype._split=function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var s=this._chooseSplitIndex(n,r,i),a=p(n.children.splice(s,n.children.length-s));a.height=n.height,a.leaf=n.leaf,o(n,this.toBBox),o(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},i.prototype._splitRoot=function(t,e){this.data=p([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},i.prototype._chooseSplitIndex=function(t,e,n){for(var i,r,o,a,l,u,h,f=1/0,d=1/0,p=e;p<=n-e;p++){var g=s(t,0,p,this.toBBox),m=s(t,p,n,this.toBBox),y=(r=g,o=m,void 0,void 0,void 0,void 0,a=Math.max(r.minX,o.minX),l=Math.max(r.minY,o.minY),u=Math.min(r.maxX,o.maxX),h=Math.min(r.maxY,o.maxY),Math.max(0,u-a)*Math.max(0,h-l)),v=c(g)+c(m);y<f?(f=y,i=p,d=v<d?v:d):y===f&&v<d&&(d=v,i=p)}return i||n-e},i.prototype._chooseSplitAxis=function(t,e,n){var i=t.leaf?this.compareMinX:l,r=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},i.prototype._allDistMargin=function(t,e,n,i){t.children.sort(i);for(var r=this.toBBox,o=s(t,0,e,r),l=s(t,n-e,n,r),u=h(o)+h(l),c=e;c<n-e;c++){var f=t.children[c];a(o,t.leaf?r(f):f),u+=h(o)}for(var d=n-e-1;d>=e;d--){var p=t.children[d];a(l,t.leaf?r(p):p),u+=h(l)}return u},i.prototype._adjustParentBBoxes=function(t,e,n){for(var i=n;i>=0;i--)a(e[i],t)},i.prototype._condense=function(t){for(var e=t.length-1,n=void 0;e>=0;e--)0===t[e].children.length?e>0?(n=t[e-1].children).splice(n.indexOf(t[e]),1):this.clear():o(t[e],this.toBBox)},i}()},210:(t,e,n)=>{"use strict";var i,r=SyntaxError,o=Function,s=TypeError,a=function(t){try{return o('"use strict"; return ('+t+").constructor;")()}catch(t){}},l=Object.getOwnPropertyDescriptor;if(l)try{l({},"")}catch(t){l=null}var u=function(){throw new s},c=l?function(){try{return u}catch(t){try{return l(arguments,"callee").get}catch(t){return u}}}():u,h=n(1405)(),f=Object.getPrototypeOf||function(t){return t.__proto__},d={},p="undefined"==typeof Uint8Array?i:f(Uint8Array),g={"%AggregateError%":"undefined"==typeof AggregateError?i:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?i:ArrayBuffer,"%ArrayIteratorPrototype%":h?f([][Symbol.iterator]()):i,"%AsyncFromSyncIteratorPrototype%":i,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":"undefined"==typeof Atomics?i:Atomics,"%BigInt%":"undefined"==typeof BigInt?i:BigInt,"%BigInt64Array%":"undefined"==typeof BigInt64Array?i:BigInt64Array,"%BigUint64Array%":"undefined"==typeof BigUint64Array?i:BigUint64Array,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?i:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?i:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?i:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?i:FinalizationRegistry,"%Function%":o,"%GeneratorFunction%":d,"%Int8Array%":"undefined"==typeof Int8Array?i:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?i:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?i:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":h?f(f([][Symbol.iterator]())):i,"%JSON%":"object"==typeof JSON?JSON:i,"%Map%":"undefined"==typeof Map?i:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&h?f((new Map)[Symbol.iterator]()):i,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?i:Promise,"%Proxy%":"undefined"==typeof Proxy?i:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?i:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?i:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&h?f((new Set)[Symbol.iterator]()):i,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?i:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":h?f(""[Symbol.iterator]()):i,"%Symbol%":h?Symbol:i,"%SyntaxError%":r,"%ThrowTypeError%":c,"%TypedArray%":p,"%TypeError%":s,"%Uint8Array%":"undefined"==typeof Uint8Array?i:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?i:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?i:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?i:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?i:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?i:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?i:WeakSet};try{null.error}catch(t){var m=f(f(t));g["%Error.prototype%"]=m}var y=function t(e){var n;if("%AsyncFunction%"===e)n=a("async function () {}");else if("%GeneratorFunction%"===e)n=a("function* () {}");else if("%AsyncGeneratorFunction%"===e)n=a("async function* () {}");else if("%AsyncGenerator%"===e){var i=t("%AsyncGeneratorFunction%");i&&(n=i.prototype)}else if("%AsyncIteratorPrototype%"===e){var r=t("%AsyncGenerator%");r&&(n=f(r.prototype))}return g[e]=n,n},v={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},_=n(8612),b=n(7642),x=_.call(Function.call,Array.prototype.concat),w=_.call(Function.apply,Array.prototype.splice),E=_.call(Function.call,String.prototype.replace),S=_.call(Function.call,String.prototype.slice),P=_.call(Function.call,RegExp.prototype.exec),C=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,I=/\\(\\)?/g,T=function(t){var e=S(t,0,1),n=S(t,-1);if("%"===e&&"%"!==n)throw new r("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==e)throw new r("invalid intrinsic syntax, expected opening `%`");var i=[];return E(t,C,(function(t,e,n,r){i[i.length]=n?E(r,I,"$1"):e||t})),i},M=function(t,e){var n,i=t;if(b(v,i)&&(i="%"+(n=v[i])[0]+"%"),b(g,i)){var o=g[i];if(o===d&&(o=y(i)),void 0===o&&!e)throw new s("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:o}}throw new r("intrinsic "+t+" does not exist!")};t.exports=function(t,e){if("string"!=typeof t||0===t.length)throw new s("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof e)throw new s('"allowMissing" argument must be a boolean');if(null===P(/^%?[^%]*%?$/,t))throw new r("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=T(t),i=n.length>0?n[0]:"",o=M("%"+i+"%",e),a=o.name,u=o.value,c=!1,h=o.alias;h&&(i=h[0],w(n,x([0,1],h)));for(var f=1,d=!0;f<n.length;f+=1){var p=n[f],m=S(p,0,1),y=S(p,-1);if(('"'===m||"'"===m||"`"===m||'"'===y||"'"===y||"`"===y)&&m!==y)throw new r("property names with quotes must have matching quotes");if("constructor"!==p&&d||(c=!0),b(g,a="%"+(i+="."+p)+"%"))u=g[a];else if(null!=u){if(!(p in u)){if(!e)throw new s("base intrinsic for "+t+" exists, but the property is not available.");return}if(l&&f+1>=n.length){var v=l(u,p);u=(d=!!v)&&"get"in v&&!("originalValue"in v.get)?v.get:u[p]}else d=b(u,p),u=u[p];d&&!c&&(g[a]=u)}}return u}},840:(t,e,n)=>{var i;!function(r,o,s,a){"use strict";var l,u=["","webkit","Moz","MS","ms","o"],c=o.createElement("div"),h="function",f=Math.round,d=Math.abs,p=Date.now;function g(t,e,n){return setTimeout(w(t,n),e)}function m(t,e,n){return!!Array.isArray(t)&&(y(t,n[e],n),!0)}function y(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==a)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function v(t,e,n){var i="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=r.console&&(r.console.warn||r.console.log);return o&&o.call(r.console,i,n),t.apply(this,arguments)}}l="function"!=typeof Object.assign?function(t){if(t===a||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==a&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}:Object.assign;var _=v((function(t,e,n){for(var i=Object.keys(e),r=0;r<i.length;)(!n||n&&t[i[r]]===a)&&(t[i[r]]=e[i[r]]),r++;return t}),"extend","Use `assign`."),b=v((function(t,e){return _(t,e,!0)}),"merge","Use `assign`.");function x(t,e,n){var i,r=e.prototype;(i=t.prototype=Object.create(r)).constructor=t,i._super=r,n&&l(i,n)}function w(t,e){return function(){return t.apply(e,arguments)}}function E(t,e){return typeof t==h?t.apply(e&&e[0]||a,e):t}function S(t,e){return t===a?e:t}function P(t,e,n){y(M(e),(function(e){t.addEventListener(e,n,!1)}))}function C(t,e,n){y(M(e),(function(e){t.removeEventListener(e,n,!1)}))}function I(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function T(t,e){return t.indexOf(e)>-1}function M(t){return t.trim().split(/\s+/g)}function L(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function A(t){return Array.prototype.slice.call(t,0)}function O(t,e,n){for(var i=[],r=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];L(r,s)<0&&i.push(t[o]),r[o]=s,o++}return n&&(i=e?i.sort((function(t,n){return t[e]>n[e]})):i.sort()),i}function N(t,e){for(var n,i,r=e[0].toUpperCase()+e.slice(1),o=0;o<u.length;){if((i=(n=u[o])?n+r:e)in t)return i;o++}return a}var R=1;function k(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||r}var D="ontouchstart"in r,F=N(r,"PointerEvent")!==a,z=D&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),B="touch",j="mouse",U=25,V=1,G=2,q=4,W=8,H=1,X=2,Y=4,Z=8,K=16,$=X|Y,Q=Z|K,J=$|Q,tt=["x","y"],et=["clientX","clientY"];function nt(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){E(t.options.enable,[t])&&n.handler(e)},this.init()}function it(t,e,n){var i=n.pointers.length,r=n.changedPointers.length,o=e&V&&i-r==0,s=e&(q|W)&&i-r==0;n.isFirst=!!o,n.isFinal=!!s,o&&(t.session={}),n.eventType=e,function(t,e){var n=t.session,i=e.pointers,r=i.length;n.firstInput||(n.firstInput=rt(e)),r>1&&!n.firstMultiple?n.firstMultiple=rt(e):1===r&&(n.firstMultiple=!1);var o=n.firstInput,s=n.firstMultiple,l=s?s.center:o.center,u=e.center=ot(i);e.timeStamp=p(),e.deltaTime=e.timeStamp-o.timeStamp,e.angle=ut(l,u),e.distance=lt(l,u),function(t,e){var n=e.center,i=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};e.eventType!==V&&o.eventType!==q||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=r.x+(n.x-i.x),e.deltaY=r.y+(n.y-i.y)}(n,e),e.offsetDirection=at(e.deltaX,e.deltaY);var c,h,f=st(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=f.x,e.overallVelocityY=f.y,e.overallVelocity=d(f.x)>d(f.y)?f.x:f.y,e.scale=s?(c=s.pointers,lt((h=i)[0],h[1],et)/lt(c[0],c[1],et)):1,e.rotation=s?function(t,e){return ut(e[1],e[0],et)+ut(t[1],t[0],et)}(s.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,function(t,e){var n,i,r,o,s=t.lastInterval||e,l=e.timeStamp-s.timeStamp;if(e.eventType!=W&&(l>U||s.velocity===a)){var u=e.deltaX-s.deltaX,c=e.deltaY-s.deltaY,h=st(l,u,c);i=h.x,r=h.y,n=d(h.x)>d(h.y)?h.x:h.y,o=at(u,c),t.lastInterval=e}else n=s.velocity,i=s.velocityX,r=s.velocityY,o=s.direction;e.velocity=n,e.velocityX=i,e.velocityY=r,e.direction=o}(n,e);var g=t.element;I(e.srcEvent.target,g)&&(g=e.srcEvent.target),e.target=g}(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function rt(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:f(t.pointers[n].clientX),clientY:f(t.pointers[n].clientY)},n++;return{timeStamp:p(),pointers:e,center:ot(e),deltaX:t.deltaX,deltaY:t.deltaY}}function ot(t){var e=t.length;if(1===e)return{x:f(t[0].clientX),y:f(t[0].clientY)};for(var n=0,i=0,r=0;r<e;)n+=t[r].clientX,i+=t[r].clientY,r++;return{x:f(n/e),y:f(i/e)}}function st(t,e,n){return{x:e/t||0,y:n/t||0}}function at(t,e){return t===e?H:d(t)>=d(e)?t<0?X:Y:e<0?Z:K}function lt(t,e,n){n||(n=tt);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return Math.sqrt(i*i+r*r)}function ut(t,e,n){n||(n=tt);var i=e[n[0]]-t[n[0]],r=e[n[1]]-t[n[1]];return 180*Math.atan2(r,i)/Math.PI}nt.prototype={handler:function(){},init:function(){this.evEl&&P(this.element,this.evEl,this.domHandler),this.evTarget&&P(this.target,this.evTarget,this.domHandler),this.evWin&&P(k(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(k(this.element),this.evWin,this.domHandler)}};var ct={mousedown:V,mousemove:G,mouseup:q},ht="mousedown",ft="mousemove mouseup";function dt(){this.evEl=ht,this.evWin=ft,this.pressed=!1,nt.apply(this,arguments)}x(dt,nt,{handler:function(t){var e=ct[t.type];e&V&&0===t.button&&(this.pressed=!0),e&G&&1!==t.which&&(e=q),this.pressed&&(e&q&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:j,srcEvent:t}))}});var pt={pointerdown:V,pointermove:G,pointerup:q,pointercancel:W,pointerout:W},gt={2:B,3:"pen",4:j,5:"kinect"},mt="pointerdown",yt="pointermove pointerup pointercancel";function vt(){this.evEl=mt,this.evWin=yt,nt.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(mt="MSPointerDown",yt="MSPointerMove MSPointerUp MSPointerCancel"),x(vt,nt,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),r=pt[i],o=gt[t.pointerType]||t.pointerType,s=o==B,a=L(e,t.pointerId,"pointerId");r&V&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):r&(q|W)&&(n=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),n&&e.splice(a,1))}});var _t={touchstart:V,touchmove:G,touchend:q,touchcancel:W},bt="touchstart",xt="touchstart touchmove touchend touchcancel";function wt(){this.evTarget=bt,this.evWin=xt,this.started=!1,nt.apply(this,arguments)}function Et(t,e){var n=A(t.touches),i=A(t.changedTouches);return e&(q|W)&&(n=O(n.concat(i),"identifier",!0)),[n,i]}x(wt,nt,{handler:function(t){var e=_t[t.type];if(e===V&&(this.started=!0),this.started){var n=Et.call(this,t,e);e&(q|W)&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}}});var St={touchstart:V,touchmove:G,touchend:q,touchcancel:W},Pt="touchstart touchmove touchend touchcancel";function Ct(){this.evTarget=Pt,this.targetIds={},nt.apply(this,arguments)}function It(t,e){var n=A(t.touches),i=this.targetIds;if(e&(V|G)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,o,s=A(t.changedTouches),a=[],l=this.target;if(o=n.filter((function(t){return I(t.target,l)})),e===V)for(r=0;r<o.length;)i[o[r].identifier]=!0,r++;for(r=0;r<s.length;)i[s[r].identifier]&&a.push(s[r]),e&(q|W)&&delete i[s[r].identifier],r++;return a.length?[O(o.concat(a),"identifier",!0),a]:void 0}x(Ct,nt,{handler:function(t){var e=St[t.type],n=It.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:B,srcEvent:t})}});var Tt=2500,Mt=25;function Lt(){nt.apply(this,arguments);var t=w(this.handler,this);this.touch=new Ct(this.manager,t),this.mouse=new dt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function At(t,e){t&V?(this.primaryTouch=e.changedPointers[0].identifier,Ot.call(this,e)):t&(q|W)&&Ot.call(this,e)}function Ot(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var t=i.indexOf(n);t>-1&&i.splice(t,1)}),Tt)}}function Nt(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],o=Math.abs(e-r.x),s=Math.abs(n-r.y);if(o<=Mt&&s<=Mt)return!0}return!1}x(Lt,nt,{handler:function(t,e,n){var i=n.pointerType==B,r=n.pointerType==j;if(!(r&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)At.call(this,e,n);else if(r&&Nt.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Rt=N(c.style,"touchAction"),kt=Rt!==a,Dt="compute",Ft="auto",zt="manipulation",Bt="none",jt="pan-x",Ut="pan-y",Vt=function(){if(!kt)return!1;var t={},e=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(n){t[n]=!e||r.CSS.supports("touch-action",n)})),t}();function Gt(t,e){this.manager=t,this.set(e)}Gt.prototype={set:function(t){t==Dt&&(t=this.compute()),kt&&this.manager.element.style&&Vt[t]&&(this.manager.element.style[Rt]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return y(this.manager.recognizers,(function(e){E(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))})),function(t){if(T(t,Bt))return Bt;var e=T(t,jt),n=T(t,Ut);return e&&n?Bt:e||n?e?jt:Ut:T(t,zt)?zt:Ft}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var i=this.actions,r=T(i,Bt)&&!Vt[Bt],o=T(i,Ut)&&!Vt[Ut],s=T(i,jt)&&!Vt[jt];if(r){var a=1===t.pointers.length,l=t.distance<2,u=t.deltaTime<250;if(a&&l&&u)return}if(!s||!o)return r||o&&n&$||s&&n&Q?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var qt=1,Wt=2,Ht=4,Xt=8,Yt=Xt,Zt=16,Kt=32;function $t(t){this.options=l({},this.defaults,t||{}),this.id=R++,this.manager=null,this.options.enable=S(this.options.enable,!0),this.state=qt,this.simultaneous={},this.requireFail=[]}function Qt(t){return t&Zt?"cancel":t&Xt?"end":t&Ht?"move":t&Wt?"start":""}function Jt(t){return t==K?"down":t==Z?"up":t==X?"left":t==Y?"right":""}function te(t,e){var n=e.manager;return n?n.get(t):t}function ee(){$t.apply(this,arguments)}function ne(){ee.apply(this,arguments),this.pX=null,this.pY=null}function ie(){ee.apply(this,arguments)}function re(){$t.apply(this,arguments),this._timer=null,this._input=null}function oe(){ee.apply(this,arguments)}function se(){ee.apply(this,arguments)}function ae(){$t.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function le(t,e){return(e=e||{}).recognizers=S(e.recognizers,le.defaults.preset),new ue(t,e)}function ue(t,e){this.options=l({},le.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new(this.options.inputClass||(F?vt:z?Ct:D?Lt:dt))(this,it),this.touchAction=new Gt(this,this.options.touchAction),ce(this,!0),y(this.options.recognizers,(function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])}),this)}function ce(t,e){var n,i=t.element;i.style&&(y(t.options.cssProps,(function(r,o){n=N(i.style,o),e?(t.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=t.oldCssProps[n]||""})),e||(t.oldCssProps={}))}$t.prototype={defaults:{},set:function(t){return l(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(m(t,"recognizeWith",this))return this;var e=this.simultaneous;return e[(t=te(t,this)).id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return m(t,"dropRecognizeWith",this)||(t=te(t,this),delete this.simultaneous[t.id]),this},requireFailure:function(t){if(m(t,"requireFailure",this))return this;var e=this.requireFail;return-1===L(e,t=te(t,this))&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(m(t,"dropRequireFailure",this))return this;t=te(t,this);var e=L(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,n=this.state;function i(n){e.manager.emit(n,t)}n<Xt&&i(e.options.event+Qt(n)),i(e.options.event),t.additionalEvent&&i(t.additionalEvent),n>=Xt&&i(e.options.event+Qt(n))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=Kt},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(Kt|qt)))return!1;t++}return!0},recognize:function(t){var e=l({},t);if(!E(this.options.enable,[this,e]))return this.reset(),void(this.state=Kt);this.state&(Yt|Zt|Kt)&&(this.state=qt),this.state=this.process(e),this.state&(Wt|Ht|Xt|Zt)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},x(ee,$t,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=e&(Wt|Ht),r=this.attrTest(t);return i&&(n&W||!r)?e|Zt:i||r?n&q?e|Xt:e&Wt?e|Ht:Wt:Kt}}),x(ne,ee,{defaults:{event:"pan",threshold:10,pointers:1,direction:J},getTouchAction:function(){var t=this.options.direction,e=[];return t&$&&e.push(Ut),t&Q&&e.push(jt),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,r=t.direction,o=t.deltaX,s=t.deltaY;return r&e.direction||(e.direction&$?(r=0===o?H:o<0?X:Y,n=o!=this.pX,i=Math.abs(t.deltaX)):(r=0===s?H:s<0?Z:K,n=s!=this.pY,i=Math.abs(t.deltaY))),t.direction=r,n&&i>e.threshold&&r&e.direction},attrTest:function(t){return ee.prototype.attrTest.call(this,t)&&(this.state&Wt||!(this.state&Wt)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Jt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),x(ie,ee,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Bt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Wt)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),x(re,$t,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Ft]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(q|W)&&!r)this.reset();else if(t.eventType&V)this.reset(),this._timer=g((function(){this.state=Yt,this.tryEmit()}),e.time,this);else if(t.eventType&q)return Yt;return Kt},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===Yt&&(t&&t.eventType&q?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}}),x(oe,ee,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Bt]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Wt)}}),x(se,ee,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:$|Q,pointers:1},getTouchAction:function(){return ne.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&($|Q)?e=t.overallVelocity:n&$?e=t.overallVelocityX:n&Q&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&d(e)>this.options.velocity&&t.eventType&q},emit:function(t){var e=Jt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),x(ae,$t,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[zt]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&V&&0===this.count)return this.failTimeout();if(i&&r&&n){if(t.eventType!=q)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||lt(this.pCenter,t.center)<e.posThreshold;if(this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t,0==this.count%e.taps)return this.hasRequireFailures()?(this._timer=g((function(){this.state=Yt,this.tryEmit()}),e.interval,this),Wt):Yt}return Kt},failTimeout:function(){return this._timer=g((function(){this.state=Kt}),this.options.interval,this),Kt},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Yt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),le.VERSION="2.0.7",le.defaults={domEvents:!1,touchAction:Dt,enable:!0,inputTarget:null,inputClass:null,preset:[[oe,{enable:!1}],[ie,{enable:!1},["rotate"]],[se,{direction:$}],[ne,{direction:$},["swipe"]],[ae],[ae,{event:"doubletap",taps:2},["tap"]],[re]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},ue.prototype={set:function(t){return l(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var n;this.touchAction.preventDefaults(t);var i=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&Yt)&&(r=e.curRecognizer=null);for(var o=0;o<i.length;)n=i[o],2===e.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(t),!r&&n.state&(Wt|Ht|Xt)&&(r=e.curRecognizer=n),o++}},get:function(t){if(t instanceof $t)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(m(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(m(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=L(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==a&&e!==a){var n=this.handlers;return y(M(t),(function(t){n[t]=n[t]||[],n[t].push(e)})),this}},off:function(t,e){if(t!==a){var n=this.handlers;return y(M(t),(function(t){e?n[t]&&n[t].splice(L(n[t],e),1):delete n[t]})),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=o.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&ce(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(le,{INPUT_START:V,INPUT_MOVE:G,INPUT_END:q,INPUT_CANCEL:W,STATE_POSSIBLE:qt,STATE_BEGAN:Wt,STATE_CHANGED:Ht,STATE_ENDED:Xt,STATE_RECOGNIZED:Yt,STATE_CANCELLED:Zt,STATE_FAILED:Kt,DIRECTION_NONE:H,DIRECTION_LEFT:X,DIRECTION_RIGHT:Y,DIRECTION_UP:Z,DIRECTION_DOWN:K,DIRECTION_HORIZONTAL:$,DIRECTION_VERTICAL:Q,DIRECTION_ALL:J,Manager:ue,Input:nt,TouchAction:Gt,TouchInput:Ct,MouseInput:dt,PointerEventInput:vt,TouchMouseInput:Lt,SingleTouchInput:wt,Recognizer:$t,AttrRecognizer:ee,Tap:ae,Pan:ne,Swipe:se,Pinch:ie,Rotate:oe,Press:re,on:P,off:C,each:y,merge:b,extend:_,assign:l,inherit:x,bindFn:w,prefixed:N}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=le,(i=function(){return le}.call(e,n,e,t))===a||(t.exports=i)}(window,document)},1044:(t,e,n)=>{"use strict";var i=n(210)("%Object.defineProperty%",!0),r=function(){if(i)try{return i({},"a",{value:1}),!0}catch(t){return!1}return!1};r.hasArrayLengthDefineBug=function(){if(!r())return null;try{return 1!==i([],"length",{value:1}).length}catch(t){return!0}},t.exports=r},1405:(t,e,n)=>{"use strict";var i="undefined"!=typeof Symbol&&Symbol,r=n(5419);t.exports=function(){return"function"==typeof i&&"function"==typeof Symbol&&"symbol"==typeof i("foo")&&"symbol"==typeof Symbol("bar")&&r()}},5419:t=>{"use strict";t.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var t={},e=Symbol("test"),n=Object(e);if("string"==typeof e)return!1;if("[object Symbol]"!==Object.prototype.toString.call(e))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(e in t[e]=42,t)return!1;if("function"==typeof Object.keys&&0!==Object.keys(t).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(t).length)return!1;var i=Object.getOwnPropertySymbols(t);if(1!==i.length||i[0]!==e)return!1;if(!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var r=Object.getOwnPropertyDescriptor(t,e);if(42!==r.value||!0!==r.enumerable)return!1}return!0}},6410:(t,e,n)=>{"use strict";var i=n(5419);t.exports=function(){return i()&&!!Symbol.toStringTag}},7642:(t,e,n)=>{"use strict";var i=n(8612);t.exports=i.call(Function.call,Object.prototype.hasOwnProperty)},2584:(t,e,n)=>{"use strict";var i=n(6410)(),r=n(1924)("Object.prototype.toString"),o=function(t){return!(i&&t&&"object"==typeof t&&Symbol.toStringTag in t)&&"[object Arguments]"===r(t)},s=function(t){return!!o(t)||null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Array]"!==r(t)&&"[object Function]"===r(t.callee)},a=function(){return o(arguments)}();o.isLegacyArguments=s,t.exports=a?o:s},8923:(t,e,n)=>{"use strict";var i=Date.prototype.getDay,r=Object.prototype.toString,o=n(6410)();t.exports=function(t){return"object"==typeof t&&null!==t&&(o?function(t){try{return i.call(t),!0}catch(t){return!1}}(t):"[object Date]"===r.call(t))}},8420:(t,e,n)=>{"use strict";var i,r,o,s,a=n(1924),l=n(6410)();if(l){i=a("Object.prototype.hasOwnProperty"),r=a("RegExp.prototype.exec"),o={};var u=function(){throw o};s={toString:u,valueOf:u},"symbol"==typeof Symbol.toPrimitive&&(s[Symbol.toPrimitive]=u)}var c=a("Object.prototype.toString"),h=Object.getOwnPropertyDescriptor;t.exports=l?function(t){if(!t||"object"!=typeof t)return!1;var e=h(t,"lastIndex");if(!e||!i(e,"value"))return!1;try{r(t,s)}catch(t){return t===o}}:function(t){return!(!t||"object"!=typeof t&&"function"!=typeof t)&&"[object RegExp]"===c(t)}},7418:t=>{"use strict";var e=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(t){i[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,r){for(var o,s,a=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),l=1;l<arguments.length;l++){for(var u in o=Object(arguments[l]))n.call(o,u)&&(a[u]=o[u]);if(e){s=e(o);for(var c=0;c<s.length;c++)i.call(o,s[c])&&(a[s[c]]=o[s[c]])}}return a}},4244:t=>{"use strict";var e=function(t){return t!=t};t.exports=function(t,n){return 0===t&&0===n?1/t==1/n:t===n||!(!e(t)||!e(n))}},609:(t,e,n)=>{"use strict";var i=n(4289),r=n(5559),o=n(4244),s=n(5624),a=n(2281),l=r(s(),Object);i(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},5624:(t,e,n)=>{"use strict";var i=n(4244);t.exports=function(){return"function"==typeof Object.is?Object.is:i}},2281:(t,e,n)=>{"use strict";var i=n(5624),r=n(4289);t.exports=function(){var t=i();return r(Object,{is:t},{is:function(){return Object.is!==t}}),t}},8987:(t,e,n)=>{"use strict";var i;if(!Object.keys){var r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,s=n(1414),a=Object.prototype.propertyIsEnumerable,l=!a.call({toString:null},"toString"),u=a.call((function(){}),"prototype"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],h=function(t){var e=t.constructor;return e&&e.prototype===t},f={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var t in window)try{if(!f["$"+t]&&r.call(window,t)&&null!==window[t]&&"object"==typeof window[t])try{h(window[t])}catch(t){return!0}}catch(t){return!0}return!1}();i=function(t){var e=null!==t&&"object"==typeof t,n="[object Function]"===o.call(t),i=s(t),a=e&&"[object String]"===o.call(t),f=[];if(!e&&!n&&!i)throw new TypeError("Object.keys called on a non-object");var p=u&&n;if(a&&t.length>0&&!r.call(t,0))for(var g=0;g<t.length;++g)f.push(String(g));if(i&&t.length>0)for(var m=0;m<t.length;++m)f.push(String(m));else for(var y in t)p&&"prototype"===y||!r.call(t,y)||f.push(String(y));if(l)for(var v=function(t){if("undefined"==typeof window||!d)return h(t);try{return h(t)}catch(t){return!1}}(t),_=0;_<c.length;++_)v&&"constructor"===c[_]||!r.call(t,c[_])||f.push(c[_]);return f}}t.exports=i},2215:(t,e,n)=>{"use strict";var i=Array.prototype.slice,r=n(1414),o=Object.keys,s=o?function(t){return o(t)}:n(8987),a=Object.keys;s.shim=function(){if(Object.keys){var t=function(){var t=Object.keys(arguments);return t&&t.length===arguments.length}(1,2);t||(Object.keys=function(t){return r(t)?a(i.call(t)):a(t)})}else Object.keys=s;return Object.keys||s},t.exports=s},1414:t=>{"use strict";var e=Object.prototype.toString;t.exports=function(t){var n=e.call(t),i="[object Arguments]"===n;return i||(i="[object Array]"!==n&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&"[object Function]"===e.call(t.callee)),i}},1895:t=>{t.exports=function(t,e,n,i){var r=t[0],o=t[1],s=!1;void 0===n&&(n=0),void 0===i&&(i=e.length);for(var a=(i-n)/2,l=0,u=a-1;l<a;u=l++){var c=e[n+2*l+0],h=e[n+2*l+1],f=e[n+2*u+0],d=e[n+2*u+1];h>o!=d>o&&r<(f-c)*(o-h)/(d-h)+c&&(s=!s)}return s}},6960:(t,e,n)=>{var i=n(1895),r=n(8139);t.exports=function(t,e,n,o){return e.length>0&&Array.isArray(e[0])?r(t,e,n,o):i(t,e,n,o)},t.exports.nested=r,t.exports.flat=i},8139:t=>{t.exports=function(t,e,n,i){var r=t[0],o=t[1],s=!1;void 0===n&&(n=0),void 0===i&&(i=e.length);for(var a=i-n,l=0,u=a-1;l<a;u=l++){var c=e[l+n][0],h=e[l+n][1],f=e[u+n][0],d=e[u+n][1];h>o!=d>o&&r<(f-c)*(o-h)/(d-h)+c&&(s=!s)}return s}},2676:function(t){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}var i=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function r(t,e){return t>e?1:t<e?-1:0}function o(t,e,n){for(var r=new i(null,null),o=r,s=r;;){var a=n(t,e.key);if(a<0){if(null===e.left)break;if(n(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}s.left=e,s=e,e=e.left}else{if(!(a>0))break;if(null===e.right)break;if(n(t,e.right.key)>0&&(l=e.right,e.right=l.left,l.left=e,null===(e=l).right))break;o.right=e,o=e,e=e.right}}return o.right=e.left,s.left=e.right,e.left=r.right,e.right=r.left,e}function s(t,e,n,r){var s=new i(t,e);if(null===n)return s.left=s.right=null,s;var a=r(t,(n=o(t,n,r)).key);return a<0?(s.left=n.left,s.right=n,n.left=null):a>=0&&(s.right=n.right,s.left=n,n.right=null),s}function a(t,e,n){var i=null,r=null;if(e){var s=n((e=o(t,e,n)).key,t);0===s?(i=e.left,r=e.right):s<0?(r=e.right,e.right=null,i=e):(i=e.left,e.left=null,r=e)}return{left:i,right:r}}function l(t,e,n,i,r){if(t){i(e+(n?"└── ":"├── ")+r(t)+"\n");var o=e+(n?"    ":"│   ");t.left&&l(t.left,o,!1,i,r),t.right&&l(t.right,o,!0,i,r)}}var u=function(){function t(t){void 0===t&&(t=r),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=s(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var n=new i(t,e);null===this._root&&(n.left=n.right=null,this._size++,this._root=n);var r=this._comparator,s=o(t,this._root,r),a=r(t,s.key);return 0===a?this._root=s:(a<0?(n.left=s.left,n.right=s,s.left=null):a>0&&(n.right=s.right,n.left=s,s.right=null),this._size++,this._root=n),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,n){var i;return null===e?null:0===n(t,(e=o(t,e,n)).key)?(null===e.left?i=e.right:(i=o(t,e.left,n)).right=e.right,this._size--,i):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=o(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=o(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,n=this._comparator;e;){var i=n(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var n=this._root,i=[],r=!1;!r;)null!==n?(i.push(n),n=n.left):0!==i.length?(n=i.pop(),t.call(e,n),n=n.right):r=!0;return this},t.prototype.range=function(t,e,n,i){for(var r=[],o=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&n.call(i,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var n=e.key;return t.push(n)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var n=e.data;return t.push(n)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,n=!1,i=0,r=[];!n;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),i===t)return e;i++,e=e.right}else n=!0;return null},t.prototype.next=function(t){var e=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?(n=e,e=e.left):e=e.right}return n},t.prototype.prev=function(t){var e=this._root,n=null;if(null!==t.left){for(n=t.left;n.right;)n=n.right;return n}for(var i=this._comparator;e;){var r=i(t.key,e.key);if(0===r)break;r<0?e=e.left:(n=e,e=e.right)}return n},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){for(var e=t,n=[],r=!1,o=new i(null,null),s=o;!r;)e?(n.push(e),e=e.left):n.length>0?e=(e=s=s.next=n.pop()).right:r=!0;return s.next=null,o.next}(this._root)},t.prototype.load=function(t,e,n){void 0===e&&(e=[]),void 0===n&&(n=!1);var r=t.length,o=this._comparator;if(n&&f(t,e,0,r-1,o),null===this._root)this._root=c(t,e,0,r),this._size=r;else{var s=function(t,e,n){for(var r=new i(null,null),o=r,s=t,a=e;null!==s&&null!==a;)n(s.key,a.key)<0?(o.next=s,s=s.next):(o.next=a,a=a.next),o=o.next;return null!==s?o.next=s:null!==a&&(o.next=a),r.next}(this.toList(),function(t,e){for(var n=new i(null,null),r=n,o=0;o<t.length;o++)r=r.next=new i(t[o],e[o]);return r.next=null,n.next}(t,e),o);r=this._size+r,this._root=h({head:s},0,r)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return l(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,n){var i=this._comparator,r=a(t,this._root,i),l=r.left,u=r.right;i(t,e)<0?u=s(e,n,u,i):l=s(e,n,l,i),this._root=function(t,e,n){return null===e?t:(null===t||((e=o(t.key,e,n)).left=t),e)}(l,u,i)},t.prototype.split=function(t){return a(t,this._root,this._comparator)},t}();function c(t,e,n,r){var o=r-n;if(o>0){var s=n+Math.floor(o/2),a=t[s],l=e[s],u=new i(a,l);return u.left=c(t,e,n,s),u.right=c(t,e,s+1,r),u}return null}function h(t,e,n){var i=n-e;if(i>0){var r=e+Math.floor(i/2),o=h(t,e,r),s=t.head;return s.left=o,t.head=t.head.next,s.right=h(t,r+1,n),s}return null}function f(t,e,n,i,r){if(!(n>=i)){for(var o=t[n+i>>1],s=n-1,a=i+1;;){do{s++}while(r(t[s],o)<0);do{a--}while(r(t[a],o)>0);if(s>=a)break;var l=t[s];t[s]=t[a],t[a]=l,l=e[s],e[s]=e[a],e[a]=l}f(t,e,n,a,r),f(t,e,a+1,i,r)}}var d=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},p=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,i=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:n,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:i,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},g=Number.EPSILON;void 0===g&&(g=Math.pow(2,-52));var m=g*g,y=function(t,e){if(-g<t&&t<g&&-g<e&&e<g)return 0;var n=t-e;return n*n<m*t*e?0:t<e?-1:1},v=function(){function e(){t(this,e),this.reset()}return n(e,[{key:"reset",value:function(){this.xRounder=new _,this.yRounder=new _}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),_=function(){function e(){t(this,e),this.tree=new u,this.round(0)}return n(e,[{key:"round",value:function(t){var e=this.tree.add(t),n=this.tree.prev(e);if(null!==n&&0===y(e.key,n.key))return this.tree.remove(t),n.key;var i=this.tree.next(e);return null!==i&&0===y(e.key,i.key)?(this.tree.remove(t),i.key):t}}]),e}(),b=new v,x=function(t,e){return t.x*e.y-t.y*e.x},w=function(t,e){return t.x*e.x+t.y*e.y},E=function(t,e,n){var i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y},o=x(i,r);return y(o,0)},S=function(t){return Math.sqrt(w(t,t))},P=function(t,e,n){var i={x:e.x-t.x,y:e.y-t.y},r={x:n.x-t.x,y:n.y-t.y};return w(r,i)/S(r)/S(i)},C=function(t,e,n){return 0===e.y?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},I=function(t,e,n){return 0===e.x?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},T=function(){function e(n,i){t(this,e),void 0===n.events?n.events=[this]:n.events.push(this),this.point=n,this.isLeft=i}return n(e,null,[{key:"compare",value:function(t,n){var i=e.comparePoints(t.point,n.point);return 0!==i?i:(t.point!==n.point&&t.link(n),t.isLeft!==n.isLeft?t.isLeft?1:-1:L.compare(t.segment,n.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),n(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,n=0,i=e.length;n<i;n++){var r=e[n];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var n=this.point.events[e];if(void 0===n.segment.consumedBy)for(var i=e+1;i<t;i++){var r=this.point.events[i];void 0===r.consumedBy&&n.otherSE.point.events===r.otherSE.point.events&&n.segment.consume(r.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,n=this.point.events.length;e<n;e++){var i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,n=new Map,i=function(i){var r,o,s,a,l,u=i.otherSE;n.set(i,{sine:(r=e.point,o=t.point,s=u.point,a={x:o.x-r.x,y:o.y-r.y},l={x:s.x-r.x,y:s.y-r.y},x(l,a)/S(l)/S(a)),cosine:P(e.point,t.point,u.point)})};return function(t,e){n.has(t)||i(t),n.has(e)||i(e);var r=n.get(t),o=r.sine,s=r.cosine,a=n.get(e),l=a.sine,u=a.cosine;return o>=0&&l>=0?s<u?1:s>u?-1:0:o<0&&l<0?s<u?-1:s>u?1:0:l<o?-1:l>o?1:0}}}]),e}(),M=0,L=function(){function e(n,i,r,o){t(this,e),this.id=++M,this.leftSE=n,n.segment=this,n.otherSE=i,this.rightSE=i,i.segment=this,i.otherSE=n,this.rings=r,this.windings=o}return n(e,null,[{key:"compare",value:function(t,e){var n=t.leftSE.point.x,i=e.leftSE.point.x,r=t.rightSE.point.x,o=e.rightSE.point.x;if(o<n)return 1;if(r<i)return-1;var s=t.leftSE.point.y,a=e.leftSE.point.y,l=t.rightSE.point.y,u=e.rightSE.point.y;if(n<i){if(a<s&&a<l)return 1;if(a>s&&a>l)return-1;var c=t.comparePoint(e.leftSE.point);if(c<0)return 1;if(c>0)return-1;var h=e.comparePoint(t.rightSE.point);return 0!==h?h:-1}if(n>i){if(s<a&&s<u)return-1;if(s>a&&s>u)return 1;var f=e.comparePoint(t.leftSE.point);if(0!==f)return f;var d=t.comparePoint(e.rightSE.point);return d<0?1:d>0?-1:1}if(s<a)return-1;if(s>a)return 1;if(r<o){var p=e.comparePoint(t.rightSE.point);if(0!==p)return p}if(r>o){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(r!==o){var m=l-s,y=r-n,v=u-a,_=o-i;if(m>y&&v<_)return 1;if(m<y&&v>_)return-1}return r>o?1:r<o||l<u?-1:l>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),n(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(e.x===n.x)return t.x===e.x?0:t.x<e.x?1:-1;var r=(t.y-e.y)/i.y,o=e.x+r*i.x;if(t.x===o)return 0;var s=(t.x-e.x)/i.x,a=e.y+s*i.y;return t.y===a?0:t.y<a?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),n=t.bbox(),i=p(e,n);if(null===i)return null;var r=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,a=t.rightSE.point,l=d(e,s)&&0===this.comparePoint(s),u=d(n,r)&&0===t.comparePoint(r),c=d(e,a)&&0===this.comparePoint(a),h=d(n,o)&&0===t.comparePoint(o);if(u&&l)return h&&!c?o:!h&&c?a:null;if(u)return c&&r.x===a.x&&r.y===a.y?null:r;if(l)return h&&o.x===s.x&&o.y===s.y?null:s;if(h&&c)return null;if(h)return o;if(c)return a;var f=function(t,e,n,i){if(0===e.x)return I(n,i,t.x);if(0===i.x)return I(t,e,n.x);if(0===e.y)return C(n,i,t.y);if(0===i.y)return C(t,e,n.y);var r=x(e,i);if(0==r)return null;var o={x:n.x-t.x,y:n.y-t.y},s=x(o,e)/r,a=x(o,i)/r;return{x:(t.x+a*e.x+(n.x+s*i.x))/2,y:(t.y+a*e.y+(n.y+s*i.y))/2}}(r,this.vector(),s,t.vector());return null===f?null:d(i,f)?b.round(f.x,f.y):null}},{key:"split",value:function(t){var n=[],i=void 0!==t.events,r=new T(t,!0),o=new T(t,!1),s=this.rightSE;this.replaceRightSE(o),n.push(o),n.push(r);var a=new e(r,s,this.rings.slice(),this.windings.slice());return T.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),T.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(r.checkForConsuming(),o.checkForConsuming()),n}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,n=this.windings.length;e<n;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var n=this,i=t;n.consumedBy;)n=n.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var r=e.compare(n,i);if(0!==r){if(r>0){var o=n;n=i,i=o}if(n.prev===i){var s=n;n=i,i=s}for(var a=0,l=i.rings.length;a<l;a++){var u=i.rings[a],c=i.windings[a],h=n.rings.indexOf(u);-1===h?(n.rings.push(u),n.windings.push(c)):n.windings[h]+=c}i.rings=null,i.windings=null,i.consumedBy=n,i.leftSE.consumedBy=n.leftSE,i.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys,r=0,o=this.rings.length;r<o;r++){var s=this.rings[r],a=this.windings[r],l=e.indexOf(s);-1===l?(e.push(s),n.push(a)):n[l]+=a}for(var u=[],c=[],h=0,f=e.length;h<f;h++)if(0!==n[h]){var d=e[h],p=d.poly;if(-1===c.indexOf(p))if(d.isExterior)u.push(p);else{-1===c.indexOf(p)&&c.push(p);var g=u.indexOf(d.poly);-1!==g&&u.splice(g,1)}}for(var m=0,y=u.length;m<y;m++){var v=u[m].multiPoly;-1===i.indexOf(v)&&i.push(v)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(j.type){case"union":var n=0===t.length,i=0===e.length;this._isInResult=n!==i;break;case"intersection":var r,o;t.length<e.length?(r=t.length,o=e.length):(r=e.length,o=t.length),this._isInResult=o===j.numMultiPolys&&r<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var a=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=a(t)!==a(e);break;default:throw new Error("Unrecognized operation type found ".concat(j.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,n,i){var r,o,s,a=T.comparePoints(t,n);if(a<0)r=t,o=n,s=1;else{if(!(a>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));r=n,o=t,s=-1}return new e(new T(r,!0),new T(o,!1),[i],[s])}}]),e}(),A=function(){function e(n,i,r){if(t(this,e),!Array.isArray(n)||0===n.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=i,this.isExterior=r,this.segments=[],"number"!=typeof n[0][0]||"number"!=typeof n[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var o=b.round(n[0][0],n[0][1]);this.bbox={ll:{x:o.x,y:o.y},ur:{x:o.x,y:o.y}};for(var s=o,a=1,l=n.length;a<l;a++){if("number"!=typeof n[a][0]||"number"!=typeof n[a][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=b.round(n[a][0],n[a][1]);u.x===s.x&&u.y===s.y||(this.segments.push(L.fromRing(s,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),s=u)}o.x===s.x&&o.y===s.y||this.segments.push(L.fromRing(s,o,this))}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.segments.length;e<n;e++){var i=this.segments[e];t.push(i.leftSE),t.push(i.rightSE)}return t}}]),e}(),O=function(){function e(n,i){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new A(n[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,o=n.length;r<o;r++){var s=new A(n[r],this,!1);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.interiorRings.push(s)}this.multiPoly=i}return n(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,n=this.interiorRings.length;e<n;e++)for(var i=this.interiorRings[e].getSweepEvents(),r=0,o=i.length;r<o;r++)t.push(i[r]);return t}}]),e}(),N=function(){function e(n,i){if(t(this,e),!Array.isArray(n))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof n[0][0][0]&&(n=[n])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,o=n.length;r<o;r++){var s=new O(n[r],this);s.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=s.bbox.ll.x),s.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=s.bbox.ll.y),s.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=s.bbox.ur.x),s.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=s.bbox.ur.y),this.polys.push(s)}this.isSubject=i}return n(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++)for(var i=this.polys[e].getSweepEvents(),r=0,o=i.length;r<o;r++)t.push(i[r]);return t}}]),e}(),R=function(){function e(n){t(this,e),this.events=n;for(var i=0,r=n.length;i<r;i++)n[i].segment.ringOut=this;this.poly=null}return n(e,null,[{key:"factory",value:function(t){for(var n=[],i=0,r=t.length;i<r;i++){var o=t[i];if(o.isInResult()&&!o.ringOut){for(var s=null,a=o.leftSE,l=o.rightSE,u=[a],c=a.point,h=[];s=a,a=l,u.push(a),a.point!==c;)for(;;){var f=a.getAvailableLinkedEvents();if(0===f.length){var d=u[0].point,p=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(d.x,",")+" ".concat(d.y,"]. Last matching segment found ends at")+" [".concat(p.x,", ").concat(p.y,"]."))}if(1===f.length){l=f[0].otherSE;break}for(var g=null,m=0,y=h.length;m<y;m++)if(h[m].point===a.point){g=m;break}if(null===g){h.push({index:u.length,point:a.point});var v=a.getLeftmostComparator(s);l=f.sort(v)[0].otherSE;break}var _=h.splice(g)[0],b=u.splice(_.index);b.unshift(b[0].otherSE),n.push(new e(b.reverse()))}n.push(new e(u))}}return n}}]),n(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],n=1,i=this.events.length-1;n<i;n++){var r=this.events[n].point,o=this.events[n+1].point;0!==E(r,t,o)&&(e.push(r),t=r)}if(1===e.length)return null;var s=e[0],a=e[1];0===E(s,t,a)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,c=this.isExteriorRing()?e.length:-1,h=[],f=u;f!=c;f+=l)h.push([e[f].x,e[f].y]);return h}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,n=this.events.length;e<n;e++){var i=this.events[e];T.compare(t,i)>0&&(t=i)}for(var r=t.segment.prevInResult(),o=r?r.prevInResult():null;;){if(!r)return null;if(!o)return r.ringOut;if(o.ringOut!==r.ringOut)return o.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=o.prevInResult(),o=r?r.prevInResult():null}}}]),e}(),k=function(){function e(n){t(this,e),this.exteriorRing=n,n.poly=this,this.interiorRings=[]}return n(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,n=this.interiorRings.length;e<n;e++){var i=this.interiorRings[e].getGeom();null!==i&&t.push(i)}return t}}]),e}(),D=function(){function e(n){t(this,e),this.rings=n,this.polys=this._composePolys(n)}return n(e,[{key:"getGeom",value:function(){for(var t=[],e=0,n=this.polys.length;e<n;e++){var i=this.polys[e].getGeom();null!==i&&t.push(i)}return t}},{key:"_composePolys",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];if(!r.poly)if(r.isExteriorRing())e.push(new k(r));else{var o=r.enclosingRing();o.poly||e.push(new k(o)),o.poly.addInterior(r)}}return e}}]),e}(),F=function(){function e(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:L.compare;t(this,e),this.queue=n,this.tree=new u(i),this.segments=[]}return n(e,[{key:"process",value:function(t){var e=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),n;var i=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!i)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=i,o=i,s=void 0,a=void 0;void 0===s;)null===(r=this.tree.prev(r))?s=null:void 0===r.key.consumedBy&&(s=r.key);for(;void 0===a;)null===(o=this.tree.next(o))?a=null:void 0===o.key.consumedBy&&(a=o.key);if(t.isLeft){var l=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(l=u),!s.isAnEndpoint(u)))for(var c=this._splitSafely(s,u),h=0,f=c.length;h<f;h++)n.push(c[h])}var d=null;if(a){var p=a.getIntersection(e);if(null!==p&&(e.isAnEndpoint(p)||(d=p),!a.isAnEndpoint(p)))for(var g=this._splitSafely(a,p),m=0,y=g.length;m<y;m++)n.push(g[m])}if(null!==l||null!==d){var v;v=null===l?d:null===d||T.comparePoints(l,d)<=0?l:d,this.queue.remove(e.rightSE),n.push(e.rightSE);for(var _=e.split(v),b=0,x=_.length;b<x;b++)n.push(_[b])}n.length>0?(this.tree.remove(e),n.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&a){var w=s.getIntersection(a);if(null!==w){if(!s.isAnEndpoint(w))for(var E=this._splitSafely(s,w),S=0,P=E.length;S<P;S++)n.push(E[S]);if(!a.isAnEndpoint(w))for(var C=this._splitSafely(a,w),I=0,M=C.length;I<M;I++)n.push(C[I])}}this.tree.remove(e)}return n}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var n=t.rightSE;this.queue.remove(n);var i=t.split(e);return i.push(n),void 0===t.consumedBy&&this.tree.insert(t),i}}]),e}(),z="undefined"!=typeof process&&"MISSING_ENV_VAR".POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,B="undefined"!=typeof process&&"MISSING_ENV_VAR".POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,j=new(function(){function e(){t(this,e)}return n(e,[{key:"run",value:function(t,e,n){j.type=t,b.reset();for(var i=[new N(e,!0)],r=0,o=n.length;r<o;r++)i.push(new N(n[r],!1));if(j.numMultiPolys=i.length,"difference"===j.type)for(var s=i[0],a=1;a<i.length;)null!==p(i[a].bbox,s.bbox)?a++:i.splice(a,1);if("intersection"===j.type)for(var l=0,c=i.length;l<c;l++)for(var h=i[l],f=l+1,d=i.length;f<d;f++)if(null===p(h.bbox,i[f].bbox))return[];for(var g=new u(T.compare),m=0,y=i.length;m<y;m++)for(var v=i[m].getSweepEvents(),_=0,x=v.length;_<x;_++)if(g.insert(v[_]),g.size>z)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var w=new F(g),E=g.size,S=g.pop();S;){var P=S.key;if(g.size===E){var C=P.segment;throw new Error("Unable to pop() ".concat(P.isLeft?"left":"right"," SweepEvent ")+"[".concat(P.point.x,", ").concat(P.point.y,"] from segment #").concat(C.id," ")+"[".concat(C.leftSE.point.x,", ").concat(C.leftSE.point.y,"] -> ")+"[".concat(C.rightSE.point.x,", ").concat(C.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(g.size>z)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(w.segments.length>B)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var I=w.process(P),M=0,L=I.length;M<L;M++){var A=I[M];void 0===A.consumedBy&&g.insert(A)}E=g.size,S=g.pop()}b.reset();var O=R.factory(w.segments);return new D(O).getGeom()}}]),e}());return{union:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return j.run("union",t,n)},intersection:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return j.run("intersection",t,n)},xor:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return j.run("xor",t,n)},difference:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return j.run("difference",t,n)}}}()},8166:function(t){t.exports=function(){"use strict";function t(n,i,r,o,s){for(;o>r;){if(o-r>600){var a=o-r+1,l=i-r+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(n,i,Math.max(r,Math.floor(i-l*c/a+h)),Math.min(o,Math.floor(i+(a-l)*c/a+h)),s)}var f=n[i],d=r,p=o;for(e(n,r,i),s(n[o],f)>0&&e(n,r,o);d<p;){for(e(n,d,p),d++,p--;s(n[d],f)<0;)d++;for(;s(n[p],f)>0;)p--}0===s(n[r],f)?e(n,r,p):e(n,++p,o),p<=i&&(r=p+1),i<=p&&(o=p-1)}}function e(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function n(t,e){return t<e?-1:t>e?1:0}return function(e,i,r,o,s){t(e,i,r||0,o||e.length-1,s||n)}}()},5510:(t,e,n)=>{"use strict";t.exports=r,t.exports.default=r;var i=n(8166);function r(t,e){if(!(this instanceof r))return new r(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function o(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function s(t,e){a(t,0,t.children.length,e,t)}function a(t,e,n,i,r){r||(r=g(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,s=e;s<n;s++)o=t.children[s],l(r,t.leaf?i(o):o);return r}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function u(t,e){return t.minX-e.minX}function c(t,e){return t.minY-e.minY}function h(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function f(t){return t.maxX-t.minX+(t.maxY-t.minY)}function d(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function p(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,n,r,o){for(var s,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=r||(s=e+Math.ceil((n-e)/r/2)*r,i(t,s,e,n,o),a.push(e,s,s,n))}r.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!p(t,e))return n;for(var r,o,s,a,l=[];e;){for(r=0,o=e.children.length;r<o;r++)s=e.children[r],p(t,a=e.leaf?i(s):s)&&(e.leaf?n.push(s):d(t,a)?this._all(s,n):l.push(s));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!p(t,e))return!1;for(var i,r,o,s,a=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],p(t,s=e.leaf?n(o):o)){if(e.leaf||d(t,s))return!0;a.push(o)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,s,a=this.data,l=this.toBBox(t),u=[],c=[];a||u.length;){if(a||(a=u.pop(),i=u[u.length-1],n=c.pop(),s=!0),a.leaf&&-1!==(r=o(t,a.children,e)))return a.children.splice(r,1),u.push(a),this._condense(u),this;s||a.leaf||!d(a,l)?i?(n++,a=i.children[n],s=!1):a=null:(u.push(a),c.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:u,compareMinY:c,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,a=this._maxEntries;if(o<=a)return s(r=g(t.slice(e,n+1)),this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,i-1))),(r=g([])).leaf=!1,r.height=i;var l,u,c,h,f=Math.ceil(o/a),d=f*Math.ceil(Math.sqrt(a));for(m(t,e,n,d,this.compareMinX),l=e;l<=n;l+=d)for(m(t,l,c=Math.min(l+d-1,n),f,this.compareMinY),u=l;u<=c;u+=f)h=Math.min(u+f-1,c),r.children.push(this._build(t,u,h,i-1));return s(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,s,a,l,u,c,f,d,p;i.push(e),!e.leaf&&i.length-1!==n;){for(c=f=1/0,r=0,o=e.children.length;r<o;r++)l=h(s=e.children[r]),d=t,p=s,(u=(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-l)<f?(f=u,c=l<c?l:c,a=s):u===f&&l<c&&(c=l,a=s);e=a||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],s=this._chooseSubtree(r,this.data,e,o);for(s.children.push(t),l(s,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),a=g(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,s(n,this.toBBox),s(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,s,l,u,c,f,d,p,g,m,y,v;for(u=c=1/0,i=e;i<=n-e;i++)d=r=a(t,0,i,this.toBBox),p=o=a(t,i,n,this.toBBox),void 0,void 0,void 0,void 0,g=Math.max(d.minX,p.minX),m=Math.max(d.minY,p.minY),y=Math.min(d.maxX,p.maxX),v=Math.min(d.maxY,p.maxY),s=Math.max(0,y-g)*Math.max(0,v-m),l=h(r)+h(o),s<u?(u=s,f=i,c=l<c?l:c):s===u&&l<c&&(c=l,f=i);return f},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:u,r=t.leaf?this.compareMinY:c;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,s=this.toBBox,u=a(t,0,e,s),c=a(t,n-e,n,s),h=f(u)+f(c);for(r=e;r<n-e;r++)o=t.children[r],l(u,t.leaf?s(o):o),h+=f(u);for(r=n-e-1;r>=e;r--)o=t.children[r],l(c,t.leaf?s(o):o),h+=f(c);return h},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)l(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():s(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},4448:(t,e,n)=>{"use strict";var i=n(7294),r=n(3840);function o(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,a={};function l(t,e){u(t,e),u(t+"Capture",e)}function u(t,e){for(a[t]=e,t=0;t<e.length;t++)s.add(e[t])}var c=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function g(t,e,n,i,r,o,s){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(t){m[t]=new g(t,0,!1,t,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(t){var e=t[0];m[e]=new g(e,1,!1,t[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(t){m[t]=new g(t,2,!1,t.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(t){m[t]=new g(t,2,!1,t,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(t){m[t]=new g(t,3,!1,t.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(t){m[t]=new g(t,3,!0,t,null,!1,!1)})),["capture","download"].forEach((function(t){m[t]=new g(t,4,!1,t,null,!1,!1)})),["cols","rows","size","span"].forEach((function(t){m[t]=new g(t,6,!1,t,null,!1,!1)})),["rowSpan","start"].forEach((function(t){m[t]=new g(t,5,!1,t.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(t){return t[1].toUpperCase()}function _(t,e,n,i){var r=m.hasOwnProperty(e)?m[e]:null;(null!==r?0!==r.type:i||!(2<e.length)||"o"!==e[0]&&"O"!==e[0]||"n"!==e[1]&&"N"!==e[1])&&(function(t,e,n,i){if(null==e||function(t,e,n,i){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!i&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}(t,e,n,i))return!0;if(i)return!1;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}(e,n,r,i)&&(n=null),i||null===r?function(t){return!!h.call(p,t)||!h.call(d,t)&&(f.test(t)?p[t]=!0:(d[t]=!0,!1))}(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=null===n?3!==r.type&&"":n:(e=r.attributeName,i=r.attributeNamespace,null===n?t.removeAttribute(e):(n=3===(r=r.type)||4===r&&!0===n?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(t){var e=t.replace(y,v);m[e]=new g(e,1,!1,t,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(t){var e=t.replace(y,v);m[e]=new g(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(t){var e=t.replace(y,v);m[e]=new g(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!1,!1)})),m.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(t){m[t]=new g(t,1,!1,t.toLowerCase(),null,!0,!0)}));var b=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),w=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),I=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),O=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var N=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function k(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=R&&t[R]||t["@@iterator"])?t:null}var D,F=Object.assign;function z(t){if(void 0===D)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);D=e&&e[1]||""}return"\n"+D+t}var B=!1;function j(t,e){if(!t||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(e,[])}catch(t){var i=t}Reflect.construct(t,[],e)}else{try{e.call()}catch(t){i=t}t.call(e.prototype)}else{try{throw Error()}catch(t){i=t}t()}}catch(e){if(e&&i&&"string"==typeof e.stack){for(var r=e.stack.split("\n"),o=i.stack.split("\n"),s=r.length-1,a=o.length-1;1<=s&&0<=a&&r[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(r[s]!==o[a]){if(1!==s||1!==a)do{if(s--,0>--a||r[s]!==o[a]){var l="\n"+r[s].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}}while(1<=s&&0<=a);break}}}finally{B=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?z(t):""}function U(t){switch(t.tag){case 5:return z(t.type);case 16:return z("Lazy");case 13:return z("Suspense");case 19:return z("SuspenseList");case 0:case 2:case 15:return j(t.type,!1);case 11:return j(t.type.render,!1);case 1:return j(t.type,!0);default:return""}}function V(t){if(null==t)return null;if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t;switch(t){case E:return"Fragment";case w:return"Portal";case P:return"Profiler";case S:return"StrictMode";case M:return"Suspense";case L:return"SuspenseList"}if("object"==typeof t)switch(t.$$typeof){case I:return(t.displayName||"Context")+".Consumer";case C:return(t._context.displayName||"Context")+".Provider";case T:var e=t.render;return(t=t.displayName)||(t=""!==(t=e.displayName||e.name||"")?"ForwardRef("+t+")":"ForwardRef"),t;case A:return null!==(e=t.displayName||null)?e:V(t.type)||"Memo";case O:e=t._payload,t=t._init;try{return V(t(e))}catch(t){}}return null}function G(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=(t=e.render).displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(e);case 8:return e===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e}return null}function q(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":case"object":return t;default:return""}}function W(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function H(t){t._valueTracker||(t._valueTracker=function(t){var e=W(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&void 0!==n&&"function"==typeof n.get&&"function"==typeof n.set){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(t){i=""+t,o.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}(t))}function X(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=W(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function Y(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Z(t,e){var n=e.checked;return F({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function K(t,e){var n=null==e.defaultValue?"":e.defaultValue,i=null!=e.checked?e.checked:e.defaultChecked;n=q(null!=e.value?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function $(t,e){null!=(e=e.checked)&&_(t,"checked",e,!1)}function Q(t,e){$(t,e);var n=q(e.value),i=e.type;if(null!=n)"number"===i?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if("submit"===i||"reset"===i)return void t.removeAttribute("value");e.hasOwnProperty("value")?tt(t,e.type,n):e.hasOwnProperty("defaultValue")&&tt(t,e.type,q(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function J(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!("submit"!==i&&"reset"!==i||void 0!==e.value&&null!==e.value))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}""!==(n=t.name)&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,""!==n&&(t.name=n)}function tt(t,e,n){"number"===e&&Y(t.ownerDocument)===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var et=Array.isArray;function nt(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+q(n),e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function it(t,e){if(null!=e.dangerouslySetInnerHTML)throw Error(o(91));return F({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function rt(t,e){var n=e.value;if(null==n){if(n=e.children,e=e.defaultValue,null!=n){if(null!=e)throw Error(o(92));if(et(n)){if(1<n.length)throw Error(o(93));n=n[0]}e=n}null==e&&(e=""),n=e}t._wrapperState={initialValue:q(n)}}function ot(t,e){var n=q(e.value),i=q(e.defaultValue);null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&t.defaultValue!==n&&(t.defaultValue=n)),null!=i&&(t.defaultValue=""+i)}function st(t){var e=t.textContent;e===t._wrapperState.initialValue&&""!==e&&null!==e&&(t.value=e)}function at(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lt(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?at(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}var ut,ct,ht=(ct=function(t,e){if("http://www.w3.org/2000/svg"!==t.namespaceURI||"innerHTML"in t)t.innerHTML=e;else{for((ut=ut||document.createElement("div")).innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ut.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,e,n,i){MSApp.execUnsafeLocalFunction((function(){return ct(t,e)}))}:ct);function ft(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}var dt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pt=["Webkit","ms","Moz","O"];function gt(t,e,n){return null==e||"boolean"==typeof e||""===e?"":n||"number"!=typeof e||0===e||dt.hasOwnProperty(t)&&dt[t]?(""+e).trim():e+"px"}function mt(t,e){for(var n in t=t.style,e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=gt(n,e[n],i);"float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}Object.keys(dt).forEach((function(t){pt.forEach((function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),dt[e]=dt[t]}))}));var yt=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vt(t,e){if(e){if(yt[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML))throw Error(o(137,t));if(null!=e.dangerouslySetInnerHTML){if(null!=e.children)throw Error(o(60));if("object"!=typeof e.dangerouslySetInnerHTML||!("__html"in e.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=e.style&&"object"!=typeof e.style)throw Error(o(62))}}function _t(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var bt=null;function xt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}var wt=null,Et=null,St=null;function Pt(t){if(t=_r(t)){if("function"!=typeof wt)throw Error(o(280));var e=t.stateNode;e&&(e=xr(e),wt(t.stateNode,t.type,e))}}function Ct(t){Et?St?St.push(t):St=[t]:Et=t}function It(){if(Et){var t=Et,e=St;if(St=Et=null,Pt(t),e)for(t=0;t<e.length;t++)Pt(e[t])}}function Tt(t,e){return t(e)}function Mt(){}var Lt=!1;function At(t,e,n){if(Lt)return t(e,n);Lt=!0;try{return Tt(t,e,n)}finally{Lt=!1,(null!==Et||null!==St)&&(Mt(),It())}}function Ot(t,e){var n=t.stateNode;if(null===n)return null;var i=xr(n);if(null===i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(t=t.type)||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}if(t)return null;if(n&&"function"!=typeof n)throw Error(o(231,e,typeof n));return n}var Nt=!1;if(c)try{var Rt={};Object.defineProperty(Rt,"passive",{get:function(){Nt=!0}}),window.addEventListener("test",Rt,Rt),window.removeEventListener("test",Rt,Rt)}catch(ct){Nt=!1}function kt(t,e,n,i,r,o,s,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(t){this.onError(t)}}var Dt=!1,Ft=null,zt=!1,Bt=null,jt={onError:function(t){Dt=!0,Ft=t}};function Ut(t,e,n,i,r,o,s,a,l){Dt=!1,Ft=null,kt.apply(jt,arguments)}function Vt(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do{0!=(4098&(e=t).flags)&&(n=e.return),t=e.return}while(t)}return 3===e.tag?n:null}function Gt(t){if(13===t.tag){var e=t.memoizedState;if(null===e&&null!==(t=t.alternate)&&(e=t.memoizedState),null!==e)return e.dehydrated}return null}function qt(t){if(Vt(t)!==t)throw Error(o(188))}function Wt(t){return null!==(t=function(t){var e=t.alternate;if(!e){if(null===(e=Vt(t)))throw Error(o(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){if(null!==(i=r.return)){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return qt(r),t;if(s===i)return qt(r),e;s=s.sibling}throw Error(o(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,l=r.child;l;){if(l===n){a=!0,n=r,i=s;break}if(l===i){a=!0,i=r,n=s;break}l=l.sibling}if(!a){for(l=s.child;l;){if(l===n){a=!0,n=s,i=r;break}if(l===i){a=!0,i=s,n=r;break}l=l.sibling}if(!a)throw Error(o(189))}}if(n.alternate!==i)throw Error(o(190))}if(3!==n.tag)throw Error(o(188));return n.stateNode.current===n?t:e}(t))?Ht(t):null}function Ht(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var e=Ht(t);if(null!==e)return e;t=t.sibling}return null}var Xt=r.unstable_scheduleCallback,Yt=r.unstable_cancelCallback,Zt=r.unstable_shouldYield,Kt=r.unstable_requestPaint,$t=r.unstable_now,Qt=r.unstable_getCurrentPriorityLevel,Jt=r.unstable_ImmediatePriority,te=r.unstable_UserBlockingPriority,ee=r.unstable_NormalPriority,ne=r.unstable_LowPriority,ie=r.unstable_IdlePriority,re=null,oe=null,se=Math.clz32?Math.clz32:function(t){return 0===(t>>>=0)?32:31-(ae(t)/le|0)|0},ae=Math.log,le=Math.LN2,ue=64,ce=4194304;function he(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&t;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&t;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function fe(t,e){var n=t.pendingLanes;if(0===n)return 0;var i=0,r=t.suspendedLanes,o=t.pingedLanes,s=268435455&n;if(0!==s){var a=s&~r;0!==a?i=he(a):0!=(o&=s)&&(i=he(o))}else 0!=(s=n&~r)?i=he(s):0!==o&&(i=he(o));if(0===i)return 0;if(0!==e&&e!==i&&0==(e&r)&&((r=i&-i)>=(o=e&-e)||16===r&&0!=(4194240&o)))return e;if(0!=(4&i)&&(i|=16&n),0!==(e=t.entangledLanes))for(t=t.entanglements,e&=i;0<e;)r=1<<(n=31-se(e)),i|=t[n],e&=~r;return i}function de(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;default:return-1}}function pe(t){return 0!=(t=-1073741825&t.pendingLanes)?t:1073741824&t?1073741824:0}function ge(){var t=ue;return 0==(4194240&(ue<<=1))&&(ue=64),t}function me(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ye(t,e,n){t.pendingLanes|=e,536870912!==e&&(t.suspendedLanes=0,t.pingedLanes=0),(t=t.eventTimes)[e=31-se(e)]=n}function ve(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-se(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var _e=0;function be(t){return 1<(t&=-t)?4<t?0!=(268435455&t)?16:536870912:4:1}var xe,we,Ee,Se,Pe,Ce=!1,Ie=[],Te=null,Me=null,Le=null,Ae=new Map,Oe=new Map,Ne=[],Re="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ke(t,e){switch(t){case"focusin":case"focusout":Te=null;break;case"dragenter":case"dragleave":Me=null;break;case"mouseover":case"mouseout":Le=null;break;case"pointerover":case"pointerout":Ae.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Oe.delete(e.pointerId)}}function De(t,e,n,i,r,o){return null===t||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==e&&null!==(e=_r(e))&&we(e),t):(t.eventSystemFlags|=i,e=t.targetContainers,null!==r&&-1===e.indexOf(r)&&e.push(r),t)}function Fe(t){var e=vr(t.target);if(null!==e){var n=Vt(e);if(null!==n)if(13===(e=n.tag)){if(null!==(e=Gt(n)))return t.blockedOn=e,void Pe(t.priority,(function(){Ee(n)}))}else if(3===e&&n.stateNode.current.memoizedState.isDehydrated)return void(t.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}t.blockedOn=null}function ze(t){if(null!==t.blockedOn)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ze(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(null!==n)return null!==(e=_r(n))&&we(e),t.blockedOn=n,!1;var i=new(n=t.nativeEvent).constructor(n.type,n);bt=i,n.target.dispatchEvent(i),bt=null,e.shift()}return!0}function Be(t,e,n){ze(t)&&n.delete(e)}function je(){Ce=!1,null!==Te&&ze(Te)&&(Te=null),null!==Me&&ze(Me)&&(Me=null),null!==Le&&ze(Le)&&(Le=null),Ae.forEach(Be),Oe.forEach(Be)}function Ue(t,e){t.blockedOn===e&&(t.blockedOn=null,Ce||(Ce=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,je)))}function Ve(t){function e(e){return Ue(e,t)}if(0<Ie.length){Ue(Ie[0],t);for(var n=1;n<Ie.length;n++){var i=Ie[n];i.blockedOn===t&&(i.blockedOn=null)}}for(null!==Te&&Ue(Te,t),null!==Me&&Ue(Me,t),null!==Le&&Ue(Le,t),Ae.forEach(e),Oe.forEach(e),n=0;n<Ne.length;n++)(i=Ne[n]).blockedOn===t&&(i.blockedOn=null);for(;0<Ne.length&&null===(n=Ne[0]).blockedOn;)Fe(n),null===n.blockedOn&&Ne.shift()}var Ge=b.ReactCurrentBatchConfig,qe=!0;function We(t,e,n,i){var r=_e,o=Ge.transition;Ge.transition=null;try{_e=1,Xe(t,e,n,i)}finally{_e=r,Ge.transition=o}}function He(t,e,n,i){var r=_e,o=Ge.transition;Ge.transition=null;try{_e=4,Xe(t,e,n,i)}finally{_e=r,Ge.transition=o}}function Xe(t,e,n,i){if(qe){var r=Ze(t,e,n,i);if(null===r)qi(t,e,i,Ye,n),ke(t,i);else if(function(t,e,n,i,r){switch(e){case"focusin":return Te=De(Te,t,e,n,i,r),!0;case"dragenter":return Me=De(Me,t,e,n,i,r),!0;case"mouseover":return Le=De(Le,t,e,n,i,r),!0;case"pointerover":var o=r.pointerId;return Ae.set(o,De(Ae.get(o)||null,t,e,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,Oe.set(o,De(Oe.get(o)||null,t,e,n,i,r)),!0}return!1}(r,t,e,n,i))i.stopPropagation();else if(ke(t,i),4&e&&-1<Re.indexOf(t)){for(;null!==r;){var o=_r(r);if(null!==o&&xe(o),null===(o=Ze(t,e,n,i))&&qi(t,e,i,Ye,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else qi(t,e,i,null,n)}}var Ye=null;function Ze(t,e,n,i){if(Ye=null,null!==(t=vr(t=xt(i))))if(null===(e=Vt(t)))t=null;else if(13===(n=e.tag)){if(null!==(t=Gt(e)))return t;t=null}else if(3===n){if(e.stateNode.current.memoizedState.isDehydrated)return 3===e.tag?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ye=t,null}function Ke(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case Jt:return 1;case te:return 4;case ee:case ne:return 16;case ie:return 536870912;default:return 16}default:return 16}}var $e=null,Qe=null,Je=null;function tn(){if(Je)return Je;var t,e,n=Qe,i=n.length,r="value"in $e?$e.value:$e.textContent,o=r.length;for(t=0;t<i&&n[t]===r[t];t++);var s=i-t;for(e=1;e<=s&&n[i-e]===r[o-e];e++);return Je=r.slice(t,1<e?1-e:void 0)}function en(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function nn(){return!0}function rn(){return!1}function on(t){function e(e,n,i,r,o){for(var s in this._reactName=e,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,t)t.hasOwnProperty(s)&&(e=t[s],this[s]=e?e(r):r[s]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),e}var sn,an,ln,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cn=on(un),hn=F({},un,{view:0,detail:0}),fn=on(hn),dn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Pn,button:0,buttons:0,relatedTarget:function(t){return void 0===t.relatedTarget?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ln&&(ln&&"mousemove"===t.type?(sn=t.screenX-ln.screenX,an=t.screenY-ln.screenY):an=sn=0,ln=t),sn)},movementY:function(t){return"movementY"in t?t.movementY:an}}),pn=on(dn),gn=on(F({},dn,{dataTransfer:0})),mn=on(F({},hn,{relatedTarget:0})),yn=on(F({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},un,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),_n=on(vn),bn=on(F({},un,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=En[t])&&!!e[t]}function Pn(){return Sn}var Cn=F({},hn,{key:function(t){if(t.key){var e=xn[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=en(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?wn[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Pn,charCode:function(t){return"keypress"===t.type?en(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?en(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),In=on(Cn),Tn=on(F({},dn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mn=on(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Pn})),Ln=on(F({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=F({},dn,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),On=on(An),Nn=[9,13,27,32],Rn=c&&"CompositionEvent"in window,kn=null;c&&"documentMode"in document&&(kn=document.documentMode);var Dn=c&&"TextEvent"in window&&!kn,Fn=c&&(!Rn||kn&&8<kn&&11>=kn),zn=String.fromCharCode(32),Bn=!1;function jn(t,e){switch(t){case"keyup":return-1!==Nn.indexOf(e.keyCode);case"keydown":return 229!==e.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}var Vn=!1,Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!Gn[t.type]:"textarea"===e}function Wn(t,e,n,i){Ct(i),0<(e=Hi(e,"onChange")).length&&(n=new cn("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Hn=null,Xn=null;function Yn(t){zi(t,0)}function Zn(t){if(X(br(t)))return t}function Kn(t,e){if("change"===t)return e}var $n=!1;if(c){var Qn;if(c){var Jn="oninput"in document;if(!Jn){var ti=document.createElement("div");ti.setAttribute("oninput","return;"),Jn="function"==typeof ti.oninput}Qn=Jn}else Qn=!1;$n=Qn&&(!document.documentMode||9<document.documentMode)}function ei(){Hn&&(Hn.detachEvent("onpropertychange",ni),Xn=Hn=null)}function ni(t){if("value"===t.propertyName&&Zn(Xn)){var e=[];Wn(e,Xn,t,xt(t)),At(Yn,e)}}function ii(t,e,n){"focusin"===t?(ei(),Xn=n,(Hn=e).attachEvent("onpropertychange",ni)):"focusout"===t&&ei()}function ri(t){if("selectionchange"===t||"keyup"===t||"keydown"===t)return Zn(Xn)}function oi(t,e){if("click"===t)return Zn(e)}function si(t,e){if("input"===t||"change"===t)return Zn(e)}var ai="function"==typeof Object.is?Object.is:function(t,e){return t===e&&(0!==t||1/t==1/e)||t!=t&&e!=e};function li(t,e){if(ai(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!h.call(e,r)||!ai(t[r],e[r]))return!1}return!0}function ui(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function ci(t,e){var n,i=ui(t);for(t=0;i;){if(3===i.nodeType){if(n=t+i.textContent.length,t<=e&&n>=e)return{node:i,offset:e-t};t=n}t:{for(;i;){if(i.nextSibling){i=i.nextSibling;break t}i=i.parentNode}i=void 0}i=ui(i)}}function hi(t,e){return!(!t||!e)&&(t===e||(!t||3!==t.nodeType)&&(e&&3===e.nodeType?hi(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function fi(){for(var t=window,e=Y();e instanceof t.HTMLIFrameElement;){try{var n="string"==typeof e.contentWindow.location.href}catch(t){n=!1}if(!n)break;e=Y((t=e.contentWindow).document)}return e}function di(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&("text"===t.type||"search"===t.type||"tel"===t.type||"url"===t.type||"password"===t.type)||"textarea"===e||"true"===t.contentEditable)}function pi(t){var e=fi(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&hi(n.ownerDocument.documentElement,n)){if(null!==i&&di(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if((t=(e=n.ownerDocument||document)&&e.defaultView||window).getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(i.start,r);i=void 0===i.end?o:Math.min(i.end,r),!t.extend&&o>i&&(r=i,i=o,o=r),r=ci(n,o);var s=ci(n,i);r&&s&&(1!==t.rangeCount||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==s.node||t.focusOffset!==s.offset)&&((e=e.createRange()).setStart(r.node,r.offset),t.removeAllRanges(),o>i?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e)))}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for("function"==typeof n.focus&&n.focus(),n=0;n<e.length;n++)(t=e[n]).element.scrollLeft=t.left,t.element.scrollTop=t.top}}var gi=c&&"documentMode"in document&&11>=document.documentMode,mi=null,yi=null,vi=null,_i=!1;function bi(t,e,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_i||null==mi||mi!==Y(i)||(i="selectionStart"in(i=mi)&&di(i)?{start:i.selectionStart,end:i.selectionEnd}:{anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},vi&&li(vi,i)||(vi=i,0<(i=Hi(yi,"onSelect")).length&&(e=new cn("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=mi)))}function xi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var wi={animationend:xi("Animation","AnimationEnd"),animationiteration:xi("Animation","AnimationIteration"),animationstart:xi("Animation","AnimationStart"),transitionend:xi("Transition","TransitionEnd")},Ei={},Si={};function Pi(t){if(Ei[t])return Ei[t];if(!wi[t])return t;var e,n=wi[t];for(e in n)if(n.hasOwnProperty(e)&&e in Si)return Ei[t]=n[e];return t}c&&(Si=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);var Ci=Pi("animationend"),Ii=Pi("animationiteration"),Ti=Pi("animationstart"),Mi=Pi("transitionend"),Li=new Map,Ai="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oi(t,e){Li.set(t,e),l(e,[t])}for(var Ni=0;Ni<Ai.length;Ni++){var Ri=Ai[Ni];Oi(Ri.toLowerCase(),"on"+(Ri[0].toUpperCase()+Ri.slice(1)))}Oi(Ci,"onAnimationEnd"),Oi(Ii,"onAnimationIteration"),Oi(Ti,"onAnimationStart"),Oi("dblclick","onDoubleClick"),Oi("focusin","onFocus"),Oi("focusout","onBlur"),Oi(Mi,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ki="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Di=new Set("cancel close invalid load scroll toggle".split(" ").concat(ki));function Fi(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,function(t,e,n,i,r,s,a,l,u){if(Ut.apply(this,arguments),Dt){if(!Dt)throw Error(o(198));var c=Ft;Dt=!1,Ft=null,zt||(zt=!0,Bt=c)}}(i,e,void 0,t),t.currentTarget=null}function zi(t,e){e=0!=(4&e);for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;t:{var o=void 0;if(e)for(var s=i.length-1;0<=s;s--){var a=i[s],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break t;Fi(r,a,u),o=l}else for(s=0;s<i.length;s++){if(l=(a=i[s]).instance,u=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break t;Fi(r,a,u),o=l}}}if(zt)throw t=Bt,zt=!1,Bt=null,t}function Bi(t,e){var n=e[gr];void 0===n&&(n=e[gr]=new Set);var i=t+"__bubble";n.has(i)||(Gi(e,t,2,!1),n.add(i))}function ji(t,e,n){var i=0;e&&(i|=4),Gi(n,t,i,e)}var Ui="_reactListening"+Math.random().toString(36).slice(2);function Vi(t){if(!t[Ui]){t[Ui]=!0,s.forEach((function(e){"selectionchange"!==e&&(Di.has(e)||ji(e,!1,t),ji(e,!0,t))}));var e=9===t.nodeType?t:t.ownerDocument;null===e||e[Ui]||(e[Ui]=!0,ji("selectionchange",!1,e))}}function Gi(t,e,n,i){switch(Ke(e)){case 1:var r=We;break;case 4:r=He;break;default:r=Xe}n=r.bind(null,e,n,t),r=void 0,!Nt||"touchstart"!==e&&"touchmove"!==e&&"wheel"!==e||(r=!0),i?void 0!==r?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):void 0!==r?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function qi(t,e,n,i,r){var o=i;if(0==(1&e)&&0==(2&e)&&null!==i)t:for(;;){if(null===i)return;var s=i.tag;if(3===s||4===s){var a=i.stateNode.containerInfo;if(a===r||8===a.nodeType&&a.parentNode===r)break;if(4===s)for(s=i.return;null!==s;){var l=s.tag;if((3===l||4===l)&&((l=s.stateNode.containerInfo)===r||8===l.nodeType&&l.parentNode===r))return;s=s.return}for(;null!==a;){if(null===(s=vr(a)))return;if(5===(l=s.tag)||6===l){i=o=s;continue t}a=a.parentNode}}i=i.return}At((function(){var i=o,r=xt(n),s=[];t:{var a=Li.get(t);if(void 0!==a){var l=cn,u=t;switch(t){case"keypress":if(0===en(n))break t;case"keydown":case"keyup":l=In;break;case"focusin":u="focus",l=mn;break;case"focusout":u="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Mn;break;case Ci:case Ii:case Ti:l=yn;break;case Mi:l=Ln;break;case"scroll":l=fn;break;case"wheel":l=On;break;case"copy":case"cut":case"paste":l=_n;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Tn}var c=0!=(4&e),h=!c&&"scroll"===t,f=c?null!==a?a+"Capture":null:a;c=[];for(var d,p=i;null!==p;){var g=(d=p).stateNode;if(5===d.tag&&null!==g&&(d=g,null!==f&&null!=(g=Ot(p,f))&&c.push(Wi(p,g,d))),h)break;p=p.return}0<c.length&&(a=new l(a,u,null,n,r),s.push({event:a,listeners:c}))}}if(0==(7&e)){if(l="mouseout"===t||"pointerout"===t,(!(a="mouseover"===t||"pointerover"===t)||n===bt||!(u=n.relatedTarget||n.fromElement)||!vr(u)&&!u[pr])&&(l||a)&&(a=r.window===r?r:(a=r.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?vr(u):null)&&(u!==(h=Vt(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=i),l!==u)){if(c=pn,g="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==t&&"pointerover"!==t||(c=Tn,g="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==l?a:br(l),d=null==u?a:br(u),(a=new c(g,p+"leave",l,n,r)).target=h,a.relatedTarget=d,g=null,vr(r)===i&&((c=new c(f,p+"enter",u,n,r)).target=d,c.relatedTarget=h,g=c),h=g,l&&u)t:{for(f=u,p=0,d=c=l;d;d=Xi(d))p++;for(d=0,g=f;g;g=Xi(g))d++;for(;0<p-d;)c=Xi(c),p--;for(;0<d-p;)f=Xi(f),d--;for(;p--;){if(c===f||null!==f&&c===f.alternate)break t;c=Xi(c),f=Xi(f)}c=null}else c=null;null!==l&&Yi(s,a,l,c,!1),null!==u&&null!==h&&Yi(s,h,u,c,!0)}if("select"===(l=(a=i?br(i):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var m=Kn;else if(qn(a))if($n)m=si;else{m=ri;var y=ii}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(m=oi);switch(m&&(m=m(t,i))?Wn(s,m,n,r):(y&&y(t,a,i),"focusout"===t&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&tt(a,"number",a.value)),y=i?br(i):window,t){case"focusin":(qn(y)||"true"===y.contentEditable)&&(mi=y,yi=i,vi=null);break;case"focusout":vi=yi=mi=null;break;case"mousedown":_i=!0;break;case"contextmenu":case"mouseup":case"dragend":_i=!1,bi(s,n,r);break;case"selectionchange":if(gi)break;case"keydown":case"keyup":bi(s,n,r)}var v;if(Rn)t:{switch(t){case"compositionstart":var _="onCompositionStart";break t;case"compositionend":_="onCompositionEnd";break t;case"compositionupdate":_="onCompositionUpdate";break t}_=void 0}else Vn?jn(t,n)&&(_="onCompositionEnd"):"keydown"===t&&229===n.keyCode&&(_="onCompositionStart");_&&(Fn&&"ko"!==n.locale&&(Vn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Vn&&(v=tn()):(Qe="value"in($e=r)?$e.value:$e.textContent,Vn=!0)),0<(y=Hi(i,_)).length&&(_=new bn(_,t,null,n,r),s.push({event:_,listeners:y}),(v||null!==(v=Un(n)))&&(_.data=v))),(v=Dn?function(t,e){switch(t){case"compositionend":return Un(e);case"keypress":return 32!==e.which?null:(Bn=!0,zn);case"textInput":return(t=e.data)===zn&&Bn?null:t;default:return null}}(t,n):function(t,e){if(Vn)return"compositionend"===t||!Rn&&jn(t,e)?(t=tn(),Je=Qe=$e=null,Vn=!1,t):null;switch(t){case"paste":default:return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Fn&&"ko"!==e.locale?null:e.data}}(t,n))&&0<(i=Hi(i,"onBeforeInput")).length&&(r=new bn("onBeforeInput","beforeinput",null,n,r),s.push({event:r,listeners:i}),r.data=v)}zi(s,e)}))}function Wi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Hi(t,e){for(var n=e+"Capture",i=[];null!==t;){var r=t,o=r.stateNode;5===r.tag&&null!==o&&(r=o,null!=(o=Ot(t,n))&&i.unshift(Wi(t,o,r)),null!=(o=Ot(t,e))&&i.push(Wi(t,o,r))),t=t.return}return i}function Xi(t){if(null===t)return null;do{t=t.return}while(t&&5!==t.tag);return t||null}function Yi(t,e,n,i,r){for(var o=e._reactName,s=[];null!==n&&n!==i;){var a=n,l=a.alternate,u=a.stateNode;if(null!==l&&l===i)break;5===a.tag&&null!==u&&(a=u,r?null!=(l=Ot(n,o))&&s.unshift(Wi(n,l,a)):r||null!=(l=Ot(n,o))&&s.push(Wi(n,l,a))),n=n.return}0!==s.length&&t.push({event:e,listeners:s})}var Zi=/\r\n?/g,Ki=/\u0000|\uFFFD/g;function $i(t){return("string"==typeof t?t:""+t).replace(Zi,"\n").replace(Ki,"")}function Qi(t,e,n){if(e=$i(e),$i(t)!==e&&n)throw Error(o(425))}function Ji(){}var tr=null,er=null;function nr(t,e){return"textarea"===t||"noscript"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&null!=e.dangerouslySetInnerHTML.__html}var ir="function"==typeof setTimeout?setTimeout:void 0,rr="function"==typeof clearTimeout?clearTimeout:void 0,or="function"==typeof Promise?Promise:void 0,sr="function"==typeof queueMicrotask?queueMicrotask:void 0!==or?function(t){return or.resolve(null).then(t).catch(ar)}:ir;function ar(t){setTimeout((function(){throw t}))}function lr(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)){if(0===i)return t.removeChild(r),void Ve(e);i--}else"$"!==n&&"$?"!==n&&"$!"!==n||i++;n=r}while(n);Ve(e)}function ur(t){for(;null!=t;t=t.nextSibling){var e=t.nodeType;if(1===e||3===e)break;if(8===e){if("$"===(e=t.data)||"$!"===e||"$?"===e)break;if("/$"===e)return null}}return t}function cr(t){t=t.previousSibling;for(var e=0;t;){if(8===t.nodeType){var n=t.data;if("$"===n||"$!"===n||"$?"===n){if(0===e)return t;e--}else"/$"===n&&e++}t=t.previousSibling}return null}var hr=Math.random().toString(36).slice(2),fr="__reactFiber$"+hr,dr="__reactProps$"+hr,pr="__reactContainer$"+hr,gr="__reactEvents$"+hr,mr="__reactListeners$"+hr,yr="__reactHandles$"+hr;function vr(t){var e=t[fr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[pr]||n[fr]){if(n=e.alternate,null!==e.child||null!==n&&null!==n.child)for(t=cr(t);null!==t;){if(n=t[fr])return n;t=cr(t)}return e}n=(t=n).parentNode}return null}function _r(t){return!(t=t[fr]||t[pr])||5!==t.tag&&6!==t.tag&&13!==t.tag&&3!==t.tag?null:t}function br(t){if(5===t.tag||6===t.tag)return t.stateNode;throw Error(o(33))}function xr(t){return t[dr]||null}var wr=[],Er=-1;function Sr(t){return{current:t}}function Pr(t){0>Er||(t.current=wr[Er],wr[Er]=null,Er--)}function Cr(t,e){Er++,wr[Er]=t.current,t.current=e}var Ir={},Tr=Sr(Ir),Mr=Sr(!1),Lr=Ir;function Ar(t,e){var n=t.type.contextTypes;if(!n)return Ir;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=e[r];return i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function Or(t){return null!=t.childContextTypes}function Nr(){Pr(Mr),Pr(Tr)}function Rr(t,e,n){if(Tr.current!==Ir)throw Error(o(168));Cr(Tr,e),Cr(Mr,n)}function kr(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,"function"!=typeof i.getChildContext)return n;for(var r in i=i.getChildContext())if(!(r in e))throw Error(o(108,G(t)||"Unknown",r));return F({},n,i)}function Dr(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ir,Lr=Tr.current,Cr(Tr,t),Cr(Mr,Mr.current),!0}function Fr(t,e,n){var i=t.stateNode;if(!i)throw Error(o(169));n?(t=kr(t,e,Lr),i.__reactInternalMemoizedMergedChildContext=t,Pr(Mr),Pr(Tr),Cr(Tr,t)):Pr(Mr),Cr(Mr,n)}var zr=null,Br=!1,jr=!1;function Ur(t){null===zr?zr=[t]:zr.push(t)}function Vr(){if(!jr&&null!==zr){jr=!0;var t=0,e=_e;try{var n=zr;for(_e=1;t<n.length;t++){var i=n[t];do{i=i(!0)}while(null!==i)}zr=null,Br=!1}catch(e){throw null!==zr&&(zr=zr.slice(t+1)),Xt(Jt,Vr),e}finally{_e=e,jr=!1}}return null}var Gr=[],qr=0,Wr=null,Hr=0,Xr=[],Yr=0,Zr=null,Kr=1,$r="";function Qr(t,e){Gr[qr++]=Hr,Gr[qr++]=Wr,Wr=t,Hr=e}function Jr(t,e,n){Xr[Yr++]=Kr,Xr[Yr++]=$r,Xr[Yr++]=Zr,Zr=t;var i=Kr;t=$r;var r=32-se(i)-1;i&=~(1<<r),n+=1;var o=32-se(e)+r;if(30<o){var s=r-r%5;o=(i&(1<<s)-1).toString(32),i>>=s,r-=s,Kr=1<<32-se(e)+r|n<<r|i,$r=o+t}else Kr=1<<o|n<<r|i,$r=t}function to(t){null!==t.return&&(Qr(t,1),Jr(t,1,0))}function eo(t){for(;t===Wr;)Wr=Gr[--qr],Gr[qr]=null,Hr=Gr[--qr],Gr[qr]=null;for(;t===Zr;)Zr=Xr[--Yr],Xr[Yr]=null,$r=Xr[--Yr],Xr[Yr]=null,Kr=Xr[--Yr],Xr[Yr]=null}var no=null,io=null,ro=!1,oo=null;function so(t,e){var n=Ou(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,null===(e=t.deletions)?(t.deletions=[n],t.flags|=16):e.push(n)}function ao(t,e){switch(t.tag){case 5:var n=t.type;return null!==(e=1!==e.nodeType||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e)&&(t.stateNode=e,no=t,io=ur(e.firstChild),!0);case 6:return null!==(e=""===t.pendingProps||3!==e.nodeType?null:e)&&(t.stateNode=e,no=t,io=null,!0);case 13:return null!==(e=8!==e.nodeType?null:e)&&(n=null!==Zr?{id:Kr,overflow:$r}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},(n=Ou(18,null,null,0)).stateNode=e,n.return=t,t.child=n,no=t,io=null,!0);default:return!1}}function lo(t){return 0!=(1&t.mode)&&0==(128&t.flags)}function uo(t){if(ro){var e=io;if(e){var n=e;if(!ao(t,e)){if(lo(t))throw Error(o(418));e=ur(n.nextSibling);var i=no;e&&ao(t,e)?so(i,n):(t.flags=-4097&t.flags|2,ro=!1,no=t)}}else{if(lo(t))throw Error(o(418));t.flags=-4097&t.flags|2,ro=!1,no=t}}}function co(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag&&13!==t.tag;)t=t.return;no=t}function ho(t){if(t!==no)return!1;if(!ro)return co(t),ro=!0,!1;var e;if((e=3!==t.tag)&&!(e=5!==t.tag)&&(e="head"!==(e=t.type)&&"body"!==e&&!nr(t.type,t.memoizedProps)),e&&(e=io)){if(lo(t))throw fo(),Error(o(418));for(;e;)so(t,e),e=ur(e.nextSibling)}if(co(t),13===t.tag){if(!(t=null!==(t=t.memoizedState)?t.dehydrated:null))throw Error(o(317));t:{for(t=t.nextSibling,e=0;t;){if(8===t.nodeType){var n=t.data;if("/$"===n){if(0===e){io=ur(t.nextSibling);break t}e--}else"$"!==n&&"$!"!==n&&"$?"!==n||e++}t=t.nextSibling}io=null}}else io=no?ur(t.stateNode.nextSibling):null;return!0}function fo(){for(var t=io;t;)t=ur(t.nextSibling)}function po(){io=no=null,ro=!1}function go(t){null===oo?oo=[t]:oo.push(t)}var mo=b.ReactCurrentBatchConfig;function yo(t,e){if(t&&t.defaultProps){for(var n in e=F({},e),t=t.defaultProps)void 0===e[n]&&(e[n]=t[n]);return e}return e}var vo=Sr(null),_o=null,bo=null,xo=null;function wo(){xo=bo=_o=null}function Eo(t){var e=vo.current;Pr(vo),t._currentValue=e}function So(t,e,n){for(;null!==t;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,null!==i&&(i.childLanes|=e)):null!==i&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function Po(t,e){_o=t,xo=bo=null,null!==(t=t.dependencies)&&null!==t.firstContext&&(0!=(t.lanes&e)&&(ba=!0),t.firstContext=null)}function Co(t){var e=t._currentValue;if(xo!==t)if(t={context:t,memoizedValue:e,next:null},null===bo){if(null===_o)throw Error(o(308));bo=t,_o.dependencies={lanes:0,firstContext:t}}else bo=bo.next=t;return e}var Io=null;function To(t){null===Io?Io=[t]:Io.push(t)}function Mo(t,e,n,i){var r=e.interleaved;return null===r?(n.next=n,To(e)):(n.next=r.next,r.next=n),e.interleaved=n,Lo(t,i)}function Lo(t,e){t.lanes|=e;var n=t.alternate;for(null!==n&&(n.lanes|=e),n=t,t=t.return;null!==t;)t.childLanes|=e,null!==(n=t.alternate)&&(n.childLanes|=e),n=t,t=t.return;return 3===n.tag?n.stateNode:null}var Ao=!1;function Oo(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function No(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ro(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ko(t,e,n){var i=t.updateQueue;if(null===i)return null;if(i=i.shared,0!=(2&Ml)){var r=i.pending;return null===r?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Lo(t,n)}return null===(r=i.interleaved)?(e.next=e,To(i)):(e.next=r.next,r.next=e),i.interleaved=e,Lo(t,n)}function Do(t,e,n){if(null!==(e=e.updateQueue)&&(e=e.shared,0!=(4194240&n))){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ve(t,n)}}function Fo(t,e){var n=t.updateQueue,i=t.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?r=o=s:o=o.next=s,n=n.next}while(null!==n);null===o?r=o=e:o=o.next=e}else r=o=e;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,effects:i.effects},void(t.updateQueue=n)}null===(t=n.lastBaseUpdate)?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function zo(t,e,n,i){var r=t.updateQueue;Ao=!1;var o=r.firstBaseUpdate,s=r.lastBaseUpdate,a=r.shared.pending;if(null!==a){r.shared.pending=null;var l=a,u=l.next;l.next=null,null===s?o=u:s.next=u,s=l;var c=t.alternate;null!==c&&(a=(c=c.updateQueue).lastBaseUpdate)!==s&&(null===a?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l)}if(null!==o){var h=r.baseState;for(s=0,c=u=l=null,a=o;;){var f=a.lane,d=a.eventTime;if((i&f)===f){null!==c&&(c=c.next={eventTime:d,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});t:{var p=t,g=a;switch(f=e,d=n,g.tag){case 1:if("function"==typeof(p=g.payload)){h=p.call(d,h,f);break t}h=p;break t;case 3:p.flags=-65537&p.flags|128;case 0:if(null==(f="function"==typeof(p=g.payload)?p.call(d,h,f):p))break t;h=F({},h,f);break t;case 2:Ao=!0}}null!==a.callback&&0!==a.lane&&(t.flags|=64,null===(f=r.effects)?r.effects=[a]:f.push(a))}else d={eventTime:d,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===c?(u=c=d,l=h):c=c.next=d,s|=f;if(null===(a=a.next)){if(null===(a=r.shared.pending))break;a=(f=a).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}if(null===c&&(l=h),r.baseState=l,r.firstBaseUpdate=u,r.lastBaseUpdate=c,null!==(e=r.shared.interleaved)){r=e;do{s|=r.lane,r=r.next}while(r!==e)}else null===o&&(r.shared.lanes=0);Fl|=s,t.lanes=s,t.memoizedState=h}}function Bo(t,e,n){if(t=e.effects,e.effects=null,null!==t)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(null!==r){if(i.callback=null,i=n,"function"!=typeof r)throw Error(o(191,r));r.call(i)}}}var jo=(new i.Component).refs;function Uo(t,e,n,i){n=null==(n=n(i,e=t.memoizedState))?e:F({},e,n),t.memoizedState=n,0===t.lanes&&(t.updateQueue.baseState=n)}var Vo={isMounted:function(t){return!!(t=t._reactInternals)&&Vt(t)===t},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=eu(),r=nu(t),o=Ro(i,r);o.payload=e,null!=n&&(o.callback=n),null!==(e=ko(t,o,r))&&(iu(e,t,r,i),Do(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=eu(),r=nu(t),o=Ro(i,r);o.tag=1,o.payload=e,null!=n&&(o.callback=n),null!==(e=ko(t,o,r))&&(iu(e,t,r,i),Do(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=eu(),i=nu(t),r=Ro(n,i);r.tag=2,null!=e&&(r.callback=e),null!==(e=ko(t,r,i))&&(iu(e,t,i,n),Do(e,t,i))}};function Go(t,e,n,i,r,o,s){return"function"==typeof(t=t.stateNode).shouldComponentUpdate?t.shouldComponentUpdate(i,o,s):!(e.prototype&&e.prototype.isPureReactComponent&&li(n,i)&&li(r,o))}function qo(t,e,n){var i=!1,r=Ir,o=e.contextType;return"object"==typeof o&&null!==o?o=Co(o):(r=Or(e)?Lr:Tr.current,o=(i=null!=(i=e.contextTypes))?Ar(t,r):Ir),e=new e(n,o),t.memoizedState=null!==e.state&&void 0!==e.state?e.state:null,e.updater=Vo,t.stateNode=e,e._reactInternals=t,i&&((t=t.stateNode).__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function Wo(t,e,n,i){t=e.state,"function"==typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,i),"function"==typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&Vo.enqueueReplaceState(e,e.state,null)}function Ho(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs=jo,Oo(t);var o=e.contextType;"object"==typeof o&&null!==o?r.context=Co(o):(o=Or(e)?Lr:Tr.current,r.context=Ar(t,o)),r.state=t.memoizedState,"function"==typeof(o=e.getDerivedStateFromProps)&&(Uo(t,e,o,n),r.state=t.memoizedState),"function"==typeof e.getDerivedStateFromProps||"function"==typeof r.getSnapshotBeforeUpdate||"function"!=typeof r.UNSAFE_componentWillMount&&"function"!=typeof r.componentWillMount||(e=r.state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),e!==r.state&&Vo.enqueueReplaceState(r,r.state,null),zo(t,n,r,i),r.state=t.memoizedState),"function"==typeof r.componentDidMount&&(t.flags|=4194308)}function Xo(t,e,n){if(null!==(t=n.ref)&&"function"!=typeof t&&"object"!=typeof t){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(o(309));var i=n.stateNode}if(!i)throw Error(o(147,t));var r=i,s=""+t;return null!==e&&null!==e.ref&&"function"==typeof e.ref&&e.ref._stringRef===s?e.ref:(e=function(t){var e=r.refs;e===jo&&(e=r.refs={}),null===t?delete e[s]:e[s]=t},e._stringRef=s,e)}if("string"!=typeof t)throw Error(o(284));if(!n._owner)throw Error(o(290,t))}return t}function Yo(t,e){throw t=Object.prototype.toString.call(e),Error(o(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Zo(t){return(0,t._init)(t._payload)}function Ko(t){function e(e,n){if(t){var i=e.deletions;null===i?(e.deletions=[n],e.flags|=16):i.push(n)}}function n(n,i){if(!t)return null;for(;null!==i;)e(n,i),i=i.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(t,e){return(t=Ru(t,e)).index=0,t.sibling=null,t}function s(e,n,i){return e.index=i,t?null!==(i=e.alternate)?(i=i.index)<n?(e.flags|=2,n):i:(e.flags|=2,n):(e.flags|=1048576,n)}function a(e){return t&&null===e.alternate&&(e.flags|=2),e}function l(t,e,n,i){return null===e||6!==e.tag?((e=zu(n,t.mode,i)).return=t,e):((e=r(e,n)).return=t,e)}function u(t,e,n,i){var o=n.type;return o===E?h(t,e,n.props.children,i,n.key):null!==e&&(e.elementType===o||"object"==typeof o&&null!==o&&o.$$typeof===O&&Zo(o)===e.type)?((i=r(e,n.props)).ref=Xo(t,e,n),i.return=t,i):((i=ku(n.type,n.key,n.props,null,t.mode,i)).ref=Xo(t,e,n),i.return=t,i)}function c(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?((e=Bu(n,t.mode,i)).return=t,e):((e=r(e,n.children||[])).return=t,e)}function h(t,e,n,i,o){return null===e||7!==e.tag?((e=Du(n,t.mode,i,o)).return=t,e):((e=r(e,n)).return=t,e)}function f(t,e,n){if("string"==typeof e&&""!==e||"number"==typeof e)return(e=zu(""+e,t.mode,n)).return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case x:return(n=ku(e.type,e.key,e.props,null,t.mode,n)).ref=Xo(t,null,e),n.return=t,n;case w:return(e=Bu(e,t.mode,n)).return=t,e;case O:return f(t,(0,e._init)(e._payload),n)}if(et(e)||k(e))return(e=Du(e,t.mode,n,null)).return=t,e;Yo(t,e)}return null}function d(t,e,n,i){var r=null!==e?e.key:null;if("string"==typeof n&&""!==n||"number"==typeof n)return null!==r?null:l(t,e,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===r?u(t,e,n,i):null;case w:return n.key===r?c(t,e,n,i):null;case O:return d(t,e,(r=n._init)(n._payload),i)}if(et(n)||k(n))return null!==r?null:h(t,e,n,i,null);Yo(t,n)}return null}function p(t,e,n,i,r){if("string"==typeof i&&""!==i||"number"==typeof i)return l(e,t=t.get(n)||null,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case x:return u(e,t=t.get(null===i.key?n:i.key)||null,i,r);case w:return c(e,t=t.get(null===i.key?n:i.key)||null,i,r);case O:return p(t,e,n,(0,i._init)(i._payload),r)}if(et(i)||k(i))return h(e,t=t.get(n)||null,i,r,null);Yo(e,i)}return null}function g(r,o,a,l){for(var u=null,c=null,h=o,g=o=0,m=null;null!==h&&g<a.length;g++){h.index>g?(m=h,h=null):m=h.sibling;var y=d(r,h,a[g],l);if(null===y){null===h&&(h=m);break}t&&h&&null===y.alternate&&e(r,h),o=s(y,o,g),null===c?u=y:c.sibling=y,c=y,h=m}if(g===a.length)return n(r,h),ro&&Qr(r,g),u;if(null===h){for(;g<a.length;g++)null!==(h=f(r,a[g],l))&&(o=s(h,o,g),null===c?u=h:c.sibling=h,c=h);return ro&&Qr(r,g),u}for(h=i(r,h);g<a.length;g++)null!==(m=p(h,r,g,a[g],l))&&(t&&null!==m.alternate&&h.delete(null===m.key?g:m.key),o=s(m,o,g),null===c?u=m:c.sibling=m,c=m);return t&&h.forEach((function(t){return e(r,t)})),ro&&Qr(r,g),u}function m(r,a,l,u){var c=k(l);if("function"!=typeof c)throw Error(o(150));if(null==(l=c.call(l)))throw Error(o(151));for(var h=c=null,g=a,m=a=0,y=null,v=l.next();null!==g&&!v.done;m++,v=l.next()){g.index>m?(y=g,g=null):y=g.sibling;var _=d(r,g,v.value,u);if(null===_){null===g&&(g=y);break}t&&g&&null===_.alternate&&e(r,g),a=s(_,a,m),null===h?c=_:h.sibling=_,h=_,g=y}if(v.done)return n(r,g),ro&&Qr(r,m),c;if(null===g){for(;!v.done;m++,v=l.next())null!==(v=f(r,v.value,u))&&(a=s(v,a,m),null===h?c=v:h.sibling=v,h=v);return ro&&Qr(r,m),c}for(g=i(r,g);!v.done;m++,v=l.next())null!==(v=p(g,r,m,v.value,u))&&(t&&null!==v.alternate&&g.delete(null===v.key?m:v.key),a=s(v,a,m),null===h?c=v:h.sibling=v,h=v);return t&&g.forEach((function(t){return e(r,t)})),ro&&Qr(r,m),c}return function t(i,o,s,l){if("object"==typeof s&&null!==s&&s.type===E&&null===s.key&&(s=s.props.children),"object"==typeof s&&null!==s){switch(s.$$typeof){case x:t:{for(var u=s.key,c=o;null!==c;){if(c.key===u){if((u=s.type)===E){if(7===c.tag){n(i,c.sibling),(o=r(c,s.props.children)).return=i,i=o;break t}}else if(c.elementType===u||"object"==typeof u&&null!==u&&u.$$typeof===O&&Zo(u)===c.type){n(i,c.sibling),(o=r(c,s.props)).ref=Xo(i,c,s),o.return=i,i=o;break t}n(i,c);break}e(i,c),c=c.sibling}s.type===E?((o=Du(s.props.children,i.mode,l,s.key)).return=i,i=o):((l=ku(s.type,s.key,s.props,null,i.mode,l)).ref=Xo(i,o,s),l.return=i,i=l)}return a(i);case w:t:{for(c=s.key;null!==o;){if(o.key===c){if(4===o.tag&&o.stateNode.containerInfo===s.containerInfo&&o.stateNode.implementation===s.implementation){n(i,o.sibling),(o=r(o,s.children||[])).return=i,i=o;break t}n(i,o);break}e(i,o),o=o.sibling}(o=Bu(s,i.mode,l)).return=i,i=o}return a(i);case O:return t(i,o,(c=s._init)(s._payload),l)}if(et(s))return g(i,o,s,l);if(k(s))return m(i,o,s,l);Yo(i,s)}return"string"==typeof s&&""!==s||"number"==typeof s?(s=""+s,null!==o&&6===o.tag?(n(i,o.sibling),(o=r(o,s)).return=i,i=o):(n(i,o),(o=zu(s,i.mode,l)).return=i,i=o),a(i)):n(i,o)}}var $o=Ko(!0),Qo=Ko(!1),Jo={},ts=Sr(Jo),es=Sr(Jo),ns=Sr(Jo);function is(t){if(t===Jo)throw Error(o(174));return t}function rs(t,e){switch(Cr(ns,e),Cr(es,t),Cr(ts,Jo),t=e.nodeType){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lt(null,"");break;default:e=lt(e=(t=8===t?e.parentNode:e).namespaceURI||null,t=t.tagName)}Pr(ts),Cr(ts,e)}function os(){Pr(ts),Pr(es),Pr(ns)}function ss(t){is(ns.current);var e=is(ts.current),n=lt(e,t.type);e!==n&&(Cr(es,t),Cr(ts,n))}function as(t){es.current===t&&(Pr(ts),Pr(es))}var ls=Sr(0);function us(t){for(var e=t;null!==e;){if(13===e.tag){var n=e.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return e}else if(19===e.tag&&void 0!==e.memoizedProps.revealOrder){if(0!=(128&e.flags))return e}else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var cs=[];function hs(){for(var t=0;t<cs.length;t++)cs[t]._workInProgressVersionPrimary=null;cs.length=0}var fs=b.ReactCurrentDispatcher,ds=b.ReactCurrentBatchConfig,ps=0,gs=null,ms=null,ys=null,vs=!1,_s=!1,bs=0,xs=0;function ws(){throw Error(o(321))}function Es(t,e){if(null===e)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ai(t[n],e[n]))return!1;return!0}function Ss(t,e,n,i,r,s){if(ps=s,gs=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,fs.current=null===t||null===t.memoizedState?aa:la,t=n(i,r),_s){s=0;do{if(_s=!1,bs=0,25<=s)throw Error(o(301));s+=1,ys=ms=null,e.updateQueue=null,fs.current=ua,t=n(i,r)}while(_s)}if(fs.current=sa,e=null!==ms&&null!==ms.next,ps=0,ys=ms=gs=null,vs=!1,e)throw Error(o(300));return t}function Ps(){var t=0!==bs;return bs=0,t}function Cs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ys?gs.memoizedState=ys=t:ys=ys.next=t,ys}function Is(){if(null===ms){var t=gs.alternate;t=null!==t?t.memoizedState:null}else t=ms.next;var e=null===ys?gs.memoizedState:ys.next;if(null!==e)ys=e,ms=t;else{if(null===t)throw Error(o(310));t={memoizedState:(ms=t).memoizedState,baseState:ms.baseState,baseQueue:ms.baseQueue,queue:ms.queue,next:null},null===ys?gs.memoizedState=ys=t:ys=ys.next=t}return ys}function Ts(t,e){return"function"==typeof e?e(t):e}function Ms(t){var e=Is(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=ms,r=i.baseQueue,s=n.pending;if(null!==s){if(null!==r){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(null!==r){s=r.next,i=i.baseState;var l=a=null,u=null,c=s;do{var h=c.lane;if((ps&h)===h)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var f={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=f,a=i):u=u.next=f,gs.lanes|=h,Fl|=h}c=c.next}while(null!==c&&c!==s);null===u?a=i:u.next=l,ai(i,e.memoizedState)||(ba=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=u,n.lastRenderedState=i}if(null!==(t=n.interleaved)){r=t;do{s=r.lane,gs.lanes|=s,Fl|=s,r=r.next}while(r!==t)}else null===r&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ls(t){var e=Is(),n=e.queue;if(null===n)throw Error(o(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(null!==r){n.pending=null;var a=r=r.next;do{s=t(s,a.action),a=a.next}while(a!==r);ai(s,e.memoizedState)||(ba=!0),e.memoizedState=s,null===e.baseQueue&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function As(){}function Os(t,e){var n=gs,i=Is(),r=e(),s=!ai(i.memoizedState,r);if(s&&(i.memoizedState=r,ba=!0),i=i.queue,qs(ks.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||null!==ys&&1&ys.memoizedState.tag){if(n.flags|=2048,Bs(9,Rs.bind(null,n,i,r,e),void 0,null),null===Ll)throw Error(o(349));0!=(30&ps)||Ns(n,e,r)}return r}function Ns(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},null===(e=gs.updateQueue)?(e={lastEffect:null,stores:null},gs.updateQueue=e,e.stores=[t]):null===(n=e.stores)?e.stores=[t]:n.push(t)}function Rs(t,e,n,i){e.value=n,e.getSnapshot=i,Ds(e)&&Fs(t)}function ks(t,e,n){return n((function(){Ds(e)&&Fs(t)}))}function Ds(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ai(t,n)}catch(t){return!0}}function Fs(t){var e=Lo(t,1);null!==e&&iu(e,t,1,-1)}function zs(t){var e=Cs();return"function"==typeof t&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ts,lastRenderedState:t},e.queue=t,t=t.dispatch=na.bind(null,gs,t),[e.memoizedState,t]}function Bs(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},null===(e=gs.updateQueue)?(e={lastEffect:null,stores:null},gs.updateQueue=e,e.lastEffect=t.next=t):null===(n=e.lastEffect)?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t),t}function js(){return Is().memoizedState}function Us(t,e,n,i){var r=Cs();gs.flags|=t,r.memoizedState=Bs(1|e,n,void 0,void 0===i?null:i)}function Vs(t,e,n,i){var r=Is();i=void 0===i?null:i;var o=void 0;if(null!==ms){var s=ms.memoizedState;if(o=s.destroy,null!==i&&Es(i,s.deps))return void(r.memoizedState=Bs(e,n,o,i))}gs.flags|=t,r.memoizedState=Bs(1|e,n,o,i)}function Gs(t,e){return Us(8390656,8,t,e)}function qs(t,e){return Vs(2048,8,t,e)}function Ws(t,e){return Vs(4,2,t,e)}function Hs(t,e){return Vs(4,4,t,e)}function Xs(t,e){return"function"==typeof e?(t=t(),e(t),function(){e(null)}):null!=e?(t=t(),e.current=t,function(){e.current=null}):void 0}function Ys(t,e,n){return n=null!=n?n.concat([t]):null,Vs(4,4,Xs.bind(null,e,t),n)}function Zs(){}function Ks(t,e){var n=Is();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&Es(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function $s(t,e){var n=Is();e=void 0===e?null:e;var i=n.memoizedState;return null!==i&&null!==e&&Es(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function Qs(t,e,n){return 0==(21&ps)?(t.baseState&&(t.baseState=!1,ba=!0),t.memoizedState=n):(ai(n,e)||(n=ge(),gs.lanes|=n,Fl|=n,t.baseState=!0),e)}function Js(t,e){var n=_e;_e=0!==n&&4>n?n:4,t(!0);var i=ds.transition;ds.transition={};try{t(!1),e()}finally{_e=n,ds.transition=i}}function ta(){return Is().memoizedState}function ea(t,e,n){var i=nu(t);n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},ia(t)?ra(e,n):null!==(n=Mo(t,e,n,i))&&(iu(n,t,i,eu()),oa(n,e,i))}function na(t,e,n){var i=nu(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(ia(t))ra(e,r);else{var o=t.alternate;if(0===t.lanes&&(null===o||0===o.lanes)&&null!==(o=e.lastRenderedReducer))try{var s=e.lastRenderedState,a=o(s,n);if(r.hasEagerState=!0,r.eagerState=a,ai(a,s)){var l=e.interleaved;return null===l?(r.next=r,To(e)):(r.next=l.next,l.next=r),void(e.interleaved=r)}}catch(t){}null!==(n=Mo(t,e,r,i))&&(iu(n,t,i,r=eu()),oa(n,e,i))}}function ia(t){var e=t.alternate;return t===gs||null!==e&&e===gs}function ra(t,e){_s=vs=!0;var n=t.pending;null===n?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function oa(t,e,n){if(0!=(4194240&n)){var i=e.lanes;n|=i&=t.pendingLanes,e.lanes=n,ve(t,n)}}var sa={readContext:Co,useCallback:ws,useContext:ws,useEffect:ws,useImperativeHandle:ws,useInsertionEffect:ws,useLayoutEffect:ws,useMemo:ws,useReducer:ws,useRef:ws,useState:ws,useDebugValue:ws,useDeferredValue:ws,useTransition:ws,useMutableSource:ws,useSyncExternalStore:ws,useId:ws,unstable_isNewReconciler:!1},aa={readContext:Co,useCallback:function(t,e){return Cs().memoizedState=[t,void 0===e?null:e],t},useContext:Co,useEffect:Gs,useImperativeHandle:function(t,e,n){return n=null!=n?n.concat([t]):null,Us(4194308,4,Xs.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Us(4194308,4,t,e)},useInsertionEffect:function(t,e){return Us(4,2,t,e)},useMemo:function(t,e){var n=Cs();return e=void 0===e?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=Cs();return e=void 0!==n?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=ea.bind(null,gs,t),[i.memoizedState,t]},useRef:function(t){return t={current:t},Cs().memoizedState=t},useState:zs,useDebugValue:Zs,useDeferredValue:function(t){return Cs().memoizedState=t},useTransition:function(){var t=zs(!1),e=t[0];return t=Js.bind(null,t[1]),Cs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=gs,r=Cs();if(ro){if(void 0===n)throw Error(o(407));n=n()}else{if(n=e(),null===Ll)throw Error(o(349));0!=(30&ps)||Ns(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,Gs(ks.bind(null,i,s,t),[t]),i.flags|=2048,Bs(9,Rs.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=Cs(),e=Ll.identifierPrefix;if(ro){var n=$r;e=":"+e+"R"+(n=(Kr&~(1<<32-se(Kr)-1)).toString(32)+n),0<(n=bs++)&&(e+="H"+n.toString(32)),e+=":"}else e=":"+e+"r"+(n=xs++).toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},la={readContext:Co,useCallback:Ks,useContext:Co,useEffect:qs,useImperativeHandle:Ys,useInsertionEffect:Ws,useLayoutEffect:Hs,useMemo:$s,useReducer:Ms,useRef:js,useState:function(){return Ms(Ts)},useDebugValue:Zs,useDeferredValue:function(t){return Qs(Is(),ms.memoizedState,t)},useTransition:function(){return[Ms(Ts)[0],Is().memoizedState]},useMutableSource:As,useSyncExternalStore:Os,useId:ta,unstable_isNewReconciler:!1},ua={readContext:Co,useCallback:Ks,useContext:Co,useEffect:qs,useImperativeHandle:Ys,useInsertionEffect:Ws,useLayoutEffect:Hs,useMemo:$s,useReducer:Ls,useRef:js,useState:function(){return Ls(Ts)},useDebugValue:Zs,useDeferredValue:function(t){var e=Is();return null===ms?e.memoizedState=t:Qs(e,ms.memoizedState,t)},useTransition:function(){return[Ls(Ts)[0],Is().memoizedState]},useMutableSource:As,useSyncExternalStore:Os,useId:ta,unstable_isNewReconciler:!1};function ca(t,e){try{var n="",i=e;do{n+=U(i),i=i.return}while(i);var r=n}catch(t){r="\nError generating stack: "+t.message+"\n"+t.stack}return{value:t,source:e,stack:r,digest:null}}function ha(t,e,n){return{value:t,source:null,stack:null!=n?n:null,digest:null!=e?e:null}}function fa(t,e){try{console.error(e.value)}catch(t){setTimeout((function(){throw t}))}}var da="function"==typeof WeakMap?WeakMap:Map;function pa(t,e,n){(n=Ro(-1,n)).tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){Wl||(Wl=!0,Hl=i),fa(0,e)},n}function ga(t,e,n){(n=Ro(-1,n)).tag=3;var i=t.type.getDerivedStateFromError;if("function"==typeof i){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){fa(0,e)}}var o=t.stateNode;return null!==o&&"function"==typeof o.componentDidCatch&&(n.callback=function(){fa(0,e),"function"!=typeof i&&(null===Xl?Xl=new Set([this]):Xl.add(this));var t=e.stack;this.componentDidCatch(e.value,{componentStack:null!==t?t:""})}),n}function ma(t,e,n){var i=t.pingCache;if(null===i){i=t.pingCache=new da;var r=new Set;i.set(e,r)}else void 0===(r=i.get(e))&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=Cu.bind(null,t,e,n),e.then(t,t))}function ya(t){do{var e;if((e=13===t.tag)&&(e=null===(e=t.memoizedState)||null!==e.dehydrated),e)return t;t=t.return}while(null!==t);return null}function va(t,e,n,i,r){return 0==(1&t.mode)?(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((e=Ro(-1,1)).tag=2,ko(n,e,1))),n.lanes|=1),t):(t.flags|=65536,t.lanes=r,t)}var _a=b.ReactCurrentOwner,ba=!1;function xa(t,e,n,i){e.child=null===t?Qo(e,null,n,i):$o(e,t.child,n,i)}function wa(t,e,n,i,r){n=n.render;var o=e.ref;return Po(e,r),i=Ss(t,e,n,i,o,r),n=Ps(),null===t||ba?(ro&&n&&to(e),e.flags|=1,xa(t,e,i,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Wa(t,e,r))}function Ea(t,e,n,i,r){if(null===t){var o=n.type;return"function"!=typeof o||Nu(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((t=ku(n.type,null,i,e,e.mode,r)).ref=e.ref,t.return=e,e.child=t):(e.tag=15,e.type=o,Sa(t,e,o,i,r))}if(o=t.child,0==(t.lanes&r)){var s=o.memoizedProps;if((n=null!==(n=n.compare)?n:li)(s,i)&&t.ref===e.ref)return Wa(t,e,r)}return e.flags|=1,(t=Ru(o,i)).ref=e.ref,t.return=e,e.child=t}function Sa(t,e,n,i,r){if(null!==t){var o=t.memoizedProps;if(li(o,i)&&t.ref===e.ref){if(ba=!1,e.pendingProps=i=o,0==(t.lanes&r))return e.lanes=t.lanes,Wa(t,e,r);0!=(131072&t.flags)&&(ba=!0)}}return Ia(t,e,n,i,r)}function Pa(t,e,n){var i=e.pendingProps,r=i.children,o=null!==t?t.memoizedState:null;if("hidden"===i.mode)if(0==(1&e.mode))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cr(Rl,Nl),Nl|=n;else{if(0==(1073741824&n))return t=null!==o?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Cr(Rl,Nl),Nl|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=null!==o?o.baseLanes:n,Cr(Rl,Nl),Nl|=i}else null!==o?(i=o.baseLanes|n,e.memoizedState=null):i=n,Cr(Rl,Nl),Nl|=i;return xa(t,e,r,n),e.child}function Ca(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ia(t,e,n,i,r){var o=Or(n)?Lr:Tr.current;return o=Ar(e,o),Po(e,r),n=Ss(t,e,n,i,o,r),i=Ps(),null===t||ba?(ro&&i&&to(e),e.flags|=1,xa(t,e,n,r),e.child):(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Wa(t,e,r))}function Ta(t,e,n,i,r){if(Or(n)){var o=!0;Dr(e)}else o=!1;if(Po(e,r),null===e.stateNode)qa(t,e),qo(e,n,i),Ho(e,n,i,r),i=!0;else if(null===t){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,u=n.contextType;u="object"==typeof u&&null!==u?Co(u):Ar(e,u=Or(n)?Lr:Tr.current);var c=n.getDerivedStateFromProps,h="function"==typeof c||"function"==typeof s.getSnapshotBeforeUpdate;h||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==i||l!==u)&&Wo(e,s,i,u),Ao=!1;var f=e.memoizedState;s.state=f,zo(e,i,s,r),l=e.memoizedState,a!==i||f!==l||Mr.current||Ao?("function"==typeof c&&(Uo(e,n,c,i),l=e.memoizedState),(a=Ao||Go(e,n,a,i,f,l,u))?(h||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(e.flags|=4194308)):("function"==typeof s.componentDidMount&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),s.props=i,s.state=l,s.context=u,i=a):("function"==typeof s.componentDidMount&&(e.flags|=4194308),i=!1)}else{s=e.stateNode,No(t,e),a=e.memoizedProps,u=e.type===e.elementType?a:yo(e.type,a),s.props=u,h=e.pendingProps,f=s.context,l="object"==typeof(l=n.contextType)&&null!==l?Co(l):Ar(e,l=Or(n)?Lr:Tr.current);var d=n.getDerivedStateFromProps;(c="function"==typeof d||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(a!==h||f!==l)&&Wo(e,s,i,l),Ao=!1,f=e.memoizedState,s.state=f,zo(e,i,s,r);var p=e.memoizedState;a!==h||f!==p||Mr.current||Ao?("function"==typeof d&&(Uo(e,n,d,i),p=e.memoizedState),(u=Ao||Go(e,n,u,i,f,p,l)||!1)?(c||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(i,p,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(i,p,l)),"function"==typeof s.componentDidUpdate&&(e.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(e.flags|=1024)):("function"!=typeof s.componentDidUpdate||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=p),s.props=i,s.state=p,s.context=l,i=u):("function"!=typeof s.componentDidUpdate||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),i=!1)}return Ma(t,e,n,i,o,r)}function Ma(t,e,n,i,r,o){Ca(t,e);var s=0!=(128&e.flags);if(!i&&!s)return r&&Fr(e,n,!1),Wa(t,e,o);i=e.stateNode,_a.current=e;var a=s&&"function"!=typeof n.getDerivedStateFromError?null:i.render();return e.flags|=1,null!==t&&s?(e.child=$o(e,t.child,null,o),e.child=$o(e,null,a,o)):xa(t,e,a,o),e.memoizedState=i.state,r&&Fr(e,n,!0),e.child}function La(t){var e=t.stateNode;e.pendingContext?Rr(0,e.pendingContext,e.pendingContext!==e.context):e.context&&Rr(0,e.context,!1),rs(t,e.containerInfo)}function Aa(t,e,n,i,r){return po(),go(r),e.flags|=256,xa(t,e,n,i),e.child}var Oa,Na,Ra,ka,Da={dehydrated:null,treeContext:null,retryLane:0};function Fa(t){return{baseLanes:t,cachePool:null,transitions:null}}function za(t,e,n){var i,r=e.pendingProps,s=ls.current,a=!1,l=0!=(128&e.flags);if((i=l)||(i=(null===t||null!==t.memoizedState)&&0!=(2&s)),i?(a=!0,e.flags&=-129):null!==t&&null===t.memoizedState||(s|=1),Cr(ls,1&s),null===t)return uo(e),null!==(t=e.memoizedState)&&null!==(t=t.dehydrated)?(0==(1&e.mode)?e.lanes=1:"$!"===t.data?e.lanes=8:e.lanes=1073741824,null):(l=r.children,t=r.fallback,a?(r=e.mode,a=e.child,l={mode:"hidden",children:l},0==(1&r)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=Fu(l,r,0,null),t=Du(t,r,n,null),a.return=e,t.return=e,a.sibling=t,e.child=a,e.child.memoizedState=Fa(n),e.memoizedState=Da,t):Ba(e,l));if(null!==(s=t.memoizedState)&&null!==(i=s.dehydrated))return function(t,e,n,i,r,s,a){if(n)return 256&e.flags?(e.flags&=-257,ja(t,e,a,i=ha(Error(o(422))))):null!==e.memoizedState?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=Fu({mode:"visible",children:i.children},r,0,null),(s=Du(s,r,a,null)).flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,0!=(1&e.mode)&&$o(e,t.child,null,a),e.child.memoizedState=Fa(a),e.memoizedState=Da,s);if(0==(1&e.mode))return ja(t,e,a,null);if("$!"===r.data){if(i=r.nextSibling&&r.nextSibling.dataset)var l=i.dgst;return i=l,ja(t,e,a,i=ha(s=Error(o(419)),i,void 0))}if(l=0!=(a&t.childLanes),ba||l){if(null!==(i=Ll)){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}0!==(r=0!=(r&(i.suspendedLanes|a))?0:r)&&r!==s.retryLane&&(s.retryLane=r,Lo(t,r),iu(i,t,r,-1))}return mu(),ja(t,e,a,i=ha(Error(o(421))))}return"$?"===r.data?(e.flags|=128,e.child=t.child,e=Tu.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,io=ur(r.nextSibling),no=e,ro=!0,oo=null,null!==t&&(Xr[Yr++]=Kr,Xr[Yr++]=$r,Xr[Yr++]=Zr,Kr=t.id,$r=t.overflow,Zr=e),(e=Ba(e,i.children)).flags|=4096,e)}(t,e,l,r,i,s,n);if(a){a=r.fallback,l=e.mode,i=(s=t.child).sibling;var u={mode:"hidden",children:r.children};return 0==(1&l)&&e.child!==s?((r=e.child).childLanes=0,r.pendingProps=u,e.deletions=null):(r=Ru(s,u)).subtreeFlags=14680064&s.subtreeFlags,null!==i?a=Ru(i,a):(a=Du(a,l,n,null)).flags|=2,a.return=e,r.return=e,r.sibling=a,e.child=r,r=a,a=e.child,l=null===(l=t.child.memoizedState)?Fa(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=t.childLanes&~n,e.memoizedState=Da,r}return t=(a=t.child).sibling,r=Ru(a,{mode:"visible",children:r.children}),0==(1&e.mode)&&(r.lanes=n),r.return=e,r.sibling=null,null!==t&&(null===(n=e.deletions)?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Ba(t,e){return(e=Fu({mode:"visible",children:e},t.mode,0,null)).return=t,t.child=e}function ja(t,e,n,i){return null!==i&&go(i),$o(e,t.child,null,n),(t=Ba(e,e.pendingProps.children)).flags|=2,e.memoizedState=null,t}function Ua(t,e,n){t.lanes|=e;var i=t.alternate;null!==i&&(i.lanes|=e),So(t.return,e,n)}function Va(t,e,n,i,r){var o=t.memoizedState;null===o?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=i,o.tail=n,o.tailMode=r)}function Ga(t,e,n){var i=e.pendingProps,r=i.revealOrder,o=i.tail;if(xa(t,e,i.children,n),0!=(2&(i=ls.current)))i=1&i|2,e.flags|=128;else{if(null!==t&&0!=(128&t.flags))t:for(t=e.child;null!==t;){if(13===t.tag)null!==t.memoizedState&&Ua(t,n,e);else if(19===t.tag)Ua(t,n,e);else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break t;for(;null===t.sibling;){if(null===t.return||t.return===e)break t;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Cr(ls,i),0==(1&e.mode))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;null!==n;)null!==(t=n.alternate)&&null===us(t)&&(r=n),n=n.sibling;null===(n=r)?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Va(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;null!==r;){if(null!==(t=r.alternate)&&null===us(t)){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Va(e,!0,n,null,o);break;case"together":Va(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function qa(t,e){0==(1&e.mode)&&null!==t&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Wa(t,e,n){if(null!==t&&(e.dependencies=t.dependencies),Fl|=e.lanes,0==(n&e.childLanes))return null;if(null!==t&&e.child!==t.child)throw Error(o(153));if(null!==e.child){for(n=Ru(t=e.child,t.pendingProps),e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,(n=n.sibling=Ru(t,t.pendingProps)).return=e;n.sibling=null}return e.child}function Ha(t,e){if(!ro)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;null!==e;)null!==e.alternate&&(n=e),e=e.sibling;null===n?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?e||null===t.tail?t.tail=null:t.tail.sibling=null:i.sibling=null}}function Xa(t){var e=null!==t.alternate&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=14680064&r.subtreeFlags,i|=14680064&r.flags,r.return=t,r=r.sibling;else for(r=t.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function Ya(t,e,n){var i=e.pendingProps;switch(eo(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Xa(e),null;case 1:case 17:return Or(e.type)&&Nr(),Xa(e),null;case 3:return i=e.stateNode,os(),Pr(Mr),Pr(Tr),hs(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(ho(e)?e.flags|=4:null===t||t.memoizedState.isDehydrated&&0==(256&e.flags)||(e.flags|=1024,null!==oo&&(au(oo),oo=null))),Na(t,e),Xa(e),null;case 5:as(e);var r=is(ns.current);if(n=e.type,null!==t&&null!=e.stateNode)Ra(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(null===e.stateNode)throw Error(o(166));return Xa(e),null}if(t=is(ts.current),ho(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[fr]=e,i[dr]=s,t=0!=(1&e.mode),n){case"dialog":Bi("cancel",i),Bi("close",i);break;case"iframe":case"object":case"embed":Bi("load",i);break;case"video":case"audio":for(r=0;r<ki.length;r++)Bi(ki[r],i);break;case"source":Bi("error",i);break;case"img":case"image":case"link":Bi("error",i),Bi("load",i);break;case"details":Bi("toggle",i);break;case"input":K(i,s),Bi("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Bi("invalid",i);break;case"textarea":rt(i,s),Bi("invalid",i)}for(var l in vt(n,s),r=null,s)if(s.hasOwnProperty(l)){var u=s[l];"children"===l?"string"==typeof u?i.textContent!==u&&(!0!==s.suppressHydrationWarning&&Qi(i.textContent,u,t),r=["children",u]):"number"==typeof u&&i.textContent!==""+u&&(!0!==s.suppressHydrationWarning&&Qi(i.textContent,u,t),r=["children",""+u]):a.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Bi("scroll",i)}switch(n){case"input":H(i),J(i,s,!0);break;case"textarea":H(i),st(i);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(i.onclick=Ji)}i=r,e.updateQueue=i,null!==i&&(e.flags|=4)}else{l=9===r.nodeType?r:r.ownerDocument,"http://www.w3.org/1999/xhtml"===t&&(t=at(n)),"http://www.w3.org/1999/xhtml"===t?"script"===n?((t=l.createElement("div")).innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):"string"==typeof i.is?t=l.createElement(n,{is:i.is}):(t=l.createElement(n),"select"===n&&(l=t,i.multiple?l.multiple=!0:i.size&&(l.size=i.size))):t=l.createElementNS(t,n),t[fr]=e,t[dr]=i,Oa(t,e,!1,!1),e.stateNode=t;t:{switch(l=_t(n,i),n){case"dialog":Bi("cancel",t),Bi("close",t),r=i;break;case"iframe":case"object":case"embed":Bi("load",t),r=i;break;case"video":case"audio":for(r=0;r<ki.length;r++)Bi(ki[r],t);r=i;break;case"source":Bi("error",t),r=i;break;case"img":case"image":case"link":Bi("error",t),Bi("load",t),r=i;break;case"details":Bi("toggle",t),r=i;break;case"input":K(t,i),r=Z(t,i),Bi("invalid",t);break;case"option":default:r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=F({},i,{value:void 0}),Bi("invalid",t);break;case"textarea":rt(t,i),r=it(t,i),Bi("invalid",t)}for(s in vt(n,r),u=r)if(u.hasOwnProperty(s)){var c=u[s];"style"===s?mt(t,c):"dangerouslySetInnerHTML"===s?null!=(c=c?c.__html:void 0)&&ht(t,c):"children"===s?"string"==typeof c?("textarea"!==n||""!==c)&&ft(t,c):"number"==typeof c&&ft(t,""+c):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(a.hasOwnProperty(s)?null!=c&&"onScroll"===s&&Bi("scroll",t):null!=c&&_(t,s,c,l))}switch(n){case"input":H(t),J(t,i,!1);break;case"textarea":H(t),st(t);break;case"option":null!=i.value&&t.setAttribute("value",""+q(i.value));break;case"select":t.multiple=!!i.multiple,null!=(s=i.value)?nt(t,!!i.multiple,s,!1):null!=i.defaultValue&&nt(t,!!i.multiple,i.defaultValue,!0);break;default:"function"==typeof r.onClick&&(t.onclick=Ji)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break t;case"img":i=!0;break t;default:i=!1}}i&&(e.flags|=4)}null!==e.ref&&(e.flags|=512,e.flags|=2097152)}return Xa(e),null;case 6:if(t&&null!=e.stateNode)ka(t,e,t.memoizedProps,i);else{if("string"!=typeof i&&null===e.stateNode)throw Error(o(166));if(n=is(ns.current),is(ts.current),ho(e)){if(i=e.stateNode,n=e.memoizedProps,i[fr]=e,(s=i.nodeValue!==n)&&null!==(t=no))switch(t.tag){case 3:Qi(i.nodeValue,n,0!=(1&t.mode));break;case 5:!0!==t.memoizedProps.suppressHydrationWarning&&Qi(i.nodeValue,n,0!=(1&t.mode))}s&&(e.flags|=4)}else(i=(9===n.nodeType?n:n.ownerDocument).createTextNode(i))[fr]=e,e.stateNode=i}return Xa(e),null;case 13:if(Pr(ls),i=e.memoizedState,null===t||null!==t.memoizedState&&null!==t.memoizedState.dehydrated){if(ro&&null!==io&&0!=(1&e.mode)&&0==(128&e.flags))fo(),po(),e.flags|=98560,s=!1;else if(s=ho(e),null!==i&&null!==i.dehydrated){if(null===t){if(!s)throw Error(o(318));if(!(s=null!==(s=e.memoizedState)?s.dehydrated:null))throw Error(o(317));s[fr]=e}else po(),0==(128&e.flags)&&(e.memoizedState=null),e.flags|=4;Xa(e),s=!1}else null!==oo&&(au(oo),oo=null),s=!0;if(!s)return 65536&e.flags?e:null}return 0!=(128&e.flags)?(e.lanes=n,e):((i=null!==i)!=(null!==t&&null!==t.memoizedState)&&i&&(e.child.flags|=8192,0!=(1&e.mode)&&(null===t||0!=(1&ls.current)?0===kl&&(kl=3):mu())),null!==e.updateQueue&&(e.flags|=4),Xa(e),null);case 4:return os(),Na(t,e),null===t&&Vi(e.stateNode.containerInfo),Xa(e),null;case 10:return Eo(e.type._context),Xa(e),null;case 19:if(Pr(ls),null===(s=e.memoizedState))return Xa(e),null;if(i=0!=(128&e.flags),null===(l=s.rendering))if(i)Ha(s,!1);else{if(0!==kl||null!==t&&0!=(128&t.flags))for(t=e.child;null!==t;){if(null!==(l=us(t))){for(e.flags|=128,Ha(s,!1),null!==(i=l.updateQueue)&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;null!==n;)t=i,(s=n).flags&=14680066,null===(l=s.alternate)?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=l.childLanes,s.lanes=l.lanes,s.child=l.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=l.memoizedProps,s.memoizedState=l.memoizedState,s.updateQueue=l.updateQueue,s.type=l.type,t=l.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Cr(ls,1&ls.current|2),e.child}t=t.sibling}null!==s.tail&&$t()>Gl&&(e.flags|=128,i=!0,Ha(s,!1),e.lanes=4194304)}else{if(!i)if(null!==(t=us(l))){if(e.flags|=128,i=!0,null!==(n=t.updateQueue)&&(e.updateQueue=n,e.flags|=4),Ha(s,!0),null===s.tail&&"hidden"===s.tailMode&&!l.alternate&&!ro)return Xa(e),null}else 2*$t()-s.renderingStartTime>Gl&&1073741824!==n&&(e.flags|=128,i=!0,Ha(s,!1),e.lanes=4194304);s.isBackwards?(l.sibling=e.child,e.child=l):(null!==(n=s.last)?n.sibling=l:e.child=l,s.last=l)}return null!==s.tail?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=$t(),e.sibling=null,n=ls.current,Cr(ls,i?1&n|2:1&n),e):(Xa(e),null);case 22:case 23:return fu(),i=null!==e.memoizedState,null!==t&&null!==t.memoizedState!==i&&(e.flags|=8192),i&&0!=(1&e.mode)?0!=(1073741824&Nl)&&(Xa(e),6&e.subtreeFlags&&(e.flags|=8192)):Xa(e),null;case 24:case 25:return null}throw Error(o(156,e.tag))}function Za(t,e){switch(eo(e),e.tag){case 1:return Or(e.type)&&Nr(),65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 3:return os(),Pr(Mr),Pr(Tr),hs(),0!=(65536&(t=e.flags))&&0==(128&t)?(e.flags=-65537&t|128,e):null;case 5:return as(e),null;case 13:if(Pr(ls),null!==(t=e.memoizedState)&&null!==t.dehydrated){if(null===e.alternate)throw Error(o(340));po()}return 65536&(t=e.flags)?(e.flags=-65537&t|128,e):null;case 19:return Pr(ls),null;case 4:return os(),null;case 10:return Eo(e.type._context),null;case 22:case 23:return fu(),null;default:return null}}Oa=function(t,e){for(var n=e.child;null!==n;){if(5===n.tag||6===n.tag)t.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Na=function(){},Ra=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,is(ts.current);var o,s=null;switch(n){case"input":r=Z(t,r),i=Z(t,i),s=[];break;case"select":r=F({},r,{value:void 0}),i=F({},i,{value:void 0}),s=[];break;case"textarea":r=it(t,r),i=it(t,i),s=[];break;default:"function"!=typeof r.onClick&&"function"==typeof i.onClick&&(t.onclick=Ji)}for(c in vt(n,i),n=null,r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&null!=r[c])if("style"===c){var l=r[c];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(a.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var u=i[c];if(l=null!=r?r[c]:void 0,i.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(s||(s=[]),s.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(s=s||[]).push(c,u)):"children"===c?"string"!=typeof u&&"number"!=typeof u||(s=s||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(a.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Bi("scroll",t),s||l===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}},ka=function(t,e,n,i){n!==i&&(e.flags|=4)};var Ka=!1,$a=!1,Qa="function"==typeof WeakSet?WeakSet:Set,Ja=null;function tl(t,e){var n=t.ref;if(null!==n)if("function"==typeof n)try{n(null)}catch(n){Pu(t,e,n)}else n.current=null}function el(t,e,n){try{n()}catch(n){Pu(t,e,n)}}var nl=!1;function il(t,e,n){var i=e.updateQueue;if(null!==(i=null!==i?i.lastEffect:null)){var r=i=i.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,void 0!==o&&el(e,n,o)}r=r.next}while(r!==i)}}function rl(t,e){if(null!==(e=null!==(e=e.updateQueue)?e.lastEffect:null)){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function ol(t){var e=t.ref;if(null!==e){var n=t.stateNode;t.tag,t=n,"function"==typeof e?e(t):e.current=t}}function sl(t){var e=t.alternate;null!==e&&(t.alternate=null,sl(e)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&null!==(e=t.stateNode)&&(delete e[fr],delete e[dr],delete e[gr],delete e[mr],delete e[yr]),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function al(t){return 5===t.tag||3===t.tag||4===t.tag}function ll(t){t:for(;;){for(;null===t.sibling;){if(null===t.return||al(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;5!==t.tag&&6!==t.tag&&18!==t.tag;){if(2&t.flags)continue t;if(null===t.child||4===t.tag)continue t;t.child.return=t,t=t.child}if(!(2&t.flags))return t.stateNode}}function ul(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?8===n.nodeType?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(8===n.nodeType?(e=n.parentNode).insertBefore(t,n):(e=n).appendChild(t),null!=(n=n._reactRootContainer)||null!==e.onclick||(e.onclick=Ji));else if(4!==i&&null!==(t=t.child))for(ul(t,e,n),t=t.sibling;null!==t;)ul(t,e,n),t=t.sibling}function cl(t,e,n){var i=t.tag;if(5===i||6===i)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(4!==i&&null!==(t=t.child))for(cl(t,e,n),t=t.sibling;null!==t;)cl(t,e,n),t=t.sibling}var hl=null,fl=!1;function dl(t,e,n){for(n=n.child;null!==n;)pl(t,e,n),n=n.sibling}function pl(t,e,n){if(oe&&"function"==typeof oe.onCommitFiberUnmount)try{oe.onCommitFiberUnmount(re,n)}catch(t){}switch(n.tag){case 5:$a||tl(n,e);case 6:var i=hl,r=fl;hl=null,dl(t,e,n),fl=r,null!==(hl=i)&&(fl?(t=hl,n=n.stateNode,8===t.nodeType?t.parentNode.removeChild(n):t.removeChild(n)):hl.removeChild(n.stateNode));break;case 18:null!==hl&&(fl?(t=hl,n=n.stateNode,8===t.nodeType?lr(t.parentNode,n):1===t.nodeType&&lr(t,n),Ve(t)):lr(hl,n.stateNode));break;case 4:i=hl,r=fl,hl=n.stateNode.containerInfo,fl=!0,dl(t,e,n),hl=i,fl=r;break;case 0:case 11:case 14:case 15:if(!$a&&null!==(i=n.updateQueue)&&null!==(i=i.lastEffect)){r=i=i.next;do{var o=r,s=o.destroy;o=o.tag,void 0!==s&&(0!=(2&o)||0!=(4&o))&&el(n,e,s),r=r.next}while(r!==i)}dl(t,e,n);break;case 1:if(!$a&&(tl(n,e),"function"==typeof(i=n.stateNode).componentWillUnmount))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(t){Pu(n,e,t)}dl(t,e,n);break;case 21:dl(t,e,n);break;case 22:1&n.mode?($a=(i=$a)||null!==n.memoizedState,dl(t,e,n),$a=i):dl(t,e,n);break;default:dl(t,e,n)}}function gl(t){var e=t.updateQueue;if(null!==e){t.updateQueue=null;var n=t.stateNode;null===n&&(n=t.stateNode=new Qa),e.forEach((function(e){var i=Mu.bind(null,t,e);n.has(e)||(n.add(e),e.then(i,i))}))}}function ml(t,e){var n=e.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,a=e,l=a;t:for(;null!==l;){switch(l.tag){case 5:hl=l.stateNode,fl=!1;break t;case 3:case 4:hl=l.stateNode.containerInfo,fl=!0;break t}l=l.return}if(null===hl)throw Error(o(160));pl(s,a,r),hl=null,fl=!1;var u=r.alternate;null!==u&&(u.return=null),r.return=null}catch(t){Pu(r,e,t)}}if(12854&e.subtreeFlags)for(e=e.child;null!==e;)yl(e,t),e=e.sibling}function yl(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ml(e,t),vl(t),4&i){try{il(3,t,t.return),rl(3,t)}catch(e){Pu(t,t.return,e)}try{il(5,t,t.return)}catch(e){Pu(t,t.return,e)}}break;case 1:ml(e,t),vl(t),512&i&&null!==n&&tl(n,n.return);break;case 5:if(ml(e,t),vl(t),512&i&&null!==n&&tl(n,n.return),32&t.flags){var r=t.stateNode;try{ft(r,"")}catch(e){Pu(t,t.return,e)}}if(4&i&&null!=(r=t.stateNode)){var s=t.memoizedProps,a=null!==n?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,null!==u)try{"input"===l&&"radio"===s.type&&null!=s.name&&$(r,s),_t(l,a);var c=_t(l,s);for(a=0;a<u.length;a+=2){var h=u[a],f=u[a+1];"style"===h?mt(r,f):"dangerouslySetInnerHTML"===h?ht(r,f):"children"===h?ft(r,f):_(r,h,f,c)}switch(l){case"input":Q(r,s);break;case"textarea":ot(r,s);break;case"select":var d=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var p=s.value;null!=p?nt(r,!!s.multiple,p,!1):d!==!!s.multiple&&(null!=s.defaultValue?nt(r,!!s.multiple,s.defaultValue,!0):nt(r,!!s.multiple,s.multiple?[]:"",!1))}r[dr]=s}catch(e){Pu(t,t.return,e)}}break;case 6:if(ml(e,t),vl(t),4&i){if(null===t.stateNode)throw Error(o(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(e){Pu(t,t.return,e)}}break;case 3:if(ml(e,t),vl(t),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Ve(e.containerInfo)}catch(e){Pu(t,t.return,e)}break;case 4:default:ml(e,t),vl(t);break;case 13:ml(e,t),vl(t),8192&(r=t.child).flags&&(s=null!==r.memoizedState,r.stateNode.isHidden=s,!s||null!==r.alternate&&null!==r.alternate.memoizedState||(Vl=$t())),4&i&&gl(t);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&t.mode?($a=(c=$a)||h,ml(e,t),$a=c):ml(e,t),vl(t),8192&i){if(c=null!==t.memoizedState,(t.stateNode.isHidden=c)&&!h&&0!=(1&t.mode))for(Ja=t,h=t.child;null!==h;){for(f=Ja=h;null!==Ja;){switch(p=(d=Ja).child,d.tag){case 0:case 11:case 14:case 15:il(4,d,d.return);break;case 1:tl(d,d.return);var g=d.stateNode;if("function"==typeof g.componentWillUnmount){i=d,n=d.return;try{e=i,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(t){Pu(i,n,t)}}break;case 5:tl(d,d.return);break;case 22:if(null!==d.memoizedState){wl(f);continue}}null!==p?(p.return=d,Ja=p):wl(f)}h=h.sibling}t:for(h=null,f=t;;){if(5===f.tag){if(null===h){h=f;try{r=f.stateNode,c?"function"==typeof(s=r.style).setProperty?s.setProperty("display","none","important"):s.display="none":(l=f.stateNode,a=null!=(u=f.memoizedProps.style)&&u.hasOwnProperty("display")?u.display:null,l.style.display=gt("display",a))}catch(e){Pu(t,t.return,e)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=c?"":f.memoizedProps}catch(e){Pu(t,t.return,e)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===t)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===t)break t;for(;null===f.sibling;){if(null===f.return||f.return===t)break t;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:ml(e,t),vl(t),4&i&&gl(t);case 21:}}function vl(t){var e=t.flags;if(2&e){try{t:{for(var n=t.return;null!==n;){if(al(n)){var i=n;break t}n=n.return}throw Error(o(160))}switch(i.tag){case 5:var r=i.stateNode;32&i.flags&&(ft(r,""),i.flags&=-33),cl(t,ll(t),r);break;case 3:case 4:var s=i.stateNode.containerInfo;ul(t,ll(t),s);break;default:throw Error(o(161))}}catch(e){Pu(t,t.return,e)}t.flags&=-3}4096&e&&(t.flags&=-4097)}function _l(t,e,n){Ja=t,bl(t,e,n)}function bl(t,e,n){for(var i=0!=(1&t.mode);null!==Ja;){var r=Ja,o=r.child;if(22===r.tag&&i){var s=null!==r.memoizedState||Ka;if(!s){var a=r.alternate,l=null!==a&&null!==a.memoizedState||$a;a=Ka;var u=$a;if(Ka=s,($a=l)&&!u)for(Ja=r;null!==Ja;)l=(s=Ja).child,22===s.tag&&null!==s.memoizedState?El(r):null!==l?(l.return=s,Ja=l):El(r);for(;null!==o;)Ja=o,bl(o,e,n),o=o.sibling;Ja=r,Ka=a,$a=u}xl(t)}else 0!=(8772&r.subtreeFlags)&&null!==o?(o.return=r,Ja=o):xl(t)}}function xl(t){for(;null!==Ja;){var e=Ja;if(0!=(8772&e.flags)){var n=e.alternate;try{if(0!=(8772&e.flags))switch(e.tag){case 0:case 11:case 15:$a||rl(5,e);break;case 1:var i=e.stateNode;if(4&e.flags&&!$a)if(null===n)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:yo(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;null!==s&&Bo(e,s,i);break;case 3:var a=e.updateQueue;if(null!==a){if(n=null,null!==e.child)switch(e.child.tag){case 5:case 1:n=e.child.stateNode}Bo(e,a,n)}break;case 5:var l=e.stateNode;if(null===n&&4&e.flags){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===e.memoizedState){var c=e.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&Ve(f)}}}break;default:throw Error(o(163))}$a||512&e.flags&&ol(e)}catch(t){Pu(e,e.return,t)}}if(e===t){Ja=null;break}if(null!==(n=e.sibling)){n.return=e.return,Ja=n;break}Ja=e.return}}function wl(t){for(;null!==Ja;){var e=Ja;if(e===t){Ja=null;break}var n=e.sibling;if(null!==n){n.return=e.return,Ja=n;break}Ja=e.return}}function El(t){for(;null!==Ja;){var e=Ja;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{rl(4,e)}catch(t){Pu(e,n,t)}break;case 1:var i=e.stateNode;if("function"==typeof i.componentDidMount){var r=e.return;try{i.componentDidMount()}catch(t){Pu(e,r,t)}}var o=e.return;try{ol(e)}catch(t){Pu(e,o,t)}break;case 5:var s=e.return;try{ol(e)}catch(t){Pu(e,s,t)}}}catch(t){Pu(e,e.return,t)}if(e===t){Ja=null;break}var a=e.sibling;if(null!==a){a.return=e.return,Ja=a;break}Ja=e.return}}var Sl,Pl=Math.ceil,Cl=b.ReactCurrentDispatcher,Il=b.ReactCurrentOwner,Tl=b.ReactCurrentBatchConfig,Ml=0,Ll=null,Al=null,Ol=0,Nl=0,Rl=Sr(0),kl=0,Dl=null,Fl=0,zl=0,Bl=0,jl=null,Ul=null,Vl=0,Gl=1/0,ql=null,Wl=!1,Hl=null,Xl=null,Yl=!1,Zl=null,Kl=0,$l=0,Ql=null,Jl=-1,tu=0;function eu(){return 0!=(6&Ml)?$t():-1!==Jl?Jl:Jl=$t()}function nu(t){return 0==(1&t.mode)?1:0!=(2&Ml)&&0!==Ol?Ol&-Ol:null!==mo.transition?(0===tu&&(tu=ge()),tu):0!==(t=_e)?t:t=void 0===(t=window.event)?16:Ke(t.type)}function iu(t,e,n,i){if(50<$l)throw $l=0,Ql=null,Error(o(185));ye(t,n,i),0!=(2&Ml)&&t===Ll||(t===Ll&&(0==(2&Ml)&&(zl|=n),4===kl&&lu(t,Ol)),ru(t,i),1===n&&0===Ml&&0==(1&e.mode)&&(Gl=$t()+500,Br&&Vr()))}function ru(t,e){var n=t.callbackNode;!function(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var s=31-se(o),a=1<<s,l=r[s];-1===l?0!=(a&n)&&0==(a&i)||(r[s]=de(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}(t,e);var i=fe(t,t===Ll?Ol:0);if(0===i)null!==n&&Yt(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(null!=n&&Yt(n),1===e)0===t.tag?function(t){Br=!0,Ur(t)}(uu.bind(null,t)):Ur(uu.bind(null,t)),sr((function(){0==(6&Ml)&&Vr()})),n=null;else{switch(be(i)){case 1:n=Jt;break;case 4:n=te;break;case 16:default:n=ee;break;case 536870912:n=ie}n=Lu(n,ou.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function ou(t,e){if(Jl=-1,tu=0,0!=(6&Ml))throw Error(o(327));var n=t.callbackNode;if(Eu()&&t.callbackNode!==n)return null;var i=fe(t,t===Ll?Ol:0);if(0===i)return null;if(0!=(30&i)||0!=(i&t.expiredLanes)||e)e=yu(t,i);else{e=i;var r=Ml;Ml|=2;var s=gu();for(Ll===t&&Ol===e||(ql=null,Gl=$t()+500,du(t,e));;)try{_u();break}catch(e){pu(t,e)}wo(),Cl.current=s,Ml=r,null!==Al?e=0:(Ll=null,Ol=0,e=kl)}if(0!==e){if(2===e&&0!==(r=pe(t))&&(i=r,e=su(t,r)),1===e)throw n=Dl,du(t,0),lu(t,i),ru(t,$t()),n;if(6===e)lu(t,i);else{if(r=t.current.alternate,0==(30&i)&&!function(t){for(var e=t;;){if(16384&e.flags){var n=e.updateQueue;if(null!==n&&null!==(n=n.stores))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!ai(o(),r))return!1}catch(t){return!1}}}if(n=e.child,16384&e.subtreeFlags&&null!==n)n.return=e,e=n;else{if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}(r)&&(2===(e=yu(t,i))&&0!==(s=pe(t))&&(i=s,e=su(t,s)),1===e))throw n=Dl,du(t,0),lu(t,i),ru(t,$t()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(o(345));case 2:case 5:wu(t,Ul,ql);break;case 3:if(lu(t,i),(130023424&i)===i&&10<(e=Vl+500-$t())){if(0!==fe(t,0))break;if(((r=t.suspendedLanes)&i)!==i){eu(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=ir(wu.bind(null,t,Ul,ql),e);break}wu(t,Ul,ql);break;case 4:if(lu(t,i),(4194240&i)===i)break;for(e=t.eventTimes,r=-1;0<i;){var a=31-se(i);s=1<<a,(a=e[a])>r&&(r=a),i&=~s}if(i=r,10<(i=(120>(i=$t()-i)?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*Pl(i/1960))-i)){t.timeoutHandle=ir(wu.bind(null,t,Ul,ql),i);break}wu(t,Ul,ql);break;default:throw Error(o(329))}}}return ru(t,$t()),t.callbackNode===n?ou.bind(null,t):null}function su(t,e){var n=jl;return t.current.memoizedState.isDehydrated&&(du(t,e).flags|=256),2!==(t=yu(t,e))&&(e=Ul,Ul=n,null!==e&&au(e)),t}function au(t){null===Ul?Ul=t:Ul.push.apply(Ul,t)}function lu(t,e){for(e&=~Bl,e&=~zl,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-se(e),i=1<<n;t[n]=-1,e&=~i}}function uu(t){if(0!=(6&Ml))throw Error(o(327));Eu();var e=fe(t,0);if(0==(1&e))return ru(t,$t()),null;var n=yu(t,e);if(0!==t.tag&&2===n){var i=pe(t);0!==i&&(e=i,n=su(t,i))}if(1===n)throw n=Dl,du(t,0),lu(t,e),ru(t,$t()),n;if(6===n)throw Error(o(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,wu(t,Ul,ql),ru(t,$t()),null}function cu(t,e){var n=Ml;Ml|=1;try{return t(e)}finally{0===(Ml=n)&&(Gl=$t()+500,Br&&Vr())}}function hu(t){null!==Zl&&0===Zl.tag&&0==(6&Ml)&&Eu();var e=Ml;Ml|=1;var n=Tl.transition,i=_e;try{if(Tl.transition=null,_e=1,t)return t()}finally{_e=i,Tl.transition=n,0==(6&(Ml=e))&&Vr()}}function fu(){Nl=Rl.current,Pr(Rl)}function du(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(-1!==n&&(t.timeoutHandle=-1,rr(n)),null!==Al)for(n=Al.return;null!==n;){var i=n;switch(eo(i),i.tag){case 1:null!=(i=i.type.childContextTypes)&&Nr();break;case 3:os(),Pr(Mr),Pr(Tr),hs();break;case 5:as(i);break;case 4:os();break;case 13:case 19:Pr(ls);break;case 10:Eo(i.type._context);break;case 22:case 23:fu()}n=n.return}if(Ll=t,Al=t=Ru(t.current,null),Ol=Nl=e,kl=0,Dl=null,Bl=zl=Fl=0,Ul=jl=null,null!==Io){for(e=0;e<Io.length;e++)if(null!==(i=(n=Io[e]).interleaved)){n.interleaved=null;var r=i.next,o=n.pending;if(null!==o){var s=o.next;o.next=r,i.next=s}n.pending=i}Io=null}return t}function pu(t,e){for(;;){var n=Al;try{if(wo(),fs.current=sa,vs){for(var i=gs.memoizedState;null!==i;){var r=i.queue;null!==r&&(r.pending=null),i=i.next}vs=!1}if(ps=0,ys=ms=gs=null,_s=!1,bs=0,Il.current=null,null===n||null===n.return){kl=1,Dl=e,Al=null;break}t:{var s=t,a=n.return,l=n,u=e;if(e=Ol,l.flags|=32768,null!==u&&"object"==typeof u&&"function"==typeof u.then){var c=u,h=l,f=h.tag;if(0==(1&h.mode)&&(0===f||11===f||15===f)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ya(a);if(null!==p){p.flags&=-257,va(p,a,l,0,e),1&p.mode&&ma(s,c,e),u=c;var g=(e=p).updateQueue;if(null===g){var m=new Set;m.add(u),e.updateQueue=m}else g.add(u);break t}if(0==(1&e)){ma(s,c,e),mu();break t}u=Error(o(426))}else if(ro&&1&l.mode){var y=ya(a);if(null!==y){0==(65536&y.flags)&&(y.flags|=256),va(y,a,l,0,e),go(ca(u,l));break t}}s=u=ca(u,l),4!==kl&&(kl=2),null===jl?jl=[s]:jl.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e,Fo(s,pa(0,u,e));break t;case 1:l=u;var v=s.type,_=s.stateNode;if(0==(128&s.flags)&&("function"==typeof v.getDerivedStateFromError||null!==_&&"function"==typeof _.componentDidCatch&&(null===Xl||!Xl.has(_)))){s.flags|=65536,e&=-e,s.lanes|=e,Fo(s,ga(s,l,e));break t}}s=s.return}while(null!==s)}xu(n)}catch(t){e=t,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function gu(){var t=Cl.current;return Cl.current=sa,null===t?sa:t}function mu(){0!==kl&&3!==kl&&2!==kl||(kl=4),null===Ll||0==(268435455&Fl)&&0==(268435455&zl)||lu(Ll,Ol)}function yu(t,e){var n=Ml;Ml|=2;var i=gu();for(Ll===t&&Ol===e||(ql=null,du(t,e));;)try{vu();break}catch(e){pu(t,e)}if(wo(),Ml=n,Cl.current=i,null!==Al)throw Error(o(261));return Ll=null,Ol=0,kl}function vu(){for(;null!==Al;)bu(Al)}function _u(){for(;null!==Al&&!Zt();)bu(Al)}function bu(t){var e=Sl(t.alternate,t,Nl);t.memoizedProps=t.pendingProps,null===e?xu(t):Al=e,Il.current=null}function xu(t){var e=t;do{var n=e.alternate;if(t=e.return,0==(32768&e.flags)){if(null!==(n=Ya(n,e,Nl)))return void(Al=n)}else{if(null!==(n=Za(n,e)))return n.flags&=32767,void(Al=n);if(null===t)return kl=6,void(Al=null);t.flags|=32768,t.subtreeFlags=0,t.deletions=null}if(null!==(e=e.sibling))return void(Al=e);Al=e=t}while(null!==e);0===kl&&(kl=5)}function wu(t,e,n){var i=_e,r=Tl.transition;try{Tl.transition=null,_e=1,function(t,e,n,i){do{Eu()}while(null!==Zl);if(0!=(6&Ml))throw Error(o(327));n=t.finishedWork;var r=t.finishedLanes;if(null===n)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(o(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(function(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-se(n),o=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~o}}(t,s),t===Ll&&(Al=Ll=null,Ol=0),0==(2064&n.subtreeFlags)&&0==(2064&n.flags)||Yl||(Yl=!0,Lu(ee,(function(){return Eu(),null}))),s=0!=(15990&n.flags),0!=(15990&n.subtreeFlags)||s){s=Tl.transition,Tl.transition=null;var a=_e;_e=1;var l=Ml;Ml|=4,Il.current=null,function(t,e){if(tr=qe,di(t=fi())){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else t:{var i=(n=(n=t.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch(t){n=null;break t}var a=0,l=-1,u=-1,c=0,h=0,f=t,d=null;e:for(;;){for(var p;f!==n||0!==r&&3!==f.nodeType||(l=a+r),f!==s||0!==i&&3!==f.nodeType||(u=a+i),3===f.nodeType&&(a+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===t)break e;if(d===n&&++c===r&&(l=a),d===s&&++h===i&&(u=a),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(er={focusedElem:t,selectionRange:n},qe=!1,Ja=e;null!==Ja;)if(t=(e=Ja).child,0!=(1028&e.subtreeFlags)&&null!==t)t.return=e,Ja=t;else for(;null!==Ja;){e=Ja;try{var g=e.alternate;if(0!=(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var m=g.memoizedProps,y=g.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?m:yo(e.type,m),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=e.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(o(163))}}catch(t){Pu(e,e.return,t)}if(null!==(t=e.sibling)){t.return=e.return,Ja=t;break}Ja=e.return}g=nl,nl=!1}(t,n),yl(n,t),pi(er),qe=!!tr,er=tr=null,t.current=n,_l(n,t,r),Kt(),Ml=l,_e=a,Tl.transition=s}else t.current=n;if(Yl&&(Yl=!1,Zl=t,Kl=r),0===(s=t.pendingLanes)&&(Xl=null),function(t){if(oe&&"function"==typeof oe.onCommitFiberRoot)try{oe.onCommitFiberRoot(re,t,void 0,128==(128&t.current.flags))}catch(t){}}(n.stateNode),ru(t,$t()),null!==e)for(i=t.onRecoverableError,n=0;n<e.length;n++)i((r=e[n]).value,{componentStack:r.stack,digest:r.digest});if(Wl)throw Wl=!1,t=Hl,Hl=null,t;0!=(1&Kl)&&0!==t.tag&&Eu(),0!=(1&(s=t.pendingLanes))?t===Ql?$l++:($l=0,Ql=t):$l=0,Vr()}(t,e,n,i)}finally{Tl.transition=r,_e=i}return null}function Eu(){if(null!==Zl){var t=be(Kl),e=Tl.transition,n=_e;try{if(Tl.transition=null,_e=16>t?16:t,null===Zl)var i=!1;else{if(t=Zl,Zl=null,Kl=0,0!=(6&Ml))throw Error(o(331));var r=Ml;for(Ml|=4,Ja=t.current;null!==Ja;){var s=Ja,a=s.child;if(0!=(16&Ja.flags)){var l=s.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(Ja=c;null!==Ja;){var h=Ja;switch(h.tag){case 0:case 11:case 15:il(8,h,s)}var f=h.child;if(null!==f)f.return=h,Ja=f;else for(;null!==Ja;){var d=(h=Ja).sibling,p=h.return;if(sl(h),h===c){Ja=null;break}if(null!==d){d.return=p,Ja=d;break}Ja=p}}}var g=s.alternate;if(null!==g){var m=g.child;if(null!==m){g.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Ja=s}}if(0!=(2064&s.subtreeFlags)&&null!==a)a.return=s,Ja=a;else t:for(;null!==Ja;){if(0!=(2048&(s=Ja).flags))switch(s.tag){case 0:case 11:case 15:il(9,s,s.return)}var v=s.sibling;if(null!==v){v.return=s.return,Ja=v;break t}Ja=s.return}}var _=t.current;for(Ja=_;null!==Ja;){var b=(a=Ja).child;if(0!=(2064&a.subtreeFlags)&&null!==b)b.return=a,Ja=b;else t:for(a=_;null!==Ja;){if(0!=(2048&(l=Ja).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(t){Pu(l,l.return,t)}if(l===a){Ja=null;break t}var x=l.sibling;if(null!==x){x.return=l.return,Ja=x;break t}Ja=l.return}}if(Ml=r,Vr(),oe&&"function"==typeof oe.onPostCommitFiberRoot)try{oe.onPostCommitFiberRoot(re,t)}catch(t){}i=!0}return i}finally{_e=n,Tl.transition=e}}return!1}function Su(t,e,n){t=ko(t,e=pa(0,e=ca(n,e),1),1),e=eu(),null!==t&&(ye(t,1,e),ru(t,e))}function Pu(t,e,n){if(3===t.tag)Su(t,t,n);else for(;null!==e;){if(3===e.tag){Su(e,t,n);break}if(1===e.tag){var i=e.stateNode;if("function"==typeof e.type.getDerivedStateFromError||"function"==typeof i.componentDidCatch&&(null===Xl||!Xl.has(i))){e=ko(e,t=ga(e,t=ca(n,t),1),1),t=eu(),null!==e&&(ye(e,1,t),ru(e,t));break}}e=e.return}}function Cu(t,e,n){var i=t.pingCache;null!==i&&i.delete(e),e=eu(),t.pingedLanes|=t.suspendedLanes&n,Ll===t&&(Ol&n)===n&&(4===kl||3===kl&&(130023424&Ol)===Ol&&500>$t()-Vl?du(t,0):Bl|=n),ru(t,e)}function Iu(t,e){0===e&&(0==(1&t.mode)?e=1:(e=ce,0==(130023424&(ce<<=1))&&(ce=4194304)));var n=eu();null!==(t=Lo(t,e))&&(ye(t,e,n),ru(t,n))}function Tu(t){var e=t.memoizedState,n=0;null!==e&&(n=e.retryLane),Iu(t,n)}function Mu(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(o(314))}null!==i&&i.delete(e),Iu(t,n)}function Lu(t,e){return Xt(t,e)}function Au(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ou(t,e,n,i){return new Au(t,e,n,i)}function Nu(t){return!(!(t=t.prototype)||!t.isReactComponent)}function Ru(t,e){var n=t.alternate;return null===n?((n=Ou(t.tag,e,t.key,t.mode)).elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&t.flags,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ku(t,e,n,i,r,s){var a=2;if(i=t,"function"==typeof t)Nu(t)&&(a=1);else if("string"==typeof t)a=5;else t:switch(t){case E:return Du(n.children,r,s,e);case S:a=8,r|=8;break;case P:return(t=Ou(12,n,e,2|r)).elementType=P,t.lanes=s,t;case M:return(t=Ou(13,n,e,r)).elementType=M,t.lanes=s,t;case L:return(t=Ou(19,n,e,r)).elementType=L,t.lanes=s,t;case N:return Fu(n,r,s,e);default:if("object"==typeof t&&null!==t)switch(t.$$typeof){case C:a=10;break t;case I:a=9;break t;case T:a=11;break t;case A:a=14;break t;case O:a=16,i=null;break t}throw Error(o(130,null==t?t:typeof t,""))}return(e=Ou(a,n,e,r)).elementType=t,e.type=i,e.lanes=s,e}function Du(t,e,n,i){return(t=Ou(7,t,i,e)).lanes=n,t}function Fu(t,e,n,i){return(t=Ou(22,t,i,e)).elementType=N,t.lanes=n,t.stateNode={isHidden:!1},t}function zu(t,e,n){return(t=Ou(6,t,null,e)).lanes=n,t}function Bu(t,e,n){return(e=Ou(4,null!==t.children?t.children:[],t.key,e)).lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ju(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=me(0),this.expirationTimes=me(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=me(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Uu(t,e,n,i,r,o,s,a,l){return t=new ju(t,e,n,a,l),1===e?(e=1,!0===o&&(e|=8)):e=0,o=Ou(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Oo(o),t}function Vu(t){if(!t)return Ir;t:{if(Vt(t=t._reactInternals)!==t||1!==t.tag)throw Error(o(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break t;case 1:if(Or(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break t}}e=e.return}while(null!==e);throw Error(o(171))}if(1===t.tag){var n=t.type;if(Or(n))return kr(t,n,e)}return e}function Gu(t,e,n,i,r,o,s,a,l){return(t=Uu(n,i,!0,t,0,o,0,a,l)).context=Vu(null),n=t.current,(o=Ro(i=eu(),r=nu(n))).callback=null!=e?e:null,ko(n,o,r),t.current.lanes=r,ye(t,r,i),ru(t,i),t}function qu(t,e,n,i){var r=e.current,o=eu(),s=nu(r);return n=Vu(n),null===e.context?e.context=n:e.pendingContext=n,(e=Ro(o,s)).payload={element:t},null!==(i=void 0===i?null:i)&&(e.callback=i),null!==(t=ko(r,e,s))&&(iu(t,r,s,o),Do(t,r,s)),s}function Wu(t){return(t=t.current).child?(t.child.tag,t.child.stateNode):null}function Hu(t,e){if(null!==(t=t.memoizedState)&&null!==t.dehydrated){var n=t.retryLane;t.retryLane=0!==n&&n<e?n:e}}function Xu(t,e){Hu(t,e),(t=t.alternate)&&Hu(t,e)}Sl=function(t,e,n){if(null!==t)if(t.memoizedProps!==e.pendingProps||Mr.current)ba=!0;else{if(0==(t.lanes&n)&&0==(128&e.flags))return ba=!1,function(t,e,n){switch(e.tag){case 3:La(e),po();break;case 5:ss(e);break;case 1:Or(e.type)&&Dr(e);break;case 4:rs(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Cr(vo,i._currentValue),i._currentValue=r;break;case 13:if(null!==(i=e.memoizedState))return null!==i.dehydrated?(Cr(ls,1&ls.current),e.flags|=128,null):0!=(n&e.child.childLanes)?za(t,e,n):(Cr(ls,1&ls.current),null!==(t=Wa(t,e,n))?t.sibling:null);Cr(ls,1&ls.current);break;case 19:if(i=0!=(n&e.childLanes),0!=(128&t.flags)){if(i)return Ga(t,e,n);e.flags|=128}if(null!==(r=e.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),Cr(ls,ls.current),i)break;return null;case 22:case 23:return e.lanes=0,Pa(t,e,n)}return Wa(t,e,n)}(t,e,n);ba=0!=(131072&t.flags)}else ba=!1,ro&&0!=(1048576&e.flags)&&Jr(e,Hr,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;qa(t,e),t=e.pendingProps;var r=Ar(e,Tr.current);Po(e,n),r=Ss(null,e,i,t,r,n);var s=Ps();return e.flags|=1,"object"==typeof r&&null!==r&&"function"==typeof r.render&&void 0===r.$$typeof?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Or(i)?(s=!0,Dr(e)):s=!1,e.memoizedState=null!==r.state&&void 0!==r.state?r.state:null,Oo(e),r.updater=Vo,e.stateNode=r,r._reactInternals=e,Ho(e,i,t,n),e=Ma(null,e,i,!0,s,n)):(e.tag=0,ro&&s&&to(e),xa(null,e,r,n),e=e.child),e;case 16:i=e.elementType;t:{switch(qa(t,e),t=e.pendingProps,i=(r=i._init)(i._payload),e.type=i,r=e.tag=function(t){if("function"==typeof t)return Nu(t)?1:0;if(null!=t){if((t=t.$$typeof)===T)return 11;if(t===A)return 14}return 2}(i),t=yo(i,t),r){case 0:e=Ia(null,e,i,t,n);break t;case 1:e=Ta(null,e,i,t,n);break t;case 11:e=wa(null,e,i,t,n);break t;case 14:e=Ea(null,e,i,yo(i.type,t),n);break t}throw Error(o(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,Ia(t,e,i,r=e.elementType===i?r:yo(i,r),n);case 1:return i=e.type,r=e.pendingProps,Ta(t,e,i,r=e.elementType===i?r:yo(i,r),n);case 3:t:{if(La(e),null===t)throw Error(o(387));i=e.pendingProps,r=(s=e.memoizedState).element,No(t,e),zo(e,i,null,n);var a=e.memoizedState;if(i=a.element,s.isDehydrated){if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,256&e.flags){e=Aa(t,e,i,n,r=ca(Error(o(423)),e));break t}if(i!==r){e=Aa(t,e,i,n,r=ca(Error(o(424)),e));break t}for(io=ur(e.stateNode.containerInfo.firstChild),no=e,ro=!0,oo=null,n=Qo(e,null,i,n),e.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(po(),i===r){e=Wa(t,e,n);break t}xa(t,e,i,n)}e=e.child}return e;case 5:return ss(e),null===t&&uo(e),i=e.type,r=e.pendingProps,s=null!==t?t.memoizedProps:null,a=r.children,nr(i,r)?a=null:null!==s&&nr(i,s)&&(e.flags|=32),Ca(t,e),xa(t,e,a,n),e.child;case 6:return null===t&&uo(e),null;case 13:return za(t,e,n);case 4:return rs(e,e.stateNode.containerInfo),i=e.pendingProps,null===t?e.child=$o(e,null,i,n):xa(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,wa(t,e,i,r=e.elementType===i?r:yo(i,r),n);case 7:return xa(t,e,e.pendingProps,n),e.child;case 8:case 12:return xa(t,e,e.pendingProps.children,n),e.child;case 10:t:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value,Cr(vo,i._currentValue),i._currentValue=a,null!==s)if(ai(s.value,a)){if(s.children===r.children&&!Mr.current){e=Wa(t,e,n);break t}}else for(null!==(s=e.child)&&(s.return=e);null!==s;){var l=s.dependencies;if(null!==l){a=s.child;for(var u=l.firstContext;null!==u;){if(u.context===i){if(1===s.tag){(u=Ro(-1,n&-n)).tag=2;var c=s.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),So(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(10===s.tag)a=s.type===e.type?null:s.child;else if(18===s.tag){if(null===(a=s.return))throw Error(o(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),So(a,n,e),a=s.sibling}else a=s.child;if(null!==a)a.return=s;else for(a=s;null!==a;){if(a===e){a=null;break}if(null!==(s=a.sibling)){s.return=a.return,a=s;break}a=a.return}s=a}xa(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,Po(e,n),i=i(r=Co(r)),e.flags|=1,xa(t,e,i,n),e.child;case 14:return r=yo(i=e.type,e.pendingProps),Ea(t,e,i,r=yo(i.type,r),n);case 15:return Sa(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:yo(i,r),qa(t,e),e.tag=1,Or(i)?(t=!0,Dr(e)):t=!1,Po(e,n),qo(e,i,r),Ho(e,i,r,n),Ma(null,e,i,!0,t,n);case 19:return Ga(t,e,n);case 22:return Pa(t,e,n)}throw Error(o(156,e.tag))};var Yu="function"==typeof reportError?reportError:function(t){console.error(t)};function Zu(t){this._internalRoot=t}function Ku(t){this._internalRoot=t}function $u(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)}function Qu(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Ju(){}function tc(t,e,n,i,r){var o=n._reactRootContainer;if(o){var s=o;if("function"==typeof r){var a=r;r=function(){var t=Wu(s);a.call(t)}}qu(e,s,t,r)}else s=function(t,e,n,i,r){if(r){if("function"==typeof i){var o=i;i=function(){var t=Wu(s);o.call(t)}}var s=Gu(e,i,t,0,null,!1,0,"",Ju);return t._reactRootContainer=s,t[pr]=s.current,Vi(8===t.nodeType?t.parentNode:t),hu(),s}for(;r=t.lastChild;)t.removeChild(r);if("function"==typeof i){var a=i;i=function(){var t=Wu(l);a.call(t)}}var l=Uu(t,0,!1,null,0,!1,0,"",Ju);return t._reactRootContainer=l,t[pr]=l.current,Vi(8===t.nodeType?t.parentNode:t),hu((function(){qu(e,l,n,i)})),l}(n,e,t,r,i);return Wu(s)}Ku.prototype.render=Zu.prototype.render=function(t){var e=this._internalRoot;if(null===e)throw Error(o(409));qu(t,e,null,null)},Ku.prototype.unmount=Zu.prototype.unmount=function(){var t=this._internalRoot;if(null!==t){this._internalRoot=null;var e=t.containerInfo;hu((function(){qu(null,t,null,null)})),e[pr]=null}},Ku.prototype.unstable_scheduleHydration=function(t){if(t){var e=Se();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ne.length&&0!==e&&e<Ne[n].priority;n++);Ne.splice(n,0,t),0===n&&Fe(t)}},xe=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=he(e.pendingLanes);0!==n&&(ve(e,1|n),ru(e,$t()),0==(6&Ml)&&(Gl=$t()+500,Vr()))}break;case 13:hu((function(){var e=Lo(t,1);if(null!==e){var n=eu();iu(e,t,1,n)}})),Xu(t,1)}},we=function(t){if(13===t.tag){var e=Lo(t,134217728);null!==e&&iu(e,t,134217728,eu()),Xu(t,134217728)}},Ee=function(t){if(13===t.tag){var e=nu(t),n=Lo(t,e);null!==n&&iu(n,t,e,eu()),Xu(t,e)}},Se=function(){return _e},Pe=function(t,e){var n=_e;try{return _e=t,e()}finally{_e=n}},wt=function(t,e,n){switch(e){case"input":if(Q(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=xr(i);if(!r)throw Error(o(90));X(i),Q(i,r)}}}break;case"textarea":ot(t,n);break;case"select":null!=(e=n.value)&&nt(t,!!n.multiple,e,!1)}},Tt=cu,Mt=hu;var ec={usingClientEntryPoint:!1,Events:[_r,br,xr,Ct,It,cu]},nc={findFiberByHostInstance:vr,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},ic={bundleType:nc.bundleType,version:nc.version,rendererPackageName:nc.rendererPackageName,rendererConfig:nc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return null===(t=Wt(t))?null:t.stateNode},findFiberByHostInstance:nc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rc.isDisabled&&rc.supportsFiber)try{re=rc.inject(ic),oe=rc}catch(ct){}}e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ec,e.createPortal=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$u(e))throw Error(o(200));return function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}(t,e,null,n)},e.createRoot=function(t,e){if(!$u(t))throw Error(o(299));var n=!1,i="",r=Yu;return null!=e&&(!0===e.unstable_strictMode&&(n=!0),void 0!==e.identifierPrefix&&(i=e.identifierPrefix),void 0!==e.onRecoverableError&&(r=e.onRecoverableError)),e=Uu(t,1,!1,null,0,n,0,i,r),t[pr]=e.current,Vi(8===t.nodeType?t.parentNode:t),new Zu(e)},e.findDOMNode=function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternals;if(void 0===e){if("function"==typeof t.render)throw Error(o(188));throw t=Object.keys(t).join(","),Error(o(268,t))}return null===(t=Wt(e))?null:t.stateNode},e.flushSync=function(t){return hu(t)},e.hydrate=function(t,e,n){if(!Qu(e))throw Error(o(200));return tc(null,t,e,!0,n)},e.hydrateRoot=function(t,e,n){if(!$u(t))throw Error(o(405));var i=null!=n&&n.hydratedSources||null,r=!1,s="",a=Yu;if(null!=n&&(!0===n.unstable_strictMode&&(r=!0),void 0!==n.identifierPrefix&&(s=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),e=Gu(e,null,t,1,null!=n?n:null,r,0,s,a),t[pr]=e.current,Vi(t),i)for(t=0;t<i.length;t++)r=(r=(n=i[t])._getVersion)(n._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new Ku(e)},e.render=function(t,e,n){if(!Qu(e))throw Error(o(200));return tc(null,t,e,!1,n)},e.unmountComponentAtNode=function(t){if(!Qu(t))throw Error(o(40));return!!t._reactRootContainer&&(hu((function(){tc(null,null,t,!1,(function(){t._reactRootContainer=null,t[pr]=null}))})),!0)},e.unstable_batchedUpdates=cu,e.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!Qu(n))throw Error(o(200));if(null==t||void 0===t._reactInternals)throw Error(o(38));return tc(t,e,n,!1,i)},e.version="18.2.0-next-9e3b772b8-20220608"},745:(t,e,n)=>{"use strict";var i=n(3935);e.s=i.createRoot,i.hydrateRoot},3935:(t,e,n)=>{"use strict";!function t(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(t){console.error(t)}}(),t.exports=n(4448)},2408:(t,e)=>{"use strict";var n=Symbol.for("react.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator,p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,m={};function y(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}function v(){}function _(t,e,n){this.props=t,this.context=e,this.refs=m,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(t,e){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")},y.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},v.prototype=y.prototype;var b=_.prototype=new v;b.constructor=_,g(b,y.prototype),b.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,E={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function P(t,e,i){var r,o={},s=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(s=""+e.key),e)w.call(e,r)&&!S.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(1===l)o.children=i;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps)void 0===o[r]&&(o[r]=l[r]);return{$$typeof:n,type:t,key:s,ref:a,props:o,_owner:E.current}}function C(t){return"object"==typeof t&&null!==t&&t.$$typeof===n}var I=/\/+/g;function T(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,(function(t){return e[t]}))}(""+t.key):e.toString(36)}function M(t,e,r,o,s){var a=typeof t;"undefined"!==a&&"boolean"!==a||(t=null);var l=!1;if(null===t)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case n:case i:l=!0}}if(l)return s=s(l=t),t=""===o?"."+T(l,0):o,x(s)?(r="",null!=t&&(r=t.replace(I,"$&/")+"/"),M(s,e,r,"",(function(t){return t}))):null!=s&&(C(s)&&(s=function(t,e){return{$$typeof:n,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(s,r+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(I,"$&/")+"/")+t)),e.push(s)),1;if(l=0,o=""===o?".":o+":",x(t))for(var u=0;u<t.length;u++){var c=o+T(a=t[u],u);l+=M(a,e,r,c,s)}else if(c=function(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=d&&t[d]||t["@@iterator"])?t:null}(t),"function"==typeof c)for(t=c.call(t),u=0;!(a=t.next()).done;)l+=M(a=a.value,e,r,c=o+T(a,u++),s);else if("object"===a)throw e=String(t),Error("Objects are not valid as a React child (found: "+("[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function L(t,e,n){if(null==t)return t;var i=[],r=0;return M(t,i,"","",(function(t){return e.call(n,t,r++)})),i}function A(t){if(-1===t._status){var e=t._result;(e=e()).then((function(e){0!==t._status&&-1!==t._status||(t._status=1,t._result=e)}),(function(e){0!==t._status&&-1!==t._status||(t._status=2,t._result=e)})),-1===t._status&&(t._status=0,t._result=e)}if(1===t._status)return t._result.default;throw t._result}var O={current:null},N={transition:null},R={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:N,ReactCurrentOwner:E};e.Children={map:L,forEach:function(t,e,n){L(t,(function(){e.apply(this,arguments)}),n)},count:function(t){var e=0;return L(t,(function(){e++})),e},toArray:function(t){return L(t,(function(t){return t}))||[]},only:function(t){if(!C(t))throw Error("React.Children.only expected to receive a single React element child.");return t}},e.Component=y,e.Fragment=r,e.Profiler=s,e.PureComponent=_,e.StrictMode=o,e.Suspense=c,e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,e.cloneElement=function(t,e,i){if(null==t)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=g({},t.props),o=t.key,s=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(s=e.ref,a=E.current),void 0!==e.key&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)w.call(e,u)&&!S.hasOwnProperty(u)&&(r[u]=void 0===e[u]&&void 0!==l?l[u]:e[u])}var u=arguments.length-2;if(1===u)r.children=i;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:n,type:t.type,key:o,ref:s,props:r,_owner:a}},e.createContext=function(t){return(t={$$typeof:l,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:t},t.Consumer=t},e.createElement=P,e.createFactory=function(t){var e=P.bind(null,t);return e.type=t,e},e.createRef=function(){return{current:null}},e.forwardRef=function(t){return{$$typeof:u,render:t}},e.isValidElement=C,e.lazy=function(t){return{$$typeof:f,_payload:{_status:-1,_result:t},_init:A}},e.memo=function(t,e){return{$$typeof:h,type:t,compare:void 0===e?null:e}},e.startTransition=function(t){var e=N.transition;N.transition={};try{t()}finally{N.transition=e}},e.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},e.useCallback=function(t,e){return O.current.useCallback(t,e)},e.useContext=function(t){return O.current.useContext(t)},e.useDebugValue=function(){},e.useDeferredValue=function(t){return O.current.useDeferredValue(t)},e.useEffect=function(t,e){return O.current.useEffect(t,e)},e.useId=function(){return O.current.useId()},e.useImperativeHandle=function(t,e,n){return O.current.useImperativeHandle(t,e,n)},e.useInsertionEffect=function(t,e){return O.current.useInsertionEffect(t,e)},e.useLayoutEffect=function(t,e){return O.current.useLayoutEffect(t,e)},e.useMemo=function(t,e){return O.current.useMemo(t,e)},e.useReducer=function(t,e,n){return O.current.useReducer(t,e,n)},e.useRef=function(t){return O.current.useRef(t)},e.useState=function(t){return O.current.useState(t)},e.useSyncExternalStore=function(t,e,n){return O.current.useSyncExternalStore(t,e,n)},e.useTransition=function(){return O.current.useTransition()},e.version="18.2.0"},7294:(t,e,n)=>{"use strict";t.exports=n(2408)},3697:(t,e,n)=>{"use strict";var i=n(5972).functionsHaveConfigurableNames(),r=Object,o=TypeError;t.exports=function(){if(null!=this&&this!==r(this))throw new o("RegExp.prototype.flags getter called on non-object");var t="";return this.hasIndices&&(t+="d"),this.global&&(t+="g"),this.ignoreCase&&(t+="i"),this.multiline&&(t+="m"),this.dotAll&&(t+="s"),this.unicode&&(t+="u"),this.sticky&&(t+="y"),t},i&&Object.defineProperty&&Object.defineProperty(t.exports,"name",{value:"get flags"})},2847:(t,e,n)=>{"use strict";var i=n(4289),r=n(5559),o=n(3697),s=n(1721),a=n(2753),l=r(s());i(l,{getPolyfill:s,implementation:o,shim:a}),t.exports=l},1721:(t,e,n)=>{"use strict";var i=n(3697),r=n(4289).supportsDescriptors,o=Object.getOwnPropertyDescriptor;t.exports=function(){if(r&&"gim"===/a/gim.flags){var t=o(RegExp.prototype,"flags");if(t&&"function"==typeof t.get&&"boolean"==typeof RegExp.prototype.dotAll&&"boolean"==typeof RegExp.prototype.hasIndices){var e="",n={};if(Object.defineProperty(n,"hasIndices",{get:function(){e+="d"}}),Object.defineProperty(n,"sticky",{get:function(){e+="y"}}),"dy"===e)return t.get}}return i}},2753:(t,e,n)=>{"use strict";var i=n(4289).supportsDescriptors,r=n(1721),o=Object.getOwnPropertyDescriptor,s=Object.defineProperty,a=TypeError,l=Object.getPrototypeOf,u=/a/;t.exports=function(){if(!i||!l)throw new a("RegExp.prototype.flags requires a true ES5 environment that supports property descriptors");var t=r(),e=l(u),n=o(e,"flags");return n&&n.get===t||s(e,"flags",{configurable:!0,enumerable:!1,get:t}),t}},8639:function(t,e){!function(t){"use strict";const e=134217729;function n(t,e,n,i,r){let o,s,a,l,u=e[0],c=i[0],h=0,f=0;c>u==c>-u?(o=u,u=e[++h]):(o=c,c=i[++f]);let d=0;if(h<t&&f<n)for(c>u==c>-u?(a=o-((s=u+o)-u),u=e[++h]):(a=o-((s=c+o)-c),c=i[++f]),o=s,0!==a&&(r[d++]=a);h<t&&f<n;)c>u==c>-u?(a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++h]):(a=o-((s=o+c)-(l=s-o))+(c-l),c=i[++f]),o=s,0!==a&&(r[d++]=a);for(;h<t;)a=o-((s=o+u)-(l=s-o))+(u-l),u=e[++h],o=s,0!==a&&(r[d++]=a);for(;f<n;)a=o-((s=o+c)-(l=s-o))+(c-l),c=i[++f],o=s,0!==a&&(r[d++]=a);return 0===o&&0!==d||(r[d++]=o),d}function i(t){return new Float64Array(t)}const r=i(4),o=i(8),s=i(12),a=i(16),l=i(4);t.orient2d=function(t,i,u,c,h,f){const d=(i-f)*(u-h),p=(t-h)*(c-f),g=d-p;if(0===d||0===p||d>0!=p>0)return g;const m=Math.abs(d+p);return Math.abs(g)>=33306690738754716e-32*m?g:-function(t,i,u,c,h,f,d){let p,g,m,y,v,_,b,x,w,E,S,P,C,I,T,M,L,A;const O=t-h,N=u-h,R=i-f,k=c-f;v=(T=(x=O-(b=(_=e*O)-(_-O)))*(E=k-(w=(_=e*k)-(_-k)))-((I=O*k)-b*w-x*w-b*E))-(S=T-(L=(x=R-(b=(_=e*R)-(_-R)))*(E=N-(w=(_=e*N)-(_-N)))-((M=R*N)-b*w-x*w-b*E))),r[0]=T-(S+v)+(v-L),v=(C=I-((P=I+S)-(v=P-I))+(S-v))-(S=C-M),r[1]=C-(S+v)+(v-M),v=(A=P+S)-P,r[2]=P-(A-v)+(S-v),r[3]=A;let D=function(t,e){let n=e[0];for(let t=1;t<4;t++)n+=e[t];return n}(0,r),F=22204460492503146e-32*d;if(D>=F||-D>=F)return D;if(p=t-(O+(v=t-O))+(v-h),m=u-(N+(v=u-N))+(v-h),g=i-(R+(v=i-R))+(v-f),y=c-(k+(v=c-k))+(v-f),0===p&&0===g&&0===m&&0===y)return D;if(F=11093356479670487e-47*d+33306690738754706e-32*Math.abs(D),(D+=O*y+k*p-(R*m+N*g))>=F||-D>=F)return D;v=(T=(x=p-(b=(_=e*p)-(_-p)))*(E=k-(w=(_=e*k)-(_-k)))-((I=p*k)-b*w-x*w-b*E))-(S=T-(L=(x=g-(b=(_=e*g)-(_-g)))*(E=N-(w=(_=e*N)-(_-N)))-((M=g*N)-b*w-x*w-b*E))),l[0]=T-(S+v)+(v-L),v=(C=I-((P=I+S)-(v=P-I))+(S-v))-(S=C-M),l[1]=C-(S+v)+(v-M),v=(A=P+S)-P,l[2]=P-(A-v)+(S-v),l[3]=A;const z=n(4,r,4,l,o);v=(T=(x=O-(b=(_=e*O)-(_-O)))*(E=y-(w=(_=e*y)-(_-y)))-((I=O*y)-b*w-x*w-b*E))-(S=T-(L=(x=R-(b=(_=e*R)-(_-R)))*(E=m-(w=(_=e*m)-(_-m)))-((M=R*m)-b*w-x*w-b*E))),l[0]=T-(S+v)+(v-L),v=(C=I-((P=I+S)-(v=P-I))+(S-v))-(S=C-M),l[1]=C-(S+v)+(v-M),v=(A=P+S)-P,l[2]=P-(A-v)+(S-v),l[3]=A;const B=n(z,o,4,l,s);v=(T=(x=p-(b=(_=e*p)-(_-p)))*(E=y-(w=(_=e*y)-(_-y)))-((I=p*y)-b*w-x*w-b*E))-(S=T-(L=(x=g-(b=(_=e*g)-(_-g)))*(E=m-(w=(_=e*m)-(_-m)))-((M=g*m)-b*w-x*w-b*E))),l[0]=T-(S+v)+(v-L),v=(C=I-((P=I+S)-(v=P-I))+(S-v))-(S=C-M),l[1]=C-(S+v)+(v-M),v=(A=P+S)-P,l[2]=P-(A-v)+(S-v),l[3]=A;const j=n(B,s,4,l,a);return a[j-1]}(t,i,u,c,h,f,m)},t.orient2dfast=function(t,e,n,i,r,o){return(e-o)*(n-r)-(t-r)*(i-o)},Object.defineProperty(t,"__esModule",{value:!0})}(e)},53:(t,e)=>{"use strict";function n(t,e){var n=t.length;t.push(e);t:for(;0<n;){var i=n-1>>>1,r=t[i];if(!(0<o(r,e)))break t;t[i]=e,t[n]=r,n=i}}function i(t){return 0===t.length?null:t[0]}function r(t){if(0===t.length)return null;var e=t[0],n=t.pop();if(n!==e){t[0]=n;t:for(var i=0,r=t.length,s=r>>>1;i<s;){var a=2*(i+1)-1,l=t[a],u=a+1,c=t[u];if(0>o(l,n))u<r&&0>o(c,l)?(t[i]=c,t[u]=n,i=u):(t[i]=l,t[a]=n,i=a);else{if(!(u<r&&0>o(c,n)))break t;t[i]=c,t[u]=n,i=u}}}return e}function o(t,e){var n=t.sortIndex-e.sortIndex;return 0!==n?n:t.id-e.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,l=a.now();e.unstable_now=function(){return a.now()-l}}var u=[],c=[],h=1,f=null,d=3,p=!1,g=!1,m=!1,y="function"==typeof setTimeout?setTimeout:null,v="function"==typeof clearTimeout?clearTimeout:null,_="undefined"!=typeof setImmediate?setImmediate:null;function b(t){for(var e=i(c);null!==e;){if(null===e.callback)r(c);else{if(!(e.startTime<=t))break;r(c),e.sortIndex=e.expirationTime,n(u,e)}e=i(c)}}function x(t){if(m=!1,b(t),!g)if(null!==i(u))g=!0,N(w);else{var e=i(c);null!==e&&R(x,e.startTime-t)}}function w(t,n){g=!1,m&&(m=!1,v(C),C=-1),p=!0;var o=d;try{for(b(n),f=i(u);null!==f&&(!(f.expirationTime>n)||t&&!M());){var s=f.callback;if("function"==typeof s){f.callback=null,d=f.priorityLevel;var a=s(f.expirationTime<=n);n=e.unstable_now(),"function"==typeof a?f.callback=a:f===i(u)&&r(u),b(n)}else r(u);f=i(u)}if(null!==f)var l=!0;else{var h=i(c);null!==h&&R(x,h.startTime-n),l=!1}return l}finally{f=null,d=o,p=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,P=null,C=-1,I=5,T=-1;function M(){return!(e.unstable_now()-T<I)}function L(){if(null!==P){var t=e.unstable_now();T=t;var n=!0;try{n=P(!0,t)}finally{n?E():(S=!1,P=null)}}else S=!1}if("function"==typeof _)E=function(){_(L)};else if("undefined"!=typeof MessageChannel){var A=new MessageChannel,O=A.port2;A.port1.onmessage=L,E=function(){O.postMessage(null)}}else E=function(){y(L,0)};function N(t){P=t,S||(S=!0,E())}function R(t,n){C=y((function(){t(e.unstable_now())}),n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(t){t.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,N(w))},e.unstable_forceFrameRate=function(t){0>t||125<t?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<t?Math.floor(1e3/t):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_getFirstCallbackNode=function(){return i(u)},e.unstable_next=function(t){switch(d){case 1:case 2:case 3:var e=3;break;default:e=d}var n=d;d=e;try{return t()}finally{d=n}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(t,e){switch(t){case 1:case 2:case 3:case 4:case 5:break;default:t=3}var n=d;d=t;try{return e()}finally{d=n}},e.unstable_scheduleCallback=function(t,r,o){var s=e.unstable_now();switch(o="object"==typeof o&&null!==o&&"number"==typeof(o=o.delay)&&0<o?s+o:s,t){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return t={id:h++,callback:r,priorityLevel:t,startTime:o,expirationTime:a=o+a,sortIndex:-1},o>s?(t.sortIndex=o,n(c,t),null===i(u)&&t===i(c)&&(m?(v(C),C=-1):m=!0,R(x,o-s))):(t.sortIndex=a,n(u,t),g||p||(g=!0,N(w))),t},e.unstable_shouldYield=M,e.unstable_wrapCallback=function(t){var e=d;return function(){var n=d;d=e;try{return t.apply(this,arguments)}finally{d=n}}}},3840:(t,e,n)=>{"use strict";t.exports=n(53)},5697:t=>{"use strict";t.exports={eudist:function(t,e,n){for(var i=t.length,r=0,o=0;o<i;o++){var s=(t[o]||0)-(e[o]||0);r+=s*s}return n?Math.sqrt(r):r},mandist:function(t,e,n){for(var i=t.length,r=0,o=0;o<i;o++)r+=Math.abs((t[o]||0)-(e[o]||0));return n?Math.sqrt(r):r},dist:function(t,e,n){var i=Math.abs(t-e);return n?i:i*i}}},7035:(t,e,n)=>{"use strict";var i=n(5697),r=i.eudist,o=i.dist;t.exports={kmrand:function(t,e){for(var n={},i=[],r=e<<2,o=t.length,s=t[0].length>0;i.length<e&&r-- >0;){var a=t[Math.floor(Math.random()*o)],l=s?a.join("_"):""+a;n[l]||(n[l]=!0,i.push(a))}if(i.length<e)throw new Error("Error initializating clusters");return i},kmpp:function(t,e){var n=t[0].length?r:o,i=[],s=t.length,a=t[0].length>0,l=t[Math.floor(Math.random()*s)];for(a&&l.join("_"),i.push(l);i.length<e;){for(var u=[],c=i.length,h=0,f=[],d=0;d<s;d++){for(var p=1/0,g=0;g<c;g++){var m=n(t[d],i[g]);m<=p&&(p=m)}u[d]=p}for(var y=0;y<s;y++)h+=u[y];for(var v=0;v<s;v++)f[v]={i:v,v:t[v],pr:u[v]/h,cs:0};f.sort((function(t,e){return t.pr-e.pr})),f[0].cs=f[0].pr;for(var _=1;_<s;_++)f[_].cs=f[_-1].cs+f[_].pr;for(var b=Math.random(),x=0;x<s-1&&f[x++].cs<b;);i.push(f[x-1].v)}return i}}},1160:(t,e,n)=>{"use strict";var i=n(5697),r=n(7035),o=i.eudist,s=(i.mandist,i.dist,r.kmrand),a=r.kmpp;function l(t,e,n){n=n||[];for(var i=0;i<t;i++)n[i]=e;return n}t.exports=function(t,e,n,i){var r=[],u=[],c=[],h=[],f=!1,d=i||1e4,p=t.length,g=t[0].length,m=g>0,y=[];if(n)r="kmrand"==n?s(t,e):"kmpp"==n?a(t,e):n;else for(var v={};r.length<e;){var _=Math.floor(Math.random()*p);v[_]||(v[_]=!0,r.push(t[_]))}do{l(e,0,y);for(var b=0;b<p;b++){for(var x=1/0,w=0,E=0;E<e;E++)(h=m?o(t[b],r[E]):Math.abs(t[b]-r[E]))<=x&&(x=h,w=E);c[b]=w,y[w]++}for(var S=[],P=(u=[],0);P<e;P++)S[P]=m?l(g,0,S[P]):0,u[P]=r[P];if(m){for(var C=0;C<e;C++)r[C]=[];for(var I=0;I<p;I++)for(var T=S[c[I]],M=t[I],L=0;L<g;L++)T[L]+=M[L];f=!0;for(var A=0;A<e;A++){for(var O=r[A],N=S[A],R=u[A],k=y[A],D=0;D<g;D++)O[D]=N[D]/k||0;if(f)for(var F=0;F<g;F++)if(R[F]!=O[F]){f=!1;break}}}else{for(var z=0;z<p;z++)S[c[z]]+=t[z];for(var B=0;B<e;B++)r[B]=S[B]/y[B]||0;f=!0;for(var j=0;j<e;j++)if(u[j]!=r[j]){f=!1;break}}f=f||--d<=0}while(!f);return{it:1e4-d,k:e,idxs:c,centroids:r}}},3842:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});class i{constructor(t=[],e=r){if(this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(let t=(this.length>>1)-1;t>=0;t--)this._down(t)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:e,compare:n}=this,i=e[t];for(;t>0;){const r=t-1>>1,o=e[r];if(n(i,o)>=0)break;e[t]=o,t=r}e[t]=i}_down(t){const{data:e,compare:n}=this,i=this.length>>1,r=e[t];for(;t<i;){let i=1+(t<<1),o=e[i];const s=i+1;if(s<this.length&&n(e[s],o)<0&&(i=s,o=e[s]),n(o,r)>=0)break;e[t]=o,t=i}e[t]=r}}function r(t,e){return t<e?-1:t>e?1:0}},675:function(t,e){!function(t){"use strict";function e(){}function n(t){this.message=t||""}function i(t){this.message=t||""}function r(t){this.message=t||""}function o(){}function s(t){return null===t?Rt:t.color}function a(t){return null===t?null:t.parent}function l(t,e){null!==t&&(t.color=e)}function u(t){return null===t?null:t.left}function c(t){return null===t?null:t.right}function h(){this.root_=null,this.size_=0}function f(){}function d(){this.array_=[],arguments[0]instanceof bt&&this.addAll(arguments[0])}function p(){}function g(t){this.message=t||""}function m(){this.array_=[]}"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(t){if(null==this)throw new TypeError(this+" is not an object");var e=Object(this),n=Math.max(Math.min(e.length,9007199254740991),0)||0,i=1 in arguments&&parseInt(Number(arguments[1]),10)||0;i=i<0?Math.max(n+i,0):Math.min(i,n);var r=2 in arguments&&void 0!==arguments[2]?parseInt(Number(arguments[2]),10)||0:n;for(r=r<0?Math.max(n+arguments[2],0):Math.min(r,n);i<r;)e[i]=t,++i;return e},writable:!0}),Number.isFinite=Number.isFinite||function(t){return"number"==typeof t&&isFinite(t)},Number.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},Number.parseFloat=Number.parseFloat||parseFloat,Number.isNaN=Number.isNaN||function(t){return t!=t},Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var y=function(){};y.prototype.interfaces_=function(){return[]},y.prototype.getClass=function(){return y},y.prototype.equalsWithTolerance=function(t,e,n){return Math.abs(t-e)<=n};var v=function(t){function e(e){t.call(this,e),this.name="IllegalArgumentException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),_=function(){},b={MAX_VALUE:{configurable:!0}};_.isNaN=function(t){return Number.isNaN(t)},_.doubleToLongBits=function(t){return t},_.longBitsToDouble=function(t){return t},_.isInfinite=function(t){return!Number.isFinite(t)},b.MAX_VALUE.get=function(){return Number.MAX_VALUE},Object.defineProperties(_,b);var x=function(){},w=function(){},E=function(){},S=function t(){if(this.x=null,this.y=null,this.z=null,0===arguments.length)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else 2===arguments.length?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):3===arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},P={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};S.prototype.setOrdinate=function(t,e){switch(t){case S.X:this.x=e;break;case S.Y:this.y=e;break;case S.Z:this.z=e;break;default:throw new v("Invalid ordinate index: "+t)}},S.prototype.equals2D=function(){if(1===arguments.length){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!y.equalsWithTolerance(this.x,e.x,n)&&!!y.equalsWithTolerance(this.y,e.y,n)}},S.prototype.getOrdinate=function(t){switch(t){case S.X:return this.x;case S.Y:return this.y;case S.Z:return this.z}throw new v("Invalid ordinate index: "+t)},S.prototype.equals3D=function(t){return this.x===t.x&&this.y===t.y&&(this.z===t.z||_.isNaN(this.z))&&_.isNaN(t.z)},S.prototype.equals=function(t){return t instanceof S&&this.equals2D(t)},S.prototype.equalInZ=function(t,e){return y.equalsWithTolerance(this.z,t.z,e)},S.prototype.compareTo=function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0},S.prototype.clone=function(){},S.prototype.copy=function(){return new S(this)},S.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},S.prototype.distance3D=function(t){var e=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return Math.sqrt(e*e+n*n+i*i)},S.prototype.distance=function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)},S.prototype.hashCode=function(){var t=17;return 37*(t=37*t+S.hashCode(this.x))+S.hashCode(this.y)},S.prototype.setCoordinate=function(t){this.x=t.x,this.y=t.y,this.z=t.z},S.prototype.interfaces_=function(){return[x,w,e]},S.prototype.getClass=function(){return S},S.hashCode=function(){if(1===arguments.length){var t=arguments[0],e=_.doubleToLongBits(t);return Math.trunc((e^e)>>>32)}},P.DimensionalComparator.get=function(){return C},P.serialVersionUID.get=function(){return 0x5cbf2c235c7e5800},P.NULL_ORDINATE.get=function(){return _.NaN},P.X.get=function(){return 0},P.Y.get=function(){return 1},P.Z.get=function(){return 2},Object.defineProperties(S,P);var C=function(t){if(this._dimensionsToTest=2,0===arguments.length);else if(1===arguments.length){var e=arguments[0];if(2!==e&&3!==e)throw new v("only 2 or 3 dimensions may be specified");this._dimensionsToTest=e}};C.prototype.compare=function(t,e){var n=t,i=e,r=C.compare(n.x,i.x);if(0!==r)return r;var o=C.compare(n.y,i.y);return 0!==o?o:this._dimensionsToTest<=2?0:C.compare(n.z,i.z)},C.prototype.interfaces_=function(){return[E]},C.prototype.getClass=function(){return C},C.compare=function(t,e){return t<e?-1:t>e?1:_.isNaN(t)?_.isNaN(e)?0:-1:_.isNaN(e)?1:0};var I=function(){};I.prototype.create=function(){},I.prototype.interfaces_=function(){return[]},I.prototype.getClass=function(){return I};var T=function(){},M={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};T.prototype.interfaces_=function(){return[]},T.prototype.getClass=function(){return T},T.toLocationSymbol=function(t){switch(t){case T.EXTERIOR:return"e";case T.BOUNDARY:return"b";case T.INTERIOR:return"i";case T.NONE:return"-"}throw new v("Unknown location value: "+t)},M.INTERIOR.get=function(){return 0},M.BOUNDARY.get=function(){return 1},M.EXTERIOR.get=function(){return 2},M.NONE.get=function(){return-1},Object.defineProperties(T,M);var L=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},A=function(){},O={LOG_10:{configurable:!0}};A.prototype.interfaces_=function(){return[]},A.prototype.getClass=function(){return A},A.log10=function(t){var e=Math.log(t);return _.isInfinite(e)||_.isNaN(e)?e:e/A.LOG_10},A.min=function(t,e,n,i){var r=t;return e<r&&(r=e),n<r&&(r=n),i<r&&(r=i),r},A.clamp=function(){if("number"==typeof arguments[2]&&"number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],r=arguments[1],o=arguments[2];return i<r?r:i>o?o:i}},A.wrap=function(t,e){return t<0?e- -t%e:t%e},A.max=function(){if(3===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[0];return t>n&&(n=t),e>n&&(n=e),n}if(4===arguments.length){var i=arguments[1],r=arguments[2],o=arguments[3],s=arguments[0];return i>s&&(s=i),r>s&&(s=r),o>s&&(s=o),s}},A.average=function(t,e){return(t+e)/2},O.LOG_10.get=function(){return Math.log(10)},Object.defineProperties(A,O);var N=function(t){this.str=t};N.prototype.append=function(t){this.str+=t},N.prototype.setCharAt=function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)},N.prototype.toString=function(t){return this.str};var R=function(t){this.value=t};R.prototype.intValue=function(){return this.value},R.prototype.compareTo=function(t){return this.value<t?-1:this.value>t?1:0},R.isNaN=function(t){return Number.isNaN(t)};var k=function(){};k.isWhitespace=function(t){return t<=32&&t>=0||127===t},k.toUpperCase=function(t){return t.toUpperCase()};var D=function t(){if(this._hi=0,this._lo=0,0===arguments.length)this.init(0);else if(1===arguments.length)if("number"==typeof arguments[0]){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else"string"==typeof arguments[0]&&t.call(this,t.parse(arguments[0]));else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i,r)}},F={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};D.prototype.le=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<=t._lo},D.prototype.extractSignificantDigits=function(t,e){var n=this.abs(),i=D.magnitude(n._hi),r=D.TEN.pow(i);(n=n.divide(r)).gt(D.TEN)?(n=n.divide(D.TEN),i+=1):n.lt(D.ONE)&&(n=n.multiply(D.TEN),i-=1);for(var o=i+1,s=new N,a=D.MAX_PRINT_DIGITS-1,l=0;l<=a;l++){t&&l===o&&s.append(".");var u=Math.trunc(n._hi);if(u<0)break;var c=!1,h=0;u>9?(c=!0,h="9"):h="0"+u,s.append(h),n=n.subtract(D.valueOf(u)).multiply(D.TEN),c&&n.selfAdd(D.TEN);var f=!0,d=D.magnitude(n._hi);if(d<0&&Math.abs(d)>=a-l&&(f=!1),!f)break}return e[0]=i,s.toString()},D.prototype.sqr=function(){return this.multiply(this)},D.prototype.doubleValue=function(){return this._hi+this._lo},D.prototype.subtract=function(){if(arguments[0]instanceof D){var t=arguments[0];return this.add(t.negate())}if("number"==typeof arguments[0]){var e=arguments[0];return this.add(-e)}},D.prototype.equals=function(){if(1===arguments.length){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}},D.prototype.isZero=function(){return 0===this._hi&&0===this._lo},D.prototype.selfSubtract=function(){if(arguments[0]instanceof D){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}},D.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null},D.prototype.min=function(t){return this.le(t)?this:t},D.prototype.selfDivide=function(){if(1===arguments.length){if(arguments[0]instanceof D){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfDivide(e,0)}}else if(2===arguments.length){var n,i,r,o,s=arguments[0],a=arguments[1],l=null,u=null,c=null,h=null;return r=this._hi/s,h=(l=(c=D.SPLIT*r)-(l=c-r))*(u=(h=D.SPLIT*s)-(u=h-s))-(o=r*s)+l*(i=s-u)+(n=r-l)*u+n*i,h=r+(c=(this._hi-o-h+this._lo-r*a)/s),this._hi=h,this._lo=r-h+c,this}},D.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"},D.prototype.divide=function(){if(arguments[0]instanceof D){var t,e,n,i,r=arguments[0],o=null,s=null,a=null,l=null;return t=(n=this._hi/r._hi)-(o=(a=D.SPLIT*n)-(o=a-n)),l=o*(s=(l=D.SPLIT*r._hi)-(s=l-r._hi))-(i=n*r._hi)+o*(e=r._hi-s)+t*s+t*e,a=(this._hi-i-l+this._lo-n*r._lo)/r._hi,new D(l=n+a,n-l+a)}if("number"==typeof arguments[0]){var u=arguments[0];return _.isNaN(u)?D.createNaN():D.copy(this).selfDivide(u,0)}},D.prototype.ge=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>=t._lo},D.prototype.pow=function(t){if(0===t)return D.valueOf(1);var e=new D(this),n=D.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n},D.prototype.ceil=function(){if(this.isNaN())return D.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new D(t,e)},D.prototype.compareTo=function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0},D.prototype.rint=function(){return this.isNaN()?this:this.add(.5).floor()},D.prototype.setValue=function(){if(arguments[0]instanceof D){var t=arguments[0];return this.init(t),this}if("number"==typeof arguments[0]){var e=arguments[0];return this.init(e),this}},D.prototype.max=function(t){return this.ge(t)?this:t},D.prototype.sqrt=function(){if(this.isZero())return D.valueOf(0);if(this.isNegative())return D.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=D.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)},D.prototype.selfAdd=function(){if(1===arguments.length){if(arguments[0]instanceof D){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if("number"==typeof arguments[0]){var e,n,i,r,o,s=arguments[0],a=null;return a=(i=this._hi+s)-(r=i-this._hi),n=(o=(a=s-r+(this._hi-a))+this._lo)+(i-(e=i+o)),this._hi=e+n,this._lo=n+(e-this._hi),this}}else if(2===arguments.length){var l,u,c,h,f=arguments[0],d=arguments[1],p=null,g=null,m=null;c=this._hi+f,u=this._lo+d,g=c-(m=c-this._hi),p=u-(h=u-this._lo);var y=(l=c+(m=(g=f-m+(this._hi-g))+u))+(m=(p=d-h+(this._lo-p))+(m+(c-l))),v=m+(l-y);return this._hi=y,this._lo=v,this}},D.prototype.selfMultiply=function(){if(1===arguments.length){if(arguments[0]instanceof D){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if("number"==typeof arguments[0]){var e=arguments[0];return this.selfMultiply(e,0)}}else if(2===arguments.length){var n,i,r=arguments[0],o=arguments[1],s=null,a=null,l=null,u=null;s=(l=D.SPLIT*this._hi)-this._hi,u=D.SPLIT*r,s=l-s,n=this._hi-s,a=u-r;var c=(l=this._hi*r)+(u=s*(a=u-a)-l+s*(i=r-a)+n*a+n*i+(this._hi*o+this._lo*r)),h=u+(s=l-c);return this._hi=c,this._lo=h,this}},D.prototype.selfSqr=function(){return this.selfMultiply(this)},D.prototype.floor=function(){if(this.isNaN())return D.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new D(t,e)},D.prototype.negate=function(){return this.isNaN()?this:new D(-this._hi,-this._lo)},D.prototype.clone=function(){},D.prototype.multiply=function(){if(arguments[0]instanceof D){var t=arguments[0];return t.isNaN()?D.createNaN():D.copy(this).selfMultiply(t)}if("number"==typeof arguments[0]){var e=arguments[0];return _.isNaN(e)?D.createNaN():D.copy(this).selfMultiply(e,0)}},D.prototype.isNaN=function(){return _.isNaN(this._hi)},D.prototype.intValue=function(){return Math.trunc(this._hi)},D.prototype.toString=function(){var t=D.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()},D.prototype.toStandardNotation=function(){var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,r=n;if("."===n.charAt(0))r="0"+n;else if(i<0)r="0."+D.stringOfChar("0",-i)+n;else if(-1===n.indexOf(".")){var o=i-n.length;r=n+D.stringOfChar("0",o)+".0"}return this.isNegative()?"-"+r:r},D.prototype.reciprocal=function(){var t,e,n,i,r=null,o=null,s=null,a=null;t=(n=1/this._hi)-(r=(s=D.SPLIT*n)-(r=s-n)),o=(a=D.SPLIT*this._hi)-this._hi;var l=n+(s=(1-(i=n*this._hi)-(a=r*(o=a-o)-i+r*(e=this._hi-o)+t*o+t*e)-n*this._lo)/this._hi);return new D(l,n-l+s)},D.prototype.toSciNotation=function(){if(this.isZero())return D.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(null!==t)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=D.SCI_NOT_EXPONENT_CHAR+e[0];if("0"===n.charAt(0))throw new Error("Found leading zero: "+n);var r="";n.length>1&&(r=n.substring(1));var o=n.charAt(0)+"."+r;return this.isNegative()?"-"+o+i:o+i},D.prototype.abs=function(){return this.isNaN()?D.NaN:this.isNegative()?this.negate():new D(this)},D.prototype.isPositive=function(){return(this._hi>0||0===this._hi)&&this._lo>0},D.prototype.lt=function(t){return(this._hi<t._hi||this._hi===t._hi)&&this._lo<t._lo},D.prototype.add=function(){if(arguments[0]instanceof D){var t=arguments[0];return D.copy(this).selfAdd(t)}if("number"==typeof arguments[0]){var e=arguments[0];return D.copy(this).selfAdd(e)}},D.prototype.init=function(){if(1===arguments.length){if("number"==typeof arguments[0]){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof D){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}},D.prototype.gt=function(t){return(this._hi>t._hi||this._hi===t._hi)&&this._lo>t._lo},D.prototype.isNegative=function(){return(this._hi<0||0===this._hi)&&this._lo<0},D.prototype.trunc=function(){return this.isNaN()?D.NaN:this.isPositive()?this.floor():this.ceil()},D.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0},D.prototype.interfaces_=function(){return[e,x,w]},D.prototype.getClass=function(){return D},D.sqr=function(t){return D.valueOf(t).selfMultiply(t)},D.valueOf=function(){if("string"==typeof arguments[0]){var t=arguments[0];return D.parse(t)}if("number"==typeof arguments[0])return new D(arguments[0])},D.sqrt=function(t){return D.valueOf(t).sqrt()},D.parse=function(t){for(var e=0,n=t.length;k.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var r=t.charAt(e);"-"!==r&&"+"!==r||(e++,"-"===r&&(i=!0))}for(var o=new D,s=0,a=0,l=0;!(e>=n);){var u=t.charAt(e);if(e++,k.isDigit(u)){var c=u-"0";o.selfMultiply(D.TEN),o.selfAdd(c),s++}else{if("."!==u){if("e"===u||"E"===u){var h=t.substring(e);try{l=R.parseInt(h)}catch(e){throw e instanceof Error?new Error("Invalid exponent "+h+" in string "+t):e}break}throw new Error("Unexpected character '"+u+"' at position "+e+" in string "+t)}a=s}}var f=o,d=s-a-l;if(0===d)f=o;else if(d>0){var p=D.TEN.pow(d);f=o.divide(p)}else if(d<0){var g=D.TEN.pow(-d);f=o.multiply(g)}return i?f.negate():f},D.createNaN=function(){return new D(_.NaN,_.NaN)},D.copy=function(t){return new D(t)},D.magnitude=function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i},D.stringOfChar=function(t,e){for(var n=new N,i=0;i<e;i++)n.append(t);return n.toString()},F.PI.get=function(){return new D(3.141592653589793,12246467991473532e-32)},F.TWO_PI.get=function(){return new D(6.283185307179586,24492935982947064e-32)},F.PI_2.get=function(){return new D(1.5707963267948966,6123233995736766e-32)},F.E.get=function(){return new D(2.718281828459045,14456468917292502e-32)},F.NaN.get=function(){return new D(_.NaN,_.NaN)},F.EPS.get=function(){return 123259516440783e-46},F.SPLIT.get=function(){return 134217729},F.MAX_PRINT_DIGITS.get=function(){return 32},F.TEN.get=function(){return D.valueOf(10)},F.ONE.get=function(){return D.valueOf(1)},F.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"},F.SCI_NOT_ZERO.get=function(){return"0.0E0"},Object.defineProperties(D,F);var z=function(){},B={DP_SAFE_EPSILON:{configurable:!0}};z.prototype.interfaces_=function(){return[]},z.prototype.getClass=function(){return z},z.orientationIndex=function(t,e,n){var i=z.orientationIndexFilter(t,e,n);if(i<=1)return i;var r=D.valueOf(e.x).selfAdd(-t.x),o=D.valueOf(e.y).selfAdd(-t.y),s=D.valueOf(n.x).selfAdd(-e.x),a=D.valueOf(n.y).selfAdd(-e.y);return r.selfMultiply(a).selfSubtract(o.selfMultiply(s)).signum()},z.signOfDet2x2=function(t,e,n,i){return t.multiply(i).selfSubtract(e.multiply(n)).signum()},z.intersection=function(t,e,n,i){var r=D.valueOf(i.y).selfSubtract(n.y).selfMultiply(D.valueOf(e.x).selfSubtract(t.x)),o=D.valueOf(i.x).selfSubtract(n.x).selfMultiply(D.valueOf(e.y).selfSubtract(t.y)),s=r.subtract(o),a=D.valueOf(i.x).selfSubtract(n.x).selfMultiply(D.valueOf(t.y).selfSubtract(n.y)),l=D.valueOf(i.y).selfSubtract(n.y).selfMultiply(D.valueOf(t.x).selfSubtract(n.x)),u=a.subtract(l).selfDivide(s).doubleValue(),c=D.valueOf(t.x).selfAdd(D.valueOf(e.x).selfSubtract(t.x).selfMultiply(u)).doubleValue(),h=D.valueOf(e.x).selfSubtract(t.x).selfMultiply(D.valueOf(t.y).selfSubtract(n.y)),f=D.valueOf(e.y).selfSubtract(t.y).selfMultiply(D.valueOf(t.x).selfSubtract(n.x)),d=h.subtract(f).selfDivide(s).doubleValue(),p=D.valueOf(n.y).selfAdd(D.valueOf(i.y).selfSubtract(n.y).selfMultiply(d)).doubleValue();return new S(c,p)},z.orientationIndexFilter=function(t,e,n){var i=null,r=(t.x-n.x)*(e.y-n.y),o=(t.y-n.y)*(e.x-n.x),s=r-o;if(r>0){if(o<=0)return z.signum(s);i=r+o}else{if(!(r<0))return z.signum(s);if(o>=0)return z.signum(s);i=-r-o}var a=z.DP_SAFE_EPSILON*i;return s>=a||-s>=a?z.signum(s):2},z.signum=function(t){return t>0?1:t<0?-1:0},B.DP_SAFE_EPSILON.get=function(){return 1e-15},Object.defineProperties(z,B);var j=function(){},U={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};U.X.get=function(){return 0},U.Y.get=function(){return 1},U.Z.get=function(){return 2},U.M.get=function(){return 3},j.prototype.setOrdinate=function(t,e,n){},j.prototype.size=function(){},j.prototype.getOrdinate=function(t,e){},j.prototype.getCoordinate=function(){},j.prototype.getCoordinateCopy=function(t){},j.prototype.getDimension=function(){},j.prototype.getX=function(t){},j.prototype.clone=function(){},j.prototype.expandEnvelope=function(t){},j.prototype.copy=function(){},j.prototype.getY=function(t){},j.prototype.toCoordinateArray=function(){},j.prototype.interfaces_=function(){return[w]},j.prototype.getClass=function(){return j},Object.defineProperties(j,U);var V=function(){},G=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(V),q=function(){};q.arraycopy=function(t,e,n,i,r){for(var o=0,s=e;s<e+r;s++)n[i+o]=t[s],o++},q.getProperty=function(t){return{"line.separator":"\n"}[t]};var W=function t(){if(this.x=null,this.y=null,this.w=null,0===arguments.length)this.x=0,this.y=0,this.w=1;else if(1===arguments.length){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(2===arguments.length){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this.x=n,this.y=i,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var r=arguments[0],o=arguments[1];this.x=r.y*o.w-o.y*r.w,this.y=o.x*r.w-r.x*o.w,this.w=r.x*o.y-o.x*r.y}else if(arguments[0]instanceof S&&arguments[1]instanceof S){var s=arguments[0],a=arguments[1];this.x=s.y-a.y,this.y=a.x-s.x,this.w=s.x*a.y-a.x*s.y}}else if(3===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2];this.x=l,this.y=u,this.w=c}else if(4===arguments.length){var h=arguments[0],f=arguments[1],d=arguments[2],p=arguments[3],g=h.y-f.y,m=f.x-h.x,y=h.x*f.y-f.x*h.y,v=d.y-p.y,_=p.x-d.x,b=d.x*p.y-p.x*d.y;this.x=m*b-_*y,this.y=v*y-g*b,this.w=g*_-v*m}};W.prototype.getY=function(){var t=this.y/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new G;return t},W.prototype.getX=function(){var t=this.x/this.w;if(_.isNaN(t)||_.isInfinite(t))throw new G;return t},W.prototype.getCoordinate=function(){var t=new S;return t.x=this.getX(),t.y=this.getY(),t},W.prototype.interfaces_=function(){return[]},W.prototype.getClass=function(){return W},W.intersection=function(t,e,n,i){var r=t.y-e.y,o=e.x-t.x,s=t.x*e.y-e.x*t.y,a=n.y-i.y,l=i.x-n.x,u=n.x*i.y-i.x*n.y,c=r*l-a*o,h=(o*u-l*s)/c,f=(a*s-r*u)/c;if(_.isNaN(h)||_.isInfinite(h)||_.isNaN(f)||_.isInfinite(f))throw new G;return new S(h,f)};var H=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,0===arguments.length)this.init();else if(1===arguments.length){if(arguments[0]instanceof S){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.init(i.x,r.x,i.y,r.y)}else if(4===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2],l=arguments[3];this.init(o,s,a,l)}},X={serialVersionUID:{configurable:!0}};H.prototype.getArea=function(){return this.getWidth()*this.getHeight()},H.prototype.equals=function(t){if(!(t instanceof H))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()},H.prototype.intersection=function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new H;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny,i=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new H(e,i,n,r)},H.prototype.isNull=function(){return this._maxx<this._minx},H.prototype.getMaxX=function(){return this._maxx},H.prototype.covers=function(){if(1===arguments.length){if(arguments[0]instanceof S){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof H){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy}},H.prototype.intersects=function(){if(1===arguments.length){if(arguments[0]instanceof H){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof S){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return!this.isNull()&&!(n>this._maxx||n<this._minx||i>this._maxy||i<this._miny)}},H.prototype.getMinY=function(){return this._miny},H.prototype.getMinX=function(){return this._minx},H.prototype.expandToInclude=function(){if(1===arguments.length){if(arguments[0]instanceof S){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof H){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}},H.prototype.minExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e},H.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx},H.prototype.compareTo=function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0},H.prototype.translate=function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)},H.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"},H.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1},H.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny},H.prototype.maxExtent=function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e},H.prototype.expandBy=function(){if(1===arguments.length){var t=arguments[0];this.expandBy(t,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}},H.prototype.contains=function(){if(1===arguments.length){if(arguments[0]instanceof H){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof S){var e=arguments[0];return this.covers(e)}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.covers(n,i)}},H.prototype.centre=function(){return this.isNull()?null:new S((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)},H.prototype.init=function(){if(0===arguments.length)this.setToNull();else if(1===arguments.length){if(arguments[0]instanceof S){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof H){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];r<o?(this._minx=r,this._maxx=o):(this._minx=o,this._maxx=r),s<a?(this._miny=s,this._maxy=a):(this._miny=a,this._maxy=s)}},H.prototype.getMaxY=function(){return this._maxy},H.prototype.distance=function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),0===e?n:0===n?e:Math.sqrt(e*e+n*n)},H.prototype.hashCode=function(){var t=17;return 37*(t=37*(t=37*(t=37*t+S.hashCode(this._minx))+S.hashCode(this._maxx))+S.hashCode(this._miny))+S.hashCode(this._maxy)},H.prototype.interfaces_=function(){return[x,e]},H.prototype.getClass=function(){return H},H.intersects=function(){if(3===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(4===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=Math.min(o.x,s.x),l=Math.max(o.x,s.x),u=Math.min(i.x,r.x),c=Math.max(i.x,r.x);return!(u>l||c<a||(a=Math.min(o.y,s.y),l=Math.max(o.y,s.y),u=Math.min(i.y,r.y),c=Math.max(i.y,r.y),u>l||c<a))}},X.serialVersionUID.get=function(){return 0x51845cd552189800},Object.defineProperties(H,X);var Y={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},Z=function(t){this.geometryFactory=t||new ye};Z.prototype.read=function(t){var e,n,i;t=t.replace(/[\n\r]/g," ");var r=Y.typeStr.exec(t);if(-1!==t.search("EMPTY")&&((r=Y.emptyTypeStr.exec(t))[2]=void 0),r&&(n=r[1].toLowerCase(),i=r[2],$[n]&&(e=$[n].apply(this,[i]))),void 0===e)throw new Error("Could not parse WKT "+t);return e},Z.prototype.write=function(t){return this.extractGeometry(t)},Z.prototype.extractGeometry=function(t){var e=t.getGeometryType().toLowerCase();if(!K[e])return null;var n=e.toUpperCase();return t.isEmpty()?n+" EMPTY":n+"("+K[e].apply(this,[t])+")"};var K={coordinate:function(t){return t.x+" "+t.y},point:function(t){return K.coordinate.call(this,t._coordinates._coordinates[0])},multipoint:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+K.point.apply(this,[t._geometries[n]])+")");return e.join(",")},linestring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(K.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},linearring:function(t){for(var e=[],n=0,i=t._points._coordinates.length;n<i;++n)e.push(K.coordinate.apply(this,[t._points._coordinates[n]]));return e.join(",")},multilinestring:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+K.linestring.apply(this,[t._geometries[n]])+")");return e.join(",")},polygon:function(t){var e=[];e.push("("+K.linestring.apply(this,[t._shell])+")");for(var n=0,i=t._holes.length;n<i;++n)e.push("("+K.linestring.apply(this,[t._holes[n]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push("("+K.polygon.apply(this,[t._geometries[n]])+")");return e.join(",")},geometrycollection:function(t){for(var e=[],n=0,i=t._geometries.length;n<i;++n)e.push(this.extractGeometry(t._geometries[n]));return e.join(",")}},$={point:function(t){if(void 0===t)return this.geometryFactory.createPoint();var e=t.trim().split(Y.spaces);return this.geometryFactory.createPoint(new S(Number.parseFloat(e[0]),Number.parseFloat(e[1])))},multipoint:function(t){if(void 0===t)return this.geometryFactory.createMultiPoint();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Y.trimParens,"$1"),i.push($.point.apply(this,[e]));return this.geometryFactory.createMultiPoint(i)},linestring:function(t){if(void 0===t)return this.geometryFactory.createLineString();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Y.spaces),i.push(new S(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLineString(i)},linearring:function(t){if(void 0===t)return this.geometryFactory.createLinearRing();for(var e,n=t.trim().split(","),i=[],r=0,o=n.length;r<o;++r)e=n[r].trim().split(Y.spaces),i.push(new S(Number.parseFloat(e[0]),Number.parseFloat(e[1])));return this.geometryFactory.createLinearRing(i)},multilinestring:function(t){if(void 0===t)return this.geometryFactory.createMultiLineString();for(var e,n=t.trim().split(Y.parenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Y.trimParens,"$1"),i.push($.linestring.apply(this,[e]));return this.geometryFactory.createMultiLineString(i)},polygon:function(t){if(void 0===t)return this.geometryFactory.createPolygon();for(var e,n,i,r,o=t.trim().split(Y.parenComma),s=[],a=0,l=o.length;a<l;++a)e=o[a].replace(Y.trimParens,"$1"),n=$.linestring.apply(this,[e]),i=this.geometryFactory.createLinearRing(n._points),0===a?r=i:s.push(i);return this.geometryFactory.createPolygon(r,s)},multipolygon:function(t){if(void 0===t)return this.geometryFactory.createMultiPolygon();for(var e,n=t.trim().split(Y.doubleParenComma),i=[],r=0,o=n.length;r<o;++r)e=n[r].replace(Y.trimParens,"$1"),i.push($.polygon.apply(this,[e]));return this.geometryFactory.createMultiPolygon(i)},geometrycollection:function(t){if(void 0===t)return this.geometryFactory.createGeometryCollection();for(var e=(t=t.replace(/,\s*([A-Za-z])/g,"|$1")).trim().split("|"),n=[],i=0,r=e.length;i<r;++i)n.push(this.read(e[i]));return this.geometryFactory.createGeometryCollection(n)}},Q=function(t){this.parser=new Z(t)};Q.prototype.write=function(t){return this.parser.write(t)},Q.toLineString=function(t,e){if(2!==arguments.length)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"};var J=function(t){function e(e){t.call(this,e),this.name="RuntimeException",this.message=e,this.stack=(new t).stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),tt=function(t){function e(){if(t.call(this),0===arguments.length)t.call(this);else if(1===arguments.length){var e=arguments[0];t.call(this,e)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(J),et=function(){};et.prototype.interfaces_=function(){return[]},et.prototype.getClass=function(){return et},et.shouldNeverReachHere=function(){if(0===arguments.length)et.shouldNeverReachHere(null);else if(1===arguments.length){var t=arguments[0];throw new tt("Should never reach here"+(null!==t?": "+t:""))}},et.isTrue=function(){var t,e;if(1===arguments.length)t=arguments[0],et.isTrue(t,null);else if(2===arguments.length&&(e=arguments[1],!(t=arguments[0])))throw null===e?new tt:new tt(e)},et.equals=function(){var t,e,n;if(2===arguments.length)t=arguments[0],e=arguments[1],et.equals(t,e,null);else if(3===arguments.length&&(t=arguments[0],n=arguments[2],!(e=arguments[1]).equals(t)))throw new tt("Expected "+t+" but encountered "+e+(null!==n?": "+n:""))};var nt=function(){this._result=null,this._inputLines=Array(2).fill().map((function(){return Array(2)})),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new S,this._intPt[1]=new S,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},it={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};nt.prototype.getIndexAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]},nt.prototype.getTopologySummary=function(){var t=new N;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()},nt.prototype.computeIntersection=function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)},nt.prototype.getIntersectionNum=function(){return this._result},nt.prototype.computeIntLineIndex=function(){if(0===arguments.length)null===this._intLineIndex&&(this._intLineIndex=Array(2).fill().map((function(){return Array(2)})),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(1===arguments.length){var t=arguments[0];this.getEdgeDistance(t,0)>this.getEdgeDistance(t,1)?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}},nt.prototype.isProper=function(){return this.hasIntersection()&&this._isProper},nt.prototype.setPrecisionModel=function(t){this._precisionModel=t},nt.prototype.isInteriorIntersection=function(){if(0===arguments.length)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(1===arguments.length){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}},nt.prototype.getIntersection=function(t){return this._intPt[t]},nt.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper},nt.prototype.hasIntersection=function(){return this._result!==nt.NO_INTERSECTION},nt.prototype.getEdgeDistance=function(t,e){return nt.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])},nt.prototype.isCollinear=function(){return this._result===nt.COLLINEAR_INTERSECTION},nt.prototype.toString=function(){return Q.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Q.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()},nt.prototype.getEndpoint=function(t,e){return this._inputLines[t][e]},nt.prototype.isIntersection=function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1},nt.prototype.getIntersectionAlongSegment=function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]},nt.prototype.interfaces_=function(){return[]},nt.prototype.getClass=function(){return nt},nt.computeEdgeDistance=function(t,e,n){var i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=-1;if(t.equals(e))o=0;else if(t.equals(n))o=i>r?i:r;else{var s=Math.abs(t.x-e.x),a=Math.abs(t.y-e.y);0!==(o=i>r?s:a)||t.equals(e)||(o=Math.max(s,a))}return et.isTrue(!(0===o&&!t.equals(e)),"Bad distance calculation"),o},nt.nonRobustComputeEdgeDistance=function(t,e,n){var i=t.x-e.x,r=t.y-e.y,o=Math.sqrt(i*i+r*r);return et.isTrue(!(0===o&&!t.equals(e)),"Invalid distance calculation"),o},it.DONT_INTERSECT.get=function(){return 0},it.DO_INTERSECT.get=function(){return 1},it.COLLINEAR.get=function(){return 2},it.NO_INTERSECTION.get=function(){return 0},it.POINT_INTERSECTION.get=function(){return 1},it.COLLINEAR_INTERSECTION.get=function(){return 2},Object.defineProperties(nt,it);var rt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(t){var e=new H(this._inputLines[0][0],this._inputLines[0][1]),n=new H(this._inputLines[1][0],this._inputLines[1][1]);return e.contains(t)&&n.contains(t)},e.prototype.computeIntersection=function(){if(3!==arguments.length)return t.prototype.computeIntersection.apply(this,arguments);var e=arguments[0],n=arguments[1],i=arguments[2];if(this._isProper=!1,H.intersects(n,i,e)&&0===at.orientationIndex(n,i,e)&&0===at.orientationIndex(i,n,e))return this._isProper=!0,(e.equals(n)||e.equals(i))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION},e.prototype.normalizeToMinimum=function(t,e,n,i,r){r.x=this.smallestInAbsValue(t.x,e.x,n.x,i.x),r.y=this.smallestInAbsValue(t.y,e.y,n.y,i.y),t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.safeHCoordinateIntersection=function(t,n,i,r){var o=null;try{o=W.intersection(t,n,i,r)}catch(s){if(!(s instanceof G))throw s;o=e.nearestEndpoint(t,n,i,r)}return o},e.prototype.intersection=function(t,n,i,r){var o=this.intersectionWithNormalization(t,n,i,r);return this.isInSegmentEnvelopes(o)||(o=new S(e.nearestEndpoint(t,n,i,r))),null!==this._precisionModel&&this._precisionModel.makePrecise(o),o},e.prototype.smallestInAbsValue=function(t,e,n,i){var r=t,o=Math.abs(r);return Math.abs(e)<o&&(r=e,o=Math.abs(e)),Math.abs(n)<o&&(r=n,o=Math.abs(n)),Math.abs(i)<o&&(r=i),r},e.prototype.checkDD=function(t,e,n,i,r){var o=z.intersection(t,e,n,i),s=this.isInSegmentEnvelopes(o);q.out.println("DD in env = "+s+"  --------------------- "+o),r.distance(o)>1e-4&&q.out.println("Distance = "+r.distance(o))},e.prototype.intersectionWithNormalization=function(t,e,n,i){var r=new S(t),o=new S(e),s=new S(n),a=new S(i),l=new S;this.normalizeToEnvCentre(r,o,s,a,l);var u=this.safeHCoordinateIntersection(r,o,s,a);return u.x+=l.x,u.y+=l.y,u},e.prototype.computeCollinearIntersection=function(e,n,i,r){var o=H.intersects(e,n,i),s=H.intersects(e,n,r),a=H.intersects(i,r,e),l=H.intersects(i,r,n);return o&&s?(this._intPt[0]=i,this._intPt[1]=r,t.COLLINEAR_INTERSECTION):a&&l?(this._intPt[0]=e,this._intPt[1]=n,t.COLLINEAR_INTERSECTION):o&&a?(this._intPt[0]=i,this._intPt[1]=e,!i.equals(e)||s||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):o&&l?(this._intPt[0]=i,this._intPt[1]=n,!i.equals(n)||s||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&a?(this._intPt[0]=r,this._intPt[1]=e,!r.equals(e)||o||l?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):s&&l?(this._intPt[0]=r,this._intPt[1]=n,!r.equals(n)||o||a?t.COLLINEAR_INTERSECTION:t.POINT_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(t,e,n,i,r){var o=t.x<e.x?t.x:e.x,s=t.y<e.y?t.y:e.y,a=t.x>e.x?t.x:e.x,l=t.y>e.y?t.y:e.y,u=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,h=n.x>i.x?n.x:i.x,f=n.y>i.y?n.y:i.y,d=((o>u?o:u)+(a<h?a:h))/2,p=((s>c?s:c)+(l<f?l:f))/2;r.x=d,r.y=p,t.x-=r.x,t.y-=r.y,e.x-=r.x,e.y-=r.y,n.x-=r.x,n.y-=r.y,i.x-=r.x,i.y-=r.y},e.prototype.computeIntersect=function(e,n,i,r){if(this._isProper=!1,!H.intersects(e,n,i,r))return t.NO_INTERSECTION;var o=at.orientationIndex(e,n,i),s=at.orientationIndex(e,n,r);if(o>0&&s>0||o<0&&s<0)return t.NO_INTERSECTION;var a=at.orientationIndex(i,r,e),l=at.orientationIndex(i,r,n);return a>0&&l>0||a<0&&l<0?t.NO_INTERSECTION:0===o&&0===s&&0===a&&0===l?this.computeCollinearIntersection(e,n,i,r):(0===o||0===s||0===a||0===l?(this._isProper=!1,e.equals2D(i)||e.equals2D(r)?this._intPt[0]=e:n.equals2D(i)||n.equals2D(r)?this._intPt[0]=n:0===o?this._intPt[0]=new S(i):0===s?this._intPt[0]=new S(r):0===a?this._intPt[0]=new S(e):0===l&&(this._intPt[0]=new S(n))):(this._isProper=!0,this._intPt[0]=this.intersection(e,n,i,r)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(t,e,n,i){var r=t,o=at.distancePointLine(t,n,i),s=at.distancePointLine(e,n,i);return s<o&&(o=s,r=e),(s=at.distancePointLine(n,t,e))<o&&(o=s,r=n),(s=at.distancePointLine(i,t,e))<o&&(o=s,r=i),r},e}(nt),ot=function(){};ot.prototype.interfaces_=function(){return[]},ot.prototype.getClass=function(){return ot},ot.orientationIndex=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=n.x-e.x,s=n.y-e.y;return ot.signOfDet2x2(i,r,o,s)},ot.signOfDet2x2=function(t,e,n,i){var r=null,o=null,s=null;if(r=1,0===t||0===i)return 0===e||0===n?0:e>0?n>0?-r:r:n>0?r:-r;if(0===e||0===n)return i>0?t>0?r:-r:t>0?-r:r;if(e>0?i>0?e<=i||(r=-r,o=t,t=n,n=o,o=e,e=i,i=o):e<=-i?(r=-r,n=-n,i=-i):(o=t,t=-n,n=o,o=e,e=-i,i=o):i>0?-e<=i?(r=-r,t=-t,e=-e):(o=-t,t=n,n=o,o=-e,e=i,i=o):e>=i?(t=-t,e=-e,n=-n,i=-i):(r=-r,o=-t,t=-n,n=o,o=-e,e=-i,i=o),t>0){if(!(n>0))return r;if(!(t<=n))return r}else{if(n>0)return-r;if(!(t>=n))return-r;r=-r,t=-t,n=-n}for(;;){if((i-=(s=Math.floor(n/t))*e)<0)return-r;if(i>e)return r;if(t>(n-=s*t)+n){if(e<i+i)return r}else{if(e>i+i)return-r;n=t-n,i=e-i,r=-r}if(0===i)return 0===n?0:-r;if(0===n)return r;if((e-=(s=Math.floor(t/n))*i)<0)return r;if(e>i)return-r;if(n>(t-=s*n)+t){if(i<e+e)return-r}else{if(i>e+e)return r;t=n-t,e=i-e,r=-r}if(0===e)return 0===t?0:r;if(0===t)return-r}};var st=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t};st.prototype.countSegment=function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var r=t.x-this._p.x,o=t.y-this._p.y,s=e.x-this._p.x,a=e.y-this._p.y,l=ot.signOfDet2x2(r,o,s,a);if(0===l)return this._isPointOnSegment=!0,null;a<o&&(l=-l),l>0&&this._crossingCount++}},st.prototype.isPointInPolygon=function(){return this.getLocation()!==T.EXTERIOR},st.prototype.getLocation=function(){return this._isPointOnSegment?T.BOUNDARY:this._crossingCount%2==1?T.INTERIOR:T.EXTERIOR},st.prototype.isOnSegment=function(){return this._isPointOnSegment},st.prototype.interfaces_=function(){return[]},st.prototype.getClass=function(){return st},st.locatePointInRing=function(){if(arguments[0]instanceof S&&L(arguments[1],j)){for(var t=arguments[1],e=new st(arguments[0]),n=new S,i=new S,r=1;r<t.size();r++)if(t.getCoordinate(r,n),t.getCoordinate(r-1,i),e.countSegment(n,i),e.isOnSegment())return e.getLocation();return e.getLocation()}if(arguments[0]instanceof S&&arguments[1]instanceof Array){for(var o=arguments[1],s=new st(arguments[0]),a=1;a<o.length;a++){var l=o[a],u=o[a-1];if(s.countSegment(l,u),s.isOnSegment())return s.getLocation()}return s.getLocation()}};var at=function(){},lt={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};at.prototype.interfaces_=function(){return[]},at.prototype.getClass=function(){return at},at.orientationIndex=function(t,e,n){return z.orientationIndex(t,e,n)},at.signedArea=function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var r=t[i].x-n,o=t[i+1].y;e+=r*(t[i-1].y-o)}return e/2}if(L(arguments[0],j)){var s=arguments[0],a=s.size();if(a<3)return 0;var l=new S,u=new S,c=new S;s.getCoordinate(0,u),s.getCoordinate(1,c);var h=u.x;c.x-=h;for(var f=0,d=1;d<a-1;d++)l.y=u.y,u.x=c.x,u.y=c.y,s.getCoordinate(d+1,c),c.x-=h,f+=u.x*(l.y-c.y);return f/2}},at.distanceLineLine=function(t,e,n,i){if(t.equals(e))return at.distancePointLine(t,n,i);if(n.equals(i))return at.distancePointLine(i,t,e);var r=!1;if(H.intersects(t,e,n,i)){var o=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(0===o)r=!0;else{var s=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),a=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/o,l=s/o;(l<0||l>1||a<0||a>1)&&(r=!0)}}else r=!0;return r?A.min(at.distancePointLine(t,n,i),at.distancePointLine(e,n,i),at.distancePointLine(n,t,e),at.distancePointLine(i,t,e)):0},at.isPointInRing=function(t,e){return at.locatePointInRing(t,e)!==T.EXTERIOR},at.computeLength=function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new S;t.getCoordinate(0,i);for(var r=i.x,o=i.y,s=1;s<e;s++){t.getCoordinate(s,i);var a=i.x,l=i.y,u=a-r,c=l-o;n+=Math.sqrt(u*u+c*c),r=a,o=l}return n},at.isCCW=function(t){var e=t.length-1;if(e<3)throw new v("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,r=1;r<=e;r++){var o=t[r];o.y>n.y&&(n=o,i=r)}var s=i;do{(s-=1)<0&&(s=e)}while(t[s].equals2D(n)&&s!==i);var a=i;do{a=(a+1)%e}while(t[a].equals2D(n)&&a!==i);var l=t[s],u=t[a];if(l.equals2D(n)||u.equals2D(n)||l.equals2D(u))return!1;var c=at.computeOrientation(l,n,u);return 0===c?l.x>u.x:c>0},at.locatePointInRing=function(t,e){return st.locatePointInRing(t,e)},at.distancePointLinePerpendicular=function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),r=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(r)*Math.sqrt(i)},at.computeOrientation=function(t,e,n){return at.orientationIndex(t,e,n)},at.distancePointLine=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(0===e.length)throw new v("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var r=at.distancePointLine(t,e[i],e[i+1]);r<n&&(n=r)}return n}if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];if(s.x===a.x&&s.y===a.y)return o.distance(s);var l=(a.x-s.x)*(a.x-s.x)+(a.y-s.y)*(a.y-s.y),u=((o.x-s.x)*(a.x-s.x)+(o.y-s.y)*(a.y-s.y))/l;if(u<=0)return o.distance(s);if(u>=1)return o.distance(a);var c=((s.y-o.y)*(a.x-s.x)-(s.x-o.x)*(a.y-s.y))/l;return Math.abs(c)*Math.sqrt(l)}},at.isOnLine=function(t,e){for(var n=new rt,i=1;i<e.length;i++){var r=e[i-1],o=e[i];if(n.computeIntersection(t,r,o),n.hasIntersection())return!0}return!1},lt.CLOCKWISE.get=function(){return-1},lt.RIGHT.get=function(){return at.CLOCKWISE},lt.COUNTERCLOCKWISE.get=function(){return 1},lt.LEFT.get=function(){return at.COUNTERCLOCKWISE},lt.COLLINEAR.get=function(){return 0},lt.STRAIGHT.get=function(){return at.COLLINEAR},Object.defineProperties(at,lt);var ut=function(){};ut.prototype.filter=function(t){},ut.prototype.interfaces_=function(){return[]},ut.prototype.getClass=function(){return ut};var ct=function(){var t=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=t,this._SRID=t.getSRID()},ht={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ct.prototype.isGeometryCollection=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION},ct.prototype.getFactory=function(){return this._factory},ct.prototype.getGeometryN=function(t){return this},ct.prototype.getArea=function(){return 0},ct.prototype.isRectangle=function(){return!1},ct.prototype.equals=function(){if(arguments[0]instanceof ct){var t=arguments[0];return null!==t&&this.equalsTopo(t)}if(arguments[0]instanceof Object){var e=arguments[0];if(!(e instanceof ct))return!1;var n=e;return this.equalsExact(n)}},ct.prototype.equalsExact=function(t){return this===t||this.equalsExact(t,0)},ct.prototype.geometryChanged=function(){this.apply(ct.geometryChangedFilter)},ct.prototype.geometryChangedAction=function(){this._envelope=null},ct.prototype.equalsNorm=function(t){return null!==t&&this.norm().equalsExact(t.norm())},ct.prototype.getLength=function(){return 0},ct.prototype.getNumGeometries=function(){return 1},ct.prototype.compareTo=function(){if(1===arguments.length){var t=arguments[0],e=t;return this.getSortIndex()!==e.getSortIndex()?this.getSortIndex()-e.getSortIndex():this.isEmpty()&&e.isEmpty()?0:this.isEmpty()?-1:e.isEmpty()?1:this.compareToSameClass(t)}if(2===arguments.length){var n=arguments[0],i=arguments[1];return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(n,i)}},ct.prototype.getUserData=function(){return this._userData},ct.prototype.getSRID=function(){return this._SRID},ct.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())},ct.prototype.checkNotGeometryCollection=function(t){if(t.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION)throw new v("This method does not support GeometryCollection arguments")},ct.prototype.equal=function(t,e,n){return 0===n?t.equals(e):t.distance(e)<=n},ct.prototype.norm=function(){var t=this.copy();return t.normalize(),t},ct.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()},ct.prototype.getEnvelopeInternal=function(){return null===this._envelope&&(this._envelope=this.computeEnvelopeInternal()),new H(this._envelope)},ct.prototype.setSRID=function(t){this._SRID=t},ct.prototype.setUserData=function(t){this._userData=t},ct.prototype.compare=function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var r=n.next(),o=i.next(),s=r.compareTo(o);if(0!==s)return s}return n.hasNext()?1:i.hasNext()?-1:0},ct.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()},ct.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ct.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ct.SORTINDEX_MULTIPOINT||this.getSortIndex()===ct.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ct.SORTINDEX_MULTIPOLYGON},ct.prototype.interfaces_=function(){return[w,x,e]},ct.prototype.getClass=function(){return ct},ct.hasNonEmptyElements=function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1},ct.hasNullElements=function(t){for(var e=0;e<t.length;e++)if(null===t[e])return!0;return!1},ht.serialVersionUID.get=function(){return 0x799ea46522854c00},ht.SORTINDEX_POINT.get=function(){return 0},ht.SORTINDEX_MULTIPOINT.get=function(){return 1},ht.SORTINDEX_LINESTRING.get=function(){return 2},ht.SORTINDEX_LINEARRING.get=function(){return 3},ht.SORTINDEX_MULTILINESTRING.get=function(){return 4},ht.SORTINDEX_POLYGON.get=function(){return 5},ht.SORTINDEX_MULTIPOLYGON.get=function(){return 6},ht.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7},ht.geometryChangedFilter.get=function(){return ft},Object.defineProperties(ct,ht);var ft=function(){};ft.interfaces_=function(){return[ut]},ft.filter=function(t){t.geometryChangedAction()};var dt=function(){};dt.prototype.filter=function(t){},dt.prototype.interfaces_=function(){return[]},dt.prototype.getClass=function(){return dt};var pt=function(){},gt={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};pt.prototype.isInBoundary=function(t){},pt.prototype.interfaces_=function(){return[]},pt.prototype.getClass=function(){return pt},gt.Mod2BoundaryNodeRule.get=function(){return mt},gt.EndPointBoundaryNodeRule.get=function(){return yt},gt.MultiValentEndPointBoundaryNodeRule.get=function(){return vt},gt.MonoValentEndPointBoundaryNodeRule.get=function(){return _t},gt.MOD2_BOUNDARY_RULE.get=function(){return new mt},gt.ENDPOINT_BOUNDARY_RULE.get=function(){return new yt},gt.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new vt},gt.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new _t},gt.OGC_SFS_BOUNDARY_RULE.get=function(){return pt.MOD2_BOUNDARY_RULE},Object.defineProperties(pt,gt);var mt=function(){};mt.prototype.isInBoundary=function(t){return t%2==1},mt.prototype.interfaces_=function(){return[pt]},mt.prototype.getClass=function(){return mt};var yt=function(){};yt.prototype.isInBoundary=function(t){return t>0},yt.prototype.interfaces_=function(){return[pt]},yt.prototype.getClass=function(){return yt};var vt=function(){};vt.prototype.isInBoundary=function(t){return t>1},vt.prototype.interfaces_=function(){return[pt]},vt.prototype.getClass=function(){return vt};var _t=function(){};_t.prototype.isInBoundary=function(t){return 1===t},_t.prototype.interfaces_=function(){return[pt]},_t.prototype.getClass=function(){return _t};var bt=function(){};bt.prototype.add=function(){},bt.prototype.addAll=function(){},bt.prototype.isEmpty=function(){},bt.prototype.iterator=function(){},bt.prototype.size=function(){},bt.prototype.toArray=function(){},bt.prototype.remove=function(){},(n.prototype=new Error).name="IndexOutOfBoundsException";var xt=function(){};xt.prototype.hasNext=function(){},xt.prototype.next=function(){},xt.prototype.remove=function(){};var wt=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(bt);(i.prototype=new Error).name="NoSuchElementException";var Et=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof bt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,bt]},e.prototype.add=function(t){return 1===arguments.length?this.array_.push(t):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.set=function(t,e){var n=this.array_[t];return this.array_[t]=e,n},e.prototype.iterator=function(){return new St(this)},e.prototype.get=function(t){if(t<0||t>=this.size())throw new n;return this.array_[t]},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.remove=function(t){for(var e=!1,n=0,i=this.array_.length;n<i;n++)if(this.array_[n]===t){this.array_.splice(n,1),e=!0;break}return e},e}(wt),St=function(t){function e(e){t.call(this),this.arrayList_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new i;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(t){return this.arrayList_.set(this.position_-1,t)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(xt),Pt=function(t){function e(){if(t.call(this),0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.ensureCapacity(e.length),this.add(e,!0)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.ensureCapacity(n.length),this.add(n,i)}}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(t){return this.get(t)},e.prototype.addAll=function(){if(2===arguments.length){for(var e=arguments[1],n=!1,i=arguments[0].iterator();i.hasNext();)this.add(i.next(),e),n=!0;return n}return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var e=t.prototype.clone.call(this),n=0;n<this.size();n++)e.add(n,this.get(n).copy());return e},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){if(1===arguments.length){var e=arguments[0];t.prototype.add.call(this,e)}else if(2===arguments.length){if(arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var n=arguments[0],i=arguments[1];return this.add(n,i,!0),!0}if(arguments[0]instanceof S&&"boolean"==typeof arguments[1]){var r=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(r))return null;t.prototype.add.call(this,r)}else if(arguments[0]instanceof Object&&"boolean"==typeof arguments[1]){var o=arguments[0],s=arguments[1];return this.add(o,s),!0}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&arguments[0]instanceof Array&&"boolean"==typeof arguments[1]){var a=arguments[0],l=arguments[1];if(arguments[2])for(var u=0;u<a.length;u++)this.add(a[u],l);else for(var c=a.length-1;c>=0;c--)this.add(a[c],l);return!0}if("boolean"==typeof arguments[2]&&Number.isInteger(arguments[0])&&arguments[1]instanceof S){var h=arguments[0],f=arguments[1];if(!arguments[2]){var d=this.size();if(d>0){if(h>0&&this.get(h-1).equals2D(f))return null;if(h<d&&this.get(h).equals2D(f))return null}}t.prototype.add.call(this,h,f)}}else if(4===arguments.length){var p=arguments[0],g=arguments[1],m=arguments[2],y=arguments[3],v=1;m>y&&(v=-1);for(var _=m;_!==y;_+=v)this.add(p[_],g);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new S(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(Et),Ct=function(){},It={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};It.ForwardComparator.get=function(){return Tt},It.BidirectionalComparator.get=function(){return Mt},It.coordArrayType.get=function(){return new Array(0).fill(null)},Ct.prototype.interfaces_=function(){return[]},Ct.prototype.getClass=function(){return Ct},Ct.isRing=function(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))},Ct.ptNotInList=function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(Ct.indexOf(i,e)<0)return i}return null},Ct.scroll=function(t,e){var n=Ct.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);q.arraycopy(t,n,i,0,t.length-n),q.arraycopy(t,0,i,t.length-n,n),q.arraycopy(i,0,t,0,t.length)},Ct.equals=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(null===t||null===e)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];if(i===r)return!0;if(null===i||null===r)return!1;if(i.length!==r.length)return!1;for(var s=0;s<i.length;s++)if(0!==o.compare(i[s],r[s]))return!1;return!0}},Ct.intersection=function(t,e){for(var n=new Pt,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()},Ct.hasRepeatedPoints=function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1},Ct.removeRepeatedPoints=function(t){return Ct.hasRepeatedPoints(t)?new Pt(t,!1).toCoordinateArray():t},Ct.reverse=function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var r=t[i];t[i]=t[e-i],t[e-i]=r}},Ct.removeNull=function(t){for(var e=0,n=0;n<t.length;n++)null!==t[n]&&e++;var i=new Array(e).fill(null);if(0===e)return i;for(var r=0,o=0;o<t.length;o++)null!==t[o]&&(i[r++]=t[o]);return i},Ct.copyDeep=function(){if(1===arguments.length){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=new S(t[n]);return e}if(5===arguments.length)for(var i=arguments[0],r=arguments[1],o=arguments[2],s=arguments[3],a=arguments[4],l=0;l<a;l++)o[s+l]=new S(i[r+l])},Ct.isEqualReversed=function(t,e){for(var n=0;n<t.length;n++){var i=t[n],r=e[t.length-n-1];if(0!==i.compareTo(r))return!1}return!0},Ct.envelope=function(t){for(var e=new H,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e},Ct.toCoordinateArray=function(t){return t.toArray(Ct.coordArrayType)},Ct.atLeastNCoordinatesOrNothing=function(t,e){return e.length>=t?e:[]},Ct.indexOf=function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1},Ct.increasingDirection=function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(0!==i)return i}return 1},Ct.compare=function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(0!==i)return i;n++}return n<e.length?-1:n<t.length?1:0},Ct.minCoordinate=function(t){for(var e=null,n=0;n<t.length;n++)(null===e||e.compareTo(t[n])>0)&&(e=t[n]);return e},Ct.extract=function(t,e,n){e=A.clamp(e,0,t.length);var i=(n=A.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var r=new Array(i).fill(null);if(0===i)return r;for(var o=0,s=e;s<=n;s++)r[o++]=t[s];return r},Object.defineProperties(Ct,It);var Tt=function(){};Tt.prototype.compare=function(t,e){return Ct.compare(t,e)},Tt.prototype.interfaces_=function(){return[E]},Tt.prototype.getClass=function(){return Tt};var Mt=function(){};Mt.prototype.compare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;var r=Ct.compare(n,i);return Ct.isEqualReversed(n,i)?0:r},Mt.prototype.OLDcompare=function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(0===n.length)return 0;for(var r=Ct.increasingDirection(n),o=Ct.increasingDirection(i),s=r>0?0:n.length-1,a=o>0?0:n.length-1,l=0;l<n.length;l++){var u=n[s].compareTo(i[a]);if(0!==u)return u;s+=r,a+=o}return 0},Mt.prototype.interfaces_=function(){return[E]},Mt.prototype.getClass=function(){return Mt};var Lt=function(){};Lt.prototype.get=function(){},Lt.prototype.put=function(){},Lt.prototype.size=function(){},Lt.prototype.values=function(){},Lt.prototype.entrySet=function(){};var At=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Lt);(r.prototype=new Error).name="OperationNotSupported",(o.prototype=new bt).contains=function(){};var Ot=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof bt&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(this.array_[e]===t)return!0;return!1},e.prototype.add=function(t){return!this.contains(t)&&(this.array_.push(t),!0)},e.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},e.prototype.remove=function(t){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return 0===this.array_.length},e.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},e.prototype.iterator=function(){return new Nt(this)},e}(o),Nt=function(t){function e(e){t.call(this),this.hashSet_=e,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new i;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new r},e}(xt),Rt=0;(h.prototype=new At).get=function(t){for(var e=this.root_;null!==e;){var n=t.compareTo(e.key);if(n<0)e=e.left;else{if(!(n>0))return e.value;e=e.right}}return null},h.prototype.put=function(t,e){if(null===this.root_)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Rt,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n,i,r=this.root_;do{if(n=r,(i=t.compareTo(r.key))<0)r=r.left;else{if(!(i>0)){var o=r.value;return r.value=e,o}r=r.right}}while(null!==r);var s={key:t,left:null,right:null,value:e,parent:n,color:Rt,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?n.left=s:n.right=s,this.fixAfterInsertion(s),this.size_++,null},h.prototype.fixAfterInsertion=function(t){for(t.color=1;null!=t&&t!==this.root_&&1===t.parent.color;)if(a(t)===u(a(a(t)))){var e=c(a(a(t)));1===s(e)?(l(a(t),Rt),l(e,Rt),l(a(a(t)),1),t=a(a(t))):(t===c(a(t))&&(t=a(t),this.rotateLeft(t)),l(a(t),Rt),l(a(a(t)),1),this.rotateRight(a(a(t))))}else{var n=u(a(a(t)));1===s(n)?(l(a(t),Rt),l(n,Rt),l(a(a(t)),1),t=a(a(t))):(t===u(a(t))&&(t=a(t),this.rotateRight(t)),l(a(t),Rt),l(a(a(t)),1),this.rotateLeft(a(a(t))))}this.root_.color=Rt},h.prototype.values=function(){var t=new Et,e=this.getFirstEntry();if(null!==e)for(t.add(e.value);null!==(e=h.successor(e));)t.add(e.value);return t},h.prototype.entrySet=function(){var t=new Ot,e=this.getFirstEntry();if(null!==e)for(t.add(e);null!==(e=h.successor(e));)t.add(e);return t},h.prototype.rotateLeft=function(t){if(null!=t){var e=t.right;t.right=e.left,null!=e.left&&(e.left.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}},h.prototype.rotateRight=function(t){if(null!=t){var e=t.left;t.left=e.right,null!=e.right&&(e.right.parent=t),e.parent=t.parent,null===t.parent?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}},h.prototype.getFirstEntry=function(){var t=this.root_;if(null!=t)for(;null!=t.left;)t=t.left;return t},h.successor=function(t){if(null===t)return null;if(null!==t.right){for(var e=t.right;null!==e.left;)e=e.left;return e}for(var n=t.parent,i=t;null!==n&&i===n.right;)i=n,n=n.parent;return n},h.prototype.size=function(){return this.size_};var kt=function(){};kt.prototype.interfaces_=function(){return[]},kt.prototype.getClass=function(){return kt},f.prototype=new o,(d.prototype=new f).contains=function(t){for(var e=0,n=this.array_.length;e<n;e++)if(0===this.array_[e].compareTo(t))return!0;return!1},d.prototype.add=function(t){if(this.contains(t))return!1;for(var e=0,n=this.array_.length;e<n;e++)if(1===this.array_[e].compareTo(t))return this.array_.splice(e,0,t),!0;return this.array_.push(t),!0},d.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next());return!0},d.prototype.remove=function(t){throw new r},d.prototype.size=function(){return this.array_.length},d.prototype.isEmpty=function(){return 0===this.array_.length},d.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t},d.prototype.iterator=function(){return new Dt(this)};var Dt=function(t){this.treeSet_=t,this.position_=0};Dt.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new i;return this.treeSet_.array_[this.position_++]},Dt.prototype.hasNext=function(){return this.position_<this.treeSet_.size()},Dt.prototype.remove=function(){throw new r};var Ft=function(){};Ft.sort=function(){var t,e,n,i,r=arguments[0];if(1===arguments.length)i=function(t,e){return t.compareTo(e)},r.sort(i);else if(2===arguments.length)n=arguments[1],i=function(t,e){return n.compare(t,e)},r.sort(i);else if(3===arguments.length){(e=r.slice(arguments[1],arguments[2])).sort();var o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length));for(r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])}else if(4===arguments.length)for(e=r.slice(arguments[1],arguments[2]),n=arguments[3],i=function(t,e){return n.compare(t,e)},e.sort(i),o=r.slice(0,arguments[1]).concat(e,r.slice(arguments[2],r.length)),r.splice(0,r.length),t=0;t<o.length;t++)r.push(o[t])},Ft.asList=function(t){for(var e=new Et,n=0,i=t.length;n<i;n++)e.add(t[n]);return e};var zt=function(){},Bt={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Bt.P.get=function(){return 0},Bt.L.get=function(){return 1},Bt.A.get=function(){return 2},Bt.FALSE.get=function(){return-1},Bt.TRUE.get=function(){return-2},Bt.DONTCARE.get=function(){return-3},Bt.SYM_FALSE.get=function(){return"F"},Bt.SYM_TRUE.get=function(){return"T"},Bt.SYM_DONTCARE.get=function(){return"*"},Bt.SYM_P.get=function(){return"0"},Bt.SYM_L.get=function(){return"1"},Bt.SYM_A.get=function(){return"2"},zt.prototype.interfaces_=function(){return[]},zt.prototype.getClass=function(){return zt},zt.toDimensionSymbol=function(t){switch(t){case zt.FALSE:return zt.SYM_FALSE;case zt.TRUE:return zt.SYM_TRUE;case zt.DONTCARE:return zt.SYM_DONTCARE;case zt.P:return zt.SYM_P;case zt.L:return zt.SYM_L;case zt.A:return zt.SYM_A}throw new v("Unknown dimension value: "+t)},zt.toDimensionValue=function(t){switch(k.toUpperCase(t)){case zt.SYM_FALSE:return zt.FALSE;case zt.SYM_TRUE:return zt.TRUE;case zt.SYM_DONTCARE:return zt.DONTCARE;case zt.SYM_P:return zt.P;case zt.SYM_L:return zt.L;case zt.SYM_A:return zt.A}throw new v("Unknown dimension symbol: "+t)},Object.defineProperties(zt,Bt);var jt=function(){};jt.prototype.filter=function(t){},jt.prototype.interfaces_=function(){return[]},jt.prototype.getClass=function(){return jt};var Ut=function(){};Ut.prototype.filter=function(t,e){},Ut.prototype.isDone=function(){},Ut.prototype.isGeometryChanged=function(){},Ut.prototype.interfaces_=function(){return[]},Ut.prototype.getClass=function(){return Ut};var Vt=function(t){function e(e,n){if(t.call(this,n),this._geometries=e||[],t.hasNullElements(this._geometries))throw new v("geometries must not contain null elements")}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var t=new H,e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t},e.prototype.getGeometryN=function(t){return this._geometries[t]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=0;n<this._geometries.length;n++)for(var i=this._geometries[n].getCoordinates(),r=0;r<i.length;r++)t[++e]=i[r];return t},e.prototype.getArea=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._geometries.length!==i._geometries.length)return!1;for(var r=0;r<this._geometries.length;r++)if(!this._geometries[r].equalsExact(i._geometries[r],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Ft.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var t=zt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t},e.prototype.getDimension=function(){for(var t=zt.FALSE,e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t},e.prototype.getLength=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=0,e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createGeometryCollection(e)},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=new d(Ft.asList(this._geometries)),n=new d(Ft.asList(t._geometries));return this.compare(e,n)}if(2===arguments.length){for(var i=arguments[1],r=arguments[0],o=this.getNumGeometries(),s=r.getNumGeometries(),a=0;a<o&&a<s;){var l=this.getGeometryN(a),u=r.getGeometryN(a),c=l.compareToSameClass(u,i);if(0!==c)return c;a++}return a<o?1:a<s?-1:0}},e.prototype.apply=function(){if(L(arguments[0],dt))for(var t=arguments[0],e=0;e<this._geometries.length;e++)this._geometries[e].apply(t);else if(L(arguments[0],Ut)){var n=arguments[0];if(0===this._geometries.length)return null;for(var i=0;i<this._geometries.length&&(this._geometries[i].apply(n),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else if(L(arguments[0],jt)){var r=arguments[0];r.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(r)}else if(L(arguments[0],ut)){var s=arguments[0];s.filter(this);for(var a=0;a<this._geometries.length;a++)this._geometries[a].apply(s)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),et.shouldNeverReachHere(),null},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._geometries=new Array(this._geometries.length).fill(null);for(var n=0;n<this._geometries.length;n++)e._geometries[n]=this._geometries[n].clone();return e},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.isEmpty=function(){for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x4f07bcb1f857d800},Object.defineProperties(e,n),e}(ct),Gt=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?zt.FALSE:0},e.prototype.isClosed=function(){if(this.isEmpty())return!1;for(var t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[t-1-n]=this._geometries[n].reverse();return this.getFactory().createMultiLineString(e)},e.prototype.getBoundary=function(){return new qt(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[kt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x7155d2ab4afa8000},Object.defineProperties(e,n),e}(Vt),qt=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,1===arguments.length){var t=arguments[0],e=pt.MOD2_BOUNDARY_RULE;this._geom=t,this._geomFact=t.getFactory(),this._bnRule=e}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this._geom=n,this._geomFact=n.getFactory(),this._bnRule=i}};qt.prototype.boundaryMultiLineString=function(t){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var e=this.computeBoundaryCoordinates(t);return 1===e.length?this._geomFact.createPoint(e[0]):this._geomFact.createMultiPointFromCoords(e)},qt.prototype.getBoundary=function(){return this._geom instanceof Zt?this.boundaryLineString(this._geom):this._geom instanceof Gt?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()},qt.prototype.boundaryLineString=function(t){return this._geom.isEmpty()?this.getEmptyMultiPoint():t.isClosed()?this._bnRule.isInBoundary(2)?t.getStartPoint():this._geomFact.createMultiPoint():this._geomFact.createMultiPoint([t.getStartPoint(),t.getEndPoint()])},qt.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()},qt.prototype.computeBoundaryCoordinates=function(t){var e=new Et;this._endpointMap=new h;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);0!==i.getNumPoints()&&(this.addEndpoint(i.getCoordinateN(0)),this.addEndpoint(i.getCoordinateN(i.getNumPoints()-1)))}for(var r=this._endpointMap.entrySet().iterator();r.hasNext();){var o=r.next(),s=o.getValue().count;this._bnRule.isInBoundary(s)&&e.add(o.getKey())}return Ct.toCoordinateArray(e)},qt.prototype.addEndpoint=function(t){var e=this._endpointMap.get(t);null===e&&(e=new Wt,this._endpointMap.put(t,e)),e.count++},qt.prototype.interfaces_=function(){return[]},qt.prototype.getClass=function(){return qt},qt.getBoundary=function(){return 1===arguments.length?new qt(arguments[0]).getBoundary():2===arguments.length?new qt(arguments[0],arguments[1]).getBoundary():void 0};var Wt=function(){this.count=null};Wt.prototype.interfaces_=function(){return[]},Wt.prototype.getClass=function(){return Wt};var Ht=function(){},Xt={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Ht.prototype.interfaces_=function(){return[]},Ht.prototype.getClass=function(){return Ht},Ht.chars=function(t,e){for(var n=new Array(e).fill(null),i=0;i<e;i++)n[i]=t;return String(n)},Ht.getStackTrace=function(){if(1===arguments.length){var t=arguments[0],e=new function(){},n=new function(){}(e);return t.printStackTrace(n),e.toString()}if(2===arguments.length){for(var i=arguments[0],r=arguments[1],o="",s=new function(){}(new function(){}(Ht.getStackTrace(i))),a=0;a<r;a++)try{o+=s.readLine()+Ht.NEWLINE}catch(t){if(!(t instanceof p))throw t;et.shouldNeverReachHere()}return o}},Ht.split=function(t,e){for(var n=e.length,i=new Et,r=""+t,o=r.indexOf(e);o>=0;){var s=r.substring(0,o);i.add(s),o=(r=r.substring(o+n)).indexOf(e)}r.length>0&&i.add(r);for(var a=new Array(i.size()).fill(null),l=0;l<a.length;l++)a[l]=i.get(l);return a},Ht.toString=function(){if(1===arguments.length){var t=arguments[0];return Ht.SIMPLE_ORDINATE_FORMAT.format(t)}},Ht.spaces=function(t){return Ht.chars(" ",t)},Xt.NEWLINE.get=function(){return q.getProperty("line.separator")},Xt.SIMPLE_ORDINATE_FORMAT.get=function(){return new function(){}("0.#")},Object.defineProperties(Ht,Xt);var Yt=function(){};Yt.prototype.interfaces_=function(){return[]},Yt.prototype.getClass=function(){return Yt},Yt.copyCoord=function(t,e,n,i){for(var r=Math.min(t.getDimension(),n.getDimension()),o=0;o<r;o++)n.setOrdinate(i,o,t.getOrdinate(e,o))},Yt.isRing=function(t){var e=t.size();return 0===e||!(e<=3)&&t.getOrdinate(0,j.X)===t.getOrdinate(e-1,j.X)&&t.getOrdinate(0,j.Y)===t.getOrdinate(e-1,j.Y)},Yt.isEqual=function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),r=0;r<n;r++)for(var o=0;o<i;o++){var s=t.getOrdinate(r,o),a=e.getOrdinate(r,o);if(!(t.getOrdinate(r,o)===e.getOrdinate(r,o)||_.isNaN(s)&&_.isNaN(a)))return!1}return!0},Yt.extend=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();if(Yt.copy(e,0,i,0,r),r>0)for(var o=r;o<n;o++)Yt.copy(e,r-1,i,o,1);return i},Yt.reverse=function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)Yt.swap(t,i,e-i)},Yt.swap=function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var r=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,r)}},Yt.copy=function(t,e,n,i,r){for(var o=0;o<r;o++)Yt.copyCoord(t,e+o,n,i+o)},Yt.toString=function(){if(1===arguments.length){var t=arguments[0],e=t.size();if(0===e)return"()";var n=t.getDimension(),i=new N;i.append("(");for(var r=0;r<e;r++){r>0&&i.append(" ");for(var o=0;o<n;o++)o>0&&i.append(","),i.append(Ht.toString(t.getOrdinate(r,o)))}return i.append(")"),i.toString()}},Yt.ensureValidRing=function(t,e){var n=e.size();return 0===n?e:n<=3?Yt.createClosedRing(t,e,4):e.getOrdinate(0,j.X)===e.getOrdinate(n-1,j.X)&&e.getOrdinate(0,j.Y)===e.getOrdinate(n-1,j.Y)?e:Yt.createClosedRing(t,e,n+1)},Yt.createClosedRing=function(t,e,n){var i=t.create(n,e.getDimension()),r=e.size();Yt.copy(e,0,i,0,r);for(var o=r;o<n;o++)Yt.copy(e,0,i,o,1);return i};var Zt=function(t){function e(e,n){t.call(this,n),this._points=null,this.init(e)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new H:this._points.expandEnvelope(new H)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e;if(this._points.size()!==i._points.size())return!1;for(var r=0;r<this._points.size();r++)if(!this.equal(this._points.getCoordinate(r),i._points.getCoordinate(r),n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var t=0;t<Math.trunc(this._points.size()/2);t++){var e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e)))return this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0&&Yt.reverse(this._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?zt.FALSE:0},e.prototype.isClosed=function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return at.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var t=this._points.copy();return Yt.reverse(t),this.getFactory().createLineString(t)},e.prototype.compareToSameClass=function(){if(1===arguments.length){for(var t=arguments[0],e=0,n=0;e<this._points.size()&&n<t._points.size();){var i=this._points.getCoordinate(e).compareTo(t._points.getCoordinate(n));if(0!==i)return i;e++,n++}return e<this._points.size()?1:n<t._points.size()?-1:0}if(2===arguments.length){var r=arguments[0];return arguments[1].compare(this._points,r._points)}},e.prototype.apply=function(){if(L(arguments[0],dt))for(var t=arguments[0],e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e));else if(L(arguments[0],Ut)){var n=arguments[0];if(0===this._points.size())return null;for(var i=0;i<this._points.size()&&(n.filter(this._points,i),!n.isDone());i++);n.isGeometryChanged()&&this.geometryChanged()}else(L(arguments[0],jt)||L(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return new qt(this).getBoundary()},e.prototype.isEquivalentClass=function(t){return t instanceof e},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._points=this._points.clone(),e},e.prototype.getCoordinateN=function(t){return this._points.getCoordinate(t)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return 0===this._points.size()},e.prototype.init=function(t){if(null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),1===t.size())throw new v("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t},e.prototype.isCoordinate=function(t){for(var e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(t){return this.getFactory().createPoint(this._points.getCoordinate(t))},e.prototype.interfaces_=function(){return[kt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(ct),Kt=function(){};Kt.prototype.interfaces_=function(){return[]},Kt.prototype.getClass=function(){return Kt};var $t=function(t){function e(e,n){t.call(this,n),this._coordinates=e||null,this.init(this._coordinates)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new H;var t=new H;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&(!(!this.isEmpty()||!e.isEmpty())||this.isEmpty()===e.isEmpty()&&this.equal(e.getCoordinate(),this.getCoordinate(),n))}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return 0!==this._coordinates.size()?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return zt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(null===this.getCoordinate())throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0];return this.getCoordinate().compareTo(t.getCoordinate())}if(2===arguments.length){var e=arguments[0];return arguments[1].compare(this._coordinates,e._coordinates)}},e.prototype.apply=function(){if(L(arguments[0],dt)){var t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(L(arguments[0],Ut)){var e=arguments[0];if(this.isEmpty())return null;e.filter(this._coordinates,0),e.isGeometryChanged()&&this.geometryChanged()}else(L(arguments[0],jt)||L(arguments[0],ut))&&arguments[0].filter(this)},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);return e._coordinates=this._coordinates.clone(),e},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(null===this.getCoordinate())throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return 0===this._coordinates.size()},e.prototype.init=function(t){null===t&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),et.isTrue(t.size()<=1),this._coordinates=t},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Kt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x44077bad161cbc00},Object.defineProperties(e,n),e}(ct),Qt=function(){};Qt.prototype.interfaces_=function(){return[]},Qt.prototype.getClass=function(){return Qt};var Jt=function(t){function e(e,n,i){if(t.call(this,i),this._shell=null,this._holes=null,null===e&&(e=this.getFactory().createLinearRing()),null===n&&(n=[]),t.hasNullElements(n))throw new v("holes must not contain null elements");if(e.isEmpty()&&t.hasNonEmptyElements(n))throw new v("shell is empty but holes are not");this._shell=e,this._holes=n}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){if(this.isEmpty())return[];for(var t=new Array(this.getNumPoints()).fill(null),e=-1,n=this._shell.getCoordinates(),i=0;i<n.length;i++)t[++e]=n[i];for(var r=0;r<this._holes.length;r++)for(var o=this._holes[r].getCoordinates(),s=0;s<o.length;s++)t[++e]=o[s];return t},e.prototype.getArea=function(){var t=0;t+=Math.abs(at.signedArea(this._shell.getCoordinateSequence()));for(var e=0;e<this._holes.length;e++)t-=Math.abs(at.signedArea(this._holes[e].getCoordinateSequence()));return t},e.prototype.isRectangle=function(){if(0!==this.getNumInteriorRing())return!1;if(null===this._shell)return!1;if(5!==this._shell.getNumPoints())return!1;for(var t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal(),n=0;n<5;n++){var i=t.getX(n);if(i!==e.getMinX()&&i!==e.getMaxX())return!1;var r=t.getY(n);if(r!==e.getMinY()&&r!==e.getMaxY())return!1}for(var o=t.getX(0),s=t.getY(0),a=1;a<=4;a++){var l=t.getX(a),u=t.getY(a);if(l!==o==(u!==s))return!1;o=l,s=u}return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];if(!this.isEquivalentClass(e))return!1;var i=e,r=this._shell,o=i._shell;if(!r.equalsExact(o,n))return!1;if(this._holes.length!==i._holes.length)return!1;for(var s=0;s<this._holes.length;s++)if(!this._holes[s].equalsExact(i._holes[s],n))return!1;return!0}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){if(0===arguments.length){this.normalize(this._shell,!0);for(var t=0;t<this._holes.length;t++)this.normalize(this._holes[t],!1);Ft.sort(this._holes)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(e.isEmpty())return null;var i=new Array(e.getCoordinates().length-1).fill(null);q.arraycopy(e.getCoordinates(),0,i,0,i.length);var r=Ct.minCoordinate(e.getCoordinates());Ct.scroll(i,r),q.arraycopy(i,0,e.getCoordinates(),0,i.length),e.getCoordinates()[i.length]=i[0],at.isCCW(e.getCoordinates())===n&&Ct.reverse(e.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var t=0;t+=this._shell.getLength();for(var e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t},e.prototype.getNumPoints=function(){for(var t=this._shell.getNumPoints(),e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t},e.prototype.reverse=function(){var t=this.copy();t._shell=this._shell.copy().reverse(),t._holes=new Array(this._holes.length).fill(null);for(var e=0;e<this._holes.length;e++)t._holes[e]=this._holes[e].copy().reverse();return t},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){if(1===arguments.length){var t=arguments[0],e=this._shell,n=t._shell;return e.compareToSameClass(n)}if(2===arguments.length){var i=arguments[1],r=arguments[0],o=this._shell,s=r._shell,a=o.compareToSameClass(s,i);if(0!==a)return a;for(var l=this.getNumInteriorRing(),u=r.getNumInteriorRing(),c=0;c<l&&c<u;){var h=this.getInteriorRingN(c),f=r.getInteriorRingN(c),d=h.compareToSameClass(f,i);if(0!==d)return d;c++}return c<l?1:c<u?-1:0}},e.prototype.apply=function(t){if(L(t,dt)){this._shell.apply(t);for(var e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(L(t,Ut)){if(this._shell.apply(t),!t.isDone())for(var n=0;n<this._holes.length&&(this._holes[n].apply(t),!t.isDone());n++);t.isGeometryChanged()&&this.geometryChanged()}else if(L(t,jt))t.filter(this);else if(L(t,ut)){t.filter(this),this._shell.apply(t);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(t)}},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(var e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)},e.prototype.clone=function(){var e=t.prototype.clone.call(this);e._shell=this._shell.clone(),e._holes=new Array(this._holes.length).fill(null);for(var n=0;n<this._holes.length;n++)e._holes[n]=this._holes[n].clone();return e},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var t=this._shell.copy(),n=new Array(this._holes.length).fill(null),i=0;i<n.length;i++)n[i]=this._holes[i].copy();return new e(t,n,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(t){return this._holes[t]},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(ct),te=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(1===arguments.length){var e=arguments[0];return this._geometries[e].getCoordinate()}return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return zt.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Kt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x6fb1ed4162e0fc00},Object.defineProperties(e,n),e}(Vt),ee=function(t){function e(e,n){e instanceof S&&n instanceof ye&&(e=n.getCoordinateSequenceFactory().create(e)),t.call(this,e,n),this.validateConstruction()}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return zt.FALSE},e.prototype.isClosed=function(){return!!this.isEmpty()||t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var t=this._points.copy();return Yt.reverse(t),this.getFactory().createLinearRing(t)},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new v("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new v("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(Zt),ne=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ct.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return!!this.isEquivalentClass(e)&&t.prototype.equalsExact.call(this,e,n)}return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var t=this._geometries.length,e=new Array(t).fill(null),n=0;n<this._geometries.length;n++)e[n]=this._geometries[n].reverse();return this.getFactory().createMultiPolygon(e)},e.prototype.getBoundary=function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var t=new Et,e=0;e<this._geometries.length;e++)for(var n=this._geometries[e].getBoundary(),i=0;i<n.getNumGeometries();i++)t.add(n.getGeometryN(i));var r=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(r))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var t=new Array(this._geometries.length).fill(null),n=0;n<t.length;n++)t[n]=this._geometries[n].copy();return new e(t,this._factory)},e.prototype.interfaces_=function(){return[Qt]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Vt),ie=function(t){this._factory=t||null,this._isUserDataCopied=!1},re={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};ie.prototype.setCopyUserData=function(t){this._isUserDataCopied=t},ie.prototype.edit=function(t,e){if(null===t)return null;var n=this.editInternal(t,e);return this._isUserDataCopied&&n.setUserData(t.getUserData()),n},ie.prototype.editInternal=function(t,e){return null===this._factory&&(this._factory=t.getFactory()),t instanceof Vt?this.editGeometryCollection(t,e):t instanceof Jt?this.editPolygon(t,e):t instanceof $t||t instanceof Zt?e.edit(t,this._factory):(et.shouldNeverReachHere("Unsupported Geometry class: "+t.getClass().getName()),null)},ie.prototype.editGeometryCollection=function(t,e){for(var n=e.edit(t,this._factory),i=new Et,r=0;r<n.getNumGeometries();r++){var o=this.edit(n.getGeometryN(r),e);null===o||o.isEmpty()||i.add(o)}return n.getClass()===te?this._factory.createMultiPoint(i.toArray([])):n.getClass()===Gt?this._factory.createMultiLineString(i.toArray([])):n.getClass()===ne?this._factory.createMultiPolygon(i.toArray([])):this._factory.createGeometryCollection(i.toArray([]))},ie.prototype.editPolygon=function(t,e){var n=e.edit(t,this._factory);if(null===n&&(n=this._factory.createPolygon(null)),n.isEmpty())return n;var i=this.edit(n.getExteriorRing(),e);if(null===i||i.isEmpty())return this._factory.createPolygon();for(var r=new Et,o=0;o<n.getNumInteriorRing();o++){var s=this.edit(n.getInteriorRingN(o),e);null===s||s.isEmpty()||r.add(s)}return this._factory.createPolygon(i,r.toArray([]))},ie.prototype.interfaces_=function(){return[]},ie.prototype.getClass=function(){return ie},ie.GeometryEditorOperation=function(){},re.NoOpGeometryOperation.get=function(){return oe},re.CoordinateOperation.get=function(){return se},re.CoordinateSequenceOperation.get=function(){return ae},Object.defineProperties(ie,re);var oe=function(){};oe.prototype.edit=function(t,e){return t},oe.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},oe.prototype.getClass=function(){return oe};var se=function(){};se.prototype.edit=function(t,e){var n=this.editCoordinates(t.getCoordinates(),t);return null===n?t:t instanceof ee?e.createLinearRing(n):t instanceof Zt?e.createLineString(n):t instanceof $t?n.length>0?e.createPoint(n[0]):e.createPoint():t},se.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},se.prototype.getClass=function(){return se};var ae=function(){};ae.prototype.edit=function(t,e){return t instanceof ee?e.createLinearRing(this.edit(t.getCoordinateSequence(),t)):t instanceof Zt?e.createLineString(this.edit(t.getCoordinateSequence(),t)):t instanceof $t?e.createPoint(this.edit(t.getCoordinateSequence(),t)):t},ae.prototype.interfaces_=function(){return[ie.GeometryEditorOperation]},ae.prototype.getClass=function(){return ae};var le=function(){if(this._dimension=3,this._coordinates=null,1===arguments.length){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var t=arguments[0];this._coordinates=new Array(t).fill(null);for(var e=0;e<t;e++)this._coordinates[e]=new S}else if(L(arguments[0],j)){var n=arguments[0];if(null===n)return this._coordinates=new Array(0).fill(null),null;this._dimension=n.getDimension(),this._coordinates=new Array(n.size()).fill(null);for(var i=0;i<this._coordinates.length;i++)this._coordinates[i]=n.getCoordinateCopy(i)}}else if(2===arguments.length)if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var r=arguments[0],o=arguments[1];this._coordinates=r,this._dimension=o,null===r&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var s=arguments[0],a=arguments[1];this._coordinates=new Array(s).fill(null),this._dimension=a;for(var l=0;l<s;l++)this._coordinates[l]=new S}},ue={serialVersionUID:{configurable:!0}};le.prototype.setOrdinate=function(t,e,n){switch(e){case j.X:this._coordinates[t].x=n;break;case j.Y:this._coordinates[t].y=n;break;case j.Z:this._coordinates[t].z=n;break;default:throw new v("invalid ordinateIndex")}},le.prototype.size=function(){return this._coordinates.length},le.prototype.getOrdinate=function(t,e){switch(e){case j.X:return this._coordinates[t].x;case j.Y:return this._coordinates[t].y;case j.Z:return this._coordinates[t].z}return _.NaN},le.prototype.getCoordinate=function(){if(1===arguments.length){var t=arguments[0];return this._coordinates[t]}if(2===arguments.length){var e=arguments[0],n=arguments[1];n.x=this._coordinates[e].x,n.y=this._coordinates[e].y,n.z=this._coordinates[e].z}},le.prototype.getCoordinateCopy=function(t){return new S(this._coordinates[t])},le.prototype.getDimension=function(){return this._dimension},le.prototype.getX=function(t){return this._coordinates[t].x},le.prototype.clone=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].clone();return new le(t,this._dimension)},le.prototype.expandEnvelope=function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t},le.prototype.copy=function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++)t[e]=this._coordinates[e].copy();return new le(t,this._dimension)},le.prototype.toString=function(){if(this._coordinates.length>0){var t=new N(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"},le.prototype.getY=function(t){return this._coordinates[t].y},le.prototype.toCoordinateArray=function(){return this._coordinates},le.prototype.interfaces_=function(){return[j,e]},le.prototype.getClass=function(){return le},ue.serialVersionUID.get=function(){return-0xcb44a778db18e00},Object.defineProperties(le,ue);var ce=function(){},he={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};ce.prototype.readResolve=function(){return ce.instance()},ce.prototype.create=function(){if(1===arguments.length){if(arguments[0]instanceof Array)return new le(arguments[0]);if(L(arguments[0],j))return new le(arguments[0])}else if(2===arguments.length){var t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2?new le(t):new le(t,e)}},ce.prototype.interfaces_=function(){return[I,e]},ce.prototype.getClass=function(){return ce},ce.instance=function(){return ce.instanceObject},he.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00},he.instanceObject.get=function(){return new ce},Object.defineProperties(ce,he);var fe=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(t){return this.map_.get(t)||null},e.prototype.put=function(t,e){return this.map_.set(t,e),e},e.prototype.values=function(){for(var t=new Et,e=this.map_.values(),n=e.next();!n.done;)t.add(n.value),n=e.next();return t},e.prototype.entrySet=function(){var t=new Ot;return this.map_.entries().forEach((function(e){return t.add(e)})),t},e.prototype.size=function(){return this.map_.size()},e}(Lt),de=function t(){if(this._modelType=null,this._scale=null,0===arguments.length)this._modelType=t.FLOATING;else if(1===arguments.length)if(arguments[0]instanceof ge){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if("number"==typeof arguments[0]){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var i=arguments[0];this._modelType=i._modelType,this._scale=i._scale}},pe={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};de.prototype.equals=function(t){if(!(t instanceof de))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale},de.prototype.compareTo=function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return new R(n).compareTo(new R(i))},de.prototype.getScale=function(){return this._scale},de.prototype.isFloating=function(){return this._modelType===de.FLOATING||this._modelType===de.FLOATING_SINGLE},de.prototype.getType=function(){return this._modelType},de.prototype.toString=function(){var t="UNKNOWN";return this._modelType===de.FLOATING?t="Floating":this._modelType===de.FLOATING_SINGLE?t="Floating-Single":this._modelType===de.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t},de.prototype.makePrecise=function(){if("number"==typeof arguments[0]){var t=arguments[0];return _.isNaN(t)||this._modelType===de.FLOATING_SINGLE?t:this._modelType===de.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof S){var e=arguments[0];if(this._modelType===de.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}},de.prototype.getMaximumSignificantDigits=function(){var t=16;return this._modelType===de.FLOATING?t=16:this._modelType===de.FLOATING_SINGLE?t=6:this._modelType===de.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t},de.prototype.setScale=function(t){this._scale=Math.abs(t)},de.prototype.interfaces_=function(){return[e,x]},de.prototype.getClass=function(){return de},de.mostPrecise=function(t,e){return t.compareTo(e)>=0?t:e},pe.serialVersionUID.get=function(){return 0x6bee6404e9a25c00},pe.maximumPreciseValue.get=function(){return 9007199254740992},Object.defineProperties(de,pe);var ge=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},me={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};ge.prototype.readResolve=function(){return ge.nameToTypeMap.get(this._name)},ge.prototype.toString=function(){return this._name},ge.prototype.interfaces_=function(){return[e]},ge.prototype.getClass=function(){return ge},me.serialVersionUID.get=function(){return-552860263173159e4},me.nameToTypeMap.get=function(){return new fe},Object.defineProperties(ge,me),de.Type=ge,de.FIXED=new ge("FIXED"),de.FLOATING=new ge("FLOATING"),de.FLOATING_SINGLE=new ge("FLOATING SINGLE");var ye=function t(){this._precisionModel=new de,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),0===arguments.length||(1===arguments.length?L(arguments[0],I)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof de&&(this._precisionModel=arguments[0]):2===arguments.length?(this._precisionModel=arguments[0],this._SRID=arguments[1]):3===arguments.length&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},ve={serialVersionUID:{configurable:!0}};ye.prototype.toGeometry=function(t){return t.isNull()?this.createPoint(null):t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new S(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new S(t.getMinX(),t.getMinY()),new S(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new S(t.getMinX(),t.getMinY()),new S(t.getMinX(),t.getMaxY()),new S(t.getMaxX(),t.getMaxY()),new S(t.getMaxX(),t.getMinY()),new S(t.getMinX(),t.getMinY())]),null)},ye.prototype.createLineString=function(t){return t?t instanceof Array?new Zt(this.getCoordinateSequenceFactory().create(t),this):L(t,j)?new Zt(t,this):void 0:new Zt(this.getCoordinateSequenceFactory().create([]),this)},ye.prototype.createMultiLineString=function(){return 0===arguments.length?new Gt(null,this):1===arguments.length?new Gt(arguments[0],this):void 0},ye.prototype.buildGeometry=function(t){for(var e=null,n=!1,i=!1,r=t.iterator();r.hasNext();){var o=r.next(),s=o.getClass();null===e&&(e=s),s!==e&&(n=!0),o.isGeometryCollectionOrDerived()&&(i=!0)}if(null===e)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(ye.toGeometryArray(t));var a=t.iterator().next();if(t.size()>1){if(a instanceof Jt)return this.createMultiPolygon(ye.toPolygonArray(t));if(a instanceof Zt)return this.createMultiLineString(ye.toLineStringArray(t));if(a instanceof $t)return this.createMultiPoint(ye.toPointArray(t));et.shouldNeverReachHere("Unhandled class: "+a.getClass().getName())}return a},ye.prototype.createMultiPointFromCoords=function(t){return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)},ye.prototype.createPoint=function(){if(0===arguments.length)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof S){var t=arguments[0];return this.createPoint(null!==t?this.getCoordinateSequenceFactory().create([t]):null)}if(L(arguments[0],j))return new $t(arguments[0],this)}},ye.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory},ye.prototype.createPolygon=function(){if(0===arguments.length)return new Jt(null,null,this);if(1===arguments.length){if(L(arguments[0],j)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof ee){var n=arguments[0];return this.createPolygon(n,null)}}else if(2===arguments.length)return new Jt(arguments[0],arguments[1],this)},ye.prototype.getSRID=function(){return this._SRID},ye.prototype.createGeometryCollection=function(){return 0===arguments.length?new Vt(null,this):1===arguments.length?new Vt(arguments[0],this):void 0},ye.prototype.createGeometry=function(t){return new ie(this).edit(t,{edit:function(){if(2===arguments.length){var t=arguments[0];return this._coordinateSequenceFactory.create(t)}}})},ye.prototype.getPrecisionModel=function(){return this._precisionModel},ye.prototype.createLinearRing=function(){if(0===arguments.length)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(1===arguments.length){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(L(arguments[0],j))return new ee(arguments[0],this)}},ye.prototype.createMultiPolygon=function(){return 0===arguments.length?new ne(null,this):1===arguments.length?new ne(arguments[0],this):void 0},ye.prototype.createMultiPoint=function(){if(0===arguments.length)return new te(null,this);if(1===arguments.length){if(arguments[0]instanceof Array)return new te(arguments[0],this);if(arguments[0]instanceof Array){var t=arguments[0];return this.createMultiPoint(null!==t?this.getCoordinateSequenceFactory().create(t):null)}if(L(arguments[0],j)){var e=arguments[0];if(null===e)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),i=0;i<e.size();i++){var r=this.getCoordinateSequenceFactory().create(1,e.getDimension());Yt.copy(e,i,r,0,1),n[i]=this.createPoint(r)}return this.createMultiPoint(n)}}},ye.prototype.interfaces_=function(){return[e]},ye.prototype.getClass=function(){return ye},ye.toMultiPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toGeometryArray=function(t){if(null===t)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.getDefaultCoordinateSequenceFactory=function(){return ce.instance()},ye.toMultiLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toLineStringArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toMultiPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toLinearRingArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toPointArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.toPolygonArray=function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)},ye.createPointFromInternalCoord=function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)},ve.serialVersionUID.get=function(){return-0x5ea75f2051eeb400},Object.defineProperties(ye,ve);var _e=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],be=function(t){this.geometryFactory=t||new ye};be.prototype.read=function(t){var e,n=(e="string"==typeof t?JSON.parse(t):t).type;if(!xe[n])throw new Error("Unknown GeoJSON type: "+e.type);return-1!==_e.indexOf(n)?xe[n].apply(this,[e.coordinates]):"GeometryCollection"===n?xe[n].apply(this,[e.geometries]):xe[n].apply(this,[e])},be.prototype.write=function(t){var e=t.getGeometryType();if(!we[e])throw new Error("Geometry is not supported");return we[e].apply(this,[t])};var xe={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var i=t.geometry.type;if(!xe[i])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=xe.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e={};if(t.features){e.features=[];for(var n=0;n<t.features.length;++n)e.features.push(this.read(t.features[n]))}return t.bbox&&(e.bbox=this.parse.bbox.apply(this,[t.bbox])),e},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(new S(i[0],i[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new S(t[0],t[1]),new S(t[2],t[1]),new S(t[2],t[3]),new S(t[0],t[3]),new S(t[0],t[1])])},Point:function(t){var e=new S(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=[],n=0;n<t.length;++n)e.push(xe.Point.apply(this,[t[n]]));return this.geometryFactory.createMultiPoint(e)},LineString:function(t){var e=xe.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=[],n=0;n<t.length;++n)e.push(xe.LineString.apply(this,[t[n]]));return this.geometryFactory.createMultiLineString(e)},Polygon:function(t){for(var e=xe.coordinates.apply(this,[t[0]]),n=this.geometryFactory.createLinearRing(e),i=[],r=1;r<t.length;++r){var o=t[r],s=xe.coordinates.apply(this,[o]),a=this.geometryFactory.createLinearRing(s);i.push(a)}return this.geometryFactory.createPolygon(n,i)},MultiPolygon:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(xe.Polygon.apply(this,[i]))}return this.geometryFactory.createMultiPolygon(e)},GeometryCollection:function(t){for(var e=[],n=0;n<t.length;++n){var i=t[n];e.push(this.read(i))}return this.geometryFactory.createGeometryCollection(e)}},we={coordinate:function(t){return[t.x,t.y]},Point:function(t){return{type:"Point",coordinates:we.coordinate.apply(this,[t.getCoordinate()])}},MultiPoint:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=we.Point.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPoint",coordinates:e}},LineString:function(t){for(var e=[],n=t.getCoordinates(),i=0;i<n.length;++i){var r=n[i];e.push(we.coordinate.apply(this,[r]))}return{type:"LineString",coordinates:e}},MultiLineString:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=we.LineString.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiLineString",coordinates:e}},Polygon:function(t){var e=[],n=we.LineString.apply(this,[t._shell]);e.push(n.coordinates);for(var i=0;i<t._holes.length;++i){var r=t._holes[i],o=we.LineString.apply(this,[r]);e.push(o.coordinates)}return{type:"Polygon",coordinates:e}},MultiPolygon:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=we.Polygon.apply(this,[i]);e.push(r.coordinates)}return{type:"MultiPolygon",coordinates:e}},GeometryCollection:function(t){for(var e=[],n=0;n<t._geometries.length;++n){var i=t._geometries[n],r=i.getGeometryType();e.push(we[r].apply(this,[i]))}return{type:"GeometryCollection",geometries:e}}},Ee=function(t){this.geometryFactory=t||new ye,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new be(this.geometryFactory)};Ee.prototype.read=function(t){var e=this.parser.read(t);return this.precisionModel.getType()===de.FIXED&&this.reducePrecision(e),e},Ee.prototype.reducePrecision=function(t){var e,n;if(t.coordinate)this.precisionModel.makePrecise(t.coordinate);else if(t.points)for(e=0,n=t.points.length;e<n;e++)this.precisionModel.makePrecise(t.points[e]);else if(t.geometries)for(e=0,n=t.geometries.length;e<n;e++)this.reducePrecision(t.geometries[e])};var Se=function(){this.parser=new be(this.geometryFactory)};Se.prototype.write=function(t){return this.parser.write(t)};var Pe=function(){},Ce={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};Pe.prototype.interfaces_=function(){return[]},Pe.prototype.getClass=function(){return Pe},Pe.opposite=function(t){return t===Pe.LEFT?Pe.RIGHT:t===Pe.RIGHT?Pe.LEFT:t},Ce.ON.get=function(){return 0},Ce.LEFT.get=function(){return 1},Ce.RIGHT.get=function(){return 2},Object.defineProperties(Pe,Ce),(g.prototype=new Error).name="EmptyStackException",(m.prototype=new wt).add=function(t){return this.array_.push(t),!0},m.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]},m.prototype.push=function(t){return this.array_.push(t),t},m.prototype.pop=function(t){if(0===this.array_.length)throw new g;return this.array_.pop()},m.prototype.peek=function(){if(0===this.array_.length)throw new g;return this.array_[this.array_.length-1]},m.prototype.empty=function(){return 0===this.array_.length},m.prototype.isEmpty=function(){return this.empty()},m.prototype.search=function(t){return this.array_.indexOf(t)},m.prototype.size=function(){return this.array_.length},m.prototype.toArray=function(){for(var t=[],e=0,n=this.array_.length;e<n;e++)t.push(this.array_[e]);return t};var Ie=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Ie.prototype.getCoordinate=function(){return this._minCoord},Ie.prototype.getRightmostSide=function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n},Ie.prototype.findRightmostEdgeAtVertex=function(){var t=this._minDe.getEdge().getCoordinates();et.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=at.computeOrientation(this._minCoord,n,e),r=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===at.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===at.CLOCKWISE)&&(r=!0),r&&(this._minIndex=this._minIndex-1)},Ie.prototype.getRightmostSideOfSegment=function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length)return-1;if(n[e].y===n[e+1].y)return-1;var i=Pe.LEFT;return n[e].y<n[e+1].y&&(i=Pe.RIGHT),i},Ie.prototype.getEdge=function(){return this._orientedDe},Ie.prototype.checkForRightmostCoordinate=function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(null===this._minCoord||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])},Ie.prototype.findRightmostEdgeAtNode=function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)},Ie.prototype.findEdge=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}et.isTrue(0!==this._minIndex||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),0===this._minIndex?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===Pe.LEFT&&(this._orientedDe=this._minDe.getSym())},Ie.prototype.interfaces_=function(){return[]},Ie.prototype.getClass=function(){return Ie};var Te=function(t){function e(n,i){t.call(this,e.msgWithCoord(n,i)),this.pt=i?new S(i):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(t,e){return e?t:t+" [ "+e+" ]"},e}(J),Me=function(){this.array_=[]};Me.prototype.addLast=function(t){this.array_.push(t)},Me.prototype.removeFirst=function(){return this.array_.shift()},Me.prototype.isEmpty=function(){return 0===this.array_.length};var Le=function(){this._finder=null,this._dirEdgeList=new Et,this._nodes=new Et,this._rightMostCoord=null,this._env=null,this._finder=new Ie};Le.prototype.clearVisitedEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)},Le.prototype.getRightmostCoordinate=function(){return this._rightMostCoord},Le.prototype.computeNodeDepth=function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(null===e)throw new Te("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var r=t.getEdges().iterator();r.hasNext();){var o=r.next();o.setVisited(!0),this.copySymDepths(o)}},Le.prototype.computeDepth=function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.setEdgeDepths(Pe.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)},Le.prototype.create=function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()},Le.prototype.findResultEdges=function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(Pe.RIGHT)>=1&&e.getDepth(Pe.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}},Le.prototype.computeDepths=function(t){var e=new Ot,n=new Me,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var r=n.removeFirst();e.add(r),this.computeNodeDepth(r);for(var o=r.getEdges().iterator();o.hasNext();){var s=o.next().getSym();if(!s.isVisited()){var a=s.getNode();e.contains(a)||(n.addLast(a),e.add(a))}}}},Le.prototype.compareTo=function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0},Le.prototype.getEnvelope=function(){if(null===this._env){for(var t=new H,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env},Le.prototype.addReachable=function(t){var e=new m;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}},Le.prototype.copySymDepths=function(t){var e=t.getSym();e.setDepth(Pe.LEFT,t.getDepth(Pe.RIGHT)),e.setDepth(Pe.RIGHT,t.getDepth(Pe.LEFT))},Le.prototype.add=function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var r=i.getSym().getNode();r.isVisited()||e.push(r)}},Le.prototype.getNodes=function(){return this._nodes},Le.prototype.getDirectedEdges=function(){return this._dirEdgeList},Le.prototype.interfaces_=function(){return[x]},Le.prototype.getClass=function(){return Le};var Ae=function t(){if(this.location=null,1===arguments.length){if(arguments[0]instanceof Array){var e=arguments[0];this.init(e.length)}else if(Number.isInteger(arguments[0])){var n=arguments[0];this.init(1),this.location[Pe.ON]=n}else if(arguments[0]instanceof t){var i=arguments[0];if(this.init(i.location.length),null!==i)for(var r=0;r<this.location.length;r++)this.location[r]=i.location[r]}}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.init(3),this.location[Pe.ON]=o,this.location[Pe.LEFT]=s,this.location[Pe.RIGHT]=a}};Ae.prototype.setAllLocations=function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t},Ae.prototype.isNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==T.NONE)return!1;return!0},Ae.prototype.setAllLocationsIfNull=function(t){for(var e=0;e<this.location.length;e++)this.location[e]===T.NONE&&(this.location[e]=t)},Ae.prototype.isLine=function(){return 1===this.location.length},Ae.prototype.merge=function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[Pe.ON]=this.location[Pe.ON],e[Pe.LEFT]=T.NONE,e[Pe.RIGHT]=T.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===T.NONE&&n<t.location.length&&(this.location[n]=t.location[n])},Ae.prototype.getLocations=function(){return this.location},Ae.prototype.flip=function(){if(this.location.length<=1)return null;var t=this.location[Pe.LEFT];this.location[Pe.LEFT]=this.location[Pe.RIGHT],this.location[Pe.RIGHT]=t},Ae.prototype.toString=function(){var t=new N;return this.location.length>1&&t.append(T.toLocationSymbol(this.location[Pe.LEFT])),t.append(T.toLocationSymbol(this.location[Pe.ON])),this.location.length>1&&t.append(T.toLocationSymbol(this.location[Pe.RIGHT])),t.toString()},Ae.prototype.setLocations=function(t,e,n){this.location[Pe.ON]=t,this.location[Pe.LEFT]=e,this.location[Pe.RIGHT]=n},Ae.prototype.get=function(t){return t<this.location.length?this.location[t]:T.NONE},Ae.prototype.isArea=function(){return this.location.length>1},Ae.prototype.isAnyNull=function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===T.NONE)return!0;return!1},Ae.prototype.setLocation=function(){if(1===arguments.length){var t=arguments[0];this.setLocation(Pe.ON,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.location[e]=n}},Ae.prototype.init=function(t){this.location=new Array(t).fill(null),this.setAllLocations(T.NONE)},Ae.prototype.isEqualOnSide=function(t,e){return this.location[e]===t.location[e]},Ae.prototype.allPositionsEqual=function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0},Ae.prototype.interfaces_=function(){return[]},Ae.prototype.getClass=function(){return Ae};var Oe=function t(){if(this.elt=new Array(2).fill(null),1===arguments.length){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Ae(e),this.elt[1]=new Ae(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Ae(n.elt[0]),this.elt[1]=new Ae(n.elt[1])}}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.elt[0]=new Ae(T.NONE),this.elt[1]=new Ae(T.NONE),this.elt[i].setLocation(r)}else if(3===arguments.length){var o=arguments[0],s=arguments[1],a=arguments[2];this.elt[0]=new Ae(o,s,a),this.elt[1]=new Ae(o,s,a)}else if(4===arguments.length){var l=arguments[0],u=arguments[1],c=arguments[2],h=arguments[3];this.elt[0]=new Ae(T.NONE,T.NONE,T.NONE),this.elt[1]=new Ae(T.NONE,T.NONE,T.NONE),this.elt[l].setLocations(u,c,h)}};Oe.prototype.getGeometryCount=function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t},Oe.prototype.setAllLocations=function(t,e){this.elt[t].setAllLocations(e)},Oe.prototype.isNull=function(t){return this.elt[t].isNull()},Oe.prototype.setAllLocationsIfNull=function(){if(1===arguments.length){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}},Oe.prototype.isLine=function(t){return this.elt[t].isLine()},Oe.prototype.merge=function(t){for(var e=0;e<2;e++)null===this.elt[e]&&null!==t.elt[e]?this.elt[e]=new Ae(t.elt[e]):this.elt[e].merge(t.elt[e])},Oe.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()},Oe.prototype.getLocation=function(){if(1===arguments.length){var t=arguments[0];return this.elt[t].get(Pe.ON)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}},Oe.prototype.toString=function(){var t=new N;return null!==this.elt[0]&&(t.append("A:"),t.append(this.elt[0].toString())),null!==this.elt[1]&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()},Oe.prototype.isArea=function(){if(0===arguments.length)return this.elt[0].isArea()||this.elt[1].isArea();if(1===arguments.length){var t=arguments[0];return this.elt[t].isArea()}},Oe.prototype.isAnyNull=function(t){return this.elt[t].isAnyNull()},Oe.prototype.setLocation=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(Pe.ON,e)}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this.elt[n].setLocation(i,r)}},Oe.prototype.isEqualOnSide=function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)},Oe.prototype.allPositionsEqual=function(t,e){return this.elt[t].allPositionsEqual(e)},Oe.prototype.toLine=function(t){this.elt[t].isArea()&&(this.elt[t]=new Ae(this.elt[t].location[0]))},Oe.prototype.interfaces_=function(){return[]},Oe.prototype.getClass=function(){return Oe},Oe.toLineLabel=function(t){for(var e=new Oe(T.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e};var Ne=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new Et,this._pts=new Et,this._label=new Oe(T.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new Et,this._geometryFactory=null;var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()};Ne.prototype.computeRing=function(){if(null!==this._ring)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=at.isCCW(this._ring.getCoordinates())},Ne.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},Ne.prototype.computePoints=function(t){this._startDe=t;var e=t,n=!0;do{if(null===e)throw new Te("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new Te("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();et.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)},Ne.prototype.getLinearRing=function(){return this._ring},Ne.prototype.getCoordinate=function(t){return this._pts.get(t)},Ne.prototype.computeMaxNodeDegree=function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2},Ne.prototype.addPoints=function(t,e,n){var i=t.getCoordinates();if(e){var r=1;n&&(r=0);for(var o=r;o<i.length;o++)this._pts.add(i[o])}else{var s=i.length-2;n&&(s=i.length-1);for(var a=s;a>=0;a--)this._pts.add(i[a])}},Ne.prototype.isHole=function(){return this._isHole},Ne.prototype.setInResult=function(){var t=this._startDe;do{t.getEdge().setInResult(!0),t=t.getNext()}while(t!==this._startDe)},Ne.prototype.containsPoint=function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t))return!1;if(!at.isPointInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0},Ne.prototype.addHole=function(t){this._holes.add(t)},Ne.prototype.isShell=function(){return null===this._shell},Ne.prototype.getLabel=function(){return this._label},Ne.prototype.getEdges=function(){return this._edges},Ne.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree},Ne.prototype.getShell=function(){return this._shell},Ne.prototype.mergeLabel=function(){if(1===arguments.length){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(2===arguments.length){var e=arguments[1],n=arguments[0].getLocation(e,Pe.RIGHT);if(n===T.NONE)return null;if(this._label.getLocation(e)===T.NONE)return this._label.setLocation(e,n),null}},Ne.prototype.setShell=function(t){this._shell=t,null!==t&&t.addHole(this)},Ne.prototype.toPolygon=function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)},Ne.prototype.interfaces_=function(){return[]},Ne.prototype.getClass=function(){return Ne};var Re=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(t,e){t.setMinEdgeRing(e)},e.prototype.getNext=function(t){return t.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ne),ke=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var t=new Et,e=this._startDe;do{if(null===e.getMinEdgeRing()){var n=new Re(e,this._geometryFactory);t.add(n)}e=e.getNext()}while(e!==this._startDe);return t},e.prototype.setEdgeRing=function(t,e){t.setEdgeRing(e)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var t=this._startDe;do{t.getNode().getEdges().linkMinimalDirectedEdges(this),t=t.getNext()}while(t!==this._startDe)},e.prototype.getNext=function(t){return t.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ne),De=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._label=t}};De.prototype.setVisited=function(t){this._isVisited=t},De.prototype.setInResult=function(t){this._isInResult=t},De.prototype.isCovered=function(){return this._isCovered},De.prototype.isCoveredSet=function(){return this._isCoveredSet},De.prototype.setLabel=function(t){this._label=t},De.prototype.getLabel=function(){return this._label},De.prototype.setCovered=function(t){this._isCovered=t,this._isCoveredSet=!0},De.prototype.updateIM=function(t){et.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)},De.prototype.isInResult=function(){return this._isInResult},De.prototype.isVisited=function(){return this._isVisited},De.prototype.interfaces_=function(){return[]},De.prototype.getClass=function(){return De};var Fe=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var e=arguments[0],n=arguments[1];this._coord=e,this._edges=n,this._label=new Oe(0,T.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var t=this.getEdges().getEdges().iterator();t.hasNext();)if(t.next().getEdge().isInResult())return!0;return!1},e.prototype.isIsolated=function(){return 1===this._label.getGeometryCount()},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(t){t.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(t){},e.prototype.computeMergedLocation=function(t,e){var n=T.NONE;if(n=this._label.getLocation(e),!t.isNull(e)){var i=t.getLocation(e);n!==T.BOUNDARY&&(n=i)}return n},e.prototype.setLabel=function(){if(2!==arguments.length)return t.prototype.setLabel.apply(this,arguments);var e=arguments[0],n=arguments[1];null===this._label?this._label=new Oe(e,n):this._label.setLocation(e,n)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){if(arguments[0]instanceof e){var t=arguments[0];this.mergeLabel(t._label)}else if(arguments[0]instanceof Oe)for(var n=arguments[0],i=0;i<2;i++){var r=this.computeMergedLocation(n,i);this._label.getLocation(i)===T.NONE&&this._label.setLocation(i,r)}},e.prototype.add=function(t){this._edges.insert(t),t.setNode(this)},e.prototype.setLabelBoundary=function(t){if(null===this._label)return null;var e=T.NONE;null!==this._label&&(e=this._label.getLocation(t));var n=null;switch(e){case T.BOUNDARY:n=T.INTERIOR;break;case T.INTERIOR:default:n=T.BOUNDARY}this._label.setLocation(t,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(De),ze=function(){this.nodeMap=new h,this.nodeFact=null;var t=arguments[0];this.nodeFact=t};ze.prototype.find=function(t){return this.nodeMap.get(t)},ze.prototype.addNode=function(){if(arguments[0]instanceof S){var t=arguments[0],e=this.nodeMap.get(t);return null===e&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof Fe){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return null===i?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}},ze.prototype.print=function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)},ze.prototype.iterator=function(){return this.nodeMap.values().iterator()},ze.prototype.values=function(){return this.nodeMap.values()},ze.prototype.getBoundaryNodes=function(t){for(var e=new Et,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===T.BOUNDARY&&e.add(i)}return e},ze.prototype.add=function(t){var e=t.getCoordinate();this.addNode(e).add(t)},ze.prototype.interfaces_=function(){return[]},ze.prototype.getClass=function(){return ze};var Be=function(){},je={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};Be.prototype.interfaces_=function(){return[]},Be.prototype.getClass=function(){return Be},Be.isNorthern=function(t){return t===Be.NE||t===Be.NW},Be.isOpposite=function(t,e){return t!==e&&2==(t-e+4)%4},Be.commonHalfPlane=function(t,e){if(t===e)return t;if(2==(t-e+4)%4)return-1;var n=t<e?t:e;return 0===n&&3===(t>e?t:e)?3:n},Be.isInHalfPlane=function(t,e){return e===Be.SE?t===Be.SE||t===Be.SW:t===e||t===e+1},Be.quadrant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new v("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?Be.NE:Be.SE:e>=0?Be.NW:Be.SW}if(arguments[0]instanceof S&&arguments[1]instanceof S){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new v("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?Be.NE:Be.SE:i.y>=n.y?Be.NW:Be.SW}},je.NE.get=function(){return 0},je.NW.get=function(){return 1},je.SW.get=function(){return 2},je.SE.get=function(){return 3},Object.defineProperties(Be,je);var Ue=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,1===arguments.length){var t=arguments[0];this._edge=t}else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._edge=e,this.init(n,i),this._label=null}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this._edge=r,this.init(o,s),this._label=a}};Ue.prototype.compareDirection=function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:at.computeOrientation(t._p0,t._p1,this._p1)},Ue.prototype.getDy=function(){return this._dy},Ue.prototype.getCoordinate=function(){return this._p0},Ue.prototype.setNode=function(t){this._node=t},Ue.prototype.print=function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),r=n.substring(i+1);t.print("  "+r+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)},Ue.prototype.compareTo=function(t){var e=t;return this.compareDirection(e)},Ue.prototype.getDirectedCoordinate=function(){return this._p1},Ue.prototype.getDx=function(){return this._dx},Ue.prototype.getLabel=function(){return this._label},Ue.prototype.getEdge=function(){return this._edge},Ue.prototype.getQuadrant=function(){return this._quadrant},Ue.prototype.getNode=function(){return this._node},Ue.prototype.toString=function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label},Ue.prototype.computeLabel=function(t){},Ue.prototype.init=function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=Be.quadrant(this._dx,this._dy),et.isTrue(!(0===this._dx&&0===this._dy),"EdgeEnd with identical endpoints found")},Ue.prototype.interfaces_=function(){return[x]},Ue.prototype.getClass=function(){return Ue};var Ve=function(t){function e(){var e=arguments[0],n=arguments[1];if(t.call(this,e),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=n,n)this.init(e.getCoordinate(0),e.getCoordinate(1));else{var i=e.getNumPoints()-1;this.init(e.getCoordinate(i),e.getCoordinate(i-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(t){return this._depth[t]},e.prototype.setVisited=function(t){this._isVisited=t},e.prototype.computeDirectedLabel=function(){this._label=new Oe(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(t,e){if(-999!==this._depth[t]&&this._depth[t]!==e)throw new Te("assigned depths do not match",this.getCoordinate());this._depth[t]=e},e.prototype.isInteriorAreaEdge=function(){for(var t=!0,e=0;e<2;e++)this._label.isArea(e)&&this._label.getLocation(e,Pe.LEFT)===T.INTERIOR&&this._label.getLocation(e,Pe.RIGHT)===T.INTERIOR||(t=!1);return t},e.prototype.setNextMin=function(t){this._nextMin=t},e.prototype.print=function(e){t.prototype.print.call(this,e),e.print(" "+this._depth[Pe.LEFT]+"/"+this._depth[Pe.RIGHT]),e.print(" ("+this.getDepthDelta()+")"),this._isInResult&&e.print(" inResult")},e.prototype.setMinEdgeRing=function(t){this._minEdgeRing=t},e.prototype.isLineEdge=function(){var t=this._label.isLine(0)||this._label.isLine(1),e=!this._label.isArea(0)||this._label.allPositionsEqual(0,T.EXTERIOR),n=!this._label.isArea(1)||this._label.allPositionsEqual(1,T.EXTERIOR);return t&&e&&n},e.prototype.setEdgeRing=function(t){this._edgeRing=t},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var t=this._edge.getDepthDelta();return this._isForward||(t=-t),t},e.prototype.setInResult=function(t){this._isInResult=t},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(t){this.print(t),t.print(" "),this._isForward?this._edge.print(t):this._edge.printReverse(t)},e.prototype.setSym=function(t){this._sym=t},e.prototype.setVisitedEdge=function(t){this.setVisited(t),this._sym.setVisited(t)},e.prototype.setEdgeDepths=function(t,e){var n=this.getEdge().getDepthDelta();this._isForward||(n=-n);var i=1;t===Pe.LEFT&&(i=-1);var r=Pe.opposite(t),o=e+n*i;this.setDepth(t,e),this.setDepth(r,o)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(t){this._next=t},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(t,e){return t===T.EXTERIOR&&e===T.INTERIOR?1:t===T.INTERIOR&&e===T.EXTERIOR?-1:0},e}(Ue),Ge=function(){};Ge.prototype.createNode=function(t){return new Fe(t,null)},Ge.prototype.interfaces_=function(){return[]},Ge.prototype.getClass=function(){return Ge};var qe=function(){if(this._edges=new Et,this._nodes=null,this._edgeEndList=new Et,0===arguments.length)this._nodes=new ze(new Ge);else if(1===arguments.length){var t=arguments[0];this._nodes=new ze(t)}};qe.prototype.printEdges=function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}},qe.prototype.find=function(t){return this._nodes.find(t)},qe.prototype.addNode=function(){if(arguments[0]instanceof Fe){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof S){var e=arguments[0];return this._nodes.addNode(e)}},qe.prototype.getNodeIterator=function(){return this._nodes.iterator()},qe.prototype.linkResultDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()},qe.prototype.debugPrintln=function(t){q.out.println(t)},qe.prototype.isBoundaryNode=function(t,e){var n=this._nodes.find(e);if(null===n)return!1;var i=n.getLabel();return null!==i&&i.getLocation(t)===T.BOUNDARY},qe.prototype.linkAllDirectedEdges=function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()},qe.prototype.matchInSameDirection=function(t,e,n,i){return!!t.equals(n)&&at.computeOrientation(t,e,i)===at.COLLINEAR&&Be.quadrant(t,e)===Be.quadrant(n,i)},qe.prototype.getEdgeEnds=function(){return this._edgeEndList},qe.prototype.debugPrint=function(t){q.out.print(t)},qe.prototype.getEdgeIterator=function(){return this._edges.iterator()},qe.prototype.findEdgeInSameDirection=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(this.matchInSameDirection(t,e,r[0],r[1]))return i;if(this.matchInSameDirection(t,e,r[r.length-1],r[r.length-2]))return i}return null},qe.prototype.insertEdge=function(t){this._edges.add(t)},qe.prototype.findEdgeEnd=function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null},qe.prototype.addEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new Ve(n,!0),r=new Ve(n,!1);i.setSym(r),r.setSym(i),this.add(i),this.add(r)}},qe.prototype.add=function(t){this._nodes.add(t),this._edgeEndList.add(t)},qe.prototype.getNodes=function(){return this._nodes.values()},qe.prototype.findEdge=function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),r=i.getCoordinates();if(t.equals(r[0])&&e.equals(r[1]))return i}return null},qe.prototype.interfaces_=function(){return[]},qe.prototype.getClass=function(){return qe},qe.linkResultDirectedEdges=function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()};var We=function(){this._geometryFactory=null,this._shellList=new Et;var t=arguments[0];this._geometryFactory=t};We.prototype.sortShellsAndHoles=function(t,e,n){for(var i=t.iterator();i.hasNext();){var r=i.next();r.isHole()?n.add(r):e.add(r)}},We.prototype.computePolygons=function(t){for(var e=new Et,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e},We.prototype.placeFreeHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(null===i.getShell()){var r=this.findEdgeRingContaining(i,t);if(null===r)throw new Te("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(r)}}},We.prototype.buildMinimalEdgeRings=function(t,e,n){for(var i=new Et,r=t.iterator();r.hasNext();){var o=r.next();if(o.getMaxNodeDegree()>2){o.linkDirectedEdgesForMinimalEdgeRings();var s=o.buildMinimalRings(),a=this.findShell(s);null!==a?(this.placePolygonHoles(a,s),e.add(a)):n.addAll(s)}else i.add(o)}return i},We.prototype.containsPoint=function(t){for(var e=this._shellList.iterator();e.hasNext();)if(e.next().containsPoint(t))return!0;return!1},We.prototype.buildMaximalEdgeRings=function(t){for(var e=new Et,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&null===i.getEdgeRing()){var r=new ke(i,this._geometryFactory);e.add(r),r.setInResult()}}return e},We.prototype.placePolygonHoles=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}},We.prototype.getPolygons=function(){return this.computePolygons(this._shellList)},We.prototype.findEdgeRingContaining=function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),r=n.getCoordinateN(0),o=null,s=null,a=e.iterator();a.hasNext();){var l=a.next(),u=l.getLinearRing(),c=u.getEnvelopeInternal();null!==o&&(s=o.getLinearRing().getEnvelopeInternal());var h=!1;c.contains(i)&&at.isPointInRing(r,u.getCoordinates())&&(h=!0),h&&(null===o||s.contains(c))&&(o=l)}return o},We.prototype.findShell=function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var r=i.next();r.isHole()||(n=r,e++)}return et.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n},We.prototype.add=function(){if(1===arguments.length){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(2===arguments.length){var e=arguments[0],n=arguments[1];qe.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),r=new Et,o=this.buildMinimalEdgeRings(i,this._shellList,r);this.sortShellsAndHoles(o,this._shellList,r),this.placeFreeHoles(this._shellList,r)}},We.prototype.interfaces_=function(){return[]},We.prototype.getClass=function(){return We};var He=function(){};He.prototype.getBounds=function(){},He.prototype.interfaces_=function(){return[]},He.prototype.getClass=function(){return He};var Xe=function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e};Xe.prototype.getItem=function(){return this._item},Xe.prototype.getBounds=function(){return this._bounds},Xe.prototype.interfaces_=function(){return[He,e]},Xe.prototype.getClass=function(){return Xe};var Ye=function(){this._size=null,this._items=null,this._size=0,this._items=new Et,this._items.add(null)};Ye.prototype.poll=function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t},Ye.prototype.size=function(){return this._size},Ye.prototype.reorder=function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)},Ye.prototype.clear=function(){this._size=0,this._items.clear()},Ye.prototype.isEmpty=function(){return 0===this._size},Ye.prototype.add=function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)},Ye.prototype.interfaces_=function(){return[]},Ye.prototype.getClass=function(){return Ye};var Ze=function(){};Ze.prototype.visitItem=function(t){},Ze.prototype.interfaces_=function(){return[]},Ze.prototype.getClass=function(){return Ze};var Ke=function(){};Ke.prototype.insert=function(t,e){},Ke.prototype.remove=function(t,e){},Ke.prototype.query=function(){},Ke.prototype.interfaces_=function(){return[]},Ke.prototype.getClass=function(){return Ke};var $e=function(){if(this._childBoundables=new Et,this._bounds=null,this._level=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this._level=t}},Qe={serialVersionUID:{configurable:!0}};$e.prototype.getLevel=function(){return this._level},$e.prototype.size=function(){return this._childBoundables.size()},$e.prototype.getChildBoundables=function(){return this._childBoundables},$e.prototype.addChildBoundable=function(t){et.isTrue(null===this._bounds),this._childBoundables.add(t)},$e.prototype.isEmpty=function(){return this._childBoundables.isEmpty()},$e.prototype.getBounds=function(){return null===this._bounds&&(this._bounds=this.computeBounds()),this._bounds},$e.prototype.interfaces_=function(){return[He,e]},$e.prototype.getClass=function(){return $e},Qe.serialVersionUID.get=function(){return 0x5a1e55ec41369800},Object.defineProperties($e,Qe);var Je=function(){};Je.reverseOrder=function(){return{compare:function(t,e){return e.compareTo(t)}}},Je.min=function(t){return Je.sort(t),t.get(0)},Je.sort=function(t,e){var n=t.toArray();e?Ft.sort(n,e):Ft.sort(n);for(var i=t.iterator(),r=0,o=n.length;r<o;r++)i.next(),i.set(n[r])},Je.singletonList=function(t){var e=new Et;return e.add(t),e};var tn=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()};tn.prototype.expandToQueue=function(t,e){var n=tn.isComposite(this._boundable1),i=tn.isComposite(this._boundable2);if(n&&i)return tn.area(this._boundable1)>tn.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,t,e),null):(this.expand(this._boundable2,this._boundable1,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,t,e),null;throw new v("neither boundable is composite")},tn.prototype.isLeaves=function(){return!(tn.isComposite(this._boundable1)||tn.isComposite(this._boundable2))},tn.prototype.compareTo=function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0},tn.prototype.expand=function(t,e,n,i){for(var r=t.getChildBoundables().iterator();r.hasNext();){var o=r.next(),s=new tn(o,e,this._itemDistance);s.getDistance()<i&&n.add(s)}},tn.prototype.getBoundable=function(t){return 0===t?this._boundable1:this._boundable2},tn.prototype.getDistance=function(){return this._distance},tn.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())},tn.prototype.interfaces_=function(){return[x]},tn.prototype.getClass=function(){return tn},tn.area=function(t){return t.getBounds().getArea()},tn.isComposite=function(t){return t instanceof $e};var en=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new Et,this._nodeCapacity=null,0===arguments.length){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(1===arguments.length){var n=arguments[0];et.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},nn={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};en.prototype.getNodeCapacity=function(){return this._nodeCapacity},en.prototype.lastNode=function(t){return t.get(t.size()-1)},en.prototype.size=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.size(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();n instanceof $e?t+=this.size(n):n instanceof Xe&&(t+=1)}return t}},en.prototype.removeItem=function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var r=i.next();r instanceof Xe&&r.getItem()===e&&(n=r)}return null!==n&&(t.getChildBoundables().remove(n),!0)},en.prototype.itemsTree=function(){if(0===arguments.length){this.build();var t=this.itemsTree(this._root);return null===t?new Et:t}if(1===arguments.length){for(var e=arguments[0],n=new Et,i=e.getChildBoundables().iterator();i.hasNext();){var r=i.next();if(r instanceof $e){var o=this.itemsTree(r);null!==o&&n.add(o)}else r instanceof Xe?n.add(r.getItem()):et.shouldNeverReachHere()}return n.size()<=0?null:n}},en.prototype.insert=function(t,e){et.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new Xe(t,e))},en.prototype.boundablesAtLevel=function(){if(1===arguments.length){var t=arguments[0],e=new Et;return this.boundablesAtLevel(t,this._root,e),e}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];if(et.isTrue(n>-2),i.getLevel()===n)return r.add(i),null;for(var o=i.getChildBoundables().iterator();o.hasNext();){var s=o.next();s instanceof $e?this.boundablesAtLevel(n,s,r):(et.isTrue(s instanceof Xe),-1===n&&r.add(s))}return null}},en.prototype.query=function(){if(1===arguments.length){var t=arguments[0];this.build();var e=new Et;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.query(t,this._root,e),e}if(2===arguments.length){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,i)}else if(3===arguments.length)if(L(arguments[2],Ze)&&arguments[0]instanceof Object&&arguments[1]instanceof $e)for(var r=arguments[0],o=arguments[2],s=arguments[1].getChildBoundables(),a=0;a<s.size();a++){var l=s.get(a);this.getIntersectsOp().intersects(l.getBounds(),r)&&(l instanceof $e?this.query(r,l,o):l instanceof Xe?o.visitItem(l.getItem()):et.shouldNeverReachHere())}else if(L(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof $e)for(var u=arguments[0],c=arguments[2],h=arguments[1].getChildBoundables(),f=0;f<h.size();f++){var d=h.get(f);this.getIntersectsOp().intersects(d.getBounds(),u)&&(d instanceof $e?this.query(u,d,c):d instanceof Xe?c.add(d.getItem()):et.shouldNeverReachHere())}},en.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0},en.prototype.getRoot=function(){return this.build(),this._root},en.prototype.remove=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=this.removeItem(i,r);if(o)return!0;for(var s=null,a=i.getChildBoundables().iterator();a.hasNext();){var l=a.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof $e&&(o=this.remove(n,l,r))){s=l;break}}return null!==s&&s.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(s),o}},en.prototype.createHigherLevels=function(t,e){et.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return 1===n.size()?n.get(0):this.createHigherLevels(n,e+1)},en.prototype.depth=function(){if(0===arguments.length)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(1===arguments.length){for(var t=0,e=arguments[0].getChildBoundables().iterator();e.hasNext();){var n=e.next();if(n instanceof $e){var i=this.depth(n);i>t&&(t=i)}}return t+1}},en.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var n=new Et;n.add(this.createNode(e));var i=new Et(t);Je.sort(i,this.getComparator());for(var r=i.iterator();r.hasNext();){var o=r.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(o)}return n},en.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()},en.prototype.interfaces_=function(){return[e]},en.prototype.getClass=function(){return en},en.compareDoubles=function(t,e){return t>e?1:t<e?-1:0},nn.IntersectsOp.get=function(){return rn},nn.serialVersionUID.get=function(){return-0x35ef64c82d4c5400},nn.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(en,nn);var rn=function(){},on=function(){};on.prototype.distance=function(t,e){},on.prototype.interfaces_=function(){return[]},on.prototype.getClass=function(){return on};var sn=function(t){function n(e){e=e||n.DEFAULT_NODE_CAPACITY,t.call(this,e)}t&&(n.__proto__=t),(n.prototype=Object.create(t&&t.prototype)).constructor=n;var i={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return n.prototype.createParentBoundablesFromVerticalSlices=function(t,e){et.isTrue(t.length>0);for(var n=new Et,i=0;i<t.length;i++)n.addAll(this.createParentBoundablesFromVerticalSlice(t[i],e));return n},n.prototype.createNode=function(t){return new an(t)},n.prototype.size=function(){return 0===arguments.length?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},n.prototype.insert=function(){if(2!==arguments.length)return t.prototype.insert.apply(this,arguments);var e=arguments[0],n=arguments[1];if(e.isNull())return null;t.prototype.insert.call(this,e,n)},n.prototype.getIntersectsOp=function(){return n.intersectsOp},n.prototype.verticalSlices=function(t,e){for(var n=Math.trunc(Math.ceil(t.size()/e)),i=new Array(e).fill(null),r=t.iterator(),o=0;o<e;o++){i[o]=new Et;for(var s=0;r.hasNext()&&s<n;){var a=r.next();i[o].add(a),s++}}return i},n.prototype.query=function(){if(1===arguments.length){var e=arguments[0];return t.prototype.query.call(this,e)}if(2===arguments.length){var n=arguments[0],i=arguments[1];t.prototype.query.call(this,n,i)}else if(3===arguments.length)if(L(arguments[2],Ze)&&arguments[0]instanceof Object&&arguments[1]instanceof $e){var r=arguments[0],o=arguments[1],s=arguments[2];t.prototype.query.call(this,r,o,s)}else if(L(arguments[2],wt)&&arguments[0]instanceof Object&&arguments[1]instanceof $e){var a=arguments[0],l=arguments[1],u=arguments[2];t.prototype.query.call(this,a,l,u)}},n.prototype.getComparator=function(){return n.yComparator},n.prototype.createParentBoundablesFromVerticalSlice=function(e,n){return t.prototype.createParentBoundables.call(this,e,n)},n.prototype.remove=function(){if(2===arguments.length){var e=arguments[0],n=arguments[1];return t.prototype.remove.call(this,e,n)}return t.prototype.remove.apply(this,arguments)},n.prototype.depth=function(){return 0===arguments.length?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},n.prototype.createParentBoundables=function(t,e){et.isTrue(!t.isEmpty());var i=Math.trunc(Math.ceil(t.size()/this.getNodeCapacity())),r=new Et(t);Je.sort(r,n.xComparator);var o=this.verticalSlices(r,Math.trunc(Math.ceil(Math.sqrt(i))));return this.createParentBoundablesFromVerticalSlices(o,e)},n.prototype.nearestNeighbour=function(){if(1===arguments.length){if(L(arguments[0],on)){var t=arguments[0],e=new tn(this.getRoot(),this.getRoot(),t);return this.nearestNeighbour(e)}if(arguments[0]instanceof tn){var i=arguments[0];return this.nearestNeighbour(i,_.POSITIVE_INFINITY)}}else if(2===arguments.length){if(arguments[0]instanceof n&&L(arguments[1],on)){var r=arguments[0],o=arguments[1],s=new tn(this.getRoot(),r.getRoot(),o);return this.nearestNeighbour(s)}if(arguments[0]instanceof tn&&"number"==typeof arguments[1]){var a=arguments[0],l=arguments[1],u=null,c=new Ye;for(c.add(a);!c.isEmpty()&&l>0;){var h=c.poll(),f=h.getDistance();if(f>=l)break;h.isLeaves()?(l=f,u=h):h.expandToQueue(c,l)}return[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else if(3===arguments.length){var d=arguments[2],p=new Xe(arguments[0],arguments[1]),g=new tn(this.getRoot(),p,d);return this.nearestNeighbour(g)[0]}},n.prototype.interfaces_=function(){return[Ke,e]},n.prototype.getClass=function(){return n},n.centreX=function(t){return n.avg(t.getMinX(),t.getMaxX())},n.avg=function(t,e){return(t+e)/2},n.centreY=function(t){return n.avg(t.getMinY(),t.getMaxY())},i.STRtreeNode.get=function(){return an},i.serialVersionUID.get=function(){return 0x39920f7d5f261e0},i.xComparator.get=function(){return{interfaces_:function(){return[E]},compare:function(e,i){return t.compareDoubles(n.centreX(e.getBounds()),n.centreX(i.getBounds()))}}},i.yComparator.get=function(){return{interfaces_:function(){return[E]},compare:function(e,i){return t.compareDoubles(n.centreY(e.getBounds()),n.centreY(i.getBounds()))}}},i.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(t,e){return t.intersects(e)}}},i.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(n,i),n}(en),an=function(t){function e(){var e=arguments[0];t.call(this,e)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var t=null,e=this.getChildBoundables().iterator();e.hasNext();){var n=e.next();null===t?t=new H(n.getBounds()):t.expandToInclude(n.getBounds())}return t},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($e),ln=function(){};ln.prototype.interfaces_=function(){return[]},ln.prototype.getClass=function(){return ln},ln.relativeSign=function(t,e){return t<e?-1:t>e?1:0},ln.compare=function(t,e,n){if(e.equals2D(n))return 0;var i=ln.relativeSign(e.x,n.x),r=ln.relativeSign(e.y,n.y);switch(t){case 0:return ln.compareValue(i,r);case 1:return ln.compareValue(r,i);case 2:return ln.compareValue(r,-i);case 3:return ln.compareValue(-i,r);case 4:return ln.compareValue(-i,-r);case 5:return ln.compareValue(-r,-i);case 6:return ln.compareValue(-r,i);case 7:return ln.compareValue(i,-r)}return et.shouldNeverReachHere("invalid octant value"),0},ln.compareValue=function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0};var un=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new S(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))};un.prototype.getCoordinate=function(){return this.coord},un.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)},un.prototype.compareTo=function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:ln.compare(this._segmentOctant,this.coord,e.coord)},un.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&!this._isInterior||this.segmentIndex===t},un.prototype.isInterior=function(){return this._isInterior},un.prototype.interfaces_=function(){return[x]},un.prototype.getClass=function(){return un};var cn=function(){this._nodeMap=new h,this._edge=null;var t=arguments[0];this._edge=t};cn.prototype.getSplitCoordinates=function(){var t=new Pt;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()},cn.prototype.addCollapsedNodes=function(){var t=new Et;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}},cn.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},cn.prototype.findCollapsesFromExistingVertices=function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e),i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(new R(e+1))}},cn.prototype.addEdgeCoordinates=function(t,e,n){var i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);n.add(new S(t.coord),!1);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)n.add(this._edge.getCoordinate(o));r&&n.add(new S(e.coord))},cn.prototype.iterator=function(){return this._nodeMap.values().iterator()},cn.prototype.addSplitEdges=function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},cn.prototype.findCollapseIndex=function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,1===i&&(n[0]=t.segmentIndex+1,!0)},cn.prototype.findCollapsesFromInsertedNodes=function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var r=n.next();this.findCollapseIndex(i,r,e)&&t.add(new R(e[0])),i=r}},cn.prototype.getEdge=function(){return this._edge},cn.prototype.addEndpoints=function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)},cn.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this._edge.getCoordinate(e.segmentIndex),r=e.isInterior()||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new S(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this._edge.getCoordinate(a);return r&&(o[s]=new S(e.coord)),new pn(o,this._edge.getData())},cn.prototype.add=function(t,e){var n=new un(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return null!==i?(et.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)},cn.prototype.checkSplitEdgesCorrectness=function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new J("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),r=i[i.length-1];if(!r.equals2D(e[e.length-1]))throw new J("bad split edge end point at "+r)},cn.prototype.interfaces_=function(){return[]},cn.prototype.getClass=function(){return cn};var hn=function(){};hn.prototype.interfaces_=function(){return[]},hn.prototype.getClass=function(){return hn},hn.octant=function(){if("number"==typeof arguments[0]&&"number"==typeof arguments[1]){var t=arguments[0],e=arguments[1];if(0===t&&0===e)throw new v("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof S&&arguments[1]instanceof S){var r=arguments[0],o=arguments[1],s=o.x-r.x,a=o.y-r.y;if(0===s&&0===a)throw new v("Cannot compute the octant for two identical points "+r);return hn.octant(s,a)}};var fn=function(){};fn.prototype.getCoordinates=function(){},fn.prototype.size=function(){},fn.prototype.getCoordinate=function(t){},fn.prototype.isClosed=function(){},fn.prototype.setData=function(t){},fn.prototype.getData=function(){},fn.prototype.interfaces_=function(){return[]},fn.prototype.getClass=function(){return fn};var dn=function(){};dn.prototype.addIntersection=function(t,e){},dn.prototype.interfaces_=function(){return[fn]},dn.prototype.getClass=function(){return dn};var pn=function(){this._nodeList=new cn(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};pn.prototype.getCoordinates=function(){return this._pts},pn.prototype.size=function(){return this._pts.length},pn.prototype.getCoordinate=function(t){return this._pts[t]},pn.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},pn.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))},pn.prototype.setData=function(t){this._data=t},pn.prototype.safeOctant=function(t,e){return t.equals2D(e)?0:hn.octant(t,e)},pn.prototype.getData=function(){return this._data},pn.prototype.addIntersection=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(4===arguments.length){var n=arguments[1],i=arguments[3],r=new S(arguments[0].getIntersection(i));this.addIntersection(r,n)}},pn.prototype.toString=function(){return Q.toLineString(new le(this._pts))},pn.prototype.getNodeList=function(){return this._nodeList},pn.prototype.addIntersectionNode=function(t,e){var n=e,i=n+1;if(i<this._pts.length){var r=this._pts[i];t.equals2D(r)&&(n=i)}return this._nodeList.add(t,n)},pn.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},pn.prototype.interfaces_=function(){return[dn]},pn.prototype.getClass=function(){return pn},pn.getNodedSubstrings=function(){if(1===arguments.length){var t=arguments[0],e=new Et;return pn.getNodedSubstrings(t,e),e}if(2===arguments.length)for(var n=arguments[1],i=arguments[0].iterator();i.hasNext();)i.next().getNodeList().addSplitEdges(n)};var gn=function(){if(this.p0=null,this.p1=null,0===arguments.length)this.p0=new S,this.p1=new S;else if(1===arguments.length){var t=arguments[0];this.p0=new S(t.p0),this.p1=new S(t.p1)}else if(2===arguments.length)this.p0=arguments[0],this.p1=arguments[1];else if(4===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=arguments[3];this.p0=new S(e,n),this.p1=new S(i,r)}},mn={serialVersionUID:{configurable:!0}};gn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)},gn.prototype.orientationIndex=function(){if(arguments[0]instanceof gn){var t=arguments[0],e=at.orientationIndex(this.p0,this.p1,t.p0),n=at.orientationIndex(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof S){var i=arguments[0];return at.orientationIndex(this.p0,this.p1,i)}},gn.prototype.toGeometry=function(t){return t.createLineString([this.p0,this.p1])},gn.prototype.isVertical=function(){return this.p0.x===this.p1.x},gn.prototype.equals=function(t){if(!(t instanceof gn))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)},gn.prototype.intersection=function(t){var e=new rt;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null},gn.prototype.project=function(){if(arguments[0]instanceof S){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new S(t);var e=this.projectionFactor(t),n=new S;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof gn){var i=arguments[0],r=this.projectionFactor(i.p0),o=this.projectionFactor(i.p1);if(r>=1&&o>=1)return null;if(r<=0&&o<=0)return null;var s=this.project(i.p0);r<0&&(s=this.p0),r>1&&(s=this.p1);var a=this.project(i.p1);return o<0&&(a=this.p0),o>1&&(a=this.p1),new gn(s,a)}},gn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()},gn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)},gn.prototype.getCoordinate=function(t){return 0===t?this.p0:this.p1},gn.prototype.distancePerpendicular=function(t){return at.distancePointLinePerpendicular(t,this.p0,this.p1)},gn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)},gn.prototype.midPoint=function(){return gn.midPoint(this.p0,this.p1)},gn.prototype.projectionFactor=function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?_.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i},gn.prototype.closestPoints=function(t){var e=this.intersection(t);if(null!==e)return[e,e];var n=new Array(2).fill(null),i=_.MAX_VALUE,r=null,o=this.closestPoint(t.p0);i=o.distance(t.p0),n[0]=o,n[1]=t.p0;var s=this.closestPoint(t.p1);(r=s.distance(t.p1))<i&&(i=r,n[0]=s,n[1]=t.p1);var a=t.closestPoint(this.p0);(r=a.distance(this.p0))<i&&(i=r,n[0]=this.p0,n[1]=a);var l=t.closestPoint(this.p1);return(r=l.distance(this.p1))<i&&(i=r,n[0]=this.p1,n[1]=l),n},gn.prototype.closestPoint=function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1},gn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)},gn.prototype.getLength=function(){return this.p0.distance(this.p1)},gn.prototype.compareTo=function(t){var e=t,n=this.p0.compareTo(e.p0);return 0!==n?n:this.p1.compareTo(e.p1)},gn.prototype.reverse=function(){var t=this.p0;this.p0=this.p1,this.p1=t},gn.prototype.equalsTopo=function(t){return this.p0.equals(t.p0)&&(this.p1.equals(t.p1)||this.p0.equals(t.p1))&&this.p1.equals(t.p0)},gn.prototype.lineIntersection=function(t){try{return W.intersection(this.p0,this.p1,t.p0,t.p1)}catch(t){if(!(t instanceof G))throw t}return null},gn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)},gn.prototype.pointAlongOffset=function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),r=this.p1.x-this.p0.x,o=this.p1.y-this.p0.y,s=Math.sqrt(r*r+o*o),a=0,l=0;if(0!==e){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");a=e*r/s,l=e*o/s}return new S(n-l,i+a)},gn.prototype.setCoordinates=function(){if(1===arguments.length){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}},gn.prototype.segmentFraction=function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||_.isNaN(e))&&(e=1),e},gn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"},gn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y},gn.prototype.distance=function(){if(arguments[0]instanceof gn){var t=arguments[0];return at.distanceLineLine(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof S){var e=arguments[0];return at.distancePointLine(e,this.p0,this.p1)}},gn.prototype.pointAlong=function(t){var e=new S;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e},gn.prototype.hashCode=function(){var t=_.doubleToLongBits(this.p0.x);t^=31*_.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=_.doubleToLongBits(this.p1.x);return n^=31*_.doubleToLongBits(this.p1.y),e^Math.trunc(n)^Math.trunc(n>>32)},gn.prototype.interfaces_=function(){return[x,e]},gn.prototype.getClass=function(){return gn},gn.midPoint=function(t,e){return new S((t.x+e.x)/2,(t.y+e.y)/2)},mn.serialVersionUID.get=function(){return 0x2d2172135f411c00},Object.defineProperties(gn,mn);var yn=function(){this.tempEnv1=new H,this.tempEnv2=new H,this._overlapSeg1=new gn,this._overlapSeg2=new gn};yn.prototype.overlap=function(){if(2===arguments.length);else if(4===arguments.length){var t=arguments[1],e=arguments[2],n=arguments[3];arguments[0].getLineSegment(t,this._overlapSeg1),e.getLineSegment(n,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}},yn.prototype.interfaces_=function(){return[]},yn.prototype.getClass=function(){return yn};var vn=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i};vn.prototype.getLineSegment=function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]},vn.prototype.computeSelect=function(t,e,n,i){var r=this._pts[e],o=this._pts[n];if(i.tempEnv1.init(r,o),n-e==1)return i.select(this,e),null;if(!t.intersects(i.tempEnv1))return null;var s=Math.trunc((e+n)/2);e<s&&this.computeSelect(t,e,s,i),s<n&&this.computeSelect(t,s,n,i)},vn.prototype.getCoordinates=function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t},vn.prototype.computeOverlaps=function(t,e){this.computeOverlapsInternal(this._start,this._end,t,t._start,t._end,e)},vn.prototype.setId=function(t){this._id=t},vn.prototype.select=function(t,e){this.computeSelect(t,this._start,this._end,e)},vn.prototype.getEnvelope=function(){if(null===this._env){var t=this._pts[this._start],e=this._pts[this._end];this._env=new H(t,e)}return this._env},vn.prototype.getEndIndex=function(){return this._end},vn.prototype.getStartIndex=function(){return this._start},vn.prototype.getContext=function(){return this._context},vn.prototype.getId=function(){return this._id},vn.prototype.computeOverlapsInternal=function(t,e,n,i,r,o){var s=this._pts[t],a=this._pts[e],l=n._pts[i],u=n._pts[r];if(e-t==1&&r-i==1)return o.overlap(this,t,n,i),null;if(o.tempEnv1.init(s,a),o.tempEnv2.init(l,u),!o.tempEnv1.intersects(o.tempEnv2))return null;var c=Math.trunc((t+e)/2),h=Math.trunc((i+r)/2);t<c&&(i<h&&this.computeOverlapsInternal(t,c,n,i,h,o),h<r&&this.computeOverlapsInternal(t,c,n,h,r,o)),c<e&&(i<h&&this.computeOverlapsInternal(c,e,n,i,h,o),h<r&&this.computeOverlapsInternal(c,e,n,h,r,o))},vn.prototype.interfaces_=function(){return[]},vn.prototype.getClass=function(){return vn};var _n=function(){};_n.prototype.interfaces_=function(){return[]},_n.prototype.getClass=function(){return _n},_n.getChainStartIndices=function(t){var e=0,n=new Et;n.add(new R(e));do{var i=_n.findChainEnd(t,e);n.add(new R(i)),e=i}while(e<t.length-1);return _n.toIntArray(n)},_n.findChainEnd=function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=Be.quadrant(t[n],t[n+1]),r=e+1;r<t.length&&(t[r-1].equals2D(t[r])||Be.quadrant(t[r-1],t[r])===i);)r++;return r-1},_n.getChains=function(){if(1===arguments.length){var t=arguments[0];return _n.getChains(t,null)}if(2===arguments.length){for(var e=arguments[0],n=arguments[1],i=new Et,r=_n.getChainStartIndices(e),o=0;o<r.length-1;o++){var s=new vn(e,r[o],r[o+1],n);i.add(s)}return i}},_n.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var bn=function(){};bn.prototype.computeNodes=function(t){},bn.prototype.getNodedSubstrings=function(){},bn.prototype.interfaces_=function(){return[]},bn.prototype.getClass=function(){return bn};var xn=function(){if(this._segInt=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];this.setSegmentIntersector(t)}};xn.prototype.setSegmentIntersector=function(t){this._segInt=t},xn.prototype.interfaces_=function(){return[bn]},xn.prototype.getClass=function(){return xn};var wn=function(t){function e(e){e?t.call(this,e):t.call(this),this._monoChains=new Et,this._index=new sn,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return pn.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(t){for(var e=_n.getChains(t.getCoordinates(),t).iterator();e.hasNext();){var n=e.next();n.setId(this._idCounter++),this._index.insert(n.getEnvelope(),n),this._monoChains.add(n)}},e.prototype.computeNodes=function(t){this._nodedSegStrings=t;for(var e=t.iterator();e.hasNext();)this.add(e.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var t=new En(this._segInt),e=this._monoChains.iterator();e.hasNext();)for(var n=e.next(),i=this._index.query(n.getEnvelope()).iterator();i.hasNext();){var r=i.next();if(r.getId()>n.getId()&&(n.computeOverlaps(r,t),this._nOverlaps++),this._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return En},Object.defineProperties(e,n),e}(xn),En=function(t){function e(){t.call(this),this._si=null;var e=arguments[0];this._si=e}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(4!==arguments.length)return t.prototype.overlap.apply(this,arguments);var e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[0].getContext(),o=n.getContext();this._si.processIntersections(r,e,o,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(yn),Sn=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,0===arguments.length);else if(1===arguments.length){var e=arguments[0];this.setQuadrantSegments(e)}else if(2===arguments.length){var n=arguments[0],i=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(i)}else if(4===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3];this.setQuadrantSegments(r),this.setEndCapStyle(o),this.setJoinStyle(s),this.setMitreLimit(a)}},Pn={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};Sn.prototype.getEndCapStyle=function(){return this._endCapStyle},Sn.prototype.isSingleSided=function(){return this._isSingleSided},Sn.prototype.setQuadrantSegments=function(t){this._quadrantSegments=t,0===this._quadrantSegments&&(this._joinStyle=Sn.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=Sn.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==Sn.JOIN_ROUND&&(this._quadrantSegments=Sn.DEFAULT_QUADRANT_SEGMENTS)},Sn.prototype.getJoinStyle=function(){return this._joinStyle},Sn.prototype.setJoinStyle=function(t){this._joinStyle=t},Sn.prototype.setSimplifyFactor=function(t){this._simplifyFactor=t<0?0:t},Sn.prototype.getSimplifyFactor=function(){return this._simplifyFactor},Sn.prototype.getQuadrantSegments=function(){return this._quadrantSegments},Sn.prototype.setEndCapStyle=function(t){this._endCapStyle=t},Sn.prototype.getMitreLimit=function(){return this._mitreLimit},Sn.prototype.setMitreLimit=function(t){this._mitreLimit=t},Sn.prototype.setSingleSided=function(t){this._isSingleSided=t},Sn.prototype.interfaces_=function(){return[]},Sn.prototype.getClass=function(){return Sn},Sn.bufferDistanceError=function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)},Pn.CAP_ROUND.get=function(){return 1},Pn.CAP_FLAT.get=function(){return 2},Pn.CAP_SQUARE.get=function(){return 3},Pn.JOIN_ROUND.get=function(){return 1},Pn.JOIN_MITRE.get=function(){return 2},Pn.JOIN_BEVEL.get=function(){return 3},Pn.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8},Pn.DEFAULT_MITRE_LIMIT.get=function(){return 5},Pn.DEFAULT_SIMPLIFY_FACTOR.get=function(){return.01},Object.defineProperties(Sn,Pn);var Cn=function(t){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=at.COUNTERCLOCKWISE,this._inputLine=t||null},In={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Cn.prototype.isDeletable=function(t,e,n,i){var r=this._inputLine[t],o=this._inputLine[e],s=this._inputLine[n];return!!this.isConcave(r,o,s)&&!!this.isShallow(r,o,s,i)&&this.isShallowSampled(r,o,t,n,i)},Cn.prototype.deleteShallowConcavities=function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var r=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=Cn.DELETE,r=!0,i=!0),t=r?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i},Cn.prototype.isShallowConcavity=function(t,e,n,i){return at.computeOrientation(t,e,n)===this._angleOrientation&&at.distancePointLine(e,t,n)<i},Cn.prototype.isShallowSampled=function(t,e,n,i,r){var o=Math.trunc((i-n)/Cn.NUM_PTS_TO_CHECK);o<=0&&(o=1);for(var s=n;s<i;s+=o)if(!this.isShallow(t,e,this._inputLine[s],r))return!1;return!0},Cn.prototype.isConcave=function(t,e,n){return at.computeOrientation(t,e,n)===this._angleOrientation},Cn.prototype.simplify=function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=at.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do{e=this.deleteShallowConcavities()}while(e);return this.collapseLine()},Cn.prototype.findNextNonDeletedIndex=function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===Cn.DELETE;)e++;return e},Cn.prototype.isShallow=function(t,e,n,i){return at.distancePointLine(e,t,n)<i},Cn.prototype.collapseLine=function(){for(var t=new Pt,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==Cn.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()},Cn.prototype.interfaces_=function(){return[]},Cn.prototype.getClass=function(){return Cn},Cn.simplify=function(t,e){return new Cn(t).simplify(e)},In.INIT.get=function(){return 0},In.DELETE.get=function(){return 1},In.KEEP.get=function(){return 1},In.NUM_PTS_TO_CHECK.get=function(){return 10},Object.defineProperties(Cn,In);var Tn=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new Et},Mn={COORDINATE_ARRAY_TYPE:{configurable:!0}};Tn.prototype.getCoordinates=function(){return this._ptList.toArray(Tn.COORDINATE_ARRAY_TYPE)},Tn.prototype.setPrecisionModel=function(t){this._precisionModel=t},Tn.prototype.addPt=function(t){var e=new S(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)},Tn.prototype.revere=function(){},Tn.prototype.addPts=function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;i>=0;i--)this.addPt(t[i])},Tn.prototype.isRedundant=function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance},Tn.prototype.toString=function(){return(new ye).createLineString(this.getCoordinates()).toString()},Tn.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var t=new S(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)},Tn.prototype.setMinimumVertexDistance=function(t){this._minimimVertexDistance=t},Tn.prototype.interfaces_=function(){return[]},Tn.prototype.getClass=function(){return Tn},Mn.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)},Object.defineProperties(Tn,Mn);var Ln=function(){},An={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Ln.prototype.interfaces_=function(){return[]},Ln.prototype.getClass=function(){return Ln},Ln.toDegrees=function(t){return 180*t/Math.PI},Ln.normalize=function(t){for(;t>Math.PI;)t-=Ln.PI_TIMES_2;for(;t<=-Math.PI;)t+=Ln.PI_TIMES_2;return t},Ln.angle=function(){if(1===arguments.length){var t=arguments[0];return Math.atan2(t.y,t.x)}if(2===arguments.length){var e=arguments[0],n=arguments[1],i=n.x-e.x,r=n.y-e.y;return Math.atan2(r,i)}},Ln.isAcute=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)>0},Ln.isObtuse=function(t,e,n){var i=t.x-e.x,r=t.y-e.y;return i*(n.x-e.x)+r*(n.y-e.y)<0},Ln.interiorAngle=function(t,e,n){var i=Ln.angle(e,t),r=Ln.angle(e,n);return Math.abs(r-i)},Ln.normalizePositive=function(t){if(t<0){for(;t<0;)t+=Ln.PI_TIMES_2;t>=Ln.PI_TIMES_2&&(t=0)}else{for(;t>=Ln.PI_TIMES_2;)t-=Ln.PI_TIMES_2;t<0&&(t=0)}return t},Ln.angleBetween=function(t,e,n){var i=Ln.angle(e,t),r=Ln.angle(e,n);return Ln.diff(i,r)},Ln.diff=function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n},Ln.toRadians=function(t){return t*Math.PI/180},Ln.getTurn=function(t,e){var n=Math.sin(e-t);return n>0?Ln.COUNTERCLOCKWISE:n<0?Ln.CLOCKWISE:Ln.NONE},Ln.angleBetweenOriented=function(t,e,n){var i=Ln.angle(e,t),r=Ln.angle(e,n)-i;return r<=-Math.PI?r+Ln.PI_TIMES_2:r>Math.PI?r-Ln.PI_TIMES_2:r},An.PI_TIMES_2.get=function(){return 2*Math.PI},An.PI_OVER_2.get=function(){return Math.PI/2},An.PI_OVER_4.get=function(){return Math.PI/4},An.COUNTERCLOCKWISE.get=function(){return at.COUNTERCLOCKWISE},An.CLOCKWISE.get=function(){return at.CLOCKWISE},An.NONE.get=function(){return at.COLLINEAR},Object.defineProperties(Ln,An);var On=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new gn,this._seg1=new gn,this._offset0=new gn,this._offset1=new gn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new rt,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===Sn.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(i)},Nn={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};On.prototype.addNextSegment=function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=at.computeOrientation(this._s0,this._s1,this._s2),i=n===at.CLOCKWISE&&this._side===Pe.LEFT||n===at.COUNTERCLOCKWISE&&this._side===Pe.RIGHT;0===n?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)},On.prototype.addLineEndCap=function(t,e){var n=new gn(t,e),i=new gn;this.computeOffsetSegment(n,Pe.LEFT,this._distance,i);var r=new gn;this.computeOffsetSegment(n,Pe.RIGHT,this._distance,r);var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o);switch(this._bufParams.getEndCapStyle()){case Sn.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(e,a+Math.PI/2,a-Math.PI/2,at.CLOCKWISE,this._distance),this._segList.addPt(r.p1);break;case Sn.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(r.p1);break;case Sn.CAP_SQUARE:var l=new S;l.x=Math.abs(this._distance)*Math.cos(a),l.y=Math.abs(this._distance)*Math.sin(a);var u=new S(i.p1.x+l.x,i.p1.y+l.y),c=new S(r.p1.x+l.x,r.p1.y+l.y);this._segList.addPt(u),this._segList.addPt(c)}},On.prototype.getCoordinates=function(){return this._segList.getCoordinates()},On.prototype.addMitreJoin=function(t,e,n,i){var r=!0,o=null;try{o=W.intersection(e.p0,e.p1,n.p0,n.p1),(i<=0?1:o.distance(t)/Math.abs(i))>this._bufParams.getMitreLimit()&&(r=!1)}catch(t){if(!(t instanceof G))throw t;o=new S(0,0),r=!1}r?this._segList.addPt(o):this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())},On.prototype.addFilletCorner=function(t,e,n,i,r){var o=e.x-t.x,s=e.y-t.y,a=Math.atan2(s,o),l=n.x-t.x,u=n.y-t.y,c=Math.atan2(u,l);i===at.CLOCKWISE?a<=c&&(a+=2*Math.PI):a>=c&&(a-=2*Math.PI),this._segList.addPt(e),this.addFilletArc(t,a,c,i,r),this._segList.addPt(n)},On.prototype.addOutsideTurn=function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*On.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Sn.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Sn.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))},On.prototype.createSquare=function(t){this._segList.addPt(new S(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new S(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new S(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new S(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()},On.prototype.addSegments=function(t,e){this._segList.addPts(t,e)},On.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)},On.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)},On.prototype.initSideSegments=function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)},On.prototype.addLimitedMitreJoin=function(t,e,n,i){var r=this._seg0.p1,o=Ln.angle(r,this._seg0.p0),s=Ln.angleBetweenOriented(this._seg0.p0,r,this._seg1.p1)/2,a=Ln.normalize(o+s),l=Ln.normalize(a+Math.PI),u=i*n,c=n-u*Math.abs(Math.sin(s)),h=r.x+u*Math.cos(l),f=r.y+u*Math.sin(l),d=new S(h,f),p=new gn(r,d),g=p.pointAlongOffset(1,c),m=p.pointAlongOffset(1,-c);this._side===Pe.LEFT?(this._segList.addPt(g),this._segList.addPt(m)):(this._segList.addPt(m),this._segList.addPt(g))},On.prototype.computeOffsetSegment=function(t,e,n,i){var r=e===Pe.LEFT?1:-1,o=t.p1.x-t.p0.x,s=t.p1.y-t.p0.y,a=Math.sqrt(o*o+s*s),l=r*n*o/a,u=r*n*s/a;i.p0.x=t.p0.x-u,i.p0.y=t.p0.y+l,i.p1.x=t.p1.x-u,i.p1.y=t.p1.y+l},On.prototype.addFilletArc=function(t,e,n,i,r){var o=i===at.CLOCKWISE?-1:1,s=Math.abs(e-n),a=Math.trunc(s/this._filletAngleQuantum+.5);if(a<1)return null;for(var l=s/a,u=0,c=new S;u<s;){var h=e+o*u;c.x=t.x+r*Math.cos(h),c.y=t.y+r*Math.sin(h),this._segList.addPt(c),u+=l}},On.prototype.addInsideTurn=function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*On.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new S((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new S((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}},On.prototype.createCircle=function(t){var e=new S(t.x+this._distance,t.y);this._segList.addPt(e),this.addFilletArc(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()},On.prototype.addBevelJoin=function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)},On.prototype.init=function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Tn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*On.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)},On.prototype.addCollinear=function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Sn.JOIN_BEVEL||this._bufParams.getJoinStyle()===Sn.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,at.CLOCKWISE,this._distance))},On.prototype.closeRing=function(){this._segList.closeRing()},On.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle},On.prototype.interfaces_=function(){return[]},On.prototype.getClass=function(){return On},Nn.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return.001},Nn.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return.001},Nn.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6},Nn.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80},Object.defineProperties(On,Nn);var Rn=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e};Rn.prototype.getOffsetCurve=function(t,e){if(this._distance=e,0===e)return null;var n=e<0,i=Math.abs(e),r=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],r):this.computeOffsetCurve(t,n,r);var o=r.getCoordinates();return n&&Ct.reverse(o),o},Rn.prototype.computeSingleSidedBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var r=Cn.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Pe.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{n.addSegments(t,!1);var a=Cn.simplify(t,i),l=a.length-1;n.initSideSegments(a[0],a[1],Pe.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment(),n.closeRing()},Rn.prototype.computeRingBufferCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);e===Pe.RIGHT&&(i=-i);var r=Cn.simplify(t,i),o=r.length-1;n.initSideSegments(r[o-1],r[0],e);for(var s=1;s<=o;s++){var a=1!==s;n.addNextSegment(r[s],a)}n.closeRing()},Rn.prototype.computeLineBufferCurve=function(t,e){var n=this.simplifyTolerance(this._distance),i=Cn.simplify(t,n),r=i.length-1;e.initSideSegments(i[0],i[1],Pe.LEFT);for(var o=2;o<=r;o++)e.addNextSegment(i[o],!0);e.addLastSegment(),e.addLineEndCap(i[r-1],i[r]);var s=Cn.simplify(t,-n),a=s.length-1;e.initSideSegments(s[a],s[a-1],Pe.LEFT);for(var l=a-2;l>=0;l--)e.addNextSegment(s[l],!0);e.addLastSegment(),e.addLineEndCap(s[1],s[0]),e.closeRing()},Rn.prototype.computePointCurve=function(t,e){switch(this._bufParams.getEndCapStyle()){case Sn.CAP_ROUND:e.createCircle(t);break;case Sn.CAP_SQUARE:e.createSquare(t)}},Rn.prototype.getLineCurve=function(t,e){if(this._distance=e,e<0&&!this._bufParams.isSingleSided())return null;if(0===e)return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var r=e<0;this.computeSingleSidedBufferCurve(t,r,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()},Rn.prototype.getBufferParameters=function(){return this._bufParams},Rn.prototype.simplifyTolerance=function(t){return t*this._bufParams.getSimplifyFactor()},Rn.prototype.getRingCurve=function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(0===n)return Rn.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()},Rn.prototype.computeOffsetCurve=function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var r=Cn.simplify(t,-i),o=r.length-1;n.initSideSegments(r[o],r[o-1],Pe.LEFT),n.addFirstSegment();for(var s=o-2;s>=0;s--)n.addNextSegment(r[s],!0)}else{var a=Cn.simplify(t,i),l=a.length-1;n.initSideSegments(a[0],a[1],Pe.LEFT),n.addFirstSegment();for(var u=2;u<=l;u++)n.addNextSegment(a[u],!0)}n.addLastSegment()},Rn.prototype.getSegGen=function(t){return new On(this._precisionModel,this._bufParams,t)},Rn.prototype.interfaces_=function(){return[]},Rn.prototype.getClass=function(){return Rn},Rn.copyCoordinates=function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new S(t[n]);return e};var kn=function(){this._subgraphs=null,this._seg=new gn,this._cga=new at;var t=arguments[0];this._subgraphs=t},Dn={DepthSegment:{configurable:!0}};kn.prototype.findStabbedSegments=function(){if(1===arguments.length){for(var t=arguments[0],e=new Et,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),r=i.getEnvelope();t.y<r.getMinY()||t.y>r.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(3===arguments.length)if(L(arguments[2],wt)&&arguments[0]instanceof S&&arguments[1]instanceof Ve){for(var o=arguments[0],s=arguments[1],a=arguments[2],l=s.getEdge().getCoordinates(),u=0;u<l.length-1;u++)if(this._seg.p0=l[u],this._seg.p1=l[u+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse(),!(Math.max(this._seg.p0.x,this._seg.p1.x)<o.x||this._seg.isHorizontal()||o.y<this._seg.p0.y||o.y>this._seg.p1.y||at.computeOrientation(this._seg.p0,this._seg.p1,o)===at.RIGHT)){var c=s.getDepth(Pe.LEFT);this._seg.p0.equals(l[u])||(c=s.getDepth(Pe.RIGHT));var h=new Fn(this._seg,c);a.add(h)}}else if(L(arguments[2],wt)&&arguments[0]instanceof S&&L(arguments[1],wt))for(var f=arguments[0],d=arguments[2],p=arguments[1].iterator();p.hasNext();){var g=p.next();g.isForward()&&this.findStabbedSegments(f,g,d)}},kn.prototype.getDepth=function(t){var e=this.findStabbedSegments(t);return 0===e.size()?0:Je.min(e)._leftDepth},kn.prototype.interfaces_=function(){return[]},kn.prototype.getClass=function(){return kn},Dn.DepthSegment.get=function(){return Fn},Object.defineProperties(kn,Dn);var Fn=function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new gn(t),this._leftDepth=e};Fn.prototype.compareTo=function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return 0!==n||0!=(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))?n:this._upwardSeg.compareTo(e._upwardSeg)},Fn.prototype.compareX=function(t,e){var n=t.p0.compareTo(e.p0);return 0!==n?n:t.p1.compareTo(e.p1)},Fn.prototype.toString=function(){return this._upwardSeg.toString()},Fn.prototype.interfaces_=function(){return[x]},Fn.prototype.getClass=function(){return Fn};var zn=function(t,e,n){this.p0=t||null,this.p1=e||null,this.p2=n||null};zn.prototype.area=function(){return zn.area(this.p0,this.p1,this.p2)},zn.prototype.signedArea=function(){return zn.signedArea(this.p0,this.p1,this.p2)},zn.prototype.interpolateZ=function(t){if(null===t)throw new v("Supplied point is null.");return zn.interpolateZ(t,this.p0,this.p1,this.p2)},zn.prototype.longestSideLength=function(){return zn.longestSideLength(this.p0,this.p1,this.p2)},zn.prototype.isAcute=function(){return zn.isAcute(this.p0,this.p1,this.p2)},zn.prototype.circumcentre=function(){return zn.circumcentre(this.p0,this.p1,this.p2)},zn.prototype.area3D=function(){return zn.area3D(this.p0,this.p1,this.p2)},zn.prototype.centroid=function(){return zn.centroid(this.p0,this.p1,this.p2)},zn.prototype.inCentre=function(){return zn.inCentre(this.p0,this.p1,this.p2)},zn.prototype.interfaces_=function(){return[]},zn.prototype.getClass=function(){return zn},zn.area=function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)},zn.signedArea=function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2},zn.det=function(t,e,n,i){return t*i-e*n},zn.interpolateZ=function(t,e,n,i){var r=e.x,o=e.y,s=n.x-r,a=i.x-r,l=n.y-o,u=i.y-o,c=s*u-a*l,h=t.x-r,f=t.y-o,d=(u*h-a*f)/c,p=(-l*h+s*f)/c;return e.z+d*(n.z-e.z)+p*(i.z-e.z)},zn.longestSideLength=function(t,e,n){var i=t.distance(e),r=e.distance(n),o=n.distance(t),s=i;return r>s&&(s=r),o>s&&(s=o),s},zn.isAcute=function(t,e,n){return!!Ln.isAcute(t,e,n)&&!!Ln.isAcute(e,n,t)&&!!Ln.isAcute(n,t,e)},zn.circumcentre=function(t,e,n){var i=n.x,r=n.y,o=t.x-i,s=t.y-r,a=e.x-i,l=e.y-r,u=2*zn.det(o,s,a,l),c=zn.det(s,o*o+s*s,l,a*a+l*l),h=zn.det(o,o*o+s*s,a,a*a+l*l);return new S(i-c/u,r+h/u)},zn.perpendicularBisector=function(t,e){var n=e.x-t.x,i=e.y-t.y,r=new W(t.x+n/2,t.y+i/2,1),o=new W(t.x-i+n/2,t.y+n+i/2,1);return new W(r,o)},zn.angleBisector=function(t,e,n){var i=e.distance(t),r=i/(i+e.distance(n)),o=n.x-t.x,s=n.y-t.y;return new S(t.x+r*o,t.y+r*s)},zn.area3D=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=e.z-t.z,s=n.x-t.x,a=n.y-t.y,l=n.z-t.z,u=r*l-o*a,c=o*s-i*l,h=i*a-r*s,f=u*u+c*c+h*h;return Math.sqrt(f)/2},zn.centroid=function(t,e,n){var i=(t.x+e.x+n.x)/3,r=(t.y+e.y+n.y)/3;return new S(i,r)},zn.inCentre=function(t,e,n){var i=e.distance(n),r=t.distance(n),o=t.distance(e),s=i+r+o,a=(i*t.x+r*e.x+o*n.x)/s,l=(i*t.y+r*e.y+o*n.y)/s;return new S(a,l)};var Bn=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new Et;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n};Bn.prototype.addPoint=function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,T.EXTERIOR,T.INTERIOR)},Bn.prototype.addPolygon=function(t){var e=this._distance,n=Pe.LEFT;this._distance<0&&(e=-this._distance,n=Pe.RIGHT);var i=t.getExteriorRing(),r=Ct.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance))return null;if(this._distance<=0&&r.length<3)return null;this.addPolygonRing(r,e,n,T.EXTERIOR,T.INTERIOR);for(var o=0;o<t.getNumInteriorRing();o++){var s=t.getInteriorRingN(o),a=Ct.removeRepeatedPoints(s.getCoordinates());this._distance>0&&this.isErodedCompletely(s,-this._distance)||this.addPolygonRing(a,e,Pe.opposite(n),T.INTERIOR,T.EXTERIOR)}},Bn.prototype.isTriangleErodedCompletely=function(t,e){var n=new zn(t[0],t[1],t[2]),i=n.inCentre();return at.distancePointLine(i,n.p0,n.p1)<Math.abs(e)},Bn.prototype.addLineString=function(t){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var e=Ct.removeRepeatedPoints(t.getCoordinates()),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,T.EXTERIOR,T.INTERIOR)},Bn.prototype.addCurve=function(t,e,n){if(null===t||t.length<2)return null;var i=new pn(t,new Oe(0,T.BOUNDARY,e,n));this._curveList.add(i)},Bn.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList},Bn.prototype.addPolygonRing=function(t,e,n,i,r){if(0===e&&t.length<ee.MINIMUM_VALID_SIZE)return null;var o=i,s=r;t.length>=ee.MINIMUM_VALID_SIZE&&at.isCCW(t)&&(o=r,s=i,n=Pe.opposite(n));var a=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(a,o,s)},Bn.prototype.add=function(t){if(t.isEmpty())return null;t instanceof Jt?this.addPolygon(t):t instanceof Zt?this.addLineString(t):t instanceof $t?this.addPoint(t):(t instanceof te||t instanceof Gt||t instanceof ne||t instanceof Vt)&&this.addCollection(t)},Bn.prototype.isErodedCompletely=function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(4===n.length)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),r=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>r},Bn.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},Bn.prototype.interfaces_=function(){return[]},Bn.prototype.getClass=function(){return Bn};var jn=function(){};jn.prototype.locate=function(t){},jn.prototype.interfaces_=function(){return[]},jn.prototype.getClass=function(){return jn};var Un=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()};Un.prototype.next=function(){if(this._atStart)return this._atStart=!1,Un.isAtomic(this._parent)&&this._index++,this._parent;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new i;var t=this._parent.getGeometryN(this._index++);return t instanceof Vt?(this._subcollectionIterator=new Un(t),this._subcollectionIterator.next()):t},Un.prototype.remove=function(){throw new Error(this.getClass().getName())},Un.prototype.hasNext=function(){if(this._atStart)return!0;if(null!==this._subcollectionIterator){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)},Un.prototype.interfaces_=function(){return[xt]},Un.prototype.getClass=function(){return Un},Un.isAtomic=function(t){return!(t instanceof Vt)};var Vn=function(){this._geom=null;var t=arguments[0];this._geom=t};Vn.prototype.locate=function(t){return Vn.locate(t,this._geom)},Vn.prototype.interfaces_=function(){return[jn]},Vn.prototype.getClass=function(){return Vn},Vn.isPointInRing=function(t,e){return!!e.getEnvelopeInternal().intersects(t)&&at.isPointInRing(t,e.getCoordinates())},Vn.containsPointInPolygon=function(t,e){if(e.isEmpty())return!1;var n=e.getExteriorRing();if(!Vn.isPointInRing(t,n))return!1;for(var i=0;i<e.getNumInteriorRing();i++){var r=e.getInteriorRingN(i);if(Vn.isPointInRing(t,r))return!1}return!0},Vn.containsPoint=function(t,e){if(e instanceof Jt)return Vn.containsPointInPolygon(t,e);if(e instanceof Vt)for(var n=new Un(e);n.hasNext();){var i=n.next();if(i!==e&&Vn.containsPoint(t,i))return!0}return!1},Vn.locate=function(t,e){return e.isEmpty()?T.EXTERIOR:Vn.containsPoint(t,e)?T.INTERIOR:T.EXTERIOR};var Gn=function(){this._edgeMap=new h,this._edgeList=null,this._ptInAreaLocation=[T.NONE,T.NONE]};Gn.prototype.getNextCW=function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return 0===e&&(n=this._edgeList.size()-1),this._edgeList.get(n)},Gn.prototype.propagateSideLabels=function(t){for(var e=T.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,Pe.LEFT)!==T.NONE&&(e=i.getLocation(t,Pe.LEFT))}if(e===T.NONE)return null;for(var r=e,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getLabel();if(a.getLocation(t,Pe.ON)===T.NONE&&a.setLocation(t,Pe.ON,r),a.isArea(t)){var l=a.getLocation(t,Pe.LEFT),u=a.getLocation(t,Pe.RIGHT);if(u!==T.NONE){if(u!==r)throw new Te("side location conflict",s.getCoordinate());l===T.NONE&&et.shouldNeverReachHere("found single null side (at "+s.getCoordinate()+")"),r=l}else et.isTrue(a.getLocation(t,Pe.LEFT)===T.NONE,"found single null side"),a.setLocation(t,Pe.RIGHT,r),a.setLocation(t,Pe.LEFT,r)}}},Gn.prototype.getCoordinate=function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null},Gn.prototype.print=function(t){q.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)},Gn.prototype.isAreaLabelsConsistent=function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)},Gn.prototype.checkAreaLabelsConsistent=function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,Pe.LEFT);et.isTrue(i!==T.NONE,"Found unlabelled area edge");for(var r=i,o=this.iterator();o.hasNext();){var s=o.next().getLabel();et.isTrue(s.isArea(t),"Found non-area edge");var a=s.getLocation(t,Pe.LEFT),l=s.getLocation(t,Pe.RIGHT);if(a===l)return!1;if(l!==r)return!1;r=a}return!0},Gn.prototype.findIndex=function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1},Gn.prototype.iterator=function(){return this.getEdges().iterator()},Gn.prototype.getEdges=function(){return null===this._edgeList&&(this._edgeList=new Et(this._edgeMap.values())),this._edgeList},Gn.prototype.getLocation=function(t,e,n){return this._ptInAreaLocation[t]===T.NONE&&(this._ptInAreaLocation[t]=Vn.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]},Gn.prototype.toString=function(){var t=new N;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append("\n");for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append("\n")}return t.toString()},Gn.prototype.computeEdgeEndLabels=function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)},Gn.prototype.computeLabelling=function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),r=0;r<2;r++)i.isLine(r)&&i.getLocation(r)===T.BOUNDARY&&(e[r]=!0);for(var o=this.iterator();o.hasNext();)for(var s=o.next(),a=s.getLabel(),l=0;l<2;l++)if(a.isAnyNull(l)){var u=T.NONE;if(e[l])u=T.EXTERIOR;else{var c=s.getCoordinate();u=this.getLocation(l,c,t)}a.setAllLocationsIfNull(l,u)}},Gn.prototype.getDegree=function(){return this._edgeMap.size()},Gn.prototype.insertEdgeEnd=function(t,e){this._edgeMap.put(t,e),this._edgeList=null},Gn.prototype.interfaces_=function(){return[]},Gn.prototype.getClass=function(){return Gn};var qn=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){this.getResultAreaEdges();for(var t=null,e=null,n=this._SCANNING_FOR_INCOMING,i=0;i<this._resultAreaEdgeList.size();i++){var r=this._resultAreaEdgeList.get(i),o=r.getSym();if(r.getLabel().isArea())switch(null===t&&r.isInResult()&&(t=r),n){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;e=o,n=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!r.isInResult())continue;e.setNext(r),n=this._SCANNING_FOR_INCOMING}}if(n===this._LINKING_TO_OUTGOING){if(null===t)throw new Te("no outgoing dirEdge found",this.getCoordinate());et.isTrue(t.isInResult(),"unable to link last incoming dirEdge"),e.setNext(t)}},e.prototype.insert=function(t){var e=t;this.insertEdgeEnd(e,e)},e.prototype.getRightmostEdge=function(){var t=this.getEdges(),e=t.size();if(e<1)return null;var n=t.get(0);if(1===e)return n;var i=t.get(e-1),r=n.getQuadrant(),o=i.getQuadrant();return Be.isNorthern(r)&&Be.isNorthern(o)?n:Be.isNorthern(r)||Be.isNorthern(o)?0!==n.getDy()?n:0!==i.getDy()?i:(et.shouldNeverReachHere("found two horizontal edges incident on node"),null):i},e.prototype.print=function(t){q.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var e=this.iterator();e.hasNext();){var n=e.next();t.print("out "),n.print(t),t.println(),t.print("in "),n.getSym().print(t),t.println()}},e.prototype.getResultAreaEdges=function(){if(null!==this._resultAreaEdgeList)return this._resultAreaEdgeList;this._resultAreaEdgeList=new Et;for(var t=this.iterator();t.hasNext();){var e=t.next();(e.isInResult()||e.getSym().isInResult())&&this._resultAreaEdgeList.add(e)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(t){for(var e=this.iterator();e.hasNext();){var n=e.next().getLabel();n.setAllLocationsIfNull(0,t.getLocation(0)),n.setAllLocationsIfNull(1,t.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){this.getEdges();for(var t=null,e=null,n=this._edgeList.size()-1;n>=0;n--){var i=this._edgeList.get(n),r=i.getSym();null===e&&(e=r),null!==t&&r.setNext(t),t=i}e.setNext(t)},e.prototype.computeDepths=function(){if(1===arguments.length){var t=arguments[0],e=this.findIndex(t),n=t.getDepth(Pe.LEFT),i=t.getDepth(Pe.RIGHT),r=this.computeDepths(e+1,this._edgeList.size(),n);if(this.computeDepths(0,e,r)!==i)throw new Te("depth mismatch at "+t.getCoordinate())}else if(3===arguments.length){for(var o=arguments[1],s=arguments[2],a=arguments[0];a<o;a++){var l=this._edgeList.get(a);l.setEdgeDepths(Pe.RIGHT,s),s=l.getDepth(Pe.LEFT)}return s}},e.prototype.mergeSymLabels=function(){for(var t=this.iterator();t.hasNext();){var e=t.next();e.getLabel().merge(e.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(t){for(var e=null,n=null,i=this._SCANNING_FOR_INCOMING,r=this._resultAreaEdgeList.size()-1;r>=0;r--){var o=this._resultAreaEdgeList.get(r),s=o.getSym();switch(null===e&&o.getEdgeRing()===t&&(e=o),i){case this._SCANNING_FOR_INCOMING:if(s.getEdgeRing()!==t)continue;n=s,i=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==t)continue;n.setNextMin(o),i=this._SCANNING_FOR_INCOMING}}i===this._LINKING_TO_OUTGOING&&(et.isTrue(null!==e,"found null for first outgoing dirEdge"),et.isTrue(e.getEdgeRing()===t,"unable to link last incoming dirEdge"),n.setNextMin(e))},e.prototype.getOutgoingDegree=function(){if(0===arguments.length){for(var t=0,e=this.iterator();e.hasNext();)e.next().isInResult()&&t++;return t}if(1===arguments.length){for(var n=arguments[0],i=0,r=this.iterator();r.hasNext();)r.next().getEdgeRing()===n&&i++;return i}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var t=T.NONE,e=this.iterator();e.hasNext();){var n=e.next(),i=n.getSym();if(!n.isLineEdge()){if(n.isInResult()){t=T.INTERIOR;break}if(i.isInResult()){t=T.EXTERIOR;break}}}if(t===T.NONE)return null;for(var r=t,o=this.iterator();o.hasNext();){var s=o.next(),a=s.getSym();s.isLineEdge()?s.getEdge().setCovered(r===T.INTERIOR):(s.isInResult()&&(r=T.EXTERIOR),a.isInResult()&&(r=T.INTERIOR))}},e.prototype.computeLabelling=function(e){t.prototype.computeLabelling.call(this,e),this._label=new Oe(T.NONE);for(var n=this.iterator();n.hasNext();)for(var i=n.next().getEdge().getLabel(),r=0;r<2;r++){var o=i.getLocation(r);o!==T.INTERIOR&&o!==T.BOUNDARY||this._label.setLocation(r,T.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Gn),Wn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(t){return new Fe(t,new qn)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Ge),Hn=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};Hn.prototype.compareTo=function(t){var e=t;return Hn.compareOriented(this._pts,this._orientation,e._pts,e._orientation)},Hn.prototype.interfaces_=function(){return[x]},Hn.prototype.getClass=function(){return Hn},Hn.orientation=function(t){return 1===Ct.increasingDirection(t)},Hn.compareOriented=function(t,e,n,i){for(var r=e?1:-1,o=i?1:-1,s=e?t.length:-1,a=i?n.length:-1,l=e?0:t.length-1,u=i?0:n.length-1;;){var c=t[l].compareTo(n[u]);if(0!==c)return c;var h=(l+=r)===s,f=(u+=o)===a;if(h&&!f)return-1;if(!h&&f)return 1;if(h&&f)return 0}};var Xn=function(){this._edges=new Et,this._ocaMap=new h};Xn.prototype.print=function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),r=0;r<i.length;r++)r>0&&t.print(","),t.print(i[r].x+" "+i[r].y);t.println(")")}t.print(")  ")},Xn.prototype.addAll=function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())},Xn.prototype.findEdgeIndex=function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1},Xn.prototype.iterator=function(){return this._edges.iterator()},Xn.prototype.getEdges=function(){return this._edges},Xn.prototype.get=function(t){return this._edges.get(t)},Xn.prototype.findEqualEdge=function(t){var e=new Hn(t.getCoordinates());return this._ocaMap.get(e)},Xn.prototype.add=function(t){this._edges.add(t);var e=new Hn(t.getCoordinates());this._ocaMap.put(e,t)},Xn.prototype.interfaces_=function(){return[]},Xn.prototype.getClass=function(){return Xn};var Yn=function(){};Yn.prototype.processIntersections=function(t,e,n,i){},Yn.prototype.isDone=function(){},Yn.prototype.interfaces_=function(){return[]},Yn.prototype.getClass=function(){return Yn};var Zn=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t};Zn.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(Zn.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.size()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},Zn.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},Zn.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},Zn.prototype.getLineIntersector=function(){return this._li},Zn.prototype.hasProperIntersection=function(){return this._hasProper},Zn.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))},Zn.prototype.hasIntersection=function(){return this._hasIntersection},Zn.prototype.isDone=function(){return!1},Zn.prototype.hasInteriorIntersection=function(){return this._hasInterior},Zn.prototype.interfaces_=function(){return[Yn]},Zn.prototype.getClass=function(){return Zn},Zn.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var Kn=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new S(t),this.segmentIndex=e,this.dist=n};Kn.prototype.getSegmentIndex=function(){return this.segmentIndex},Kn.prototype.getCoordinate=function(){return this.coord},Kn.prototype.print=function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)},Kn.prototype.compareTo=function(t){var e=t;return this.compare(e.segmentIndex,e.dist)},Kn.prototype.isEndPoint=function(t){return 0===this.segmentIndex&&0===this.dist||this.segmentIndex===t},Kn.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist},Kn.prototype.getDistance=function(){return this.dist},Kn.prototype.compare=function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0},Kn.prototype.interfaces_=function(){return[x]},Kn.prototype.getClass=function(){return Kn};var $n=function(){this._nodeMap=new h,this.edge=null;var t=arguments[0];this.edge=t};$n.prototype.print=function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)},$n.prototype.iterator=function(){return this._nodeMap.values().iterator()},$n.prototype.addSplitEdges=function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),r=this.createSplitEdge(n,i);t.add(r),n=i}},$n.prototype.addEndpoints=function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)},$n.prototype.createSplitEdge=function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],r=e.dist>0||!e.coord.equals2D(i);r||n--;var o=new Array(n).fill(null),s=0;o[s++]=new S(t.coord);for(var a=t.segmentIndex+1;a<=e.segmentIndex;a++)o[s++]=this.edge.pts[a];return r&&(o[s]=e.coord),new ni(o,new Oe(this.edge._label))},$n.prototype.add=function(t,e,n){var i=new Kn(t,e,n),r=this._nodeMap.get(i);return null!==r?r:(this._nodeMap.put(i,i),i)},$n.prototype.isIntersection=function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1},$n.prototype.interfaces_=function(){return[]},$n.prototype.getClass=function(){return $n};var Qn=function(){};Qn.prototype.getChainStartIndices=function(t){var e=0,n=new Et;n.add(new R(e));do{var i=this.findChainEnd(t,e);n.add(new R(i)),e=i}while(e<t.length-1);return Qn.toIntArray(n)},Qn.prototype.findChainEnd=function(t,e){for(var n=Be.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&Be.quadrant(t[i-1],t[i])===n;)i++;return i-1},Qn.prototype.interfaces_=function(){return[]},Qn.prototype.getClass=function(){return Qn},Qn.toIntArray=function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e};var Jn=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new H,this.env2=new H;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Qn;this.startIndex=e.getChainStartIndices(this.pts)};Jn.prototype.getCoordinates=function(){return this.pts},Jn.prototype.getMaxX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n},Jn.prototype.getMinX=function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n},Jn.prototype.computeIntersectsForChain=function(){if(4===arguments.length){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(6===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2],a=arguments[3],l=arguments[4],u=arguments[5],c=this.pts[r],h=this.pts[o],f=s.pts[a],d=s.pts[l];if(o-r==1&&l-a==1)return u.addIntersections(this.e,r,s.e,a),null;if(this.env1.init(c,h),this.env2.init(f,d),!this.env1.intersects(this.env2))return null;var p=Math.trunc((r+o)/2),g=Math.trunc((a+l)/2);r<p&&(a<g&&this.computeIntersectsForChain(r,p,s,a,g,u),g<l&&this.computeIntersectsForChain(r,p,s,g,l,u)),p<o&&(a<g&&this.computeIntersectsForChain(p,o,s,a,g,u),g<l&&this.computeIntersectsForChain(p,o,s,g,l,u))}},Jn.prototype.getStartIndexes=function(){return this.startIndex},Jn.prototype.computeIntersects=function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)},Jn.prototype.interfaces_=function(){return[]},Jn.prototype.getClass=function(){return Jn};var ti=function t(){this._depth=Array(2).fill().map((function(){return Array(3)}));for(var e=0;e<2;e++)for(var n=0;n<3;n++)this._depth[e][n]=t.NULL_VALUE},ei={NULL_VALUE:{configurable:!0}};ti.prototype.getDepth=function(t,e){return this._depth[t][e]},ti.prototype.setDepth=function(t,e,n){this._depth[t][e]=n},ti.prototype.isNull=function(){if(0===arguments.length){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==ti.NULL_VALUE)return!1;return!0}if(1===arguments.length){var n=arguments[0];return this._depth[n][1]===ti.NULL_VALUE}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._depth[i][r]===ti.NULL_VALUE}},ti.prototype.normalize=function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}},ti.prototype.getDelta=function(t){return this._depth[t][Pe.RIGHT]-this._depth[t][Pe.LEFT]},ti.prototype.getLocation=function(t,e){return this._depth[t][e]<=0?T.EXTERIOR:T.INTERIOR},ti.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]},ti.prototype.add=function(){if(1===arguments.length)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==T.EXTERIOR&&i!==T.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=ti.depthAtLocation(i):this._depth[e][n]+=ti.depthAtLocation(i))}else if(3===arguments.length){var r=arguments[0],o=arguments[1];arguments[2]===T.INTERIOR&&this._depth[r][o]++}},ti.prototype.interfaces_=function(){return[]},ti.prototype.getClass=function(){return ti},ti.depthAtLocation=function(t){return t===T.EXTERIOR?0:t===T.INTERIOR?1:ti.NULL_VALUE},ei.NULL_VALUE.get=function(){return-1},Object.defineProperties(ti,ei);var ni=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new $n(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new ti,this._depthDelta=0,1===arguments.length){var n=arguments[0];e.call(this,n,null)}else if(2===arguments.length){var i=arguments[0],r=arguments[1];this.pts=i,this._label=r}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var t=new Array(2).fill(null);return t[0]=this.pts[0],t[1]=this.pts[1],new e(t,Oe.toLineLabel(this._label))},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(t){this._isIsolated=t},e.prototype.setName=function(t){this._name=t},e.prototype.equals=function(t){if(!(t instanceof e))return!1;var n=t;if(this.pts.length!==n.pts.length)return!1;for(var i=!0,r=!0,o=this.pts.length,s=0;s<this.pts.length;s++)if(this.pts[s].equals2D(n.pts[s])||(i=!1),this.pts[s].equals2D(n.pts[--o])||(r=!1),!i&&!r)return!1;return!0},e.prototype.getCoordinate=function(){if(0===arguments.length)return this.pts.length>0?this.pts[0]:null;if(1===arguments.length){var t=arguments[0];return this.pts[t]}},e.prototype.print=function(t){t.print("edge "+this._name+": "),t.print("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.print(","),t.print(this.pts[e].x+" "+this.pts[e].y);t.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(t){e.updateIM(this._label,t)},e.prototype.isCollapsed=function(){return!!this._label.isArea()&&3===this.pts.length&&!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(t){t.print("edge "+this._name+": ");for(var e=this.pts.length-1;e>=0;e--)t.print(this.pts[e]+" ");t.println("")},e.prototype.getMonotoneChainEdge=function(){return null===this._mce&&(this._mce=new Jn(this)),this._mce},e.prototype.getEnvelope=function(){if(null===this._env){this._env=new H;for(var t=0;t<this.pts.length;t++)this._env.expandToInclude(this.pts[t])}return this._env},e.prototype.addIntersection=function(t,e,n,i){var r=new S(t.getIntersection(i)),o=e,s=t.getEdgeDistance(n,i),a=o+1;if(a<this.pts.length){var l=this.pts[a];r.equals2D(l)&&(o=a,s=0)}this.eiList.add(r,o,s)},e.prototype.toString=function(){var t=new N;t.append("edge "+this._name+": "),t.append("LINESTRING (");for(var e=0;e<this.pts.length;e++)e>0&&t.append(","),t.append(this.pts[e].x+" "+this.pts[e].y);return t.append(")  "+this._label+" "+this._depthDelta),t.toString()},e.prototype.isPointwiseEqual=function(t){if(this.pts.length!==t.pts.length)return!1;for(var e=0;e<this.pts.length;e++)if(!this.pts[e].equals2D(t.pts[e]))return!1;return!0},e.prototype.setDepthDelta=function(t){this._depthDelta=t},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(2!==arguments.length)return t.prototype.updateIM.apply(this,arguments);var e=arguments[0],n=arguments[1];n.setAtLeastIfValid(e.getLocation(0,Pe.ON),e.getLocation(1,Pe.ON),1),e.isArea()&&(n.setAtLeastIfValid(e.getLocation(0,Pe.LEFT),e.getLocation(1,Pe.LEFT),2),n.setAtLeastIfValid(e.getLocation(0,Pe.RIGHT),e.getLocation(1,Pe.RIGHT),2))},e}(De),ii=function(t){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Xn,this._bufParams=t||null};ii.prototype.setWorkingPrecisionModel=function(t){this._workingPrecisionModel=t},ii.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Oe(t.getLabel())).flip(),n.merge(i);var r=ii.depthDelta(i),o=e.getDepthDelta()+r;e.setDepthDelta(o)}else this._edgeList.add(t),t.setDepthDelta(ii.depthDelta(t.getLabel()))},ii.prototype.buildSubgraphs=function(t,e){for(var n=new Et,i=t.iterator();i.hasNext();){var r=i.next(),o=r.getRightmostCoordinate(),s=new kn(n).getDepth(o);r.computeDepth(s),r.findResultEdges(),n.add(r),e.add(r.getDirectedEdges(),r.getNodes())}},ii.prototype.createSubgraphs=function(t){for(var e=new Et,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var r=new Le;r.create(i),e.add(r)}}return Je.sort(e,Je.reverseOrder()),e},ii.prototype.createEmptyResultGeometry=function(){return this._geomFact.createPolygon()},ii.prototype.getNoder=function(t){if(null!==this._workingNoder)return this._workingNoder;var e=new wn,n=new rt;return n.setPrecisionModel(t),e.setSegmentIntersector(new Zn(n)),e},ii.prototype.buffer=function(t,e){var n=this._workingPrecisionModel;null===n&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new Rn(n,this._bufParams),r=new Bn(t,e,i).getCurves();if(r.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(r,n),this._graph=new qe(new Wn),this._graph.addEdges(this._edgeList.getEdges());var o=this.createSubgraphs(this._graph),s=new We(this._geomFact);this.buildSubgraphs(o,s);var a=s.getPolygons();return a.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(a)},ii.prototype.computeNodedEdges=function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var r=i.next(),o=r.getCoordinates();if(2!==o.length||!o[0].equals2D(o[1])){var s=r.getData(),a=new ni(r.getCoordinates(),new Oe(s));this.insertUniqueEdge(a)}}},ii.prototype.setNoder=function(t){this._workingNoder=t},ii.prototype.interfaces_=function(){return[]},ii.prototype.getClass=function(){return ii},ii.depthDelta=function(t){var e=t.getLocation(0,Pe.LEFT),n=t.getLocation(0,Pe.RIGHT);return e===T.INTERIOR&&n===T.EXTERIOR?1:e===T.EXTERIOR&&n===T.INTERIOR?-1:0},ii.convertSegStrings=function(t){for(var e=new ye,n=new Et;t.hasNext();){var i=t.next(),r=e.createLineString(i.getCoordinates());n.add(r)}return e.buildGeometry(n)};var ri=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,2===arguments.length){var t=arguments[0],e=arguments[1];this._noder=t,this._scaleFactor=e,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(4===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2],o=arguments[3];this._noder=n,this._scaleFactor=i,this._offsetX=r,this._offsetY=o,this._isScaled=!this.isIntegerPrecision()}};ri.prototype.rescale=function(){if(L(arguments[0],bt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.rescale(e.getCoordinates())}else if(arguments[0]instanceof Array){for(var n=arguments[0],i=0;i<n.length;i++)n[i].x=n[i].x/this._scaleFactor+this._offsetX,n[i].y=n[i].y/this._scaleFactor+this._offsetY;2===n.length&&n[0].equals2D(n[1])&&q.out.println(n)}},ri.prototype.scale=function(){if(L(arguments[0],bt)){for(var t=arguments[0],e=new Et,n=t.iterator();n.hasNext();){var i=n.next();e.add(new pn(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var r=arguments[0],o=new Array(r.length).fill(null),s=0;s<r.length;s++)o[s]=new S(Math.round((r[s].x-this._offsetX)*this._scaleFactor),Math.round((r[s].y-this._offsetY)*this._scaleFactor),r[s].z);return Ct.removeRepeatedPoints(o)}},ri.prototype.isIntegerPrecision=function(){return 1===this._scaleFactor},ri.prototype.getNodedSubstrings=function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t},ri.prototype.computeNodes=function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)},ri.prototype.interfaces_=function(){return[bn]},ri.prototype.getClass=function(){return ri};var oi=function(){this._li=new rt,this._segStrings=null;var t=arguments[0];this._segStrings=t},si={fact:{configurable:!0}};oi.prototype.checkEndPtVertexIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next().getCoordinates();this.checkEndPtVertexIntersections(e[0],this._segStrings),this.checkEndPtVertexIntersections(e[e.length-1],this._segStrings)}else if(2===arguments.length)for(var n=arguments[0],i=arguments[1].iterator();i.hasNext();)for(var r=i.next().getCoordinates(),o=1;o<r.length-1;o++)if(r[o].equals(n))throw new J("found endpt/interior pt intersection at index "+o+" :pt "+n)},oi.prototype.checkInteriorIntersections=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(2===arguments.length)for(var r=arguments[0],o=arguments[1],s=r.getCoordinates(),a=o.getCoordinates(),l=0;l<s.length-1;l++)for(var u=0;u<a.length-1;u++)this.checkInteriorIntersections(r,l,o,u);else if(4===arguments.length){var c=arguments[0],h=arguments[1],f=arguments[2],d=arguments[3];if(c===f&&h===d)return null;var p=c.getCoordinates()[h],g=c.getCoordinates()[h+1],m=f.getCoordinates()[d],y=f.getCoordinates()[d+1];if(this._li.computeIntersection(p,g,m,y),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,p,g)||this.hasInteriorIntersection(this._li,m,y)))throw new J("found non-noded intersection at "+p+"-"+g+" and "+m+"-"+y)}},oi.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()},oi.prototype.checkCollapses=function(){if(0===arguments.length)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(1===arguments.length)for(var n=arguments[0].getCoordinates(),i=0;i<n.length-2;i++)this.checkCollapse(n[i],n[i+1],n[i+2])},oi.prototype.hasInteriorIntersection=function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var r=t.getIntersection(i);if(!r.equals(e)&&!r.equals(n))return!0}return!1},oi.prototype.checkCollapse=function(t,e,n){if(t.equals(n))throw new J("found non-noded collapse at "+oi.fact.createLineString([t,e,n]))},oi.prototype.interfaces_=function(){return[]},oi.prototype.getClass=function(){return oi},si.fact.get=function(){return new ye},Object.defineProperties(oi,si);var ai=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new v("Scale factor must be non-zero");1!==e&&(this._pt=new S(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new S,this._p1Scaled=new S),this.initCorners(this._pt)},li={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};ai.prototype.intersectsScaled=function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),r=Math.min(t.y,e.y),o=Math.max(t.y,e.y),s=this._maxx<n||this._minx>i||this._maxy<r||this._miny>o;if(s)return!1;var a=this.intersectsToleranceSquare(t,e);return et.isTrue(!(s&&a),"Found bad envelope test"),a},ai.prototype.initCorners=function(t){this._minx=t.x-.5,this._maxx=t.x+.5,this._miny=t.y-.5,this._maxy=t.y+.5,this._corner[0]=new S(this._maxx,this._maxy),this._corner[1]=new S(this._minx,this._maxy),this._corner[2]=new S(this._minx,this._miny),this._corner[3]=new S(this._maxx,this._miny)},ai.prototype.intersects=function(t,e){return 1===this._scaleFactor?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))},ai.prototype.scale=function(t){return Math.round(t*this._scaleFactor)},ai.prototype.getCoordinate=function(){return this._originalPt},ai.prototype.copyScaled=function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)},ai.prototype.getSafeEnvelope=function(){if(null===this._safeEnv){var t=ai.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new H(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv},ai.prototype.intersectsPixelClosure=function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.hasIntersection()))))},ai.prototype.intersectsToleranceSquare=function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),this._li.isProper()||n&&i||t.equals(this._pt)||e.equals(this._pt)))))},ai.prototype.addSnappedNode=function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)},ai.prototype.interfaces_=function(){return[]},ai.prototype.getClass=function(){return ai},li.SAFE_ENV_EXPANSION_FACTOR.get=function(){return.75},Object.defineProperties(ai,li);var ui=function(){this.tempEnv1=new H,this.selectedSegment=new gn};ui.prototype.select=function(){if(1===arguments.length);else if(2===arguments.length){var t=arguments[1];arguments[0].getLineSegment(t,this.selectedSegment),this.select(this.selectedSegment)}},ui.prototype.interfaces_=function(){return[]},ui.prototype.getClass=function(){return ui};var ci=function(){this._index=null;var t=arguments[0];this._index=t},hi={HotPixelSnapAction:{configurable:!0}};ci.prototype.snap=function(){if(1===arguments.length){var t=arguments[0];return this.snap(t,null,-1)}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2],r=e.getSafeEnvelope(),o=new fi(e,n,i);return this._index.query(r,{interfaces_:function(){return[Ze]},visitItem:function(t){t.select(r,o)}}),o.isNodeAdded()}},ci.prototype.interfaces_=function(){return[]},ci.prototype.getClass=function(){return ci},hi.HotPixelSnapAction.get=function(){return fi},Object.defineProperties(ci,hi);var fi=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var e=arguments[0],n=arguments[1],i=arguments[2];this._hotPixel=e,this._parentEdge=n,this._hotPixelVertexIndex=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(2!==arguments.length)return t.prototype.select.apply(this,arguments);var e=arguments[1],n=arguments[0].getContext();if(null!==this._parentEdge&&n===this._parentEdge&&e===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(n,e)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ui),di=function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new Et};di.prototype.processIntersections=function(t,e,n,i){if(t===n&&e===i)return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];if(this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}},di.prototype.isDone=function(){return!1},di.prototype.getInteriorIntersections=function(){return this._interiorIntersections},di.prototype.interfaces_=function(){return[Yn]},di.prototype.getClass=function(){return di};var pi=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new rt,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()};pi.prototype.checkCorrectness=function(t){var e=pn.getNodedSubstrings(t),n=new oi(e);try{n.checkValid()}catch(t){if(!(t instanceof V))throw t;t.printStackTrace()}},pi.prototype.getNodedSubstrings=function(){return pn.getNodedSubstrings(this._nodedSegStrings)},pi.prototype.snapRound=function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)},pi.prototype.findInteriorIntersections=function(t,e){var n=new di(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()},pi.prototype.computeVertexSnaps=function(){if(L(arguments[0],bt))for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.computeVertexSnaps(e)}else if(arguments[0]instanceof pn)for(var n=arguments[0],i=n.getCoordinates(),r=0;r<i.length;r++){var o=new ai(i[r],this._scaleFactor,this._li);this._pointSnapper.snap(o,n,r)&&n.addIntersection(i[r],r)}},pi.prototype.computeNodes=function(t){this._nodedSegStrings=t,this._noder=new wn,this._pointSnapper=new ci(this._noder.getIndex()),this.snapRound(t,this._li)},pi.prototype.computeIntersectionSnaps=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new ai(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}},pi.prototype.interfaces_=function(){return[bn]},pi.prototype.getClass=function(){return pi};var gi=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Sn,this._resultGeometry=null,this._saveException=null,1===arguments.length){var t=arguments[0];this._argGeom=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}},mi={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};gi.prototype.bufferFixedPrecision=function(t){var e=new ri(new pi(new de(1)),t.getScale()),n=new ii(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)},gi.prototype.bufferReducedPrecision=function(){var t=this;if(0===arguments.length){for(var e=gi.MAX_PRECISION_DIGITS;e>=0;e--){try{t.bufferReducedPrecision(e)}catch(e){if(!(e instanceof Te))throw e;t._saveException=e}if(null!==t._resultGeometry)return null}throw this._saveException}if(1===arguments.length){var n=arguments[0],i=gi.precisionScaleFactor(this._argGeom,this._distance,n),r=new de(i);this.bufferFixedPrecision(r)}},gi.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),null!==this._resultGeometry)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===de.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()},gi.prototype.setQuadrantSegments=function(t){this._bufParams.setQuadrantSegments(t)},gi.prototype.bufferOriginalPrecision=function(){try{var t=new ii(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(t){if(!(t instanceof J))throw t;this._saveException=t}},gi.prototype.getResultGeometry=function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry},gi.prototype.setEndCapStyle=function(t){this._bufParams.setEndCapStyle(t)},gi.prototype.interfaces_=function(){return[]},gi.prototype.getClass=function(){return gi},gi.bufferOp=function(){if(2===arguments.length){var t=arguments[1];return new gi(arguments[0]).getResultGeometry(t)}if(3===arguments.length){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var e=arguments[1],n=arguments[2],i=new gi(arguments[0]);return i.setQuadrantSegments(n),i.getResultGeometry(e)}if(arguments[2]instanceof Sn&&arguments[0]instanceof ct&&"number"==typeof arguments[1]){var r=arguments[1];return new gi(arguments[0],arguments[2]).getResultGeometry(r)}}else if(4===arguments.length){var o=arguments[1],s=arguments[2],a=arguments[3],l=new gi(arguments[0]);return l.setQuadrantSegments(s),l.setEndCapStyle(a),l.getResultGeometry(o)}},gi.precisionScaleFactor=function(t,e,n){var i=t.getEnvelopeInternal(),r=A.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),o=n-Math.trunc(Math.log(r)/Math.log(10)+1);return Math.pow(10,o)},mi.CAP_ROUND.get=function(){return Sn.CAP_ROUND},mi.CAP_BUTT.get=function(){return Sn.CAP_FLAT},mi.CAP_FLAT.get=function(){return Sn.CAP_FLAT},mi.CAP_SQUARE.get=function(){return Sn.CAP_SQUARE},mi.MAX_PRECISION_DIGITS.get=function(){return 12},Object.defineProperties(gi,mi);var yi=function(){this._pt=[new S,new S],this._distance=_.NaN,this._isNull=!0};yi.prototype.getCoordinates=function(){return this._pt},yi.prototype.getCoordinate=function(t){return this._pt[t]},yi.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},yi.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},yi.prototype.getDistance=function(){return this._distance},yi.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},yi.prototype.interfaces_=function(){return[]},yi.prototype.getClass=function(){return yi};var vi=function(){};vi.prototype.interfaces_=function(){return[]},vi.prototype.getClass=function(){return vi},vi.computeDistance=function(){if(arguments[2]instanceof yi&&arguments[0]instanceof Zt&&arguments[1]instanceof S)for(var t=arguments[1],e=arguments[2],n=arguments[0].getCoordinates(),i=new gn,r=0;r<n.length-1;r++){i.setCoordinates(n[r],n[r+1]);var o=i.closestPoint(t);e.setMinimum(o,t)}else if(arguments[2]instanceof yi&&arguments[0]instanceof Jt&&arguments[1]instanceof S){var s=arguments[0],a=arguments[1],l=arguments[2];vi.computeDistance(s.getExteriorRing(),a,l);for(var u=0;u<s.getNumInteriorRing();u++)vi.computeDistance(s.getInteriorRingN(u),a,l)}else if(arguments[2]instanceof yi&&arguments[0]instanceof ct&&arguments[1]instanceof S){var c=arguments[0],h=arguments[1],f=arguments[2];if(c instanceof Zt)vi.computeDistance(c,h,f);else if(c instanceof Jt)vi.computeDistance(c,h,f);else if(c instanceof Vt)for(var d=c,p=0;p<d.getNumGeometries();p++){var g=d.getGeometryN(p);vi.computeDistance(g,h,f)}else f.setMinimum(c.getCoordinate(),h)}else if(arguments[2]instanceof yi&&arguments[0]instanceof gn&&arguments[1]instanceof S){var m=arguments[1],y=arguments[2],v=arguments[0].closestPoint(m);y.setMinimum(v,m)}};var _i=function(t){this._maxPtDist=new yi,this._inputGeom=t||null},bi={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};_i.prototype.computeMaxMidpointDistance=function(t){var e=new wi(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_i.prototype.computeMaxVertexDistance=function(t){var e=new xi(this._inputGeom);t.apply(e),this._maxPtDist.setMaximum(e.getMaxPointDistance())},_i.prototype.findDistance=function(t){return this.computeMaxVertexDistance(t),this.computeMaxMidpointDistance(t),this._maxPtDist.getDistance()},_i.prototype.getDistancePoints=function(){return this._maxPtDist},_i.prototype.interfaces_=function(){return[]},_i.prototype.getClass=function(){return _i},bi.MaxPointDistanceFilter.get=function(){return xi},bi.MaxMidpointDistanceFilter.get=function(){return wi},Object.defineProperties(_i,bi);var xi=function(t){this._maxPtDist=new yi,this._minPtDist=new yi,this._geom=t||null};xi.prototype.filter=function(t){this._minPtDist.initialize(),vi.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},xi.prototype.getMaxPointDistance=function(){return this._maxPtDist},xi.prototype.interfaces_=function(){return[dt]},xi.prototype.getClass=function(){return xi};var wi=function(t){this._maxPtDist=new yi,this._minPtDist=new yi,this._geom=t||null};wi.prototype.filter=function(t,e){if(0===e)return null;var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=new S((n.x+i.x)/2,(n.y+i.y)/2);this._minPtDist.initialize(),vi.computeDistance(this._geom,r,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},wi.prototype.isDone=function(){return!1},wi.prototype.isGeometryChanged=function(){return!1},wi.prototype.getMaxPointDistance=function(){return this._maxPtDist},wi.prototype.interfaces_=function(){return[Ut]},wi.prototype.getClass=function(){return wi};var Ei=function(t){this._comps=t||null};Ei.prototype.filter=function(t){t instanceof Jt&&this._comps.add(t)},Ei.prototype.interfaces_=function(){return[jt]},Ei.prototype.getClass=function(){return Ei},Ei.getPolygons=function(){if(1===arguments.length){var t=arguments[0];return Ei.getPolygons(t,new Et)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof Jt?n.add(e):e instanceof Vt&&e.apply(new Ei(n)),n}};var Si=function(){if(this._lines=null,this._isForcedToLineString=!1,1===arguments.length){var t=arguments[0];this._lines=t}else if(2===arguments.length){var e=arguments[0],n=arguments[1];this._lines=e,this._isForcedToLineString=n}};Si.prototype.filter=function(t){if(this._isForcedToLineString&&t instanceof ee){var e=t.getFactory().createLineString(t.getCoordinateSequence());return this._lines.add(e),null}t instanceof Zt&&this._lines.add(t)},Si.prototype.setForceToLineString=function(t){this._isForcedToLineString=t},Si.prototype.interfaces_=function(){return[ut]},Si.prototype.getClass=function(){return Si},Si.getGeometry=function(){if(1===arguments.length){var t=arguments[0];return t.getFactory().buildGeometry(Si.getLines(t))}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().buildGeometry(Si.getLines(e,n))}},Si.getLines=function(){if(1===arguments.length){var t=arguments[0];return Si.getLines(t,!1)}if(2===arguments.length){if(L(arguments[0],bt)&&L(arguments[1],bt)){for(var e=arguments[1],n=arguments[0].iterator();n.hasNext();){var i=n.next();Si.getLines(i,e)}return e}if(arguments[0]instanceof ct&&"boolean"==typeof arguments[1]){var r=arguments[0],o=arguments[1],s=new Et;return r.apply(new Si(s,o)),s}if(arguments[0]instanceof ct&&L(arguments[1],bt)){var a=arguments[0],l=arguments[1];return a instanceof Zt?l.add(a):a.apply(new Si(l)),l}}else if(3===arguments.length){if("boolean"==typeof arguments[2]&&L(arguments[0],bt)&&L(arguments[1],bt)){for(var u=arguments[1],c=arguments[2],h=arguments[0].iterator();h.hasNext();){var f=h.next();Si.getLines(f,u,c)}return u}if("boolean"==typeof arguments[2]&&arguments[0]instanceof ct&&L(arguments[1],bt)){var d=arguments[1],p=arguments[2];return arguments[0].apply(new Si(d,p)),d}}};var Pi=function(){if(this._boundaryRule=pt.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,0===arguments.length);else if(1===arguments.length){var t=arguments[0];if(null===t)throw new v("Rule must be non-null");this._boundaryRule=t}};Pi.prototype.locateInternal=function(){if(arguments[0]instanceof S&&arguments[1]instanceof Jt){var t=arguments[0],e=arguments[1];if(e.isEmpty())return T.EXTERIOR;var n=e.getExteriorRing(),i=this.locateInPolygonRing(t,n);if(i===T.EXTERIOR)return T.EXTERIOR;if(i===T.BOUNDARY)return T.BOUNDARY;for(var r=0;r<e.getNumInteriorRing();r++){var o=e.getInteriorRingN(r),s=this.locateInPolygonRing(t,o);if(s===T.INTERIOR)return T.EXTERIOR;if(s===T.BOUNDARY)return T.BOUNDARY}return T.INTERIOR}if(arguments[0]instanceof S&&arguments[1]instanceof Zt){var a=arguments[0],l=arguments[1];if(!l.getEnvelopeInternal().intersects(a))return T.EXTERIOR;var u=l.getCoordinates();return l.isClosed()||!a.equals(u[0])&&!a.equals(u[u.length-1])?at.isOnLine(a,u)?T.INTERIOR:T.EXTERIOR:T.BOUNDARY}if(arguments[0]instanceof S&&arguments[1]instanceof $t){var c=arguments[0];return arguments[1].getCoordinate().equals2D(c)?T.INTERIOR:T.EXTERIOR}},Pi.prototype.locateInPolygonRing=function(t,e){return e.getEnvelopeInternal().intersects(t)?at.locatePointInRing(t,e.getCoordinates()):T.EXTERIOR},Pi.prototype.intersects=function(t,e){return this.locate(t,e)!==T.EXTERIOR},Pi.prototype.updateLocationInfo=function(t){t===T.INTERIOR&&(this._isIn=!0),t===T.BOUNDARY&&this._numBoundaries++},Pi.prototype.computeLocation=function(t,e){if(e instanceof $t&&this.updateLocationInfo(this.locateInternal(t,e)),e instanceof Zt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Jt)this.updateLocationInfo(this.locateInternal(t,e));else if(e instanceof Gt)for(var n=e,i=0;i<n.getNumGeometries();i++){var r=n.getGeometryN(i);this.updateLocationInfo(this.locateInternal(t,r))}else if(e instanceof ne)for(var o=e,s=0;s<o.getNumGeometries();s++){var a=o.getGeometryN(s);this.updateLocationInfo(this.locateInternal(t,a))}else if(e instanceof Vt)for(var l=new Un(e);l.hasNext();){var u=l.next();u!==e&&this.computeLocation(t,u)}},Pi.prototype.locate=function(t,e){return e.isEmpty()?T.EXTERIOR:e instanceof Zt||e instanceof Jt?this.locateInternal(t,e):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(t,e),this._boundaryRule.isInBoundary(this._numBoundaries)?T.BOUNDARY:this._numBoundaries>0||this._isIn?T.INTERIOR:T.EXTERIOR)},Pi.prototype.interfaces_=function(){return[]},Pi.prototype.getClass=function(){return Pi};var Ci=function t(){if(this._component=null,this._segIndex=null,this._pt=null,2===arguments.length)t.call(this,arguments[0],t.INSIDE_AREA,arguments[1]);else if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];this._component=e,this._segIndex=n,this._pt=i}},Ii={INSIDE_AREA:{configurable:!0}};Ci.prototype.isInsideArea=function(){return this._segIndex===Ci.INSIDE_AREA},Ci.prototype.getCoordinate=function(){return this._pt},Ci.prototype.getGeometryComponent=function(){return this._component},Ci.prototype.getSegmentIndex=function(){return this._segIndex},Ci.prototype.interfaces_=function(){return[]},Ci.prototype.getClass=function(){return Ci},Ii.INSIDE_AREA.get=function(){return-1},Object.defineProperties(Ci,Ii);var Ti=function(t){this._pts=t||null};Ti.prototype.filter=function(t){t instanceof $t&&this._pts.add(t)},Ti.prototype.interfaces_=function(){return[jt]},Ti.prototype.getClass=function(){return Ti},Ti.getPoints=function(){if(1===arguments.length){var t=arguments[0];return t instanceof $t?Je.singletonList(t):Ti.getPoints(t,new Et)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e instanceof $t?n.add(e):e instanceof Vt&&e.apply(new Ti(n)),n}};var Mi=function(){this._locations=null;var t=arguments[0];this._locations=t};Mi.prototype.filter=function(t){(t instanceof $t||t instanceof Zt||t instanceof Jt)&&this._locations.add(new Ci(t,0,t.getCoordinate()))},Mi.prototype.interfaces_=function(){return[jt]},Mi.prototype.getClass=function(){return Mi},Mi.getLocations=function(t){var e=new Et;return t.apply(new Mi(e)),e};var Li=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Pi,this._minDistanceLocation=null,this._minDistance=_.MAX_VALUE,2===arguments.length){var t=arguments[0],e=arguments[1];this._geom=[t,e],this._terminateDistance=0}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=n,this._geom[1]=i,this._terminateDistance=r}};Li.prototype.computeContainmentDistance=function(){if(0===arguments.length){var t=new Array(2).fill(null);if(this.computeContainmentDistance(0,t),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=1-e,r=Ei.getPolygons(this._geom[e]);if(r.size()>0){var o=Mi.getLocations(this._geom[i]);if(this.computeContainmentDistance(o,r,n),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[i]=n[0],this._minDistanceLocation[e]=n[1],null}}else if(3===arguments.length)if(arguments[2]instanceof Array&&L(arguments[0],wt)&&L(arguments[1],wt)){for(var s=arguments[0],a=arguments[1],l=arguments[2],u=0;u<s.size();u++)for(var c=s.get(u),h=0;h<a.size();h++)if(this.computeContainmentDistance(c,a.get(h),l),this._minDistance<=this._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ci&&arguments[1]instanceof Jt){var f=arguments[0],d=arguments[1],p=arguments[2],g=f.getCoordinate();if(T.EXTERIOR!==this._ptLocator.locate(g,d))return this._minDistance=0,p[0]=f,p[1]=new Ci(d,g),null}},Li.prototype.computeMinDistanceLinesPoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Li.prototype.computeFacetDistance=function(){var t=new Array(2).fill(null),e=Si.getLines(this._geom[0]),n=Si.getLines(this._geom[1]),i=Ti.getPoints(this._geom[0]),r=Ti.getPoints(this._geom[1]);return this.computeMinDistanceLines(e,n,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(e,r,t),this.updateMinDistance(t,!1),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistanceLinesPoints(n,i,t),this.updateMinDistance(t,!0),this._minDistance<=this._terminateDistance?null:(t[0]=null,t[1]=null,this.computeMinDistancePoints(i,r,t),void this.updateMinDistance(t,!1))))},Li.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation},Li.prototype.updateMinDistance=function(t,e){if(null===t[0])return null;e?(this._minDistanceLocation[0]=t[1],this._minDistanceLocation[1]=t[0]):(this._minDistanceLocation[0]=t[0],this._minDistanceLocation[1]=t[1])},Li.prototype.nearestPoints=function(){return this.computeMinDistance(),[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()]},Li.prototype.computeMinDistance=function(){if(0===arguments.length){if(null!==this._minDistanceLocation)return null;if(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance)return null;this.computeFacetDistance()}else if(3===arguments.length)if(arguments[2]instanceof Array&&arguments[0]instanceof Zt&&arguments[1]instanceof $t){var t=arguments[0],e=arguments[1],n=arguments[2];if(t.getEnvelopeInternal().distance(e.getEnvelopeInternal())>this._minDistance)return null;for(var i=t.getCoordinates(),r=e.getCoordinate(),o=0;o<i.length-1;o++){var s=at.distancePointLine(r,i[o],i[o+1]);if(s<this._minDistance){this._minDistance=s;var a=new gn(i[o],i[o+1]).closestPoint(r);n[0]=new Ci(t,o,a),n[1]=new Ci(e,0,r)}if(this._minDistance<=this._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof Zt&&arguments[1]instanceof Zt){var l=arguments[0],u=arguments[1],c=arguments[2];if(l.getEnvelopeInternal().distance(u.getEnvelopeInternal())>this._minDistance)return null;for(var h=l.getCoordinates(),f=u.getCoordinates(),d=0;d<h.length-1;d++)for(var p=0;p<f.length-1;p++){var g=at.distanceLineLine(h[d],h[d+1],f[p],f[p+1]);if(g<this._minDistance){this._minDistance=g;var m=new gn(h[d],h[d+1]),y=new gn(f[p],f[p+1]),v=m.closestPoints(y);c[0]=new Ci(l,d,v[0]),c[1]=new Ci(u,p,v[1])}if(this._minDistance<=this._terminateDistance)return null}}},Li.prototype.computeMinDistancePoints=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o),a=r.getCoordinate().distance(s.getCoordinate());if(a<this._minDistance&&(this._minDistance=a,n[0]=new Ci(r,0,r.getCoordinate()),n[1]=new Ci(s,0,s.getCoordinate())),this._minDistance<=this._terminateDistance)return null}},Li.prototype.distance=function(){if(null===this._geom[0]||null===this._geom[1])throw new v("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)},Li.prototype.computeMinDistanceLines=function(t,e,n){for(var i=0;i<t.size();i++)for(var r=t.get(i),o=0;o<e.size();o++){var s=e.get(o);if(this.computeMinDistance(r,s,n),this._minDistance<=this._terminateDistance)return null}},Li.prototype.interfaces_=function(){return[]},Li.prototype.getClass=function(){return Li},Li.distance=function(t,e){return new Li(t,e).distance()},Li.isWithinDistance=function(t,e,n){return new Li(t,e,n).distance()<=n},Li.nearestPoints=function(t,e){return new Li(t,e).nearestPoints()};var Ai=function(){this._pt=[new S,new S],this._distance=_.NaN,this._isNull=!0};Ai.prototype.getCoordinates=function(){return this._pt},Ai.prototype.getCoordinate=function(t){return this._pt[t]},Ai.prototype.setMinimum=function(){if(1===arguments.length){var t=arguments[0];this.setMinimum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i<this._distance&&this.initialize(e,n,i)}},Ai.prototype.initialize=function(){if(0===arguments.length)this._isNull=!0;else if(2===arguments.length){var t=arguments[0],e=arguments[1];this._pt[0].setCoordinate(t),this._pt[1].setCoordinate(e),this._distance=t.distance(e),this._isNull=!1}else if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];this._pt[0].setCoordinate(n),this._pt[1].setCoordinate(i),this._distance=r,this._isNull=!1}},Ai.prototype.toString=function(){return Q.toLineString(this._pt[0],this._pt[1])},Ai.prototype.getDistance=function(){return this._distance},Ai.prototype.setMaximum=function(){if(1===arguments.length){var t=arguments[0];this.setMaximum(t._pt[0],t._pt[1])}else if(2===arguments.length){var e=arguments[0],n=arguments[1];if(this._isNull)return this.initialize(e,n),null;var i=e.distance(n);i>this._distance&&this.initialize(e,n,i)}},Ai.prototype.interfaces_=function(){return[]},Ai.prototype.getClass=function(){return Ai};var Oi=function(){};Oi.prototype.interfaces_=function(){return[]},Oi.prototype.getClass=function(){return Oi},Oi.computeDistance=function(){if(arguments[2]instanceof Ai&&arguments[0]instanceof Zt&&arguments[1]instanceof S)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=new gn,r=t.getCoordinates(),o=0;o<r.length-1;o++){i.setCoordinates(r[o],r[o+1]);var s=i.closestPoint(e);n.setMinimum(s,e)}else if(arguments[2]instanceof Ai&&arguments[0]instanceof Jt&&arguments[1]instanceof S){var a=arguments[0],l=arguments[1],u=arguments[2];Oi.computeDistance(a.getExteriorRing(),l,u);for(var c=0;c<a.getNumInteriorRing();c++)Oi.computeDistance(a.getInteriorRingN(c),l,u)}else if(arguments[2]instanceof Ai&&arguments[0]instanceof ct&&arguments[1]instanceof S){var h=arguments[0],f=arguments[1],d=arguments[2];if(h instanceof Zt)Oi.computeDistance(h,f,d);else if(h instanceof Jt)Oi.computeDistance(h,f,d);else if(h instanceof Vt)for(var p=h,g=0;g<p.getNumGeometries();g++){var m=p.getGeometryN(g);Oi.computeDistance(m,f,d)}else d.setMinimum(h.getCoordinate(),f)}else if(arguments[2]instanceof Ai&&arguments[0]instanceof gn&&arguments[1]instanceof S){var y=arguments[1],v=arguments[2],_=arguments[0].closestPoint(y);v.setMinimum(_,y)}};var Ni=function(){this._g0=null,this._g1=null,this._ptDist=new Ai,this._densifyFrac=0;var t=arguments[0],e=arguments[1];this._g0=t,this._g1=e},Ri={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Ni.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()},Ni.prototype.setDensifyFraction=function(t){if(t>1||t<=0)throw new v("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=t},Ni.prototype.compute=function(t,e){this.computeOrientedDistance(t,e,this._ptDist),this.computeOrientedDistance(e,t,this._ptDist)},Ni.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()},Ni.prototype.computeOrientedDistance=function(t,e,n){var i=new ki(e);if(t.apply(i),n.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var r=new Di(e,this._densifyFrac);t.apply(r),n.setMaximum(r.getMaxPointDistance())}},Ni.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()},Ni.prototype.interfaces_=function(){return[]},Ni.prototype.getClass=function(){return Ni},Ni.distance=function(){if(2===arguments.length)return new Ni(arguments[0],arguments[1]).distance();if(3===arguments.length){var t=arguments[2],e=new Ni(arguments[0],arguments[1]);return e.setDensifyFraction(t),e.distance()}},Ri.MaxPointDistanceFilter.get=function(){return ki},Ri.MaxDensifiedByFractionDistanceFilter.get=function(){return Di},Object.defineProperties(Ni,Ri);var ki=function(){this._maxPtDist=new Ai,this._minPtDist=new Ai,this._euclideanDist=new Oi,this._geom=null;var t=arguments[0];this._geom=t};ki.prototype.filter=function(t){this._minPtDist.initialize(),Oi.computeDistance(this._geom,t,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)},ki.prototype.getMaxPointDistance=function(){return this._maxPtDist},ki.prototype.interfaces_=function(){return[dt]},ki.prototype.getClass=function(){return ki};var Di=function(){this._maxPtDist=new Ai,this._minPtDist=new Ai,this._geom=null,this._numSubSegs=0;var t=arguments[0],e=arguments[1];this._geom=t,this._numSubSegs=Math.trunc(Math.round(1/e))};Di.prototype.filter=function(t,e){if(0===e)return null;for(var n=t.getCoordinate(e-1),i=t.getCoordinate(e),r=(i.x-n.x)/this._numSubSegs,o=(i.y-n.y)/this._numSubSegs,s=0;s<this._numSubSegs;s++){var a=n.x+s*r,l=n.y+s*o,u=new S(a,l);this._minPtDist.initialize(),Oi.computeDistance(this._geom,u,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)}},Di.prototype.isDone=function(){return!1},Di.prototype.isGeometryChanged=function(){return!1},Di.prototype.getMaxPointDistance=function(){return this._maxPtDist},Di.prototype.interfaces_=function(){return[Ut]},Di.prototype.getClass=function(){return Di};var Fi=function(t,e,n){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._bufDistance=e||null,this._result=n||null},zi={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Fi.prototype.checkMaximumDistance=function(t,e,n){var i=new Ni(e,t);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>n){this._isValid=!1;var r=i.getCoordinates();this._errorLocation=r[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+Q.toLineString(r[0],r[1])+")"}},Fi.prototype.isValid=function(){var t=Math.abs(this._bufDistance),e=Fi.MAX_DISTANCE_DIFF_FRAC*t;return this._minValidDistance=t-e,this._maxValidDistance=t+e,!(!this._input.isEmpty()&&!this._result.isEmpty())||(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Fi.VERBOSE&&q.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)},Fi.prototype.checkNegativeValid=function(){if(!(this._input instanceof Jt||this._input instanceof ne||this._input instanceof Vt))return null;var t=this.getPolygonLines(this._input);if(this.checkMinimumDistance(t,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(t,this._result,this._maxValidDistance)},Fi.prototype.getErrorIndicator=function(){return this._errorIndicator},Fi.prototype.checkMinimumDistance=function(t,e,n){var i=new Li(t,e,n);if(this._minDistanceFound=i.distance(),this._minDistanceFound<n){this._isValid=!1;var r=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=t.getFactory().createLineString(r),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+Q.toLineString(r[0],r[1])+" )"}},Fi.prototype.checkPositiveValid=function(){var t=this._result.getBoundary();if(this.checkMinimumDistance(this._input,t,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,t,this._maxValidDistance)},Fi.prototype.getErrorLocation=function(){return this._errorLocation},Fi.prototype.getPolygonLines=function(t){for(var e=new Et,n=new Si(e),i=Ei.getPolygons(t).iterator();i.hasNext();)i.next().apply(n);return t.getFactory().buildGeometry(e)},Fi.prototype.getErrorMessage=function(){return this._errMsg},Fi.prototype.interfaces_=function(){return[]},Fi.prototype.getClass=function(){return Fi},zi.VERBOSE.get=function(){return!1},zi.MAX_DISTANCE_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Fi,zi);var Bi=function(t,e,n){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=t||null,this._distance=e||null,this._result=n||null},ji={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Bi.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid},Bi.prototype.checkEnvelope=function(){if(this._distance<0)return null;var t=this._distance*Bi.MAX_ENV_DIFF_FRAC;0===t&&(t=.001);var e=new H(this._input.getEnvelopeInternal());e.expandBy(this._distance);var n=new H(this._result.getEnvelopeInternal());n.expandBy(t),n.contains(e)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(n)),this.report("Envelope")},Bi.prototype.checkDistance=function(){var t=new Fi(this._input,this._distance,this._result);t.isValid()||(this._isValid=!1,this._errorMsg=t.getErrorMessage(),this._errorLocation=t.getErrorLocation(),this._errorIndicator=t.getErrorIndicator()),this.report("Distance")},Bi.prototype.checkArea=function(){var t=this._input.getArea(),e=this._result.getArea();this._distance>0&&t>e&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&t<e&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")},Bi.prototype.checkPolygonal=function(){this._result instanceof Jt||this._result instanceof ne||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")},Bi.prototype.getErrorIndicator=function(){return this._errorIndicator},Bi.prototype.getErrorLocation=function(){return this._errorLocation},Bi.prototype.checkExpectedEmpty=function(){return this._input.getDimension()>=2||this._distance>0?null:(this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),void this.report("ExpectedEmpty"))},Bi.prototype.report=function(t){if(!Bi.VERBOSE)return null;q.out.println("Check "+t+": "+(this._isValid?"passed":"FAILED"))},Bi.prototype.getErrorMessage=function(){return this._errorMsg},Bi.prototype.interfaces_=function(){return[]},Bi.prototype.getClass=function(){return Bi},Bi.isValidMsg=function(t,e,n){var i=new Bi(t,e,n);return i.isValid()?null:i.getErrorMessage()},Bi.isValid=function(t,e,n){return!!new Bi(t,e,n).isValid()},ji.VERBOSE.get=function(){return!1},ji.MAX_ENV_DIFF_FRAC.get=function(){return.012},Object.defineProperties(Bi,ji);var Ui=function(){this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e};Ui.prototype.getCoordinates=function(){return this._pts},Ui.prototype.size=function(){return this._pts.length},Ui.prototype.getCoordinate=function(t){return this._pts[t]},Ui.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])},Ui.prototype.getSegmentOctant=function(t){return t===this._pts.length-1?-1:hn.octant(this.getCoordinate(t),this.getCoordinate(t+1))},Ui.prototype.setData=function(t){this._data=t},Ui.prototype.getData=function(){return this._data},Ui.prototype.toString=function(){return Q.toLineString(new le(this._pts))},Ui.prototype.interfaces_=function(){return[fn]},Ui.prototype.getClass=function(){return Ui};var Vi=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new Et,this._intersectionCount=0,this._keepIntersections=!0;var t=arguments[0];this._li=t,this._interiorIntersection=null};Vi.prototype.getInteriorIntersection=function(){return this._interiorIntersection},Vi.prototype.setCheckEndSegmentsOnly=function(t){this._isCheckEndSegmentsOnly=t},Vi.prototype.getIntersectionSegments=function(){return this._intSegments},Vi.prototype.count=function(){return this._intersectionCount},Vi.prototype.getIntersections=function(){return this._intersections},Vi.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Vi.prototype.setKeepIntersections=function(t){this._keepIntersections=t},Vi.prototype.processIntersections=function(t,e,n,i){if(!this._findAllIntersections&&this.hasIntersection())return null;if(t===n&&e===i)return null;if(this._isCheckEndSegmentsOnly&&!this.isEndSegment(t,e)&&!this.isEndSegment(n,i))return null;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=r,this._intSegments[1]=o,this._intSegments[2]=s,this._intSegments[3]=a,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)},Vi.prototype.isEndSegment=function(t,e){return 0===e||e>=t.size()-2},Vi.prototype.hasIntersection=function(){return null!==this._interiorIntersection},Vi.prototype.isDone=function(){return!this._findAllIntersections&&null!==this._interiorIntersection},Vi.prototype.interfaces_=function(){return[Yn]},Vi.prototype.getClass=function(){return Vi},Vi.createAllIntersectionsFinder=function(t){var e=new Vi(t);return e.setFindAllIntersections(!0),e},Vi.createAnyIntersectionFinder=function(t){return new Vi(t)},Vi.createIntersectionCounter=function(t){var e=new Vi(t);return e.setFindAllIntersections(!0),e.setKeepIntersections(!1),e};var Gi=function(){this._li=new rt,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var t=arguments[0];this._segStrings=t};Gi.prototype.execute=function(){if(null!==this._segInt)return null;this.checkInteriorIntersections()},Gi.prototype.getIntersections=function(){return this._segInt.getIntersections()},Gi.prototype.isValid=function(){return this.execute(),this._isValid},Gi.prototype.setFindAllIntersections=function(t){this._findAllIntersections=t},Gi.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Vi(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var t=new wn;if(t.setSegmentIntersector(this._segInt),t.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null},Gi.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Te(this.getErrorMessage(),this._segInt.getInteriorIntersection())},Gi.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var t=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+Q.toLineString(t[0],t[1])+" and "+Q.toLineString(t[2],t[3])},Gi.prototype.interfaces_=function(){return[]},Gi.prototype.getClass=function(){return Gi},Gi.computeIntersections=function(t){var e=new Gi(t);return e.setFindAllIntersections(!0),e.isValid(),e.getIntersections()};var qi=function t(){this._nv=null;var e=arguments[0];this._nv=new Gi(t.toSegmentStrings(e))};qi.prototype.checkValid=function(){this._nv.checkValid()},qi.prototype.interfaces_=function(){return[]},qi.prototype.getClass=function(){return qi},qi.toSegmentStrings=function(t){for(var e=new Et,n=t.iterator();n.hasNext();){var i=n.next();e.add(new Ui(i.getCoordinates(),i))}return e},qi.checkValid=function(t){new qi(t).checkValid()};var Wi=function(t){this._mapOp=t};Wi.prototype.map=function(t){for(var e=new Et,n=0;n<t.getNumGeometries();n++){var i=this._mapOp.map(t.getGeometryN(n));i.isEmpty()||e.add(i)}return t.getFactory().createGeometryCollection(ye.toGeometryArray(e))},Wi.prototype.interfaces_=function(){return[]},Wi.prototype.getClass=function(){return Wi},Wi.map=function(t,e){return new Wi(e).map(t)};var Hi=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new Et,this._resultLineList=new Et;var t=arguments[0],e=arguments[1],n=arguments[2];this._op=t,this._geometryFactory=e,this._ptLocator=n};Hi.prototype.collectLines=function(t){for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next();this.collectLineEdge(n,t,this._lineEdgesList),this.collectBoundaryTouchEdge(n,t,this._lineEdgesList)}},Hi.prototype.labelIsolatedLine=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._op.getArgGeometry(e));t.getLabel().setLocation(e,n)},Hi.prototype.build=function(t){return this.findCoveredLineEdges(),this.collectLines(t),this.buildLines(t),this._resultLineList},Hi.prototype.collectLineEdge=function(t,e,n){var i=t.getLabel(),r=t.getEdge();t.isLineEdge()&&(t.isVisited()||!Cr.isResultOfOp(i,e)||r.isCovered()||(n.add(r),t.setVisitedEdge(!0)))},Hi.prototype.findCoveredLineEdges=function(){for(var t=this._op.getGraph().getNodes().iterator();t.hasNext();)t.next().getEdges().findCoveredLineEdges();for(var e=this._op.getGraph().getEdgeEnds().iterator();e.hasNext();){var n=e.next(),i=n.getEdge();if(n.isLineEdge()&&!i.isCoveredSet()){var r=this._op.isCoveredByA(n.getCoordinate());i.setCovered(r)}}},Hi.prototype.labelIsolatedLines=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=n.getLabel();n.isIsolated()&&(i.isNull(0)?this.labelIsolatedLine(n,0):this.labelIsolatedLine(n,1))}},Hi.prototype.buildLines=function(t){for(var e=this._lineEdgesList.iterator();e.hasNext();){var n=e.next(),i=this._geometryFactory.createLineString(n.getCoordinates());this._resultLineList.add(i),n.setInResult(!0)}},Hi.prototype.collectBoundaryTouchEdge=function(t,e,n){var i=t.getLabel();return t.isLineEdge()||t.isVisited()||t.isInteriorAreaEdge()||t.getEdge().isInResult()?null:(et.isTrue(!(t.isInResult()||t.getSym().isInResult())||!t.getEdge().isInResult()),void(Cr.isResultOfOp(i,e)&&e===Cr.INTERSECTION&&(n.add(t.getEdge()),t.setVisitedEdge(!0))))},Hi.prototype.interfaces_=function(){return[]},Hi.prototype.getClass=function(){return Hi};var Xi=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new Et;var t=arguments[0],e=arguments[1];this._op=t,this._geometryFactory=e};Xi.prototype.filterCoveredNodeToPoint=function(t){var e=t.getCoordinate();if(!this._op.isCoveredByLA(e)){var n=this._geometryFactory.createPoint(e);this._resultPointList.add(n)}},Xi.prototype.extractNonCoveredResultNodes=function(t){for(var e=this._op.getGraph().getNodes().iterator();e.hasNext();){var n=e.next();if(!(n.isInResult()||n.isIncidentEdgeInResult()||0!==n.getEdges().getDegree()&&t!==Cr.INTERSECTION)){var i=n.getLabel();Cr.isResultOfOp(i,t)&&this.filterCoveredNodeToPoint(n)}}},Xi.prototype.build=function(t){return this.extractNonCoveredResultNodes(t),this._resultPointList},Xi.prototype.interfaces_=function(){return[]},Xi.prototype.getClass=function(){return Xi};var Yi=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};Yi.prototype.transformPoint=function(t,e){return this._factory.createPoint(this.transformCoordinates(t.getCoordinateSequence(),t))},Yi.prototype.transformPolygon=function(t,e){var n=!0,i=this.transformLinearRing(t.getExteriorRing(),t);null!==i&&i instanceof ee&&!i.isEmpty()||(n=!1);for(var r=new Et,o=0;o<t.getNumInteriorRing();o++){var s=this.transformLinearRing(t.getInteriorRingN(o),t);null===s||s.isEmpty()||(s instanceof ee||(n=!1),r.add(s))}if(n)return this._factory.createPolygon(i,r.toArray([]));var a=new Et;return null!==i&&a.add(i),a.addAll(r),this._factory.buildGeometry(a)},Yi.prototype.createCoordinateSequence=function(t){return this._factory.getCoordinateSequenceFactory().create(t)},Yi.prototype.getInputGeometry=function(){return this._inputGeom},Yi.prototype.transformMultiLineString=function(t,e){for(var n=new Et,i=0;i<t.getNumGeometries();i++){var r=this.transformLineString(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Yi.prototype.transformCoordinates=function(t,e){return this.copy(t)},Yi.prototype.transformLineString=function(t,e){return this._factory.createLineString(this.transformCoordinates(t.getCoordinateSequence(),t))},Yi.prototype.transformMultiPoint=function(t,e){for(var n=new Et,i=0;i<t.getNumGeometries();i++){var r=this.transformPoint(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Yi.prototype.transformMultiPolygon=function(t,e){for(var n=new Et,i=0;i<t.getNumGeometries();i++){var r=this.transformPolygon(t.getGeometryN(i),t);null!==r&&(r.isEmpty()||n.add(r))}return this._factory.buildGeometry(n)},Yi.prototype.copy=function(t){return t.copy()},Yi.prototype.transformGeometryCollection=function(t,e){for(var n=new Et,i=0;i<t.getNumGeometries();i++){var r=this.transform(t.getGeometryN(i));null!==r&&(this._pruneEmptyGeometry&&r.isEmpty()||n.add(r))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(ye.toGeometryArray(n)):this._factory.buildGeometry(n)},Yi.prototype.transform=function(t){if(this._inputGeom=t,this._factory=t.getFactory(),t instanceof $t)return this.transformPoint(t,null);if(t instanceof te)return this.transformMultiPoint(t,null);if(t instanceof ee)return this.transformLinearRing(t,null);if(t instanceof Zt)return this.transformLineString(t,null);if(t instanceof Gt)return this.transformMultiLineString(t,null);if(t instanceof Jt)return this.transformPolygon(t,null);if(t instanceof ne)return this.transformMultiPolygon(t,null);if(t instanceof Vt)return this.transformGeometryCollection(t,null);throw new v("Unknown Geometry subtype: "+t.getClass().getName())},Yi.prototype.transformLinearRing=function(t,e){var n=this.transformCoordinates(t.getCoordinateSequence(),t);if(null===n)return this._factory.createLinearRing(null);var i=n.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(n):this._factory.createLinearRing(n)},Yi.prototype.interfaces_=function(){return[]},Yi.prototype.getClass=function(){return Yi};var Zi=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new gn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof Zt&&"number"==typeof arguments[1]){var e=arguments[1];t.call(this,arguments[0].getCoordinates(),e)}else if(arguments[0]instanceof Array&&"number"==typeof arguments[1]){var n=arguments[0],i=arguments[1];this._srcPts=n,this._isClosed=t.isClosed(n),this._snapTolerance=i}};Zi.prototype.snapVertices=function(t,e){for(var n=this._isClosed?t.size()-1:t.size(),i=0;i<n;i++){var r=t.get(i),o=this.findSnapForVertex(r,e);null!==o&&(t.set(i,new S(o)),0===i&&this._isClosed&&t.set(t.size()-1,new S(o)))}},Zi.prototype.findSnapForVertex=function(t,e){for(var n=0;n<e.length;n++){if(t.equals2D(e[n]))return null;if(t.distance(e[n])<this._snapTolerance)return e[n]}return null},Zi.prototype.snapTo=function(t){var e=new Pt(this._srcPts);return this.snapVertices(e,t),this.snapSegments(e,t),e.toCoordinateArray()},Zi.prototype.snapSegments=function(t,e){if(0===e.length)return null;var n=e.length;e[0].equals2D(e[e.length-1])&&(n=e.length-1);for(var i=0;i<n;i++){var r=e[i],o=this.findSegmentIndexToSnap(r,t);o>=0&&t.add(o+1,new S(r),!1)}},Zi.prototype.findSegmentIndexToSnap=function(t,e){for(var n=_.MAX_VALUE,i=-1,r=0;r<e.size()-1;r++){if(this._seg.p0=e.get(r),this._seg.p1=e.get(r+1),this._seg.p0.equals2D(t)||this._seg.p1.equals2D(t)){if(this._allowSnappingToSourceVertices)continue;return-1}var o=this._seg.distance(t);o<this._snapTolerance&&o<n&&(n=o,i=r)}return i},Zi.prototype.setAllowSnappingToSourceVertices=function(t){this._allowSnappingToSourceVertices=t},Zi.prototype.interfaces_=function(){return[]},Zi.prototype.getClass=function(){return Zi},Zi.isClosed=function(t){return!(t.length<=1)&&t[0].equals2D(t[t.length-1])};var Ki=function(t){this._srcGeom=t||null},$i={SNAP_PRECISION_FACTOR:{configurable:!0}};Ki.prototype.snapTo=function(t,e){var n=this.extractTargetCoordinates(t);return new Qi(e,n).transform(this._srcGeom)},Ki.prototype.snapToSelf=function(t,e){var n=this.extractTargetCoordinates(this._srcGeom),i=new Qi(t,n,!0).transform(this._srcGeom),r=i;return e&&L(r,Qt)&&(r=i.buffer(0)),r},Ki.prototype.computeSnapTolerance=function(t){return this.computeMinimumSegmentLength(t)/10},Ki.prototype.extractTargetCoordinates=function(t){for(var e=new d,n=t.getCoordinates(),i=0;i<n.length;i++)e.add(n[i]);return e.toArray(new Array(0).fill(null))},Ki.prototype.computeMinimumSegmentLength=function(t){for(var e=_.MAX_VALUE,n=0;n<t.length-1;n++){var i=t[n].distance(t[n+1]);i<e&&(e=i)}return e},Ki.prototype.interfaces_=function(){return[]},Ki.prototype.getClass=function(){return Ki},Ki.snap=function(t,e,n){var i=new Array(2).fill(null),r=new Ki(t);i[0]=r.snapTo(e,n);var o=new Ki(e);return i[1]=o.snapTo(i[0],n),i},Ki.computeOverlaySnapTolerance=function(){if(1===arguments.length){var t=arguments[0],e=Ki.computeSizeBasedSnapTolerance(t),n=t.getPrecisionModel();if(n.getType()===de.FIXED){var i=1/n.getScale()*2/1.415;i>e&&(e=i)}return e}if(2===arguments.length){var r=arguments[0],o=arguments[1];return Math.min(Ki.computeOverlaySnapTolerance(r),Ki.computeOverlaySnapTolerance(o))}},Ki.computeSizeBasedSnapTolerance=function(t){var e=t.getEnvelopeInternal();return Math.min(e.getHeight(),e.getWidth())*Ki.SNAP_PRECISION_FACTOR},Ki.snapToSelf=function(t,e,n){return new Ki(t).snapToSelf(e,n)},$i.SNAP_PRECISION_FACTOR.get=function(){return 1e-9},Object.defineProperties(Ki,$i);var Qi=function(t){function e(e,n,i){t.call(this),this._snapTolerance=e||null,this._snapPts=n||null,this._isSelfSnap=void 0!==i&&i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(t,e){var n=new Zi(t,this._snapTolerance);return n.setAllowSnappingToSourceVertices(this._isSelfSnap),n.snapTo(e)},e.prototype.transformCoordinates=function(t,e){var n=t.toCoordinateArray(),i=this.snapLine(n,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(i)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Yi),Ji=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};Ji.prototype.getCommon=function(){return _.longBitsToDouble(this._commonBits)},Ji.prototype.add=function(t){var e=_.doubleToLongBits(t);return this._isFirst?(this._commonBits=e,this._commonSignExp=Ji.signExpBits(this._commonBits),this._isFirst=!1,null):Ji.signExpBits(e)!==this._commonSignExp?(this._commonBits=0,null):(this._commonMantissaBitsCount=Ji.numCommonMostSigMantissaBits(this._commonBits,e),void(this._commonBits=Ji.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))))},Ji.prototype.toString=function(){if(1===arguments.length){var t=arguments[0],e=_.longBitsToDouble(t),n="0000000000000000000000000000000000000000000000000000000000000000"+_.toBinaryString(t),i=n.substring(n.length-64);return i.substring(0,1)+"  "+i.substring(1,12)+"(exp) "+i.substring(12)+" [ "+e+" ]"}},Ji.prototype.interfaces_=function(){return[]},Ji.prototype.getClass=function(){return Ji},Ji.getBit=function(t,e){return 0!=(t&1<<e)?1:0},Ji.signExpBits=function(t){return t>>52},Ji.zeroLowerBits=function(t,e){return t&~((1<<e)-1)},Ji.numCommonMostSigMantissaBits=function(t,e){for(var n=0,i=52;i>=0;i--){if(Ji.getBit(t,i)!==Ji.getBit(e,i))return n;n++}return 52};var tr=function(){this._commonCoord=null,this._ccFilter=new nr},er={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};tr.prototype.addCommonBits=function(t){var e=new ir(this._commonCoord);t.apply(e),t.geometryChanged()},tr.prototype.removeCommonBits=function(t){if(0===this._commonCoord.x&&0===this._commonCoord.y)return t;var e=new S(this._commonCoord);e.x=-e.x,e.y=-e.y;var n=new ir(e);return t.apply(n),t.geometryChanged(),t},tr.prototype.getCommonCoordinate=function(){return this._commonCoord},tr.prototype.add=function(t){t.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()},tr.prototype.interfaces_=function(){return[]},tr.prototype.getClass=function(){return tr},er.CommonCoordinateFilter.get=function(){return nr},er.Translater.get=function(){return ir},Object.defineProperties(tr,er);var nr=function(){this._commonBitsX=new Ji,this._commonBitsY=new Ji};nr.prototype.filter=function(t){this._commonBitsX.add(t.x),this._commonBitsY.add(t.y)},nr.prototype.getCommonCoordinate=function(){return new S(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())},nr.prototype.interfaces_=function(){return[dt]},nr.prototype.getClass=function(){return nr};var ir=function(){this.trans=null;var t=arguments[0];this.trans=t};ir.prototype.filter=function(t,e){var n=t.getOrdinate(e,0)+this.trans.x,i=t.getOrdinate(e,1)+this.trans.y;t.setOrdinate(e,0,n),t.setOrdinate(e,1,i)},ir.prototype.isDone=function(){return!1},ir.prototype.isGeometryChanged=function(){return!0},ir.prototype.interfaces_=function(){return[Ut]},ir.prototype.getClass=function(){return ir};var rr=function(t,e){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=t,this._geom[1]=e,this.computeSnapTolerance()};rr.prototype.selfSnap=function(t){return new Ki(t).snapTo(t,this._snapTolerance)},rr.prototype.removeCommonBits=function(t){this._cbr=new tr,this._cbr.add(t[0]),this._cbr.add(t[1]);var e=new Array(2).fill(null);return e[0]=this._cbr.removeCommonBits(t[0].copy()),e[1]=this._cbr.removeCommonBits(t[1].copy()),e},rr.prototype.prepareResult=function(t){return this._cbr.addCommonBits(t),t},rr.prototype.getResultGeometry=function(t){var e=this.snap(this._geom),n=Cr.overlayOp(e[0],e[1],t);return this.prepareResult(n)},rr.prototype.checkValid=function(t){t.isValid()||q.out.println("Snapped geometry is invalid")},rr.prototype.computeSnapTolerance=function(){this._snapTolerance=Ki.computeOverlaySnapTolerance(this._geom[0],this._geom[1])},rr.prototype.snap=function(t){var e=this.removeCommonBits(t);return Ki.snap(e[0],e[1],this._snapTolerance)},rr.prototype.interfaces_=function(){return[]},rr.prototype.getClass=function(){return rr},rr.overlayOp=function(t,e,n){return new rr(t,e).getResultGeometry(n)},rr.union=function(t,e){return rr.overlayOp(t,e,Cr.UNION)},rr.intersection=function(t,e){return rr.overlayOp(t,e,Cr.INTERSECTION)},rr.symDifference=function(t,e){return rr.overlayOp(t,e,Cr.SYMDIFFERENCE)},rr.difference=function(t,e){return rr.overlayOp(t,e,Cr.DIFFERENCE)};var or=function(t,e){this._geom=new Array(2).fill(null),this._geom[0]=t,this._geom[1]=e};or.prototype.getResultGeometry=function(t){var e=null,n=!1,i=null;try{e=Cr.overlayOp(this._geom[0],this._geom[1],t),n=!0}catch(t){if(!(t instanceof J))throw t;i=t}if(!n)try{e=rr.overlayOp(this._geom[0],this._geom[1],t)}catch(t){throw t instanceof J?i:t}return e},or.prototype.interfaces_=function(){return[]},or.prototype.getClass=function(){return or},or.overlayOp=function(t,e,n){return new or(t,e).getResultGeometry(n)},or.union=function(t,e){return or.overlayOp(t,e,Cr.UNION)},or.intersection=function(t,e){return or.overlayOp(t,e,Cr.INTERSECTION)},or.symDifference=function(t,e){return or.overlayOp(t,e,Cr.SYMDIFFERENCE)},or.difference=function(t,e){return or.overlayOp(t,e,Cr.DIFFERENCE)};var sr=function(){this.mce=null,this.chainIndex=null;var t=arguments[0],e=arguments[1];this.mce=t,this.chainIndex=e};sr.prototype.computeIntersections=function(t,e){this.mce.computeIntersectsForChain(this.chainIndex,t.mce,t.chainIndex,e)},sr.prototype.interfaces_=function(){return[]},sr.prototype.getClass=function(){return sr};var ar=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,2===arguments.length){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=i,this._xValue=r,this._obj=o}},lr={INSERT:{configurable:!0},DELETE:{configurable:!0}};ar.prototype.isDelete=function(){return this._eventType===ar.DELETE},ar.prototype.setDeleteEventIndex=function(t){this._deleteEventIndex=t},ar.prototype.getObject=function(){return this._obj},ar.prototype.compareTo=function(t){var e=t;return this._xValue<e._xValue?-1:this._xValue>e._xValue?1:this._eventType<e._eventType?-1:this._eventType>e._eventType?1:0},ar.prototype.getInsertEvent=function(){return this._insertEvent},ar.prototype.isInsert=function(){return this._eventType===ar.INSERT},ar.prototype.isSameLabel=function(t){return null!==this._label&&this._label===t._label},ar.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex},ar.prototype.interfaces_=function(){return[x]},ar.prototype.getClass=function(){return ar},lr.INSERT.get=function(){return 1},lr.DELETE.get=function(){return 2},Object.defineProperties(ar,lr);var ur=function(){};ur.prototype.interfaces_=function(){return[]},ur.prototype.getClass=function(){return ur};var cr=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._li=t,this._includeProper=e,this._recordIsolated=n};cr.prototype.isTrivialIntersection=function(t,e,n,i){if(t===n&&1===this._li.getIntersectionNum()){if(cr.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var r=t.getNumPoints()-1;if(0===e&&i===r||0===i&&e===r)return!0}}return!1},cr.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint},cr.prototype.setIsDoneIfProperInt=function(t){this._isDoneWhenProperInt=t},cr.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior},cr.prototype.isBoundaryPointInternal=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next().getCoordinate();if(t.isIntersection(i))return!0}return!1},cr.prototype.hasProperIntersection=function(){return this._hasProper},cr.prototype.hasIntersection=function(){return this._hasIntersection},cr.prototype.isDone=function(){return this._isDone},cr.prototype.isBoundaryPoint=function(t,e){return!(null===e||!this.isBoundaryPointInternal(t,e[0])&&!this.isBoundaryPointInternal(t,e[1]))},cr.prototype.setBoundaryNodes=function(t,e){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=t,this._bdyNodes[1]=e},cr.prototype.addIntersections=function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var r=t.getCoordinates()[e],o=t.getCoordinates()[e+1],s=n.getCoordinates()[i],a=n.getCoordinates()[i+1];this._li.computeIntersection(r,o,s,a),this._li.hasIntersection()&&(this._recordIsolated&&(t.setIsolated(!1),n.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,!this._includeProper&&this._li.isProper()||(t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))},cr.prototype.interfaces_=function(){return[]},cr.prototype.getClass=function(){return cr},cr.isAdjacentSegments=function(t,e){return 1===Math.abs(t-e)};var hr=function(t){function e(){t.call(this),this.events=new Et,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){Je.sort(this.events);for(var t=0;t<this.events.size();t++){var e=this.events.get(t);e.isDelete()&&e.getInsertEvent().setDeleteEventIndex(t)}},e.prototype.computeIntersections=function(){if(1===arguments.length){var t=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var e=0;e<this.events.size();e++){var n=this.events.get(e);if(n.isInsert()&&this.processOverlaps(e,n.getDeleteEventIndex(),n,t),t.isDone())break}}else if(3===arguments.length)if(arguments[2]instanceof cr&&L(arguments[0],wt)&&L(arguments[1],wt)){var i=arguments[0],r=arguments[1],o=arguments[2];this.addEdges(i,i),this.addEdges(r,r),this.computeIntersections(o)}else if("boolean"==typeof arguments[2]&&L(arguments[0],wt)&&arguments[1]instanceof cr){var s=arguments[0],a=arguments[1];arguments[2]?this.addEdges(s,null):this.addEdges(s),this.computeIntersections(a)}},e.prototype.addEdge=function(t,e){for(var n=t.getMonotoneChainEdge(),i=n.getStartIndexes(),r=0;r<i.length-1;r++){var o=new sr(n,r),s=new ar(e,n.getMinX(r),o);this.events.add(s),this.events.add(new ar(n.getMaxX(r),s))}},e.prototype.processOverlaps=function(t,e,n,i){for(var r=n.getObject(),o=t;o<e;o++){var s=this.events.get(o);if(s.isInsert()){var a=s.getObject();n.isSameLabel(s)||(r.computeIntersections(a,i),this.nOverlaps++)}}},e.prototype.addEdges=function(){if(1===arguments.length)for(var t=arguments[0].iterator();t.hasNext();){var e=t.next();this.addEdge(e,e)}else if(2===arguments.length)for(var n=arguments[1],i=arguments[0].iterator();i.hasNext();){var r=i.next();this.addEdge(r,n)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ur),fr=function(){this._min=_.POSITIVE_INFINITY,this._max=_.NEGATIVE_INFINITY},dr={NodeComparator:{configurable:!0}};fr.prototype.getMin=function(){return this._min},fr.prototype.intersects=function(t,e){return!(this._min>e||this._max<t)},fr.prototype.getMax=function(){return this._max},fr.prototype.toString=function(){return Q.toLineString(new S(this._min,0),new S(this._max,0))},fr.prototype.interfaces_=function(){return[]},fr.prototype.getClass=function(){return fr},dr.NodeComparator.get=function(){return pr},Object.defineProperties(fr,dr);var pr=function(){};pr.prototype.compare=function(t,e){var n=t,i=e,r=(n._min+n._max)/2,o=(i._min+i._max)/2;return r<o?-1:r>o?1:0},pr.prototype.interfaces_=function(){return[E]},pr.prototype.getClass=function(){return pr};var gr=function(t){function e(){t.call(this),this._item=null;var e=arguments[0],n=arguments[1],i=arguments[2];this._min=e,this._max=n,this._item=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;n.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fr),mr=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var e=arguments[0],n=arguments[1];this._node1=e,this._node2=n,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(t,e){this._min=Math.min(t._min,e._min),this._max=Math.max(t._max,e._max)},e.prototype.query=function(t,e,n){if(!this.intersects(t,e))return null;null!==this._node1&&this._node1.query(t,e,n),null!==this._node2&&this._node2.query(t,e,n)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(fr),yr=function(){this._leaves=new Et,this._root=null,this._level=0};yr.prototype.buildTree=function(){Je.sort(this._leaves,new fr.NodeComparator);for(var t=this._leaves,e=null,n=new Et;;){if(this.buildLevel(t,n),1===n.size())return n.get(0);e=t,t=n,n=e}},yr.prototype.insert=function(t,e,n){if(null!==this._root)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new gr(t,e,n))},yr.prototype.query=function(t,e,n){this.init(),this._root.query(t,e,n)},yr.prototype.buildRoot=function(){if(null!==this._root)return null;this._root=this.buildTree()},yr.prototype.printNode=function(t){q.out.println(Q.toLineString(new S(t._min,this._level),new S(t._max,this._level)))},yr.prototype.init=function(){if(null!==this._root)return null;this.buildRoot()},yr.prototype.buildLevel=function(t,e){this._level++,e.clear();for(var n=0;n<t.size();n+=2){var i=t.get(n);if(null===(n+1<t.size()?t.get(n):null))e.add(i);else{var r=new mr(t.get(n),t.get(n+1));e.add(r)}}},yr.prototype.interfaces_=function(){return[]},yr.prototype.getClass=function(){return yr};var vr=function(){this._items=new Et};vr.prototype.visitItem=function(t){this._items.add(t)},vr.prototype.getItems=function(){return this._items},vr.prototype.interfaces_=function(){return[Ze]},vr.prototype.getClass=function(){return vr};var _r=function(){this._index=null;var t=arguments[0];if(!L(t,Qt))throw new v("Argument must be Polygonal");this._index=new wr(t)},br={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};_r.prototype.locate=function(t){var e=new st(t),n=new xr(e);return this._index.query(t.y,t.y,n),e.getLocation()},_r.prototype.interfaces_=function(){return[jn]},_r.prototype.getClass=function(){return _r},br.SegmentVisitor.get=function(){return xr},br.IntervalIndexedGeometry.get=function(){return wr},Object.defineProperties(_r,br);var xr=function(){this._counter=null;var t=arguments[0];this._counter=t};xr.prototype.visitItem=function(t){var e=t;this._counter.countSegment(e.getCoordinate(0),e.getCoordinate(1))},xr.prototype.interfaces_=function(){return[Ze]},xr.prototype.getClass=function(){return xr};var wr=function(){this._index=new yr;var t=arguments[0];this.init(t)};wr.prototype.init=function(t){for(var e=Si.getLines(t).iterator();e.hasNext();){var n=e.next().getCoordinates();this.addLine(n)}},wr.prototype.addLine=function(t){for(var e=1;e<t.length;e++){var n=new gn(t[e-1],t[e]),i=Math.min(n.p0.y,n.p1.y),r=Math.max(n.p0.y,n.p1.y);this._index.insert(i,r,n)}},wr.prototype.query=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new vr;return this._index.query(t,e,n),n.getItems()}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2];this._index.query(i,r,o)}},wr.prototype.interfaces_=function(){return[]},wr.prototype.getClass=function(){return wr};var Er=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new fe,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Pi,2===arguments.length){var e=arguments[0],n=arguments[1],i=pt.OGC_SFS_BOUNDARY_RULE;this._argIndex=e,this._parentGeom=n,this._boundaryNodeRule=i,null!==n&&this.add(n)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];this._argIndex=r,this._parentGeom=o,this._boundaryNodeRule=s,null!==o&&this.add(o)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(t,n){var i=this._nodes.addNode(n).getLabel(),r=1;T.NONE,i.getLocation(t,Pe.ON)===T.BOUNDARY&&r++;var o=e.determineBoundary(this._boundaryNodeRule,r);i.setLocation(t,o)},e.prototype.computeSelfNodes=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1];return this.computeSelfNodes(t,e,!1)}if(3===arguments.length){var n=arguments[1],i=arguments[2],r=new cr(arguments[0],!0,!1);r.setIsDoneIfProperInt(i);var o=this.createEdgeSetIntersector(),s=this._parentGeom instanceof ee||this._parentGeom instanceof Jt||this._parentGeom instanceof ne,a=n||!s;return o.computeIntersections(this._edges,r,a),this.addSelfIntersectionNodes(this._argIndex),r}},e.prototype.computeSplitEdges=function(t){for(var e=this._edges.iterator();e.hasNext();)e.next().eiList.addSplitEdges(t)},e.prototype.computeEdgeIntersections=function(t,e,n){var i=new cr(e,n,!0);return i.setBoundaryNodes(this.getBoundaryNodes(),t.getBoundaryNodes()),this.createEdgeSetIntersector().computeIntersections(this._edges,t._edges,i),i},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof $t){var t=arguments[0].getCoordinate();this.insertPoint(this._argIndex,t,T.INTERIOR)}else if(arguments[0]instanceof S){var e=arguments[0];this.insertPoint(this._argIndex,e,T.INTERIOR)}},e.prototype.addPolygon=function(t){this.addPolygonRing(t.getExteriorRing(),T.EXTERIOR,T.INTERIOR);for(var e=0;e<t.getNumInteriorRing();e++){var n=t.getInteriorRingN(e);this.addPolygonRing(n,T.INTERIOR,T.EXTERIOR)}},e.prototype.addEdge=function(t){this.insertEdge(t);var e=t.getCoordinates();this.insertPoint(this._argIndex,e[0],T.BOUNDARY),this.insertPoint(this._argIndex,e[e.length-1],T.BOUNDARY)},e.prototype.addLineString=function(t){var e=Ct.removeRepeatedPoints(t.getCoordinates());if(e.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=e[0],null;var n=new ni(e,new Oe(this._argIndex,T.INTERIOR));this._lineEdgeMap.put(t,n),this.insertEdge(n),et.isTrue(e.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,e[0]),this.insertBoundaryPoint(this._argIndex,e[e.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var t=this.getBoundaryNodes(),e=new Array(t.size()).fill(null),n=0,i=t.iterator();i.hasNext();){var r=i.next();e[n++]=r.getCoordinate().copy()}return e},e.prototype.getBoundaryNodes=function(){return null===this._boundaryNodes&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(t,e,n){if(this.isBoundaryNode(t,e))return null;n===T.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(t,e):this.insertPoint(t,e,n)},e.prototype.addPolygonRing=function(t,e,n){if(t.isEmpty())return null;var i=Ct.removeRepeatedPoints(t.getCoordinates());if(i.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var r=e,o=n;at.isCCW(i)&&(r=n,o=e);var s=new ni(i,new Oe(this._argIndex,T.BOUNDARY,r,o));this._lineEdgeMap.put(t,s),this.insertEdge(s),this.insertPoint(this._argIndex,i[0],T.BOUNDARY)},e.prototype.insertPoint=function(t,e,n){var i=this._nodes.addNode(e),r=i.getLabel();null===r?i._label=new Oe(t,n):r.setLocation(t,n)},e.prototype.createEdgeSetIntersector=function(){return new hr},e.prototype.addSelfIntersectionNodes=function(t){for(var e=this._edges.iterator();e.hasNext();)for(var n=e.next(),i=n.getLabel().getLocation(t),r=n.eiList.iterator();r.hasNext();){var o=r.next();this.addSelfIntersectionNode(t,o.coord,i)}},e.prototype.add=function(){if(1!==arguments.length)return t.prototype.add.apply(this,arguments);var e=arguments[0];if(e.isEmpty())return null;if(e instanceof ne&&(this._useBoundaryDeterminationRule=!1),e instanceof Jt)this.addPolygon(e);else if(e instanceof Zt)this.addLineString(e);else if(e instanceof $t)this.addPoint(e);else if(e instanceof te)this.addCollection(e);else if(e instanceof Gt)this.addCollection(e);else if(e instanceof ne)this.addCollection(e);else{if(!(e instanceof Vt))throw new Error(e.getClass().getName());this.addCollection(e)}},e.prototype.addCollection=function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}},e.prototype.locate=function(t){return L(this._parentGeom,Qt)&&this._parentGeom.getNumGeometries()>50?(null===this._areaPtLocator&&(this._areaPtLocator=new _r(this._parentGeom)),this._areaPtLocator.locate(t)):this._ptLocator.locate(t,this._parentGeom)},e.prototype.findEdge=function(){if(1===arguments.length){var e=arguments[0];return this._lineEdgeMap.get(e)}return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(t,e){return t.isInBoundary(e)?T.BOUNDARY:T.INTERIOR},e}(qe),Sr=function(){if(this._li=new rt,this._resultPrecisionModel=null,this._arg=null,1===arguments.length){var t=arguments[0];this.setComputationPrecision(t.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new Er(0,t)}else if(2===arguments.length){var e=arguments[0],n=arguments[1],i=pt.OGC_SFS_BOUNDARY_RULE;e.getPrecisionModel().compareTo(n.getPrecisionModel())>=0?this.setComputationPrecision(e.getPrecisionModel()):this.setComputationPrecision(n.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Er(0,e,i),this._arg[1]=new Er(1,n,i)}else if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];r.getPrecisionModel().compareTo(o.getPrecisionModel())>=0?this.setComputationPrecision(r.getPrecisionModel()):this.setComputationPrecision(o.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new Er(0,r,s),this._arg[1]=new Er(1,o,s)}};Sr.prototype.getArgGeometry=function(t){return this._arg[t].getGeometry()},Sr.prototype.setComputationPrecision=function(t){this._resultPrecisionModel=t,this._li.setPrecisionModel(this._resultPrecisionModel)},Sr.prototype.interfaces_=function(){return[]},Sr.prototype.getClass=function(){return Sr};var Pr=function(){};Pr.prototype.interfaces_=function(){return[]},Pr.prototype.getClass=function(){return Pr},Pr.map=function(){if(arguments[0]instanceof ct&&L(arguments[1],Pr.MapOp)){for(var t=arguments[0],e=arguments[1],n=new Et,i=0;i<t.getNumGeometries();i++){var r=e.map(t.getGeometryN(i));null!==r&&n.add(r)}return t.getFactory().buildGeometry(n)}if(L(arguments[0],bt)&&L(arguments[1],Pr.MapOp)){for(var o=arguments[0],s=arguments[1],a=new Et,l=o.iterator();l.hasNext();){var u=l.next(),c=s.map(u);null!==c&&a.add(c)}return a}},Pr.MapOp=function(){};var Cr=function(t){function e(){var e=arguments[0],n=arguments[1];t.call(this,e,n),this._ptLocator=new Pi,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Xn,this._resultPolyList=new Et,this._resultLineList=new Et,this._resultPointList=new Et,this._graph=new qe(new Wn),this._geomFact=e.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(t){var e=this._edgeList.findEqualEdge(t);if(null!==e){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new Oe(t.getLabel())).flip();var r=e.getDepth();r.isNull()&&r.add(n),r.add(i),n.merge(i)}else this._edgeList.add(t)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var t=this._graph.getEdgeEnds().iterator();t.hasNext();){var e=t.next(),n=e.getSym();e.isInResult()&&n.isInResult()&&(e.setInResult(!1),n.setInResult(!1))}},e.prototype.isCoveredByLA=function(t){return!!this.isCovered(t,this._resultLineList)||!!this.isCovered(t,this._resultPolyList)},e.prototype.computeGeometry=function(t,n,i,r){var o=new Et;return o.addAll(t),o.addAll(n),o.addAll(i),o.isEmpty()?e.createEmptyResult(r,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(o)},e.prototype.mergeSymLabels=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().mergeSymLabels()},e.prototype.isCovered=function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(this._ptLocator.locate(t,i)!==T.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var t=new Et,e=this._edgeList.iterator();e.hasNext();){var n=e.next();n.isCollapsed()&&(e.remove(),t.add(n.getCollapsedEdge()))}this._edgeList.addAll(t)},e.prototype.updateNodeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getEdges().getLabel();e.getLabel().merge(n)}},e.prototype.getResultGeometry=function(t){return this.computeOverlay(t),this._resultGeom},e.prototype.insertUniqueEdges=function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this.insertUniqueEdge(n)}},e.prototype.computeOverlay=function(t){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var e=new Et;this._arg[0].computeSplitEdges(e),this._arg[1].computeSplitEdges(e),this.insertUniqueEdges(e),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),qi.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(t),this.cancelDuplicateResultEdges();var n=new We(this._geomFact);n.add(this._graph),this._resultPolyList=n.getPolygons();var i=new Hi(this,this._geomFact,this._ptLocator);this._resultLineList=i.build(t);var r=new Xi(this,this._geomFact,this._ptLocator);this._resultPointList=r.build(t),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,t)},e.prototype.labelIncompleteNode=function(t,e){var n=this._ptLocator.locate(t.getCoordinate(),this._arg[e].getGeometry());t.getLabel().setLocation(e,n)},e.prototype.copyPoints=function(t){for(var e=this._arg[t].getNodeIterator();e.hasNext();){var n=e.next();this._graph.addNode(n.getCoordinate()).setLabel(t,n.getLabel().getLocation(t))}},e.prototype.findResultAreaEdges=function(t){for(var n=this._graph.getEdgeEnds().iterator();n.hasNext();){var i=n.next(),r=i.getLabel();r.isArea()&&!i.isInteriorAreaEdge()&&e.isResultOfOp(r.getLocation(0,Pe.RIGHT),r.getLocation(1,Pe.RIGHT),t)&&i.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var t=this._edgeList.iterator();t.hasNext();){var e=t.next(),n=e.getLabel(),i=e.getDepth();if(!i.isNull()){i.normalize();for(var r=0;r<2;r++)n.isNull(r)||!n.isArea()||i.isNull(r)||(0===i.getDelta(r)?n.toLine(r):(et.isTrue(!i.isNull(r,Pe.LEFT),"depth of LEFT side has not been initialized"),n.setLocation(r,Pe.LEFT,i.getLocation(r,Pe.LEFT)),et.isTrue(!i.isNull(r,Pe.RIGHT),"depth of RIGHT side has not been initialized"),n.setLocation(r,Pe.RIGHT,i.getLocation(r,Pe.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();)t.next().getEdges().computeLabelling(this._arg);this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var t=this._graph.getNodes().iterator();t.hasNext();){var e=t.next(),n=e.getLabel();e.isIsolated()&&(n.isNull(0)?this.labelIncompleteNode(e,0):this.labelIncompleteNode(e,1)),e.getEdges().updateLabelling(n)}},e.prototype.isCoveredByA=function(t){return!!this.isCovered(t,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Sr);Cr.overlayOp=function(t,e,n){return new Cr(t,e).getResultGeometry(n)},Cr.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Cr.createEmptyResult(Cr.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return Wi.map(t,{interfaces_:function(){return[Pr.MapOp]},map:function(t){return t.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Cr.INTERSECTION)},Cr.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Cr.createEmptyResult(Cr.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Cr.SYMDIFFERENCE)},Cr.resultDimension=function(t,e,n){var i=e.getDimension(),r=n.getDimension(),o=-1;switch(t){case Cr.INTERSECTION:o=Math.min(i,r);break;case Cr.UNION:o=Math.max(i,r);break;case Cr.DIFFERENCE:o=i;break;case Cr.SYMDIFFERENCE:o=Math.max(i,r)}return o},Cr.createEmptyResult=function(t,e,n,i){var r=null;switch(Cr.resultDimension(t,e,n)){case-1:r=i.createGeometryCollection(new Array(0).fill(null));break;case 0:r=i.createPoint();break;case 1:r=i.createLineString();break;case 2:r=i.createPolygon()}return r},Cr.difference=function(t,e){return t.isEmpty()?Cr.createEmptyResult(Cr.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Cr.DIFFERENCE))},Cr.isResultOfOp=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=t.getLocation(0),i=t.getLocation(1);return Cr.isResultOfOp(n,i,e)}if(3===arguments.length){var r=arguments[0],o=arguments[1],s=arguments[2];switch(r===T.BOUNDARY&&(r=T.INTERIOR),o===T.BOUNDARY&&(o=T.INTERIOR),s){case Cr.INTERSECTION:return r===T.INTERIOR&&o===T.INTERIOR;case Cr.UNION:return r===T.INTERIOR||o===T.INTERIOR;case Cr.DIFFERENCE:return r===T.INTERIOR&&o!==T.INTERIOR;case Cr.SYMDIFFERENCE:return r===T.INTERIOR&&o!==T.INTERIOR||r!==T.INTERIOR&&o===T.INTERIOR}return!1}},Cr.INTERSECTION=1,Cr.UNION=2,Cr.DIFFERENCE=3,Cr.SYMDIFFERENCE=4;var Ir=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Pi,this._seg=new gn;var t=arguments[0],e=arguments[1];this._g=t,this._boundaryDistanceTolerance=e,this._linework=this.extractLinework(t)};Ir.prototype.isWithinToleranceOfBoundary=function(t){for(var e=0;e<this._linework.getNumGeometries();e++)for(var n=this._linework.getGeometryN(e).getCoordinateSequence(),i=0;i<n.size()-1;i++)if(n.getCoordinate(i,this._seg.p0),n.getCoordinate(i+1,this._seg.p1),this._seg.distance(t)<=this._boundaryDistanceTolerance)return!0;return!1},Ir.prototype.getLocation=function(t){return this.isWithinToleranceOfBoundary(t)?T.BOUNDARY:this._ptLocator.locate(t,this._g)},Ir.prototype.extractLinework=function(t){var e=new Tr;t.apply(e);var n=e.getLinework(),i=ye.toLineStringArray(n);return t.getFactory().createMultiLineString(i)},Ir.prototype.interfaces_=function(){return[]},Ir.prototype.getClass=function(){return Ir};var Tr=function(){this._linework=null,this._linework=new Et};Tr.prototype.getLinework=function(){return this._linework},Tr.prototype.filter=function(t){if(t instanceof Jt){var e=t;this._linework.add(e.getExteriorRing());for(var n=0;n<e.getNumInteriorRing();n++)this._linework.add(e.getInteriorRingN(n))}},Tr.prototype.interfaces_=function(){return[jt]},Tr.prototype.getClass=function(){return Tr};var Mr=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var t=arguments[0];this._g=t};Mr.prototype.extractPoints=function(t,e,n){for(var i=t.getCoordinates(),r=0;r<i.length-1;r++)this.computeOffsetPoints(i[r],i[r+1],e,n)},Mr.prototype.setSidesToGenerate=function(t,e){this._doLeft=t,this._doRight=e},Mr.prototype.getPoints=function(t){for(var e=new Et,n=Si.getLines(this._g).iterator();n.hasNext();){var i=n.next();this.extractPoints(i,t,e)}return e},Mr.prototype.computeOffsetPoints=function(t,e,n,i){var r=e.x-t.x,o=e.y-t.y,s=Math.sqrt(r*r+o*o),a=n*r/s,l=n*o/s,u=(e.x+t.x)/2,c=(e.y+t.y)/2;if(this._doLeft){var h=new S(u-l,c+a);i.add(h)}if(this._doRight){var f=new S(u+l,c-a);i.add(f)}},Mr.prototype.interfaces_=function(){return[]},Mr.prototype.getClass=function(){return Mr};var Lr=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new Et;var e=arguments[0],n=arguments[1],i=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,i],this._locFinder=[new Ir(this._geom[0],this._boundaryDistanceTolerance),new Ir(this._geom[1],this._boundaryDistanceTolerance),new Ir(this._geom[2],this._boundaryDistanceTolerance)]},Ar={TOLERANCE:{configurable:!0}};Lr.prototype.reportResult=function(t,e,n){q.out.println("Overlay result invalid - A:"+T.toLocationSymbol(e[0])+" B:"+T.toLocationSymbol(e[1])+" expected:"+(n?"i":"e")+" actual:"+T.toLocationSymbol(e[2]))},Lr.prototype.isValid=function(t){return this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]),this.checkValid(t)},Lr.prototype.checkValid=function(){if(1===arguments.length){for(var t=arguments[0],e=0;e<this._testCoords.size();e++){var n=this._testCoords.get(e);if(!this.checkValid(t,n))return this._invalidLocation=n,!1}return!0}if(2===arguments.length){var i=arguments[0],r=arguments[1];return this._location[0]=this._locFinder[0].getLocation(r),this._location[1]=this._locFinder[1].getLocation(r),this._location[2]=this._locFinder[2].getLocation(r),!!Lr.hasLocation(this._location,T.BOUNDARY)||this.isValidResult(i,this._location)}},Lr.prototype.addTestPts=function(t){var e=new Mr(t);this._testCoords.addAll(e.getPoints(5*this._boundaryDistanceTolerance))},Lr.prototype.isValidResult=function(t,e){var n=Cr.isResultOfOp(e[0],e[1],t),i=!(n^e[2]===T.INTERIOR);return i||this.reportResult(t,e,n),i},Lr.prototype.getInvalidLocation=function(){return this._invalidLocation},Lr.prototype.interfaces_=function(){return[]},Lr.prototype.getClass=function(){return Lr},Lr.hasLocation=function(t,e){for(var n=0;n<3;n++)if(t[n]===e)return!0;return!1},Lr.computeBoundaryDistanceTolerance=function(t,e){return Math.min(Ki.computeSizeBasedSnapTolerance(t),Ki.computeSizeBasedSnapTolerance(e))},Lr.isValid=function(t,e,n,i){return new Lr(t,e,i).isValid(n)},Ar.TOLERANCE.get=function(){return 1e-6},Object.defineProperties(Lr,Ar);var Or=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};Or.prototype.extractElements=function(t,e){if(null===t)return null;for(var n=0;n<t.getNumGeometries();n++){var i=t.getGeometryN(n);this._skipEmpty&&i.isEmpty()||e.add(i)}},Or.prototype.combine=function(){for(var t=new Et,e=this._inputGeoms.iterator();e.hasNext();){var n=e.next();this.extractElements(n,t)}return 0===t.size()?null!==this._geomFactory?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(t)},Or.prototype.interfaces_=function(){return[]},Or.prototype.getClass=function(){return Or},Or.combine=function(){if(1===arguments.length)return new Or(arguments[0]).combine();if(2===arguments.length){var t=arguments[0],e=arguments[1];return new Or(Or.createList(t,e)).combine()}if(3===arguments.length){var n=arguments[0],i=arguments[1],r=arguments[2];return new Or(Or.createList(n,i,r)).combine()}},Or.extractFactory=function(t){return t.isEmpty()?null:t.iterator().next().getFactory()},Or.createList=function(){if(2===arguments.length){var t=arguments[0],e=arguments[1],n=new Et;return n.add(t),n.add(e),n}if(3===arguments.length){var i=arguments[0],r=arguments[1],o=arguments[2],s=new Et;return s.add(i),s.add(r),s.add(o),s}};var Nr=function(){this._inputPolys=null,this._geomFactory=null;var t=arguments[0];this._inputPolys=t,null===this._inputPolys&&(this._inputPolys=new Et)},Rr={STRTREE_NODE_CAPACITY:{configurable:!0}};Nr.prototype.reduceToGeometries=function(t){for(var e=new Et,n=t.iterator();n.hasNext();){var i=n.next(),r=null;L(i,wt)?r=this.unionTree(i):i instanceof ct&&(r=i),e.add(r)}return e},Nr.prototype.extractByEnvelope=function(t,e,n){for(var i=new Et,r=0;r<e.getNumGeometries();r++){var o=e.getGeometryN(r);o.getEnvelopeInternal().intersects(t)?i.add(o):n.add(o)}return this._geomFactory.buildGeometry(i)},Nr.prototype.unionOptimized=function(t,e){var n=t.getEnvelopeInternal(),i=e.getEnvelopeInternal();if(!n.intersects(i))return Or.combine(t,e);if(t.getNumGeometries()<=1&&e.getNumGeometries()<=1)return this.unionActual(t,e);var r=n.intersection(i);return this.unionUsingEnvelopeIntersection(t,e,r)},Nr.prototype.union=function(){if(null===this._inputPolys)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var t=new sn(Nr.STRTREE_NODE_CAPACITY),e=this._inputPolys.iterator();e.hasNext();){var n=e.next();t.insert(n.getEnvelopeInternal(),n)}this._inputPolys=null;var i=t.itemsTree();return this.unionTree(i)},Nr.prototype.binaryUnion=function(){if(1===arguments.length){var t=arguments[0];return this.binaryUnion(t,0,t.size())}if(3===arguments.length){var e=arguments[0],n=arguments[1],i=arguments[2];if(i-n<=1){var r=Nr.getGeometry(e,n);return this.unionSafe(r,null)}if(i-n==2)return this.unionSafe(Nr.getGeometry(e,n),Nr.getGeometry(e,n+1));var o=Math.trunc((i+n)/2),s=this.binaryUnion(e,n,o),a=this.binaryUnion(e,o,i);return this.unionSafe(s,a)}},Nr.prototype.repeatedUnion=function(t){for(var e=null,n=t.iterator();n.hasNext();){var i=n.next();e=null===e?i.copy():e.union(i)}return e},Nr.prototype.unionSafe=function(t,e){return null===t&&null===e?null:null===t?e.copy():null===e?t.copy():this.unionOptimized(t,e)},Nr.prototype.unionActual=function(t,e){return Nr.restrictToPolygons(t.union(e))},Nr.prototype.unionTree=function(t){var e=this.reduceToGeometries(t);return this.binaryUnion(e)},Nr.prototype.unionUsingEnvelopeIntersection=function(t,e,n){var i=new Et,r=this.extractByEnvelope(n,t,i),o=this.extractByEnvelope(n,e,i),s=this.unionActual(r,o);return i.add(s),Or.combine(i)},Nr.prototype.bufferUnion=function(){if(1===arguments.length){var t=arguments[0];return t.get(0).getFactory().buildGeometry(t).buffer(0)}if(2===arguments.length){var e=arguments[0],n=arguments[1];return e.getFactory().createGeometryCollection([e,n]).buffer(0)}},Nr.prototype.interfaces_=function(){return[]},Nr.prototype.getClass=function(){return Nr},Nr.restrictToPolygons=function(t){if(L(t,Qt))return t;var e=Ei.getPolygons(t);return 1===e.size()?e.get(0):t.getFactory().createMultiPolygon(ye.toPolygonArray(e))},Nr.getGeometry=function(t,e){return e>=t.size()?null:t.get(e)},Nr.union=function(t){return new Nr(t).union()},Rr.STRTREE_NODE_CAPACITY.get=function(){return 4},Object.defineProperties(Nr,Rr);var kr=function(){};kr.prototype.interfaces_=function(){return[]},kr.prototype.getClass=function(){return kr},kr.union=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Cr.createEmptyResult(Cr.UNION,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),or.overlayOp(t,e,Cr.UNION)},t.GeoJSONReader=Ee,t.GeoJSONWriter=Se,t.OverlayOp=Cr,t.UnionOp=kr,t.BufferOp=gi,Object.defineProperty(t,"__esModule",{value:!0})}(e)},7840:t=>{function e(t,e){const n=new RegExp(e,"g"),i=t.match(n);return i?i.length:0}t.exports=e,t.exports.default=e},4635:(t,e,n)=>{const i=n(9622),r=n(2566),o=n(7840);function s(t,e,n){const s=n&&n.debug||!1,a=!(n&&!1===typeof n.nested),l=n&&n.startIndex||0;s&&console.log("[xml-utils] starting findTagByName with",e," and ",n);const u=i(t,`<${e}[ >/]`,l);if(s&&console.log("[xml-utils] start:",u),-1===u)return;const c=t.slice(u+e.length);let h=r(c,"^[^<]*[ /]>",0);const f=-1!==h&&"/"===c[h-1];if(s&&console.log("[xml-utils] selfClosing:",f),!1===f)if(a){let t=0,n=1,i=0;for(;-1!==(h=r(c,"[ /]"+e+">",t));){const r=c.substring(t,h+1);if(n+=o(r,"<"+e),i+=o(r,"/"+e+">"),i>=n)break;t=h}}else h=r(c,"[ /]"+e+">",0);const d=u+e.length+h+1;if(s&&console.log("[xml-utils] end:",d),-1===d)return;const p=t.slice(u,d);let g;return g=f?null:p.slice(p.indexOf(">")+1,p.lastIndexOf("<")),{inner:g,outer:p,start:u,end:d}}t.exports=s,t.exports.default=s},8602:(t,e,n)=>{const i=n(4635);function r(t,e,n){const r=[],o=n&&n.debug||!1,s=!n||"boolean"!=typeof n.nested||n.nested;let a,l=n&&n.startIndex||0;for(;a=i(t,e,{debug:o,startIndex:l});)l=s?a.start+1+e.length:a.end,r.push(a);return o&&console.log("findTagsByName found",r.length,"tags"),r}t.exports=r,t.exports.default=r},8330:t=>{function e(t,e,n){const i=n&&n.debug||!1;i&&console.log("getting "+e+" in "+t);const r="object"==typeof t?t.outer:t,o=`${e}\\="([^"]*)"`;i&&console.log("pattern:",o);const s=new RegExp(o).exec(r);if(i&&console.log("match:",s),s)return s[1]}t.exports=e,t.exports.default=e},2566:t=>{function e(t,e,n){const i=new RegExp(e).exec(t.slice(n));return i?n+i.index+i[0].length-1:-1}t.exports=e,t.exports.default=e},9622:t=>{function e(t,e,n){const i=new RegExp(e).exec(t.slice(n));return i?n+i.index:-1}t.exports=e,t.exports.default=e},9521:()=>{},3752:()=>{},3640:()=>{},2630:()=>{},7061:(t,e,n)=>{var i=n(8698).default;function r(){"use strict";t.exports=r=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},n=Object.prototype,o=n.hasOwnProperty,s=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},l=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function h(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,n){return t[e]=n}}function f(t,e,n,i){var r=e&&e.prototype instanceof g?e:g,o=Object.create(r.prototype),a=new T(i||[]);return s(o,"_invoke",{value:S(t,n,a)}),o}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var p={};function g(){}function m(){}function y(){}var v={};h(v,l,(function(){return this}));var _=Object.getPrototypeOf,b=_&&_(_(M([])));b&&b!==n&&o.call(b,l)&&(v=b);var x=y.prototype=g.prototype=Object.create(v);function w(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(r,s,a,l){var u=d(t[r],t,s);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==i(h)&&o.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,a,l)}),(function(t){n("throw",t,a,l)})):e.resolve(h).then((function(t){c.value=t,a(c)}),(function(t){return n("throw",t,a,l)}))}l(u.arg)}var r;s(this,"_invoke",{value:function(t,i){function o(){return new e((function(e,r){n(t,i,e,r)}))}return r=r?r.then(o,o):o()}})}function S(t,e,n){var i="suspendedStart";return function(r,o){if("executing"===i)throw new Error("Generator is already running");if("completed"===i){if("throw"===r)throw o;return{value:void 0,done:!0}}for(n.method=r,n.arg=o;;){var s=n.delegate;if(s){var a=P(s,n);if(a){if(a===p)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===i)throw i="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i="executing";var l=d(t,e,n);if("normal"===l.type){if(i=n.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i="completed",n.method="throw",n.arg=l.arg)}}}function P(t,e){var n=e.method,i=t.iterator[n];if(void 0===i)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,P(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var r=d(i,t.iterator,e.arg);if("throw"===r.type)return e.method="throw",e.arg=r.arg,e.delegate=null,p;var o=r.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function C(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function I(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(C,this),this.reset(!0)}function M(t){if(t){var e=t[l];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(o.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:L}}function L(){return{value:void 0,done:!0}}return m.prototype=y,s(x,"constructor",{value:y,configurable:!0}),s(y,"constructor",{value:m,configurable:!0}),m.displayName=h(y,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,h(t,c,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},w(E.prototype),h(E.prototype,u,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,i,r,o){void 0===o&&(o=Promise);var s=new E(f(t,n,i,r),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},w(x),h(x,c,"Generator"),h(x,l,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},e.values=M,T.prototype={constructor:T,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!t)for(var e in this)"t"===e.charAt(0)&&o.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,i){return s.type="throw",s.arg=t,e.next=n,i&&(e.method="next",e.arg=void 0),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return n("end");if(r.tryLoc<=this.prev){var a=o.call(r,"catchLoc"),l=o.call(r,"finallyLoc");if(a&&l){if(this.prev<r.catchLoc)return n(r.catchLoc,!0);if(this.prev<r.finallyLoc)return n(r.finallyLoc)}else if(a){if(this.prev<r.catchLoc)return n(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return n(r.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&o.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var r=i;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var s=r?r.completion:{};return s.type=t,s.arg=e,r?(this.method="next",this.next=r.finallyLoc,p):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),I(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var r=i.arg;I(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:M(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},8698:t=>{function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},4687:(t,e,n)=>{var i=n(7061)();t.exports=i;try{regeneratorRuntime=i}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=i:Function("r","regeneratorRuntime = r")(i)}},2499:(t,e,n)=>{"use strict";n.d(e,{Ie:()=>l,It:()=>o,L:()=>i,L5:()=>c,P1:()=>f,Qb:()=>h,pd:()=>u,sf:()=>a});const i={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams",50674:"LercParameters"},r={};for(const t in i)i.hasOwnProperty(t)&&(r[i[t]]=parseInt(t,10));const o=[r.BitsPerSample,r.ExtraSamples,r.SampleFormat,r.StripByteCounts,r.StripOffsets,r.StripRowCounts,r.TileByteCounts,r.TileOffsets,r.SubIFDs],s={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE",13:"IFD",16:"LONG8",17:"SLONG8",18:"IFD8"},a={};for(const t in s)s.hasOwnProperty(t)&&(a[s[t]]=parseInt(t,10));const l={WhiteIsZero:0,BlackIsZero:1,RGB:2,Palette:3,TransparencyMask:4,CMYK:5,YCbCr:6,CIELab:8,ICCLab:9},u={Unspecified:0,Assocalpha:1,Unassalpha:2},c={Version:0,AddCompression:1},h={None:0,Deflate:1},f={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},d={};for(const t in f)f.hasOwnProperty(t)&&(d[f[t]]=parseInt(t,10))}},o={};function s(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return r[t].call(n.exports,n,n.exports,s),n.exports}s.m=r,s.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return s.d(e,{a:e}),e},e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,s.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"==typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"==typeof n.then)return n}var r=Object.create(null);s.r(r);var o={};t=t||[null,e({}),e([]),e(e)];for(var a=2&i&&n;"object"==typeof a&&!~t.indexOf(a);a=e(a))Object.getOwnPropertyNames(a).forEach((t=>o[t]=()=>n[t]));return o.default=()=>n,s.d(r,o),r},s.d=(t,e)=>{for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce(((e,n)=>(s.f[n](t,e),e)),[])),s.u=t=>t+".js",s.miniCssF=t=>{},s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n={},i="deck.gl-minimum-template:",s.l=(t,e,r,o)=>{if(n[t])n[t].push(e);else{var a,l;if(void 0!==r)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var h=u[c];if(h.getAttribute("src")==t||h.getAttribute("data-webpack")==i+r){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.setAttribute("data-webpack",i+r),a.src=t),n[t]=[e];var f=(e,i)=>{a.onerror=a.onload=null,clearTimeout(d);var r=n[t];if(delete n[t],a.parentNode&&a.parentNode.removeChild(a),r&&r.forEach((t=>t(i))),e)return e(i)},d=setTimeout(f.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=f.bind(null,a.onerror),a.onload=f.bind(null,a.onload),l&&document.head.appendChild(a)}},s.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.p="",(()=>{var t={804:0};s.f.j=(e,n)=>{var i=s.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise(((n,r)=>i=t[e]=[n,r]));n.push(i[2]=r);var o=s.p+s.u(e),a=new Error;s.l(o,(n=>{if(s.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",a.name="ChunkLoadError",a.type=r,a.request=o,i[1](a)}}),"chunk-"+e,e)}};var e=(e,n)=>{var i,r,[o,a,l]=n,u=0;if(o.some((e=>0!==t[e]))){for(i in a)s.o(a,i)&&(s.m[i]=a[i]);l&&l(s)}for(e&&e(n);u<o.length;u++)r=o[u],s.o(t,r)&&t[r]&&t[r][0](),t[r]=0},n=self.webpackChunkdeck_gl_minimum_template=self.webpackChunkdeck_gl_minimum_template||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),(()=>{"use strict";var t=s(7294),e=s(745);function n(t,e,n,i,r,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(i,r)}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(a.push(i.value),a.length!==e);l=!0);}catch(t){u=!0,r=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw r}}return a}}(t,e)||function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var o=s(4687),a=s.n(o);function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e,n){return(e=function(t){var e=function(t,e){if("object"!==l(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,"string");if("object"!==l(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===l(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Math.PI,Math.PI;const c={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function h(t,{precision:e=c.precision}={}){return t=function(t){return Math.round(t/c.EPSILON)*c.EPSILON}(t),"".concat(parseFloat(t.toPrecision(e)))}function f(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function d(t,e,n){return function(t,e,n){if(f(t)){const i=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(i);for(let r=0;r<n.length&&r<i.length;++r)n[r]=e(t[r],r,n);return n}return e(t)}(t,(t=>Math.max(e,Math.min(n,t))))}function p(t,e,n){return f(t)?t.map(((t,i)=>p(t,e[i],n))):n*e+(1-n)*t}function g(t,e,n){const i=c.EPSILON;n&&(c.EPSILON=n);try{if(t===e)return!0;if(f(t)&&f(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!g(t[n],e[n]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):"number"==typeof t&&"number"==typeof e&&Math.abs(t-e)<=c.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{c.EPSILON=i}}function m(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class y{constructor(t){u(this,"_propsToCompare",void 0),u(this,"_propsToExtract",void 0),u(this,"_requiredProps",void 0);const{compare:e,extract:n,required:i}=t;this._propsToCompare=e,this._propsToExtract=n||e,this._requiredProps=i}arePropsEqual(t,e){for(const n of this._propsToCompare)if(!(n in t)||!(n in e)||!g(t[n],e[n]))return!1;return!0}initializeProps(t,e){const n={},i={};for(const r of this._propsToExtract)(r in t||r in e)&&(n[r]=t[r],i[r]=e[r]);return this._checkRequiredProps(n),this._checkRequiredProps(i),{start:n,end:i}}getDuration(t,e){return e.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach((e=>{const n=t[e];m(Number.isFinite(n)||Array.isArray(n),"".concat(e," is required for transition"))}))}}var v,_=1e-6,b="undefined"!=typeof Float32Array?Float32Array:Array;function x(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function w(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3];return t[0]=n[0]*i+n[4]*r+n[8]*o+n[12]*s,t[1]=n[1]*i+n[5]*r+n[9]*o+n[13]*s,t[2]=n[2]*i+n[6]*r+n[10]*o+n[14]*s,t[3]=n[3]*i+n[7]*r+n[11]*o+n[15]*s,t}function E(t,e){const n=w([],e,t);return x(n,n,1/n[3]),n}function S(t,e){const n=t%e;return n<0?e+n:n}function P(t,e,n){return t<e?e:t>n?n:t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),v=new b(4),b!=Float32Array&&(v[0]=0,v[1]=0,v[2]=0,v[3]=0);const C=Math.log2||function(t){return Math.log(t)*Math.LOG2E};function I(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],f=e[10],d=e[11],p=e[12],g=e[13],m=e[14],y=e[15],v=n*a-i*s,_=n*l-r*s,b=n*u-o*s,x=i*l-r*a,w=i*u-o*a,E=r*u-o*l,S=c*g-h*p,P=c*m-f*p,C=c*y-d*p,I=h*m-f*g,T=h*y-d*g,M=f*y-d*m,L=v*M-_*T+b*I+x*C-w*P+E*S;return L?(L=1/L,t[0]=(a*M-l*T+u*I)*L,t[1]=(r*T-i*M-o*I)*L,t[2]=(g*E-m*w+y*x)*L,t[3]=(f*w-h*E-d*x)*L,t[4]=(l*C-s*M-u*P)*L,t[5]=(n*M-r*C+o*P)*L,t[6]=(m*b-p*E-y*_)*L,t[7]=(c*E-f*b+d*_)*L,t[8]=(s*T-a*C+u*S)*L,t[9]=(i*C-n*T-o*S)*L,t[10]=(p*w-g*b+y*v)*L,t[11]=(h*b-c*w-d*v)*L,t[12]=(a*P-s*I-l*S)*L,t[13]=(n*I-i*P+r*S)*L,t[14]=(g*_-p*x-m*v)*L,t[15]=(c*x-h*_+f*v)*L,t):null}function T(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],g=e[12],m=e[13],y=e[14],v=e[15],_=n[0],b=n[1],x=n[2],w=n[3];return t[0]=_*i+b*a+x*h+w*g,t[1]=_*r+b*l+x*f+w*m,t[2]=_*o+b*u+x*d+w*y,t[3]=_*s+b*c+x*p+w*v,_=n[4],b=n[5],x=n[6],w=n[7],t[4]=_*i+b*a+x*h+w*g,t[5]=_*r+b*l+x*f+w*m,t[6]=_*o+b*u+x*d+w*y,t[7]=_*s+b*c+x*p+w*v,_=n[8],b=n[9],x=n[10],w=n[11],t[8]=_*i+b*a+x*h+w*g,t[9]=_*r+b*l+x*f+w*m,t[10]=_*o+b*u+x*d+w*y,t[11]=_*s+b*c+x*p+w*v,_=n[12],b=n[13],x=n[14],w=n[15],t[12]=_*i+b*a+x*h+w*g,t[13]=_*r+b*l+x*f+w*m,t[14]=_*o+b*u+x*d+w*y,t[15]=_*s+b*c+x*p+w*v,t}function M(t,e,n){var i,r,o,s,a,l,u,c,h,f,d,p,g=n[0],m=n[1],y=n[2];return e===t?(t[12]=e[0]*g+e[4]*m+e[8]*y+e[12],t[13]=e[1]*g+e[5]*m+e[9]*y+e[13],t[14]=e[2]*g+e[6]*m+e[10]*y+e[14],t[15]=e[3]*g+e[7]*m+e[11]*y+e[15]):(i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=e[9],d=e[10],p=e[11],t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=f,t[10]=d,t[11]=p,t[12]=i*g+a*m+h*y+e[12],t[13]=r*g+l*m+f*y+e[13],t[14]=o*g+u*m+d*y+e[14],t[15]=s*g+c*m+p*y+e[15]),t}function L(t,e,n){var i=n[0],r=n[1],o=n[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function A(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[4],s=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],f=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*r+u*i,t[5]=s*r+c*i,t[6]=a*r+h*i,t[7]=l*r+f*i,t[8]=u*r-o*i,t[9]=c*r-s*i,t[10]=h*r-a*i,t[11]=f*r-l*i,t}function O(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],f=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r+u*i,t[1]=s*r+c*i,t[2]=a*r+h*i,t[3]=l*r+f*i,t[4]=u*r-o*i,t[5]=c*r-s*i,t[6]=h*r-a*i,t[7]=f*r-l*i,t}function N(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function R(t,e,n,i){var r=e[0],o=e[1];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t}var k=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t};function D(){var t=new b(3);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function F(t,e,n){var i=new b(3);return i[0]=t,i[1]=e,i[2]=n,i}function z(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function B(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2];return t[0]=r*l-o*a,t[1]=o*s-i*l,t[2]=i*a-r*s,t}function j(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o+n[15];return s=s||1,t[0]=(n[0]*i+n[4]*r+n[8]*o+n[12])/s,t[1]=(n[1]*i+n[5]*r+n[9]*o+n[13])/s,t[2]=(n[2]*i+n[6]*r+n[10]*o+n[14])/s,t}function U(t,e,n){var i=e[0],r=e[1],o=e[2];return t[0]=i*n[0]+r*n[3]+o*n[6],t[1]=i*n[1]+r*n[4]+o*n[7],t[2]=i*n[2]+r*n[5]+o*n[8],t}function V(t,e,n){var i=n[0],r=n[1],o=n[2],s=n[3],a=e[0],l=e[1],u=e[2],c=r*u-o*l,h=o*a-i*u,f=i*l-r*a,d=r*f-o*h,p=o*c-i*f,g=i*h-r*c,m=2*s;return c*=m,h*=m,f*=m,d*=2,p*=2,g*=2,t[0]=a+c+d,t[1]=l+h+p,t[2]=u+f+g,t}!function(){var t=new b(2);b!=Float32Array&&(t[0]=0,t[1]=0)}();var G=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t},q=function(t){var e=t[0],n=t[1],i=t[2];return Math.hypot(e,n,i)},W=function(t){var e=t[0],n=t[1],i=t[2];return e*e+n*n+i*i};function H(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}D();const X=Math.PI,Y=X/4,Z=X/180,K=180/X,$=512,Q=4003e4,J=85.051129,tt=1.5;function et(t){return Math.pow(2,t)}function nt(t){return C(t)}function it(t){const[e,n]=t;H(Number.isFinite(e)),H(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const i=n*Z;return[$*(e*Z+X)/(2*X),$*(X+Math.log(Math.tan(Y+.5*i)))/(2*X)]}function rt(t){const[e,n]=t,i=e/$*(2*X)-X,r=2*(Math.atan(Math.exp(n/$*(2*X)-X))-Y);return[i*K,r*K]}function ot(t){const e=Math.cos(t*Z);return $/Q/e}function st(t){const{latitude:e,longitude:n,highPrecision:i=!1}=t;H(Number.isFinite(e)&&Number.isFinite(n));const r=$,o=Math.cos(e*Z),s=r/360,a=s/o,l=r/Q/o,u={unitsPerMeter:[l,l,l],metersPerUnit:[1/l,1/l,1/l],unitsPerDegree:[s,a,l],degreesPerUnit:[1/s,1/a,1/l]};if(i){const t=Z*Math.tan(e*Z)/o,n=s*t/2,i=r/Q*t,c=i/a*l;u.unitsPerDegree2=[0,n,i],u.unitsPerMeter2=[c,0,c]}return u}function at(t,e){const[n,i,r]=t,[o,s,a]=e,{unitsPerMeter:l,unitsPerMeter2:u}=st({longitude:n,latitude:i,highPrecision:!0}),c=it(t);c[0]+=o*(l[0]+u[0]*s),c[1]+=s*(l[1]+u[1]*s);const h=rt(c),f=(r||0)+(a||0);return Number.isFinite(r)||Number.isFinite(a)?[h[0],h[1],f]:h}function lt(t){return 2*Math.atan(.5/t)*K}function ut(t){return.5/Math.tan(.5*t*Z)}function ct(t,e){const[n,i,r=0]=t;return H(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(r)),E(e,[n,i,r,1])}function ht(t,e,n=0){const[i,r,o]=t;if(H(Number.isFinite(i)&&Number.isFinite(r),"invalid pixel coordinate"),Number.isFinite(o))return E(e,[i,r,o,1]);const s=E(e,[i,r,0,1]),a=E(e,[i,r,1,1]),l=s[2],u=a[2];return R([],s,a,l===u?0:((n||0)-l)/(u-l))}const ft=Math.PI/180;function dt(t,e,n){const{pixelUnprojectionMatrix:i}=t,r=E(i,[e,0,1,1]),o=E(i,[e,t.height,1,1]),s=rt(R([],r,o,(n*t.distanceScales.unitsPerMeter[2]-r[2])/(o[2]-r[2])));return s.push(n),s}const pt=.01,gt=["longitude","latitude","zoom"],mt={curve:1.414,speed:1.2};function yt(t,e,n){const i=(n=Object.assign({},mt,n)).curve,r=t.zoom,o=[t.longitude,t.latitude],s=et(r),a=e.zoom,l=[e.longitude,e.latitude],u=et(a-r),c=it(o),h=it(l),f=k([],h,c),d=Math.max(t.width,t.height),p=d/u,g=(E=(w=f)[0],S=w[1],Math.hypot(E,S)*s),m=Math.max(g,pt),y=i*i,v=(p*p-d*d+y*y*m*m)/(2*d*y*m),_=(p*p-d*d-y*y*m*m)/(2*p*y*m),b=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(_*_+1)-_);var w,E,S;return{startZoom:r,startCenterXY:c,uDelta:f,w0:d,u1:g,S:(x-b)/i,rho:i,rho2:y,r0:b,r1:x}}const vt=["bearing","pitch"],_t={speed:1.2,curve:1.414};class bt extends y{constructor(t={}){super({compare:["longitude","latitude","zoom","bearing","pitch"],extract:["width","height","longitude","latitude","zoom","bearing","pitch"],required:["width","height","latitude","longitude","zoom"]}),u(this,"opts",void 0),this.opts={..._t,...t}}interpolateProps(t,e,n){const i=function(t,e,n,i){const{startZoom:r,startCenterXY:o,uDelta:s,w0:a,u1:l,S:u,rho:c,rho2:h,r0:f}=yt(t,e,i);if(l<pt){const i={};for(const r of gt){const o=t[r],s=e[r];i[r]=(d=n)*s+(1-d)*o}return i}var d;const p=n*u,g=Math.cosh(f)/Math.cosh(f+c*p),m=a*((Math.cosh(f)*Math.tanh(f+c*p)-Math.sinh(f))/h)/l,y=r+nt(1/g),v=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}([],s,m);N(v,v,o);const _=rt(v);return{longitude:_[0],latitude:_[1],zoom:y}}(t,e,n,this.opts);for(const r of vt)i[r]=p(t[r]||0,e[r]||0,n);return i}getDuration(t,e){let{transitionDuration:n}=e;return"auto"===n&&(n=function(t,e,n){const i={...mt,...n},{screenSpeed:r,speed:o,maxDuration:s}=i,{S:a,rho:l}=yt(t,e,i),u=1e3*a;let c;return c=Number.isFinite(r)?u/(r/l):u/o,Number.isFinite(s)&&c>s?0:c}(t,e,this.opts)),n}}let xt=1,wt=1;class Et{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(t){const{delay:e=0,duration:n=Number.POSITIVE_INFINITY,rate:i=1,repeat:r=1}=t,o=xt++,s={time:0,delay:e,duration:n,rate:i,repeat:r};return this._setChannelTime(s,this.time),this.channels.set(o,s),o}removeChannel(t){this.channels.delete(t);for(const[e,n]of this.animations)n.channel===t&&this.detachAnimation(e)}isFinished(t){const e=this.channels.get(t);return void 0!==e&&this.time>=e.delay+e.duration*e.repeat}getTime(t){if(void 0===t)return this.time;const e=this.channels.get(t);return void 0===e?-1:e.time}setTime(t){this.time=Math.max(0,t);const e=this.channels.values();for(const t of e)this._setChannelTime(t,this.time);const n=this.animations.values();for(const t of n){const{animation:e,channel:n}=t;e.setTime(this.getTime(n))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,e){const n=wt++;return this.animations.set(n,{animation:t,channel:e}),t.setTime(this.getTime(e)),n}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(-1===this.lastEngineTime&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,e){const n=e-t.delay;n>=t.duration*t.repeat?t.time=t.duration*t.rate:(t.time=Math.max(0,n)%t.duration,t.time*=t.rate)}}const St=Symbol.for("component"),Pt=Symbol.for("propTypes"),Ct=Symbol.for("deprecatedProps"),It=Symbol.for("asyncPropDefaults"),Tt=Symbol.for("asyncPropOriginal"),Mt=Symbol.for("asyncPropResolved");function Lt(t){if("undefined"!=typeof window&&"object"==typeof window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof process&&"object"==typeof process.versions&&Boolean(process.versions.electron))return!0;const e="object"==typeof navigator&&"string"==typeof navigator.userAgent&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function At(){return!("object"==typeof process&&"[object process]"===String(process)&&!process.browser)||Lt()}const Ot="undefined"!=typeof __VERSION__?__VERSION__:"untranspiled source";At();class Nt{constructor(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage";u(this,"storage",void 0),u(this,"id",void 0),u(this,"config",void 0),this.storage=function(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch(t){return null}}(n),this.id=t,this.config=e,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let t={};if(this.storage){const e=this.storage.getItem(this.id);t=e?JSON.parse(e):{}}return Object.assign(this.config,t),this}}function Rt(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;const r=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>i&&(n=Math.min(n,i/t.width));const o=t.width*n,s=t.height*n,a=["font-size:1px;","padding:".concat(Math.floor(s/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(s,"px;"),"background:url(".concat(r,");"),"background-size:".concat(o,"px ").concat(s,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),a]}let kt;function Dt(t){return"string"==typeof t?kt[t.toUpperCase()]||kt.WHITE:t}function Ft(t,e){if(!t)throw new Error(e||"Assertion failed")}!function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"}(kt||(kt={}));const zt={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==s.g&&s.g,document:"undefined"!=typeof document&&document,process:"object"==typeof process&&process},Bt=(globalThis,zt.window||zt.self||zt.global),jt=zt.process||{};function Ut(){let t;var e,n;if(At&&"performance"in Bt)t=null==Bt||null===(e=Bt.performance)||void 0===e||null===(n=e.now)||void 0===n?void 0:n.call(e);else if("hrtime"in jt){var i;const e=null==jt||null===(i=jt.hrtime)||void 0===i?void 0:i.call(jt);t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}console;const Vt={debug:At&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Gt={enabled:!0,level:0};function qt(){}const Wt={},Ht={once:!0};class Xt{constructor(){let{id:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:""};u(this,"id",void 0),u(this,"VERSION",Ot),u(this,"_startTs",Ut()),u(this,"_deltaTs",Ut()),u(this,"_storage",void 0),u(this,"userData",{}),u(this,"LOG_THROTTLE_TIMEOUT",0),this.id=t,this.userData={},this._storage=new Nt("__probe-".concat(this.id,"__"),Gt),this.timeStamp("".concat(this.id," started")),function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),i=Object.getOwnPropertyNames(n);for(const n of i)"function"==typeof t[n]&&(e.find((t=>n===t))||(t[n]=t[n].bind(t)))}(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Ut()-this._startTs).toPrecision(10))}getDelta(){return Number((Ut()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,e){this._storage.setConfiguration({[t]:e})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,e){Ft(t,e)}warn(t){return this._getLogFunction(0,t,Vt.warn,arguments,Ht)}error(t){return this._getLogFunction(0,t,Vt.error,arguments)}deprecated(t,e){return this.warn("`".concat(t,"` is deprecated and will be removed in a later version. Use `").concat(e,"` instead"))}removed(t,e){return this.error("`".concat(t,"` has been removed. Use `").concat(e,"` instead"))}probe(t,e){return this._getLogFunction(t,e,Vt.log,arguments,{time:!0,once:!0})}log(t,e){return this._getLogFunction(t,e,Vt.debug,arguments)}info(t,e){return this._getLogFunction(t,e,console.info,arguments)}once(t,e){for(var n=arguments.length,i=new Array(n>2?n-2:0),r=2;r<n;r++)i[r-2]=arguments[r];return this._getLogFunction(t,e,Vt.debug||Vt.info,arguments,Ht)}table(t,e,n){return e?this._getLogFunction(t,e,console.table||qt,n&&[n],{tag:Kt(e)}):qt}image(t){let{logLevel:e,priority:n,image:i,message:r="",scale:o=1}=t;return this._shouldLog(e||n)?At?function(t){let{image:e,message:n="",scale:i=1}=t;if("string"==typeof e){const t=new Image;return t.onload=()=>{const e=Rt(t,n,i);console.log(...e)},t.src=e,qt}const r=e.nodeName||"";if("img"===r.toLowerCase())return console.log(...Rt(e,n,i)),qt;if("canvas"===r.toLowerCase()){const t=new Image;return t.onload=()=>console.log(...Rt(t,n,i)),t.src=e.toDataURL(),qt}return qt}({image:i,message:r,scale:o}):function(t){let{image:e,message:n="",scale:i=1}=t;return console.warn("removed"),qt}({image:i,message:r,scale:o}):qt}time(t,e){return this._getLogFunction(t,e,console.time?console.time:console.info)}timeEnd(t,e){return this._getLogFunction(t,e,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,e){return this._getLogFunction(t,e,console.timeStamp||qt)}group(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{collapsed:!1};const i=Zt({logLevel:t,message:e,opts:n}),{collapsed:r}=n;return i.method=(r?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.group(t,e,Object.assign({},n,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||qt)}withGroup(t,e,n){this.group(t,e)();try{n()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=Yt(t)}_getLogFunction(t,e,n,i,r){if(this._shouldLog(t)){r=Zt({logLevel:t,message:e,args:i,opts:r}),Ft(n=n||r.method),r.total=this.getTotal(),r.delta=this.getDelta(),this._deltaTs=Ut();const o=r.tag||r.message;if(r.once){if(Wt[o])return qt;Wt[o]=Ut()}return e=function(t,e,n){if("string"==typeof e){const i=n.time?function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}(function(t){let e;return e=t<10?"".concat(t.toFixed(2),"ms"):t<100?"".concat(t.toFixed(1),"ms"):t<1e3?"".concat(t.toFixed(0),"ms"):"".concat((t/1e3).toFixed(2),"s"),e}(n.total)):"";e=function(t,e,n){return At||"string"!=typeof t||(e&&(e=Dt(e),t="[".concat(e,"m").concat(t,"[39m")),n&&(e=Dt(n),t="[".concat(n+10,"m").concat(t,"[49m"))),t}(e=n.time?"".concat(t,": ").concat(i,"  ").concat(e):"".concat(t,": ").concat(e),n.color,n.background)}return e}(this.id,r.message,r),n.bind(console,e,...r.args)}return qt}}function Yt(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return Ft(Number.isFinite(e)&&e>=0),e}function Zt(t){const{logLevel:e,message:n}=t;t.logLevel=Yt(e);const i=t.args?Array.from(t.args):[];for(;i.length&&i.shift()!==n;);switch(typeof e){case"string":case"function":void 0!==n&&i.unshift(n),t.message=e;break;case"object":Object.assign(t,e)}"function"==typeof t.message&&(t.message=t.message());const r=typeof t.message;return Ft("string"===r||"object"===r),Object.assign(t,{args:i},t.opts)}function Kt(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}u(Xt,"VERSION",Ot);const $t=new Xt({id:"deck"});let Qt={};function Jt(t){Qt=t}function te(t,e,n,i){$t.level>0&&Qt[t]&&Qt[t].call(null,e,n,i)}function ee(t,e=(()=>!0)){return Array.isArray(t)?ne(t,e,[]):e(t)?[t]:[]}function ne(t,e,n){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?ne(r,e,n):e(r)&&n.push(r)}return n}function ie({target:t,source:e,start:n=0,count:i=1}){const r=e.length,o=i*r;let s=0;for(let i=n;s<r;s++)t[i++]=e[s];for(;s<o;)s<o-s?(t.copyWithin(n+s,n,n+s),s*=2):(t.copyWithin(n+s,n,n+o-s),s=o);return t}function re(){let t;if("undefined"!=typeof window&&window.performance)t=window.performance.now();else if("undefined"!=typeof process&&process.hrtime){const e=process.hrtime();t=1e3*e[0]+e[1]/1e6}else t=Date.now();return t}class oe{constructor(t,e){u(this,"name",void 0),u(this,"type",void 0),u(this,"sampleSize",1),u(this,"time",void 0),u(this,"count",void 0),u(this,"samples",void 0),u(this,"lastTiming",void 0),u(this,"lastSampleTime",void 0),u(this,"lastSampleCount",void 0),u(this,"_count",0),u(this,"_time",0),u(this,"_samples",0),u(this,"_startTime",0),u(this,"_timerPending",!1),this.name=t,this.type=e,this.reset()}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=re(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(re()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class se{constructor(t){u(this,"id",void 0),u(this,"stats",{}),this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"count";return this._getOrCreate({name:t,type:e})}get size(){return Object.keys(this.stats).length}reset(){for(const t in this.stats)this.stats[t].reset();return this}forEach(t){for(const e in this.stats)t(this.stats[e])}getTable(){const t={};return this.forEach((e=>{t[e.name]={time:e.time||0,count:e.count||0,average:e.getAverageTime()||0,hz:e.getHz()||0}})),t}_initializeStats(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>this._getOrCreate(t)))}_getOrCreate(t){if(!t||!t.name)return null;const{name:e,type:n}=t;return this.stats[e]||(this.stats[e]=t instanceof oe?t:new oe(e,n)),this.stats[e]}}const ae=t=>"function"==typeof t,le=t=>null!==t&&"object"==typeof t,ue=t=>le(t)&&t.constructor==={}.constructor,ce=t=>t&&"function"==typeof t[Symbol.iterator],he=t=>t&&"function"==typeof t[Symbol.asyncIterator],fe=t=>"undefined"!=typeof Response&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,de=t=>"undefined"!=typeof Blob&&t instanceof Blob,pe=t=>t&&"object"==typeof t&&t.isBuffer,ge=t=>(t=>"undefined"!=typeof ReadableStream&&t instanceof ReadableStream||le(t)&&ae(t.tee)&&ae(t.cancel)&&ae(t.getReader))(t)||(t=>le(t)&&ae(t.read)&&ae(t.pipe)&&(t=>"boolean"==typeof t)(t.readable))(t);function me(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function ye(t){var e;return!!t&&(Array.isArray(t)&&(t=t[0]),Array.isArray(null===(e=t)||void 0===e?void 0:e.extensions))}function ve(t){var e,n;let i;return me(t,"null loader"),me(ye(t),"invalid loader"),Array.isArray(t)&&(i=t[1],t=t[0],t={...t,options:{...t.options,...i}}),(null!==(e=t)&&void 0!==e&&e.parseTextSync||null!==(n=t)&&void 0!==n&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}let _e="";const be={},xe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,we=/^([-\w.]+\/[-\w.+]+)/;function Ee(t){const e=we.exec(t);return e?e[1]:t}function Se(t){const e=xe.exec(t);return e?e[1]:""}const Pe=/\?.*/;function Ce(t){if(fe(t)){const e=Ie(t.url||"");return{url:e,type:Ee(t.headers.get("content-type")||"")||Se(e)}}return de(t)?{url:Ie(t.name||""),type:t.type||""}:"string"==typeof t?{url:Ie(t),type:Se(t)}:{url:"",type:""}}function Ie(t){return t.replace(Pe,"")}async function Te(t){if(fe(t))return t;const e={},n=function(t){return fe(t)?t.headers["content-length"]||-1:de(t)?t.size:"string"==typeof t?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}(t);n>=0&&(e["content-length"]=String(n));const{url:i,type:r}=Ce(t);r&&(e["content-type"]=r);const o=await async function(t){if("string"==typeof t)return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const e=t.slice(0,5);return await new Promise((t=>{const n=new FileReader;n.onload=e=>{var n;return t(null==e||null===(n=e.target)||void 0===n?void 0:n.result)},n.readAsDataURL(e)}))}if(t instanceof ArrayBuffer){const e=function(t){let e="";const n=new Uint8Array(t);for(let t=0;t<n.byteLength;t++)e+=String.fromCharCode(n[t]);return btoa(e)}(t.slice(0,5));return"data:base64,".concat(e)}return null}(t);o&&(e["x-first-bytes"]=o),"string"==typeof t&&(t=(new TextEncoder).encode(t));const s=new Response(t,{headers:e});return Object.defineProperty(s,"url",{value:i}),s}async function Me(t,e){if("string"==typeof t){t=function(t){for(const e in be)if(t.startsWith(e)){const n=be[e];t=t.replace(e,n)}return t.startsWith("http://")||t.startsWith("https://")||(t="".concat(_e).concat(t)),t}(t);let n=e;return null!=e&&e.fetch&&"function"!=typeof(null==e?void 0:e.fetch)&&(n=e.fetch),await fetch(t,n)}return await Te(t)}const Le=new Xt({id:"loaders.gl"});class Ae{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==s.g&&s.g,"undefined"!=typeof document&&document;const Oe=Boolean("object"!=typeof process||"[object process]"!==String(process)||process.browser),Ne="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version),Re=(Ne&&parseFloat(Ne[1]),{fetch:null,mimeType:void 0,nothrow:!1,log:new class{constructor(){u(this,"console",void 0),this.console=console}log(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.log.bind(this.console,...e)}info(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.info.bind(this.console,...e)}warn(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.warn.bind(this.console,...e)}error(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return this.console.error.bind(this.console,...e)}},CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Oe,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]}),ke={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function De(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const Fe=()=>{const t=De();return t.globalOptions=t.globalOptions||{...Re},t.globalOptions};function ze(t,e,n,i){return n=n||[],function(t,e){je(t,null,Re,ke,e);for(const n of e){const i=t&&t[n.id]||{},r=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};je(i,n.id,r,o,e)}}(t,n=Array.isArray(n)?n:[n]),function(t,e,n){const i={...t.options||{}};return function(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}(i,n),null===i.log&&(i.log=new Ae),Ve(i,Fe()),Ve(i,e),i}(e,t,i)}function Be(t,e){const n=Fe(),i=t||n;return"function"==typeof i.fetch?i.fetch:le(i.fetch)?t=>Me(t,i):null!=e&&e.fetch?null==e?void 0:e.fetch:Me}function je(t,e,n,i,r){const o=e||"Top level",s=e?"".concat(e,"."):"";for(const a in t){const l=!e&&le(t[a]);if(!(a in n)&&("baseUri"!==a||e)&&("workerUrl"!==a||!e))if(a in i)Le.warn("".concat(o," loader option '").concat(s).concat(a,"' no longer supported, use '").concat(i[a],"'"))();else if(!l){const t=Ue(a,r);Le.warn("".concat(o," loader option '").concat(s).concat(a,"' not recognized. ").concat(t))()}}}function Ue(t,e){const n=t.toLowerCase();let i="";for(const r of e)for(const e in r.options){if(t===e)return"Did you mean '".concat(r.id,".").concat(e,"'?");const o=e.toLowerCase();(n.startsWith(o)||o.startsWith(n))&&(i=i||"Did you mean '".concat(r.id,".").concat(e,"'?"))}return i}function Ve(t,e){for(const n in e)if(n in e){const i=e[n];ue(i)&&ue(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function Ge(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}"undefined"!=typeof self&&self,"undefined"!=typeof window&&window,void 0!==s.g&&s.g,"undefined"!=typeof document&&document;const qe="object"!=typeof process||"[object process]"!==String(process)||process.browser,We="undefined"!=typeof window&&void 0!==window.orientation,He="undefined"!=typeof process&&process.version&&/v([0-9]*)/.exec(process.version);He&&parseFloat(He[1]);class Xe{terminate(){}}const Ye=new Map;function Ze(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function Ke(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;const i=n||new Set;if(t)if($e(t))i.add(t);else if($e(t.buffer))i.add(t.buffer);else if(ArrayBuffer.isView(t));else if(e&&"object"==typeof t)for(const n in t)Ke(t[n],e,i);return void 0===n?Array.from(i):[]}function $e(t){return!!t&&(t instanceof ArrayBuffer||"undefined"!=typeof MessagePort&&t instanceof MessagePort||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||"undefined"!=typeof OffscreenCanvas&&t instanceof OffscreenCanvas)}const Qe=()=>{};class Je{static isSupported(){return"undefined"!=typeof Worker&&qe||void 0!==Xe&&!qe}constructor(t){u(this,"name",void 0),u(this,"source",void 0),u(this,"url",void 0),u(this,"terminated",!1),u(this,"worker",void 0),u(this,"onMessage",void 0),u(this,"onError",void 0),u(this,"_loadableURL","");const{name:e,source:n,url:i}=t;Ge(n||i),this.name=e,this.source=n,this.url=i,this.onMessage=Qe,this.onError=t=>console.log(t),this.worker=qe?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=Qe,this.onError=Qe,this.worker.terminate(),this.terminated=!0}get isRunning(){return Boolean(this.onMessage)}postMessage(t,e){e=e||Ke(t),this.worker.postMessage(t,e)}_getErrorFromErrorEvent(t){let e="Failed to load ";return e+="worker ".concat(this.name," from ").concat(this.url,". "),t.message&&(e+="".concat(t.message," in ")),t.lineno&&(e+=":".concat(t.lineno,":").concat(t.colno)),new Error(e)}_createBrowserWorker(){this._loadableURL=function(t){Ge(t.source&&!t.url||!t.source&&t.url);let e=Ye.get(t.source||t.url);return e||(t.url&&(e=(n=t.url).startsWith("http")?Ze("try {\n  importScripts('".concat(n,"');\n} catch (error) {\n  console.error(error);\n  throw error;\n}")):n,Ye.set(t.url,e)),t.source&&(e=Ze(t.source),Ye.set(t.source,e))),Ge(e),e;var n}({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},t.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},t.onmessageerror=t=>console.error(t),t}_createNodeWorker(){let t;if(this.url){const e=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);t=new Xe(e,{eval:!1})}else{if(!this.source)throw new Error("no worker");t=new Xe(this.source,{eval:!0})}return t.on("message",(t=>{this.onMessage(t)})),t.on("error",(t=>{this.onError(t)})),t.on("exit",(t=>{})),t}}class tn{constructor(t,e){u(this,"name",void 0),u(this,"workerThread",void 0),u(this,"isRunning",!0),u(this,"result",void 0),u(this,"_resolve",(()=>{})),u(this,"_reject",(()=>{})),this.name=t,this.workerThread=e,this.result=new Promise(((t,e)=>{this._resolve=t,this._reject=e}))}postMessage(t,e){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:e})}done(t){Ge(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){Ge(this.isRunning),this.isRunning=!1,this._reject(t)}}class en{static isSupported(){return Je.isSupported()}constructor(t){u(this,"name","unnamed"),u(this,"source",void 0),u(this,"url",void 0),u(this,"maxConcurrency",1),u(this,"maxMobileConcurrency",1),u(this,"onDebug",(()=>{})),u(this,"reuseWorkers",!0),u(this,"props",{}),u(this,"jobQueue",[]),u(this,"idleQueue",[]),u(this,"count",0),u(this,"isDestroyed",!1),this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach((t=>t.destroy())),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},void 0!==t.name&&(this.name=t.name),void 0!==t.maxConcurrency&&(this.maxConcurrency=t.maxConcurrency),void 0!==t.maxMobileConcurrency&&(this.maxMobileConcurrency=t.maxMobileConcurrency),void 0!==t.reuseWorkers&&(this.reuseWorkers=t.reuseWorkers),void 0!==t.onDebug&&(this.onDebug=t.onDebug)}async startJob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t,e,n)=>t.done(n),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:(t,e)=>t.error(e);const i=new Promise((i=>(this.jobQueue.push({name:t,onMessage:e,onError:n,onStart:i}),this)));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const e=this.jobQueue.shift();if(e){this.onDebug({message:"Starting job",name:e.name,workerThread:t,backlog:this.jobQueue.length});const n=new tn(e.name,t);t.onMessage=t=>e.onMessage(n,t.type,t.payload),t.onError=t=>e.onError(n,t),e.onStart(n);try{await n.result}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new Je({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return We?this.maxMobileConcurrency:this.maxConcurrency}}const nn={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class rn{static isSupported(){return Je.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return rn._workerFarm=rn._workerFarm||new rn({}),rn._workerFarm.setProps(t),rn._workerFarm}constructor(t){u(this,"props",void 0),u(this,"workerPools",new Map),this.props={...nn},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:e,source:n,url:i}=t;let r=this.workerPools.get(e);return r||(r=new en({name:e,source:n,url:i}),r.setProps(this._getWorkerPoolProps()),this.workerPools.set(e,r)),r}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}u(rn,"_workerFarm",void 0);const on="latest";async function sn(t,e,n,i,r){const o=t.id,s=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e[t.id]||{},i="".concat(t.id,"-worker.js");let r=n.workerUrl;if(r||"compression"!==t.id||(r=e.workerUrl),"test"===e._workerType&&(r="modules/".concat(t.module,"/dist/").concat(i)),!r){let e=t.version;"latest"===e&&(e=on);const n=e?"@".concat(e):"";r="https://unpkg.com/@loaders.gl/".concat(t.module).concat(n,"/dist/").concat(i)}return Ge(r),r}(t,n),a=rn.getWorkerFarm(n).getWorkerPool({name:o,url:s});n=JSON.parse(JSON.stringify(n)),i=JSON.parse(JSON.stringify(i||{}));const l=await a.startJob("process-on-worker",an.bind(null,r));l.postMessage("process",{input:e,options:n,context:i});const u=await l.result;return await u.result}async function an(t,e,n,i){switch(n){case"done":e.done(i);break;case"error":e.error(new Error(i.error));break;case"process":const{id:r,input:o,options:s}=i;try{const n=await t(o,s);e.postMessage("done",{id:r,result:n})}catch(t){const n=t instanceof Error?t.message:"unknown error";e.postMessage("error",{id:r,error:n})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}const ln=262144,un=262144,cn=1048576;var hn=s(9521);function fn(t){if((e=t)&&"object"==typeof e&&e.isBuffer)return hn.toArrayBuffer(t);var e;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if("string"==typeof t){const e=t;return(new TextEncoder).encode(e).buffer}if(t&&"object"==typeof t&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function dn(t,e){return Oe?async function*(t,e){const n=t.getReader();let i;try{for(;;){const t=i||n.read();null!=e&&e._streamReadAhead&&(i=n.read());const{done:r,value:o}=await t;if(r)return;yield fn(o)}}catch(t){n.releaseLock()}}(t,e):async function*(t,e){for await(const e of t)yield fn(e)}(t)}const pn="Cannot convert supplied data type";async function gn(t,e,n){const i=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if("string"==typeof t||i)return function(t,e,n){if(e.text&&"string"==typeof t)return t;if(pe(t)&&(t=t.buffer),t instanceof ArrayBuffer){const n=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(n):n}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let n=t.buffer;const i=t.byteLength||t.length;return 0===t.byteOffset&&i===n.byteLength||(n=n.slice(t.byteOffset,t.byteOffset+i)),n}throw new Error(pn)}(t,e);if(de(t)&&(t=await Te(t)),fe(t)){const n=t;return await async function(t){if(!t.ok){const e=await async function(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let i=t.statusText;n.includes("application/json")&&(i+=" ".concat(await t.text())),e+=i,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch(t){}return e}(t);throw new Error(e)}}(n),e.binary?await n.arrayBuffer():await n.text()}if(ge(t)&&(t=function(t,e){if("string"==typeof t)return function*(t,e){const n=(null==e?void 0:e.chunkSize)||ln;let i=0;const r=new TextEncoder;for(;i<t.length;){const e=Math.min(t.length-i,n),o=t.slice(i,i+e);i+=e,yield r.encode(o)}}(t,e);if(t instanceof ArrayBuffer)return function*(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{chunkSize:n=un}=e;let i=0;for(;i<t.byteLength;){const e=Math.min(t.byteLength-i,n),r=new ArrayBuffer(e),o=new Uint8Array(t,i,e);new Uint8Array(r).set(o),i+=e,yield r}}(t,e);if(de(t))return async function*(t,e){const n=(null==e?void 0:e.chunkSize)||cn;let i=0;for(;i<t.size;){const e=i+n,r=await t.slice(i,e).arrayBuffer();i=e,yield r}}(t,e);if(ge(t))return dn(t,e);if(fe(t))return dn(t.body,e);throw new Error("makeIterator")}(t,n)),ce(t)||he(t))return async function(t){const e=[];for await(const n of t)e.push(n);return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const i=e.map((t=>t instanceof ArrayBuffer?new Uint8Array(t):t)),r=i.reduce(((t,e)=>t+e.byteLength),0),o=new Uint8Array(r);let s=0;for(const t of i)o.set(t,s),s+=t.byteLength;return o.buffer}(...e)}(t);throw new Error(pn)}const mn=new Xt({id:"loaders.gl"}),yn=()=>{const t=De();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry},vn=/\.([^.]+)$/;function _n(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!bn(t))return null;if(e&&!Array.isArray(e))return ve(e);let r=[];e&&(r=r.concat(e)),null!=n&&n.ignoreRegisteredLoaders||r.push(...yn()),function(t){for(const e of t)ve(e)}(r);const o=function(t,e,n,i){const{url:r,type:o}=Ce(t),s=r||(null==i?void 0:i.url);let a=null,l="";var u;return null!=n&&n.mimeType&&(a=wn(e,null==n?void 0:n.mimeType),l="match forced by supplied MIME type ".concat(null==n?void 0:n.mimeType)),a=a||function(t,e){const n=e&&vn.exec(e),i=n&&n[1];return i?function(t,e){e=e.toLowerCase();for(const n of t)for(const t of n.extensions)if(t.toLowerCase()===e)return n;return null}(t,i):null}(e,s),l=l||(a?"matched url ".concat(s):""),a=a||wn(e,o),l=l||(a?"matched MIME type ".concat(o):""),a=a||function(t,e){if(!e)return null;for(const n of t)if("string"==typeof e){if(En(e,n))return n}else if(ArrayBuffer.isView(e)){if(Sn(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&Sn(e,0,n))return n;return null}(e,t),l=l||(a?"matched initial data ".concat(Pn(t)):""),a=a||wn(e,null==n?void 0:n.fallbackMimeType),l=l||(a?"matched fallback MIME type ".concat(o):""),l&&mn.log(1,"selectLoader selected ".concat(null===(u=a)||void 0===u?void 0:u.name,": ").concat(l,".")),a}(t,r,n,i);if(!(o||null!=n&&n.nothrow))throw new Error(xn(t));return o}function bn(t){return!(t instanceof Response&&204===t.status)}function xn(t){const{url:e,type:n}=Ce(t);let i="No valid loader found (";i+=e?"".concat(function(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(e+1):""}(e),", "):"no url provided, ",i+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const r=t?Pn(t):"";return i+=r?' first bytes: "'.concat(r,'"'):"first bytes: not available",i+=")",i}function wn(t,e){for(const n of t){if(n.mimeTypes&&n.mimeTypes.includes(e))return n;if(e==="application/x.".concat(n.id))return n}return null}function En(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some((e=>t.startsWith(e)))}function Sn(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some((i=>function(t,e,n,i){if(i instanceof ArrayBuffer)return function(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const i=new Uint8Array(t),r=new Uint8Array(e);for(let t=0;t<i.length;++t)if(i[t]!==r[t])return!1;return!0}(i,t,i.byteLength);switch(typeof i){case"function":return i(t,n);case"string":return i===Cn(t,e,i.length);default:return!1}}(t,e,n,i)))}function Pn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;return"string"==typeof t?t.slice(0,e):ArrayBuffer.isView(t)?Cn(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?Cn(t,0,e):""}function Cn(t,e,n){if(t.byteLength<e+n)return"";const i=new DataView(t);let r="";for(let t=0;t<n;t++)r+=String.fromCharCode(i.getUint8(e+t));return r}async function In(t,e,n,i){Ge(!i||"object"==typeof i),!e||Array.isArray(e)||ye(e)||(i=void 0,n=e,e=void 0),t=await t,n=n||{};const{url:r}=Ce(t),o=function(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const t=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...t]:t}return n&&n.length?n:null}(e,i),s=await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;if(!bn(t))return null;let r=_n(t,e,{...n,nothrow:!0},i);if(r)return r;if(de(t)&&(r=_n(t=await t.slice(0,10).arrayBuffer(),e,n,i)),!(r||null!=n&&n.nothrow))throw new Error(xn(t));return r}(t,o,n);return s?(i=function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n)return n;const i={fetch:Be(e,t),...t};return Array.isArray(i.loaders)||(i.loaders=null),i}({url:r,parse:In,loaders:o},n=ze(n,s,o,r),i),await async function(t,e,n,i){if(function(t){Ge(t,"no worker provided");t.version}(t),fe(e)){const t=e,{ok:n,redirected:r,status:o,statusText:s,type:a,url:l}=t,u=Object.fromEntries(t.headers.entries());i.response={headers:u,ok:n,redirected:r,status:o,statusText:s,type:a,url:l}}if(e=await gn(e,t,n),t.parseTextSync&&"string"==typeof e)return n.dataType="text",t.parseTextSync(e,n,i,t);if(function(t,e){return!!rn.isSupported()&&!!(qe||null!=e&&e._nodeWorkers)&&t.worker&&(null==e?void 0:e.worker)}(t,n))return await sn(t,e,n,i,In);if(t.parseText&&"string"==typeof e)return await t.parseText(e,n,i,t);if(t.parse)return await t.parse(e,n,i,t);throw Ge(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}(s,t,n,i)):null}async function Tn(t,e,n,i){Array.isArray(e)||ye(e)||(n=e,e=void 0);const r=Be(n);let o=t;return"string"==typeof t&&(o=await r(t)),de(t)&&(o=await r(t)),await In(o,e,n)}class Mn{constructor(t,e,n){u(this,"id",void 0),u(this,"context",void 0),u(this,"isLoaded",void 0),u(this,"persistent",void 0),u(this,"_loadCount",0),u(this,"_subscribers",new Set),u(this,"_data",void 0),u(this,"_loader",void 0),u(this,"_error",void 0),u(this,"_content",void 0),this.id=t,this.context=n,this.setData(e)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then((()=>this.getData()))}setData(t,e){if(t===this._data&&!e)return;this._data=t;const n=++this._loadCount;let i=t;"string"==typeof t&&(i=Tn(t)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=void 0,this._content=t)})).catch((t=>{this._loadCount===n&&(this.isLoaded=!0,this._error=t||!0)}))):(this.isLoaded=!0,this._error=void 0,this._content=t);for(const t of this._subscribers)t.onChange(this.getData())}}class Ln{constructor({gl:t,protocol:e}){u(this,"protocol",void 0),u(this,"_context",void 0),u(this,"_resources",void 0),u(this,"_consumers",void 0),u(this,"_pruneRequest",void 0),this.protocol=e||"resource://",this._context={gl:t,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return!!t.startsWith(this.protocol)||t in this._resources}add({resourceId:t,data:e,forceUpdate:n=!1,persistent:i=!0}){let r=this._resources[t];r?r.setData(e,n):(r=new Mn(t,e,this._context),this._resources[t]=r),r.persistent=i}remove(t){const e=this._resources[t];e&&(e.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){const e=this._consumers[t];if(e){for(const t in e){const n=e[t],i=this._resources[n.resourceId];i&&i.unsubscribe(n)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:e,consumerId:n,requestId:i="default"}){const{_resources:r,protocol:o}=this;t.startsWith(o)&&(r[t=t.replace(o,"")]||this.add({resourceId:t,data:null,persistent:!1}));const s=r[t];if(this._track(n,i,s,e),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout((()=>this._prune()),0))}finalize(){for(const t in this._resources)this._resources[t].delete()}_track(t,e,n,i){const r=this._consumers,o=r[t]=r[t]||{},s=o[e]||{},a=s.resourceId&&this._resources[s.resourceId];a&&(a.unsubscribe(s),this.prune()),n&&(o[e]=s,s.onChange=i,s.resourceId=n.id,n.subscribe(s))}_prune(){this._pruneRequest=null;for(const t of Object.keys(this._resources)){const e=this._resources[t];e.persistent||e.inUse()||(e.delete(),delete this._resources[t])}}}const An=new class{constructor(t={}){u(this,"_pool",[]),u(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,e,{size:n=1,type:i,padding:r=0,copy:o=!1,initialize:s=!1,maxCount:a}){const l=i||t&&t.constructor||Float32Array,u=e*n+r;if(ArrayBuffer.isView(t)){if(u<=t.length)return t;if(u*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new l(t.buffer,0,u)}let c=1/0;a&&(c=a*n+r);const h=this._allocate(l,u,s,c);return t&&o?h.set(t):s||h.fill(0,0,4),this._release(t),h}release(t){this._release(t)}_allocate(t,e,n,i){let r=Math.max(Math.ceil(e*this.opts.overAlloc),1);r>i&&(r=i);const o=this._pool,s=t.BYTES_PER_ELEMENT*r,a=o.findIndex((t=>t.byteLength>=s));if(a>=0){const e=new t(o.splice(a,1)[0],0,r);return n&&e.fill(0),e}return new t(r)}_release(t){if(!ArrayBuffer.isView(t))return;const e=this._pool,{buffer:n}=t,{byteLength:i}=n,r=e.findIndex((t=>t.byteLength>=i));r<0?e.push(n):(r>0||e.length<this.opts.poolSize)&&e.splice(r,0,n),e.length>this.opts.poolSize&&e.shift()}};class On extends(function(t){function e(){var e=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(e,Object.getPrototypeOf(this)),e}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}(Array)){clone(){return(new this.constructor).copy(this)}fromArray(t,e=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}toArray(t=[],e=0){for(let n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:f(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(c)}formatString(t){let e="";for(let n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+h(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(!g(this[e],t[e]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,e,n){if(void 0===n)return this.lerp(this,t,e);for(let i=0;i<this.ELEMENTS;++i){const r=t[i];this[i]=r+n*(e[i]-r)}return this.check()}min(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}max(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}clamp(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}add(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=e[t];return this.check()}subtract(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=e[t];return this.check()}scale(t){if("number"==typeof t)for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;else for(let e=0;e<this.ELEMENTS&&e<t.length;++e)this[e]*=t[e];return this.check()}multiplyByScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}check(){if(c.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}addScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}get elements(){return this}}function Nn(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function Rn(t,e,n=""){if(c.debug&&!function(t,e){if(t.length!==e)return!1;for(let e=0;e<t.length;++e)if(!Number.isFinite(t[e]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}function kn(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}class Dn extends On{get x(){return this[0]}set x(t){this[0]=Nn(t)}get y(){return this[1]}set y(t){this[1]=Nn(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let e=0;for(let n=0;n<this.ELEMENTS;++n){const i=this[n]-t[n];e+=i*i}return Nn(e)}dot(t){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Nn(e)}normalize(){const t=this.magnitude();if(0!==t)for(let e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}multiply(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=e[t];return this.check()}divide(...t){for(const e of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return kn(t>=0&&t<this.ELEMENTS,"index is out of range"),Nn(this[t])}setComponent(t,e){return kn(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}addVectors(t,e){return this.copy(t).add(e)}subVectors(t,e){return this.copy(t).subtract(e)}multiplyVectors(t,e){return this.copy(t).multiply(e)}addScaledVector(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}}function Fn(t,e,n){const i=e[0],r=e[1],o=e[2],s=n[3]*i+n[7]*r+n[11]*o||1;return t[0]=(n[0]*i+n[4]*r+n[8]*o)/s,t[1]=(n[1]*i+n[5]*r+n[9]*o)/s,t[2]=(n[2]*i+n[6]*r+n[10]*o)/s,t}function zn(t,e,n){const i=e[0],r=e[1],o=e[2];return t[0]=n[0]*i+n[3]*r+n[6]*o,t[1]=n[1]*i+n[4]*r+n[7]*o,t[2]=n[2]*i+n[5]*r+n[8]*o,t[3]=e[3],t}const Bn=[0,0,0];let jn;class Un extends Dn{static get ZERO(){return jn||(jn=new Un(0,0,0),Object.freeze(jn)),jn}constructor(t=0,e=0,n=0){super(-0,-0,-0),1===arguments.length&&f(t)?this.copy(t):(c.debug&&(Nn(t),Nn(e),Nn(n)),this[0]=t,this[1]=e,this[2]=n)}set(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return c.debug&&(Nn(t.x),Nn(t.y),Nn(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=Nn(t)}angle(t){return n=t,i=(e=this)[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2],c=(u=Math.sqrt(i*i+r*r+o*o)*Math.sqrt(s*s+a*a+l*l))&&z(e,n)/u,Math.acos(Math.min(Math.max(c,-1),1));var e,n,i,r,o,s,a,l,u,c}cross(t){return B(this,this,t),this.check()}rotateX({radians:t,origin:e=Bn}){return function(t,e,n,i){var r=[],o=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0],o[1]=r[1]*Math.cos(i)-r[2]*Math.sin(i),o[2]=r[1]*Math.sin(i)+r[2]*Math.cos(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,e,t),this.check()}rotateY({radians:t,origin:e=Bn}){return function(t,e,n,i){var r=[],o=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[2]*Math.sin(i)+r[0]*Math.cos(i),o[1]=r[1],o[2]=r[2]*Math.cos(i)-r[0]*Math.sin(i),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,e,t),this.check()}rotateZ({radians:t,origin:e=Bn}){return function(t,e,n,i){var r=[],o=[];r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],o[0]=r[0]*Math.cos(i)-r[1]*Math.sin(i),o[1]=r[0]*Math.sin(i)+r[1]*Math.cos(i),o[2]=r[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2]}(this,this,e,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return j(this,this,t),this.check()}transformAsVector(t){return Fn(this,this,t),this.check()}transformByMatrix3(t){return U(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const i=e[0],r=e[1];t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2]}(this,this,t),this.check()}transformByQuaternion(t){return V(this,this,t),this.check()}}const Vn=new Un;function Gn(t,e,n,i){Vn.set(t,e,n);const r=Vn.len();return{distance:i/r,normal:new Un(-t/r,-e/r,-n/r)}}let qn;function Wn(t,e){const{size:n=1,startIndex:i=0}=e,r=void 0!==e.endIndex?e.endIndex:t.length,o=(r-i)/n;qn=An.allocate(qn,o,{type:Float32Array,size:2*n});let s=i,a=0;for(;s<r;){for(let e=0;e<n;e++){const i=t[s++];qn[a+e]=i,qn[a+e+n]=(l=i)-Math.fround(l)}a+=2*n}var l;return qn.subarray(0,o*n*2)}function Hn(t){let e=null,n=!1;for(const i of t)i&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],i[0][0]),e[0][1]=Math.min(e[0][1],i[0][1]),e[1][0]=Math.max(e[1][0],i[1][0]),e[1][1]=Math.max(e[1][1],i[1][1])):e=i);return e}class Xn extends On{toString(){let t="[";if(c.printRowMajor){t+="row-major:";for(let e=0;e<this.RANK;++e)for(let n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(let e=0;e<this.ELEMENTS;++e)t+=" ".concat(this[e])}return t+="]",t}getElementIndex(t,e){return e*this.RANK+t}getElement(t,e){return this[e*this.RANK+t]}setElement(t,e,n){return this[e*this.RANK+t]=Nn(n),this}getColumn(t,e=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)e[t]=this[n+t];return e}setColumn(t,e){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=e[t];return this}}var Yn;!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(Yn||(Yn={}));const Zn=45*Math.PI/180,Kn=1,$n=.1,Qn=500,Jn=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ti extends Xn{static get IDENTITY(){return ni||(ni=new ti,Object.freeze(ni)),ni}static get ZERO(){return ei||(ei=new ti([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(ei)),ei}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Yn}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,e,n,i,r,o,s,a,l,u,c,h,f,d,p,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this[9]=u,this[10]=c,this[11]=h,this[12]=f,this[13]=d,this[14]=p,this[15]=g,this.check()}setRowMajor(t,e,n,i,r,o,s,a,l,u,c,h,f,d,p,g){return this[0]=t,this[1]=r,this[2]=l,this[3]=f,this[4]=e,this[5]=o,this[6]=u,this[7]=d,this[8]=n,this[9]=s,this[10]=c,this[11]=p,this[12]=i,this[13]=a,this[14]=h,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(Jn)}fromObject(t){return this.check()}fromQuaternion(t){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,l=r+r,u=n*s,c=i*s,h=i*a,f=r*s,d=r*a,p=r*l,g=o*s,m=o*a,y=o*l;t[0]=1-h-p,t[1]=c+y,t[2]=f-m,t[3]=0,t[4]=c-y,t[5]=1-u-p,t[6]=d+g,t[7]=0,t[8]=f+m,t[9]=d-g,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(this,t),this.check()}frustum(t){const{left:e,right:n,bottom:i,top:r,near:o=$n,far:s=Qn}=t;return s===1/0?function(t,e,n,i,r,o){const s=2*o/(n-e),a=2*o/(r-i),l=(n+e)/(n-e),u=(r+i)/(r-i),c=-2*o;t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=l,t[9]=u,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=c,t[15]=0}(this,e,n,i,r,o):function(t,e,n,i,r,o,s){var a=1/(n-e),l=1/(r-i),u=1/(o-s);t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*l,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(r+i)*l,t[10]=(s+o)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*u,t[15]=0}(this,e,n,i,r,o,s),this.check()}lookAt(t){const{eye:e,center:n=[0,0,0],up:i=[0,1,0]}=t;return function(t,e,n,i){var r,o,s,a,l,u,c,h,f,d,p=e[0],g=e[1],m=e[2],y=i[0],v=i[1],b=i[2],x=n[0],w=n[1],E=n[2];Math.abs(p-x)<_&&Math.abs(g-w)<_&&Math.abs(m-E)<_?function(t){t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1}(t):(c=p-x,h=g-w,f=m-E,r=v*(f*=d=1/Math.hypot(c,h,f))-b*(h*=d),o=b*(c*=d)-y*f,s=y*h-v*c,(d=Math.hypot(r,o,s))?(r*=d=1/d,o*=d,s*=d):(r=0,o=0,s=0),a=h*s-f*o,l=f*r-c*s,u=c*o-h*r,(d=Math.hypot(a,l,u))?(a*=d=1/d,l*=d,u*=d):(a=0,l=0,u=0),t[0]=r,t[1]=a,t[2]=c,t[3]=0,t[4]=o,t[5]=l,t[6]=h,t[7]=0,t[8]=s,t[9]=u,t[10]=f,t[11]=0,t[12]=-(r*p+o*g+s*m),t[13]=-(a*p+l*g+u*m),t[14]=-(c*p+h*g+f*m),t[15]=1)}(this,e,n,i),this.check()}ortho(t){const{left:e,right:n,bottom:i,top:r,near:o=$n,far:s=Qn}=t;return function(t,e,n,i,r,o,s){var a=1/(e-n),l=1/(i-r),u=1/(o-s);t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*a,t[13]=(r+i)*l,t[14]=(s+o)*u,t[15]=1}(this,e,n,i,r,o,s),this.check()}orthographic(t){const{fovy:e=Zn,aspect:n=Kn,focalDistance:i=1,near:r=$n,far:o=Qn}=t;ii(e);const s=e/2,a=i*Math.tan(s),l=a*n;return this.ortho({left:-l,right:l,bottom:-a,top:a,near:r,far:o})}perspective(t){const{fovy:e=45*Math.PI/180,aspect:n=1,near:i=.1,far:r=500}=t;return ii(e),function(t,e,n,i,r){var o,s=1/Math.tan(e/2);t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(o=1/(i-r),t[10]=(r+i)*o,t[14]=2*r*i*o):(t[10]=-1,t[14]=-2*i)}(this,e,n,i,r),this.check()}determinant(){return e=(t=this)[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],f=t[11],d=t[12],p=t[13],g=t[14],(e*s-n*o)*(h*(m=t[15])-f*g)-(e*a-i*o)*(c*m-f*p)+(e*l-r*o)*(c*g-h*p)+(n*a-i*s)*(u*m-f*d)-(n*l-r*s)*(u*g-h*d)+(i*l-r*a)*(u*p-c*d);var t,e,n,i,r,o,s,a,l,u,c,h,f,d,p,g,m}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*r,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*r,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,e){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=e||[-0,-0,-0];const n=this.getScale(e),i=1/n[0],r=1/n[1],o=1/n[2];return t[0]=this[0]*i,t[1]=this[1]*r,t[2]=this[2]*o,t[3]=this[4]*i,t[4]=this[5]*r,t[5]=this[6]*o,t[6]=this[8]*i,t[7]=this[9]*r,t[8]=this[10]*o,t}transpose(){return function(t,e){if(t===e){var n=e[1],i=e[2],r=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=o,t[11]=e[14],t[12]=r,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15]}(this,this),this.check()}invert(){return I(this,this),this.check()}multiplyLeft(t){return T(this,t,this),this.check()}multiplyRight(t){return T(this,this,t),this.check()}rotateX(t){return A(this,this,t),this.check()}rotateY(t){return function(t,e,n){var i=Math.sin(n),r=Math.cos(n),o=e[0],s=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],f=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*r-u*i,t[1]=s*r-c*i,t[2]=a*r-h*i,t[3]=l*r-f*i,t[8]=o*i+u*r,t[9]=s*i+c*r,t[10]=a*i+h*r,t[11]=l*i+f*r}(this,this,t),this.check()}rotateZ(t){return O(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,e){return function(t,e,n,i){var r,o,s,a,l,u,c,h,f,d,p,g,m,y,v,b,x,w,E,S,P,C,I,T,M=i[0],L=i[1],A=i[2],O=Math.hypot(M,L,A);O<_||(M*=O=1/O,L*=O,A*=O,r=Math.sin(n),s=1-(o=Math.cos(n)),a=e[0],l=e[1],u=e[2],c=e[3],h=e[4],f=e[5],d=e[6],p=e[7],g=e[8],m=e[9],y=e[10],v=e[11],b=M*M*s+o,x=L*M*s+A*r,w=A*M*s-L*r,E=M*L*s-A*r,S=L*L*s+o,P=A*L*s+M*r,C=M*A*s+L*r,I=L*A*s-M*r,T=A*A*s+o,t[0]=a*b+h*x+g*w,t[1]=l*b+f*x+m*w,t[2]=u*b+d*x+y*w,t[3]=c*b+p*x+v*w,t[4]=a*E+h*S+g*P,t[5]=l*E+f*S+m*P,t[6]=u*E+d*S+y*P,t[7]=c*E+p*S+v*P,t[8]=a*C+h*I+g*T,t[9]=l*C+f*I+m*T,t[10]=u*C+d*I+y*T,t[11]=c*C+p*I+v*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}(this,this,t,e),this.check()}scale(t){return L(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return M(this,this,t),this.check()}transform(t,e){return 4===t.length?(Rn(e=w(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}transformAsPoint(t,e){const{length:n}=t;let i;switch(n){case 2:i=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[4]*r+n[12],t[1]=n[1]*i+n[5]*r+n[13],t}(e||[-0,-0],t,this);break;case 3:i=j(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Rn(i,t.length),i}transformAsVector(t,e){let n;switch(t.length){case 2:n=function(t,e,n){const i=e[0],r=e[1],o=n[3]*i+n[7]*r||1;return t[0]=(n[0]*i+n[4]*r)/o,t[1]=(n[1]*i+n[5]*r)/o,t}(e||[-0,-0],t,this);break;case 3:n=Fn(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Rn(n,t.length),n}transformPoint(t,e){return this.transformAsPoint(t,e)}transformVector(t,e){return this.transformAsPoint(t,e)}transformDirection(t,e){return this.transformAsVector(t,e)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,e,n){return this.identity().translate([t,e,n])}}let ei,ni;function ii(t){if(t>2*Math.PI)throw Error("expected radians")}const ri={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(ri,"IDENTITY",{get:()=>($t.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const oi={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},si={common:0,meters:1,pixels:2},ai={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},li=Math.PI/180,ui=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],ci=[0,0,0],hi={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};class fi{constructor(t={}){u(this,"id",void 0),u(this,"x",void 0),u(this,"y",void 0),u(this,"width",void 0),u(this,"height",void 0),u(this,"padding",void 0),u(this,"isGeospatial",void 0),u(this,"zoom",void 0),u(this,"focalDistance",void 0),u(this,"position",void 0),u(this,"modelMatrix",void 0),u(this,"distanceScales",void 0),u(this,"scale",void 0),u(this,"center",void 0),u(this,"cameraPosition",void 0),u(this,"projectionMatrix",void 0),u(this,"viewMatrix",void 0),u(this,"viewMatrixUncentered",void 0),u(this,"viewMatrixInverse",void 0),u(this,"viewProjectionMatrix",void 0),u(this,"pixelProjectionMatrix",void 0),u(this,"pixelUnprojectionMatrix",void 0),u(this,"resolution",void 0),u(this,"_frustumPlanes",{}),this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||hi,this.focalDistance=t.focalDistance||1,this.position=t.position||ci,this.modelMatrix=t.modelMatrix||null;const{longitude:e,latitude:n}=t;this.isGeospatial=Number.isFinite(n)&&Number.isFinite(e),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?oi.WEB_MERCATOR:oi.WEB_MERCATOR_AUTO_OFFSET:oi.IDENTITY}equals(t){return t instanceof fi&&(this===t||t.width===this.width&&t.height===this.height&&t.scale===this.scale&&g(t.projectionMatrix,this.projectionMatrix)&&g(t.viewMatrix,this.viewMatrix))}project(t,{topLeft:e=!0}={}){const n=ct(this.projectPosition(t),this.pixelProjectionMatrix),[i,r]=n,o=e?r:this.height-r;return 2===t.length?[i,o]:[i,o,n[2]]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[i,r,o]=t,s=e?r:this.height-r,a=n&&n*this.distanceScales.unitsPerMeter[2],l=ht([i,s,o],this.pixelUnprojectionMatrix,a),[u,c,h]=this.unprojectPosition(l);return Number.isFinite(o)?[u,c,h]:Number.isFinite(n)?[u,c,n]:[u,c]}projectPosition(t){const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.unitsPerMeter[2]]}unprojectPosition(t){const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)*this.distanceScales.metersPerUnit[2]]}projectFlat(t){if(this.isGeospatial){const e=it(t);return e[1]=d(e[1],-318,830),e}return t}unprojectFlat(t){return this.isGeospatial?rt(t):t}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,0],e),i=this.unproject([this.width,0],e),r=this.unproject([0,this.height],e),o=this.unproject([this.width,this.height],e);return[Math.min(n[0],i[0],r[0],o[0]),Math.min(n[1],i[1],r[1],o[1]),Math.max(n[0],i[0],r[0],o[0]),Math.max(n[1],i[1],r[1],o[1])]}getDistanceScales(t){return t?st({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:e,width:n=1,height:i=1}){return t<this.x+this.width&&this.x<t+n&&e<this.y+this.height&&this.y<e+i}getFrustumPlanes(){return this._frustumPlanes.near||Object.assign(this._frustumPlanes,{left:Gn((t=this.viewProjectionMatrix)[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:Gn(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:Gn(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:Gn(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:Gn(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:Gn(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}),this._frustumPlanes;var t}panByPosition(t,e){return null}_initProps(t){const e=t.longitude,n=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=function(t){const{latitude:e}=t;H(Number.isFinite(e));const n=Math.cos(e*Z);return nt(Q*n)-9}({latitude:n})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||st({latitude:n,longitude:e}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:r,modelMatrix:o}=t;let s=ci;if(r&&(s=o?new ti(o).transformAsVector(r,[]):r),this.isGeospatial){const t=this.projectPosition([e,n,0]);this.center=new Un(s).scale(this.distanceScales.unitsPerMeter).add(t)}else this.center=this.projectPosition(s)}_initMatrices(t){const{viewMatrix:e=ui,projectionMatrix:n=null,orthographic:i=!1,fovyRadians:r,fovy:o=75,near:s=.1,far:a=1e3,padding:l=null,focalDistance:u=1}=t;this.viewMatrixUncentered=e,this.viewMatrix=(new ti).multiplyRight(e).translate(new Un(this.center).negate()),this.projectionMatrix=n||function({width:t,height:e,orthographic:n,fovyRadians:i,focalDistance:r,padding:o,near:s,far:a}){const l=t/e,u=n?(new ti).orthographic({fovy:i,aspect:l,focalDistance:r,near:s,far:a}):(new ti).perspective({fovy:i,aspect:l,near:s,far:a});if(o){const{left:n=0,right:i=0,top:r=0,bottom:s=0}=o,a=d((n+t-i)/2,0,t)-t/2,l=d((r+e-s)/2,0,e)-e/2;u[8]-=2*a/t,u[9]+=2*l/e}return u}({width:this.width,height:this.height,orthographic:i,fovyRadians:r||o*li,focalDistance:u,padding:l,near:s,far:a});const c=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];var h;T(c,c,this.projectionMatrix),T(c,c,this.viewMatrix),this.viewProjectionMatrix=c,this.viewMatrixInverse=I([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=[(h=this.viewMatrixInverse)[12],h[13],h[14]];const f=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],p=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];L(f,f,[this.width/2,-this.height/2,1]),M(f,f,[1,-1,0]),T(p,f,this.viewProjectionMatrix),this.pixelProjectionMatrix=p,this.pixelUnprojectionMatrix=I([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||$t.warn("Pixel project matrix not invertible")()}}u(fi,"displayName","Viewport");const di="vs",pi="fs";function gi(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const mi={number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},array:{validate:(t,e)=>Array.isArray(t)||ArrayBuffer.isView(t)}};function yi(t){let e=vi(t);return"object"===e?t?"type"in t?Object.assign({},t,mi[t.type]):"value"in t?(e=vi(t.value),Object.assign({type:e},t,mi[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},mi[e])}function vi(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}class _i{constructor(t){let{name:e,vs:n,fs:i,dependencies:r=[],uniforms:o,getUniforms:s,deprecations:a=[],defines:l={},inject:u={},vertexShader:c,fragmentShader:h}=t;gi("string"==typeof e),this.name=e,this.vs=n||c,this.fs=i||h,this.getModuleUniforms=s,this.dependencies=r,this.deprecations=this._parseDeprecationDefinitions(a),this.defines=l,this.injections=function(t){const e={vs:{},fs:{}};for(const n in t){let i=t[n];"string"==typeof i&&(i={order:0,injection:i}),e[n.slice(0,2)][n]=i}return e}(u),o&&(this.uniforms=function(t){const e={};for(const n in t){const i=yi(t[n]);e[n]=i}return e}(o))}getModuleSource(t){let e;switch(t){case"vs":e=this.vs||"";break;case"fs":e=this.fs||"";break;default:gi(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),"\n").concat(e,"// END MODULE_").concat(this.name,"\n\n")}getUniforms(t,e){return this.getModuleUniforms?this.getModuleUniforms(t,e):this.uniforms?this._defaultGetUniforms(t):{}}getDefines(){return this.defines}checkDeprecations(t,e){this.deprecations.forEach((n=>{n.regex.test(t)&&(n.deprecated?e.deprecated(n.old,n.new)():e.removed(n.old,n.new)())}))}_parseDeprecationDefinitions(t){return t.forEach((t=>{"function"===t.type?t.regex=new RegExp("\\b".concat(t.old,"\\(")):t.regex=new RegExp("".concat(t.type," ").concat(t.old,";"))})),t}_defaultGetUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e={},n=this.uniforms;for(const i in n){const r=n[i];i in t&&!r.private?(r.validate&&gi(r.validate(t[i],r),"".concat(this.name,": invalid ").concat(i)),e[i]=t[i]):e[i]=r.value}return e}}function bi(t){return function(t){const e={},n={};return xi({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort(((t,e)=>n[e]-n[t])).map((t=>e[t]))}(wi(t))}function xi(t){let{modules:e,level:n,moduleMap:i,moduleDepth:r}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const t of e)i[t.name]=t,(void 0===r[t.name]||r[t.name]<n)&&(r[t.name]=n);for(const t of e)t.dependencies&&xi({modules:t.dependencies,level:n+1,moduleMap:i,moduleDepth:r})}function wi(t,e){return t.map((t=>(t instanceof _i||(gi("string"!=typeof t,"Shader module use by name is deprecated. Import shader module '".concat(t,"' and use it directly.")),gi(t.name,"shader module has no name"),(t=new _i(t)).dependencies=wi(t.dependencies)),t)))}const Ei=7936,Si=7937,Pi=7938,Ci=35724,Ii={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Ti={};Object.keys(Ii).forEach((t=>{Ti[t]=t}));const Mi={};function Li(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=Ii[e];if(gi(i,e),!function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e="undefined"!=typeof window&&window.navigator||{},n=t.userAgent||e.userAgent||"",i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r}(n))return!0;if(e in Mi)return Mi[e];const r=i[0],o=n.behavior||"enable",s="#extension GL_".concat(r," : ").concat(o,"\nvoid main(void) {}"),a=t.createShader(35633);t.shaderSource(a,s),t.compileShader(a);const l=t.getShaderParameter(a,35713);return t.deleteShader(a),Mi[e]=l,l}function Ai(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>function(t,e){const n=Ii[e];gi(n,e);const i=function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}(t)&&n[1]||n[0],r="string"==typeof i?Boolean(t.getExtension(i)):i;return gi(!1===r||!0===r),r}(t,e)))}const Oi={[di]:"#ifdef MODULE_LOGDEPTH\n  logdepth_adjustPosition(gl_Position);\n#endif\n",[pi]:"#ifdef MODULE_MATERIAL\n  gl_FragColor = material_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LIGHTING\n  gl_FragColor = lighting_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_FOG\n  gl_FragColor = fog_filterColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_PICKING\n  gl_FragColor = picking_filterHighlightColor(gl_FragColor);\n  gl_FragColor = picking_filterPickingColor(gl_FragColor);\n#endif\n\n#ifdef MODULE_LOGDEPTH\n  logdepth_setFragDepth();\n#endif\n"},Ni="__LUMA_INJECT_DECLARATIONS__",Ri=/void\s+main\s*\([^)]*\)\s*\{\n?/,ki=/}\n?[^{}]*$/,Di=[];function Fi(t,e,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=e===di;for(const e in n){const i=n[e];i.sort(((t,e)=>t.order-e.order)),Di.length=i.length;for(let t=0,e=i.length;t<e;++t)Di[t]=i[t].injection;const o="".concat(Di.join("\n"),"\n");switch(e){case"vs:#decl":r&&(t=t.replace(Ni,o));break;case"vs:#main-start":r&&(t=t.replace(Ri,(t=>t+o)));break;case"vs:#main-end":r&&(t=t.replace(ki,(t=>o+t)));break;case"fs:#decl":r||(t=t.replace(Ni,o));break;case"fs:#main-start":r||(t=t.replace(Ri,(t=>t+o)));break;case"fs:#main-end":r||(t=t.replace(ki,(t=>o+t)));break;default:t=t.replace(e,(t=>t+o))}}return t=t.replace(Ni,""),i&&(t=t.replace(/\}\s*$/,(t=>t+Oi[e]))),t}function zi(t){const e={};return gi(Array.isArray(t)&&t.length>1),t.forEach((t=>{for(const n in t)e[n]=e[n]?"".concat(e[n],"\n").concat(t[n]):t[n]})),e}function Bi(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const ji=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,"#version 300 es\n"],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Ui=[...ji,[Bi("attribute"),"in $1"],[Bi("varying"),"out $1"]],Vi=[...ji,[Bi("varying"),"in $1"]],Gi=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],qi=[...Gi,[Bi("in"),"attribute $1"],[Bi("out"),"varying $1"]],Wi=[...Gi,[Bi("in"),"varying $1"]],Hi="gl_FragColor",Xi=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,Yi=/void\s+main\s*\([^)]*\)\s*\{\n?/;function Zi(t,e){for(const[n,i]of e)t=t.replace(n,i);return t}const Ki="\n\n".concat(Ni,"\n\n"),$i={[di]:"vertex",[pi]:"fragment"},Qi="precision highp float;\n\n";function Ji(t,e){let{id:n,source:i,type:r,modules:o,defines:s={},hookFunctions:a=[],inject:l={},transpileToGLSL100:u=!1,prologue:c=!0,log:h}=e;gi("string"==typeof i,"shader source must be a string");const f=r===di,d=i.split("\n");let p=100,g="",m=i;0===d[0].indexOf("#version ")?(p=300,g=d[0],m=d.slice(1).join("\n")):g="#version ".concat(p);const y={};o.forEach((t=>{Object.assign(y,t.getDefines())})),Object.assign(y,s);let v=c?"".concat(g,"\n").concat(function(t){let{id:e,source:n,type:i}=t;return e&&"string"==typeof e&&-1===n.indexOf("SHADER_NAME")?"\n#define SHADER_NAME ".concat(e,"_").concat($i[i],"\n\n"):""}({id:n,source:i,type:r}),"\n").concat(function(t){let{type:e}=t;return"\n#define SHADER_TYPE_".concat($i[e].toUpperCase(),"\n")}({type:r}),"\n").concat(function(t){const e=function(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||Ei),i=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Si);return{gpuVendor:function(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}(n,i),vendor:n,renderer:i,version:t.getParameter(Pi),shadingLanguageVersion:t.getParameter(Ci)}}(t);switch(e.gpuVendor.toLowerCase()){case"nvidia":return"#define NVIDIA_GPU\n// Nvidia optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n";case"intel":return"#define INTEL_GPU\n// Intel optimizes away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n";case"amd":return"#define AMD_GPU\n";default:return"#define DEFAULT_GPU\n// Prevent driver from optimizing away the calculation necessary for emulated fp64\n#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1\n// Intel's built-in 'tan' function doesn't have acceptable precision\n#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1\n// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow\n#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1\n"}}(t),"\n").concat(function(t,e,n){let i="#if (__VERSION__ > 120)\n\n# define FEATURE_GLSL_DERIVATIVES\n# define FEATURE_GLSL_DRAW_BUFFERS\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FEATURE_GLSL_TEXTURE_LOD\n\n// DEPRECATED FLAGS, remove in v9\n# define FRAG_DEPTH\n# define DERIVATIVES\n# define DRAW_BUFFERS\n# define TEXTURE_LOD\n\n#endif // __VERSION\n";return Ai(t,Ti.GLSL_FRAG_DEPTH)&&(i+="\n// FRAG_DEPTH => gl_FragDepth is available\n#ifdef GL_EXT_frag_depth\n#extension GL_EXT_frag_depth : enable\n# define FEATURE_GLSL_FRAG_DEPTH\n# define FRAG_DEPTH\n# define gl_FragDepth gl_FragDepthEXT\n#endif\n"),Ai(t,Ti.GLSL_DERIVATIVES)&&Li(t,Ti.GLSL_DERIVATIVES)&&(i+="\n// DERIVATIVES => dxdF, dxdY and fwidth are available\n#ifdef GL_OES_standard_derivatives\n#extension GL_OES_standard_derivatives : enable\n# define FEATURE_GLSL_DERIVATIVES\n# define DERIVATIVES\n#endif\n"),Ai(t,Ti.GLSL_FRAG_DATA)&&Li(t,Ti.GLSL_FRAG_DATA,{behavior:"require"})&&(i+="\n// DRAW_BUFFERS => gl_FragData[] is available\n#ifdef GL_EXT_draw_buffers\n#extension GL_EXT_draw_buffers : require\n#define FEATURE_GLSL_DRAW_BUFFERS\n#define DRAW_BUFFERS\n#endif\n"),Ai(t,Ti.GLSL_TEXTURE_LOD)&&(i+="// TEXTURE_LOD => texture2DLod etc are available\n#ifdef GL_EXT_shader_texture_lod\n#extension GL_EXT_shader_texture_lod : enable\n\n# define FEATURE_GLSL_TEXTURE_LOD\n# define TEXTURE_LOD\n\n#endif\n"),i}(t),"\n").concat(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=0,n="";for(const i in t){0===e&&(n+="\n// APPLICATION DEFINES\n"),e++;const r=t[i];(r||Number.isFinite(r))&&(n+="#define ".concat(i.toUpperCase()," ").concat(t[i],"\n"))}return 0===e&&(n+="\n"),n}(y),"\n").concat(f?"":Qi,"\n"):"".concat(g,"\n");const _=function(t){const e={vs:{},fs:{}};return t.forEach((t=>{let n;"string"!=typeof t?(n=t,t=n.hook):n={},t=t.trim();const[i,r]=t.split(":"),o=t.replace(/\(.+/,"");e[i][o]=Object.assign(n,{signature:r})})),e}(a),b={},x={},w={};for(const t in l){const e="string"==typeof l[t]?{injection:l[t],order:0}:l[t],n=t.match(/^(v|f)s:(#)?([\w-]+)$/);if(n){const i=n[2],r=n[3];i?"decl"===r?x[t]=[e]:w[t]=[e]:b[t]=[e]}else w[t]=[e]}for(const t of o){h&&t.checkDeprecations(m,h),v+=t.getModuleSource(r,p);const e=t.injections[r];for(const t in e){const n=t.match(/^(v|f)s:#([\w-]+)$/);if(n){const i="decl"===n[2]?x:w;i[t]=i[t]||[],i[t].push(e[t])}else b[t]=b[t]||[],b[t].push(e[t])}}return v+=Ki,v=Fi(v,r,x),v+=function(t,e){let n="";for(const i in t){const r=t[i];if(n+="void ".concat(r.signature," {\n"),r.header&&(n+="  ".concat(r.header)),e[i]){const t=e[i];t.sort(((t,e)=>t.order-e.order));for(const e of t)n+="  ".concat(e.injection,"\n")}r.footer&&(n+="  ".concat(r.footer)),n+="}\n"}return n}(_[r],b),v+=m,v=Fi(v,r,w),v=function(t,e,n){switch(e){case 300:return n?Zi(t,Ui):function(t){const e=(t=Zi(t,Vi)).match(Xi);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(Hi,"\\b"),"g"),n)}else{const e="fragmentColor";t=t.replace(Yi,(t=>"out vec4 ".concat(e,";\n").concat(t))).replace(new RegExp("\\b".concat(Hi,"\\b"),"g"),e)}return t}(t);case 100:return n?Zi(t,qi):function(t){const e=(t=Zi(t,Wi)).match(Xi);if(e){const n=e[1];t=t.replace(Xi,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),Hi)}return t}(t);default:throw new Error("unknown GLSL version ".concat(e))}}(v,u?100:p,f),v}function tr(t){return function(e){const n={};for(const i of t){const t=i.getUniforms(e,n);Object.assign(n,t)}return n}}const er=new Xt({id:"luma.gl"});function nr(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const ir="Invalid WebGLRenderingContext",rr="Requires WebGL2";function or(t){return"undefined"!=typeof WebGLRenderingContext&&t instanceof WebGLRenderingContext||"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&Number.isFinite(t._version))}function sr(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext||Boolean(t&&2===t._version)}function ar(t){return nr(or(t),ir),t}function lr(t){return nr(sr(t),rr),t}const ur={};const cr=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let e=0;e<this.attribs.length;e++){const i=new t.VertexAttrib(n);this.attribs[e]=i}this.maxAttrib=0};(cr.VertexAttrib=function(t){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()}).prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const hr=function(t){const e=this;this.gl=t,function(t){const e=t.getError;t.getError=function(){let n;do{n=e.apply(t),0!==n&&(ur[n]=!0)}while(0!==n);for(n in ur)if(ur[n])return delete ur[n],parseInt(n,10);return 0}}(t);const n=this.original={getParameter:t.getParameter,enableVertexAttribArray:t.enableVertexAttribArray,disableVertexAttribArray:t.disableVertexAttribArray,bindBuffer:t.bindBuffer,getVertexAttrib:t.getVertexAttrib,vertexAttribPointer:t.vertexAttribPointer};t.getParameter=function(t){return t===e.VERTEX_ARRAY_BINDING_OES?e.currentVertexArrayObject===e.defaultVertexArrayObject?null:e.currentVertexArrayObject:n.getParameter.apply(this,arguments)},t.enableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;return i.maxAttrib=Math.max(i.maxAttrib,t),i.attribs[t].enabled=!0,n.enableVertexAttribArray.apply(this,arguments)},t.disableVertexAttribArray=function(t){const i=e.currentVertexArrayObject;return i.maxAttrib=Math.max(i.maxAttrib,t),i.attribs[t].enabled=!1,n.disableVertexAttribArray.apply(this,arguments)},t.bindBuffer=function(t,i){switch(t){case 34962:e.currentArrayBuffer=i;break;case 34963:e.currentVertexArrayObject.elementArrayBuffer=i}return n.bindBuffer.apply(this,arguments)},t.getVertexAttrib=function(t,i){const r=e.currentVertexArrayObject.attribs[t];switch(i){case 34975:return r.buffer;case 34338:return r.enabled;case 34339:return r.size;case 34340:return r.stride;case 34341:return r.type;case 34922:return r.normalized;default:return n.getVertexAttrib.apply(this,arguments)}},t.vertexAttribPointer=function(t,i,r,o,s,a){const l=e.currentVertexArrayObject;l.maxAttrib=Math.max(l.maxAttrib,t);const u=l.attribs[t];return u.buffer=e.currentArrayBuffer,u.size=i,u.type=r,u.normalized=o,u.stride=s,u.offset=a,u.recache(),n.vertexAttribPointer.apply(this,arguments)},t.instrumentExtension&&t.instrumentExtension(this,"OES_vertex_array_object"),t.canvas&&t.canvas.addEventListener("webglcontextrestored",(()=>{globalThis.console&&globalThis.console.log&&globalThis.console.log("OESVertexArrayObject emulation library context restored"),e.reset_()}),!0),this.reset_()};hr.prototype.VERTEX_ARRAY_BINDING_OES=34229,hr.prototype.reset_=function(){if(void 0!==this.vertexArrayObjects)for(let t=0;t<this.vertexArrayObjects.length;++t)this.vertexArrayObjects.isAlive=!1;const t=this.gl;this.maxVertexAttribs=t.getParameter(34921),this.defaultVertexArrayObject=new cr(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)},hr.prototype.createVertexArrayOES=function(){const t=new cr(this);return this.vertexArrayObjects.push(t),t},hr.prototype.deleteVertexArrayOES=function(t){t.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(t),1),this.currentVertexArrayObject===t&&this.bindVertexArrayOES(null)},hr.prototype.isVertexArrayOES=function(t){return!!(t&&t instanceof cr&&t.hasBeenBound&&t.ext===this)},hr.prototype.bindVertexArrayOES=function(t){const e=this.gl;if(t&&!t.isAlive)return n="bindVertexArrayOES: attempt to bind deleted arrayObject",ur[1282]=!0,void(void 0!==n&&(i=n,globalThis.console&&globalThis.console.error&&globalThis.console.error(i)));var n,i;const r=this.original,o=this.currentVertexArrayObject;this.currentVertexArrayObject=t||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const s=this.currentVertexArrayObject;if(o===s)return;o&&s.elementArrayBuffer===o.elementArrayBuffer||r.bindBuffer.call(e,34963,s.elementArrayBuffer);let a=this.currentArrayBuffer;const l=Math.max(o?o.maxAttrib:0,s.maxAttrib);for(let t=0;t<=l;t++){const n=s.attribs[t],i=o?o.attribs[t]:null;if(o&&n.enabled===i.enabled||(n.enabled?r.enableVertexAttribArray.call(e,t):r.disableVertexAttribArray.call(e,t)),n.enabled){let s=!1;o&&n.buffer===i.buffer||(a!==n.buffer&&(r.bindBuffer.call(e,34962,n.buffer),a=n.buffer),s=!0),(s||n.cached!==i.cached)&&r.vertexAttribPointer.call(e,t,n.size,n.type,n.normalized,n.stride,n.offset)}}this.currentArrayBuffer!==a&&r.bindBuffer.call(e,34962,this.currentArrayBuffer)};const fr="OES_element_index",dr="WEBGL_draw_buffers",pr="WEBGL_debug_renderer_info",gr=t=>sr(t)?void 0:0,mr={3074:t=>sr(t)?void 0:36064,35723:t=>sr(t)?void 0:4352,35977:gr,32937:gr,36795:(t,e)=>{const n=sr(t)?t.getExtension("EXT_disjoint_timer_query_webgl2"):t.getExtension("EXT_disjoint_timer_query");return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},37445:(t,e)=>{const n=t.getExtension(pr);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},37446:(t,e)=>{const n=t.getExtension(pr);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},34047:(t,e)=>{const n=t.luma.extensions.EXT_texture_filter_anisotropic;return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:gr,35071:gr,37447:gr,36063:(t,e)=>{if(!sr(t)){const n=t.getExtension(dr);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:gr,35374:gr,35377:gr,34852:t=>{if(!sr(t)){const e=t.getExtension(dr);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(fr)?2147483647:65535,33001:t=>t.getExtension(fr)?16777216:65535,33e3:t=>16777216,37157:gr,35373:gr,35657:gr,36183:gr,37137:gr,34045:gr,35978:gr,35979:gr,35968:gr,35376:gr,35375:gr,35659:gr,37154:gr,35371:gr,35658:gr,35076:gr,35077:gr,35380:gr},yr="ANGLE_instanced_arrays",vr={OES_vertex_array_object:{meta:{suffix:"OES"},createVertexArray:()=>{nr(!1,"VertexArray requires WebGL2 or OES_vertex_array_object extension")},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[yr]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){nr(0===e,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},WEBGL_draw_buffers:{meta:{suffix:"WEBGL"},drawBuffers:()=>{nr(!1)}},EXT_disjoint_timer_query:{meta:{suffix:"EXT"},createQuery:()=>{nr(!1)},deleteQuery:()=>{nr(!1)},beginQuery:()=>{nr(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},_r={readBuffer:(t,e,n)=>{sr(t)&&e(n)},getVertexAttrib:(t,e,n,i)=>{const{webgl2:r,ext:o}=function(t,e){return{webgl2:sr(t),ext:t.getExtension(e)}}(t,yr);let s;switch(i){case 35069:s=!!r&&void 0;break;case 35070:s=r||o?void 0:0}return void 0!==s?s:e(n,i)},getProgramParameter:(t,e,n,i)=>{if(!sr(t))switch(i){case 35967:return 35981;case 35971:case 35382:return 0}return e(n,i)},getInternalformatParameter:(t,e,n,i,r)=>sr(t)||32937!==r?t.getInternalformatParameter(n,i,r):new Int32Array([0]),getTexParameter(t,e,n,i){if(34046===i){const{extensions:e}=t.luma,n=e.EXT_texture_filter_anisotropic;i=n&&n.TEXTURE_MAX_ANISOTROPY_EXT||34046}return e(n,i)},getParameter:function(t,e,n){const i=mr[n],r="function"==typeof i?i(t,e,n):i;return void 0!==r?r:e(n)},hint:(t,e,n,i)=>e(n,i)};function br(t,e){let{extension:n,target:i,target2:r}=e;const o=vr[n];nr(o);const{meta:s={}}=o,{suffix:a=""}=s,l=t.getExtension(n);for(const e of Object.keys(o)){const n="".concat(e).concat(a);let s=null;"meta"===e||"function"==typeof t[e]||(l&&"function"==typeof l[n]?s=function(){return l[n](...arguments)}:"function"==typeof o[e]&&(s=o[e].bind(i))),s&&(i[e]=s,r[e]=s)}}globalThis.polyfillContext=function(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(function(t){if("function"==typeof t.createVertexArray)return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const t=e.call(this)||[];return t.indexOf("OES_vertex_array_object")<0&&t.push("OES_vertex_array_object"),t};const n=t.getExtension;t.getExtension=function(e){return n.call(this,e)||("OES_vertex_array_object"!==e?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new hr(this)),this.__OESVertexArrayObject))}}(t),function(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}(t),function(t,e){for(const n of Object.getOwnPropertyNames(e))"overrides"!==n&&br(t,{extension:n,target:t.luma,target2:t})}(t,vr),function(t,e){let{target:n,target2:i}=e;Object.keys(_r).forEach((e=>{if("function"==typeof _r[e]){const r=t[e]?t[e].bind(t):()=>{},o=_r[e].bind(null,t,r);n[e]=o,i[e]=o}}))}(t,{target:e,target2:t}),e.polyfilled=!0),t};const xr={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},wr=(t,e,n)=>e?t.enable(n):t.disable(n),Er=(t,e,n)=>t.hint(n,e),Sr=(t,e,n)=>t.pixelStorei(n,e);function Pr(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Cr={3042:wr,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:wr,2885:(t,e)=>t.cullFace(e),2929:wr,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:wr,35723:Er,36006:(t,e)=>{const n=sr(t)?36009:36160;return t.bindFramebuffer(n,e)},2886:(t,e)=>t.frontFace(e),33170:Er,2849:(t,e)=>t.lineWidth(e),32823:wr,32824:"polygonOffset",10752:"polygonOffset",35977:wr,32938:"sampleCoverage",32939:"sampleCoverage",3089:wr,3088:(t,e)=>t.scissor(...e),2960:wr,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:Sr,3317:Sr,37440:Sr,37441:Sr,37443:Sr,3330:Sr,3332:Sr,3331:Sr,36010:(t,e)=>t.bindFramebuffer(36008,e),3314:Sr,32878:Sr,3316:Sr,3315:Sr,32877:Sr,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=Pr(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=Pr(e)&&2===e.length?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=Pr(e)?e:[e,e];const[n,i]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,i)},stencilFunc:(t,e)=>{e=Pr(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilFuncSeparate(1028,n,i,r),t.stencilFuncSeparate(1029,o,s,a)},stencilOp:(t,e)=>{e=Pr(e)&&3===e.length?[...e,...e]:e;const[n,i,r,o,s,a]=e;t.stencilOpSeparate(1028,n,i,r),t.stencilOpSeparate(1029,o,s,a)},viewport:(t,e)=>t.viewport(...e)};function Ir(t,e,n){return void 0!==e[t]?e[t]:n[t]}const Tr={blendEquation:(t,e,n)=>t.blendEquationSeparate(Ir(32777,e,n),Ir(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(Ir(32969,e,n),Ir(32968,e,n),Ir(32971,e,n),Ir(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(Ir(32824,e,n),Ir(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(Ir(32938,e,n),Ir(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,Ir(2962,e,n),Ir(2967,e,n),Ir(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,Ir(34816,e,n),Ir(36003,e,n),Ir(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,Ir(2964,e,n),Ir(2965,e,n),Ir(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,Ir(34817,e,n),Ir(34818,e,n),Ir(34819,e,n))},Mr={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,i,r)=>t({32773:new Float32Array([e,n,i,r])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,i,r)=>t({32969:e,32968:n,32971:i,32970:r}),clearColor:(t,e,n,i,r)=>t({3106:new Float32Array([e,n,i,r])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,i,r)=>t({3107:[e,n,i,r]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,i,r)=>t({3088:new Int32Array([e,n,i,r])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[1028===e?2968:36005]:n}),stencilFunc:(t,e,n,i)=>t({2962:e,2967:n,2963:i,34816:e,36003:n,36004:i}),stencilFuncSeparate:(t,e,n,i,r)=>t({[1028===e?2962:34816]:n,[1028===e?2967:36003]:i,[1028===e?2963:36004]:r}),stencilOp:(t,e,n,i)=>t({2964:e,2965:n,2966:i,34817:e,34818:n,34819:i}),stencilOpSeparate:(t,e,n,i,r)=>t({[1028===e?2964:34817]:n,[1028===e?2965:34818]:i,[1028===e?2966:34819]:r}),viewport:(t,e,n,i,r)=>t({2978:[e,n,i,r]})},Lr=(t,e)=>t.isEnabled(e),Ar={3042:Lr,2884:Lr,2929:Lr,3024:Lr,32823:Lr,32926:Lr,32928:Lr,3089:Lr,2960:Lr,35977:Lr};function Or(t){for(const e in t)return!1;return!0}function Nr(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),i=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&i&&t.length===e.length){for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}return!1}function Rr(t,e){const n=t[e].bind(t);t[e]=function(){const e=arguments.length<=0?void 0:arguments[0];return e in t.state.cache&&t.state.enable?t.state.cache[e]:n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function kr(t,e,n){const i=t[e].bind(t);t[e]=function(){for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];const{valueChanged:s,oldValue:a}=n(t.state._updateCache,...r);return s&&i(...r),a},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}class Dr{constructor(t){let{copyState:e=!1,log:n=(()=>{})}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.program=null,this.stateStack=[],this.enable=!0,this.cache=e?function(t,e){if("number"==typeof(e=e||xr)){const n=e,i=Ar[n];return i?i(t,n):t.getParameter(n)}const n=Array.isArray(e)?e:Object.keys(e),i={};for(const e of n){const n=Ar[e];i[e]=n?n(t,Number(e)):t.getParameter(Number(e))}return i}(t):Object.assign({},xr),this.log=n,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){nr(this.stateStack.length>0);const t=this.stateStack[this.stateStack.length-1];Br(this.gl,t),this.stateStack.pop()}_updateCache(t){let e,n=!1;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const r in t){nr(void 0!==r);const o=t[r],s=this.cache[r];Nr(o,s)||(n=!0,e=s,i&&!(r in i)&&(i[r]=s),this.cache[r]=o)}return{valueChanged:n,oldValue:e}}}function Fr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{enable:n=!0,copyState:i}=e;if(nr(void 0!==i),!t.state){const{polyfillContext:e}=globalThis;e&&e(t),t.state=new Dr(t,{copyState:i}),function(t){const e=t.useProgram.bind(t);t.useProgram=function(n){t.state.program!==n&&(e(n),t.state.program=n)}}(t);for(const e in Mr)kr(t,e,Mr[e]);Rr(t,"getParameter"),Rr(t,"isEnabled")}return t.state.enable=n,t}function zr(t){nr(t.state),t.state.pop()}function Br(t,e){if(nr(or(t),"setParameters requires a WebGL context"),Or(e))return;const n={};for(const i in e){const r=Number(i),o=Cr[i];o&&("string"==typeof o?n[o]=!0:o(t,e[i],r))}const i=t.state&&t.state.cache;if(i)for(const r in n)(0,Tr[r])(t,e,i)}function jr(t,e,n){if(Or(e))return n(t);const{nocatch:i=!0}=e;let r;if(function(t){t.state||Fr(t,{copyState:!1}),t.state.push()}(t),Br(t,e),i)r=n(t),zr(t);else try{r=n(t)}finally{zr(t)}return r}function Ur(t){const{luma:e}=t;if(t.canvas&&e){const{clientWidth:n}=e.canvasSizeInfo;return n?t.drawingBufferWidth/n:1}return 1}function Vr(t,e){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function(t,e,n,i,r){const o=Gr(t[0],e,n);let s=qr(t[1],e,i,r),a=Gr(t[0]+1,e,n);const l=a===n-1?a:a-1;let u;return a=qr(t[1]+1,e,i,r),r?(a=0===a?a:a+1,u=s,s=a):u=a===i-1?a:a-1,{x:o,y:s,width:Math.max(l-o+1,1),height:Math.max(u-s+1,1)}}(e,Ur(t),t.drawingBufferWidth,t.drawingBufferHeight,n)}function Gr(t,e,n){return Math.min(Math.round(t*e),n-1)}function qr(t,e,n,i){return i?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const Wr=At(),Hr=Wr&&"undefined"!=typeof document,Xr={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function Yr(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};nr(Wr,"createGLContext only available in the browser.\nCreate your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils"),t=Object.assign({},Xr,t);const{width:e,height:n}=t;function i(e){if(t.throwOnError)throw new Error(e);return console.error(e),null}let r;t.onError=i;const{canvas:o}=t,s=function(t){let e,{canvas:n,width:i=800,height:r=600,onError:o}=t;return"string"==typeof n?(Hr&&"complete"===document.readyState||o("createGLContext called on canvas '".concat(n,"' before page was loaded")),e=document.getElementById(n)):n?e=n:(e=document.createElement("canvas"),e.id="lumagl-canvas",e.style.width=Number.isFinite(i)?"".concat(i,"px"):"100%",e.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(e,document.body.firstChild)),e}({canvas:o,width:e,height:n,onError:i});return r=function(t,e){const{onError:n}=e;let i=null;const r=t=>i=t.statusMessage||i;t.addEventListener("webglcontextcreationerror",r,!1);const{webgl1:o=!0,webgl2:s=!0}=e;let a=null;return s&&(a=a||t.getContext("webgl2",e),a=a||t.getContext("experimental-webgl2",e)),o&&(a=a||t.getContext("webgl",e),a=a||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",r,!1),a?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),a):n("Failed to create ".concat(s&&!o?"WebGL2":"WebGL"," context: ").concat(i||"Unknown error"))}(s,t),r?(r=Zr(r,t),function(t){const e=sr(t)?"WebGL2":"WebGL1",n=function(t){const e=t.getParameter(7936),n=t.getParameter(7937),i=t.getExtension("WEBGL_debug_renderer_info");return{vendor:i&&t.getParameter(i.UNMASKED_VENDOR_WEBGL||7936)||e,renderer:i&&t.getParameter(i.UNMASKED_RENDERER_WEBGL||7937)||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}(t),i=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",r=t.debug?" debug":"";er.info(1,"".concat(e).concat(r," context ").concat(i))()}(r),r):null}function Zr(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||function(t){return"undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?2:1}(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},Xr,e);const{manageState:n,debug:i}=e;return n&&Fr(t,{copyState:!1,log:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return er.log(1,...e)()}}),Wr&&i&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),er.level=Math.max(er.level,1)):er.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}const Kr="8.5.18",$r=new class{constructor(){this.stats=new Map}get(t){return this.stats.has(t)||this.stats.set(t,new se({id:t})),this.stats.get(t)}};if(globalThis.luma&&globalThis.luma.VERSION!==Kr)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(Kr));function Qr(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function Jr(t,e){if("string"!=typeof e)return e;const n=Number(e);if(!isNaN(n))return n;const i=t[e=e.replace(/^.*\./,"")];return Qr(void 0!==i,"Accessing undefined constant GL.".concat(e)),i}function to(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}globalThis.luma||(At()&&er.log(1,"luma.gl ".concat(Kr," - ").concat("set luma.log.level=1 (or higher) to trace rendering"))(),globalThis.luma=globalThis.luma||{VERSION:Kr,version:Kr,log:er,stats:$r,globals:{modules:{},nodeIO:{}}}),globalThis.luma;const eo={};function no(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id";eo[t]=eo[t]||1;const e=eo[t]++;return"".concat(t,"-").concat(e)}function io(t){return Qr("number"==typeof t,"Input must be a number"),t&&0==(t&t-1)}function ro(t){let e=!0;for(const n in t){e=!1;break}return e}function oo(t,e,n,i){const r="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),o=Object.getPrototypeOf(t);i.forEach((t=>{o.methodName||(o[t]=()=>{throw er.removed("Calling removed method ".concat(e,".").concat(t,": "),r)(),new Error(t)})}))}const so="Resource subclass must define virtual methods";class ao{get[Symbol.toStringTag](){return"Resource"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ar(t);const{id:n,userData:i={}}=e;this.gl=t,this.gl2=t,this.id=n||no(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=e.handle,void 0===this._handle&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,e&&t&&e.filter(Boolean).forEach((t=>t.delete())),this}bind(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.handle;return"function"!=typeof e?(this._bindHandle(e),this):(this._bound?t=e():(this._bindHandle(this.handle),this._bound=!0,t=e(),this._bound=!1,this._bindHandle(null)),t)}unbind(){this.bind(null)}getParameter(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Qr(t=Jr(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=sr(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension)){const e=n.webgl1,i="webgl2"in n?n.webgl2:n.webgl1;return t?i:e}}return this._getParameter(t,e)}getParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{parameters:e,keys:n}=t,i=this.constructor.PARAMETERS||{},r=sr(this.gl),o={},s=e||Object.keys(i);for(const e of s){const s=i[e];if(s&&(!("webgl2"in s)||r)&&(!("extension"in s)||this.gl.getExtension(s.extension))){const i=n?to(this.gl,e):e;o[i]=this.getParameter(e,t),n&&"GLenum"===s.type&&(o[i]=to(this.gl,o[i]))}}return o}setParameter(t,e){Qr(t=Jr(this.gl,t));const n=(this.constructor.PARAMETERS||{})[t];if(n){const t=sr(this.gl);if("webgl2"in n&&!t||"extension"in n&&!this.gl.getExtension(n.extension))throw new Error("Parameter not available on this platform");"GLenum"===n.type&&(e=Jr(e))}return this._setParameter(t,e),this}setParameters(t){for(const e in t)this.setParameter(e,t[e]);return this}stubRemovedMethods(t,e,n){return oo(this,t,e,n)}initialize(t){}_createHandle(){throw new Error(so)}_deleteHandle(){throw new Error(so)}_bindHandle(t){throw new Error(so)}_getOptsFromHandle(){throw new Error(so)}_getParameter(t,e){throw new Error(so)}_setParameter(t,e){throw new Error(so)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const t=this[Symbol.toStringTag],e=$r.get("Resource Counts");e.get("Resources Created").incrementCount(),e.get("".concat(t,"s Created")).incrementCount(),e.get("".concat(t,"s Active")).incrementCount()}_removeStats(){const t=this[Symbol.toStringTag];$r.get("Resource Counts").get("".concat(t,"s Active")).decrementCount()}_trackAllocatedMemory(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(t,e),this._trackAllocatedMemoryForContext(t,e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=t}_trackAllocatedMemoryForContext(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this[Symbol.toStringTag],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const i=$r.get("Memory Usage".concat(n));i.get("GPU Memory").addCount(t),i.get("".concat(e," Memory")).addCount(t)}_trackDeallocatedMemory(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(t),this._trackDeallocatedMemoryForContext(t,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this[Symbol.toStringTag],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const n=$r.get("Memory Usage".concat(e));n.get("GPU Memory").subtractCount(this.byteLength),n.get("".concat(t," Memory")).subtractCount(this.byteLength)}}const lo="Failed to deduce GL constant from typed array";function uo(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(lo)}}function co(t){let{clamped:e=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function ho(t){let{data:e,width:n,height:i}=t;const r=Math.round(n/2),o=Math.round(i/2),s=new Uint8Array(r*o*4);for(let t=0;t<o;t++)for(let i=0;i<r;i++)for(let o=0;o<4;o++)s[4*(t*r+i)+o]=e[4*(2*t*n+2*i)+o];return{data:s,width:r,height:o}}function fo(t,e,n){const{removedProps:i={},deprecatedProps:r={},replacedProps:o={}}=n;for(const n in i)if(n in e){const e=i[n]?"".concat(t,".").concat(i[n]):"N/A";er.removed("".concat(t,".").concat(n),e)()}for(const n in r)if(n in e){const e=r[n];er.deprecated("".concat(t,".").concat(n),"".concat(t,".").concat(e))()}let s=null;for(const n in o)if(n in e){const i=o[n];er.deprecated("".concat(t,".").concat(n),"".concat(t,".").concat(i))(),s=s||Object.assign({},e),s[i]=e[n],delete s[n]}return s||e}const po={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},go={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class mo{static getBytesPerElement(t){return co(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return Qr(t.size),co(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new mo(...[po,...e])}constructor(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e.forEach((t=>this._assign(t))),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return mo.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return mo.getBytesPerVertex(this)}_assign(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=fo("Accessor",t,go),void 0!==t.type&&(this.type=t.type,5124!==t.type&&5125!==t.type||(this.integer=!0)),void 0!==t.size&&(this.size=t.size),void 0!==t.offset&&(this.offset=t.offset),void 0!==t.stride&&(this.stride=t.stride),void 0!==t.normalized&&(this.normalized=t.normalized),void 0!==t.integer&&(this.integer=t.integer),void 0!==t.divisor&&(this.divisor=t.divisor),void 0!==t.buffer&&(this.buffer=t.buffer),void 0!==t.index&&("boolean"==typeof t.index?this.index=t.index?1:0:this.index=t.index),void 0!==t.instanced&&(this.divisor=t.instanced?1:0),void 0!==t.isInstanced&&(this.divisor=t.isInstanced?1:0),this}}const yo={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},vo={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:yo},_o={removedProps:yo};class bo extends ao{get[Symbol.toStringTag](){return"Buffer"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=e.target||(this.gl.webgl2?36662:34962),this.initialize(e),Object.seal(this)}getElementCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/mo.getBytesPerElement(t))}getVertexCount(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.accessor;return Math.round(this.byteLength/mo.getBytesPerVertex(t))}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return ArrayBuffer.isView(t)&&(t={data:t}),Number.isFinite(t)&&(t={byteLength:t}),t=fo("Buffer",t,vo),this.usage=t.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},t,t.accessor)),t.data?this._setData(t.data,t.offset,t.byteLength):this._setByteLength(t.byteLength||0),this}setProps(t){return"accessor"in(t=fo("Buffer",t,_o))&&this.setAccessor(t.accessor),this}setAccessor(t){return delete(t=Object.assign({},t)).buffer,this.accessor=new mo(t),this}reallocate(t){return t>this.byteLength?(this._setByteLength(t),!0):(this.bytesUsed=t,!1)}setData(t){return this.initialize(t)}subData(t){ArrayBuffer.isView(t)&&(t={data:t});const{data:e,offset:n=0,srcOffset:i=0}=t,r=t.byteLength||t.length;Qr(e);const o=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(o,this.handle),0!==i||void 0!==r?(lr(this.gl),this.gl.bufferSubData(this.target,n,e,i,r)):this.gl.bufferSubData(o,n,e),this.gl.bindBuffer(o,null),this.debugData=null,this._inferType(e),this}copyData(t){let{sourceBuffer:e,readOffset:n=0,writeOffset:i=0,size:r}=t;const{gl:o}=this;return lr(o),o.bindBuffer(36662,e.handle),o.bindBuffer(36663,this.handle),o.copyBufferSubData(36662,36663,n,i,r),o.bindBuffer(36662,null),o.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:t=null,srcByteOffset:e=0,dstOffset:n=0,length:i=0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};lr(this.gl);const r=co(this.accessor.type||5126,{clamped:!1}),o=this._getAvailableElementCount(e),s=n;let a,l;t?(l=t.length,a=l-s):(a=Math.min(o,i||o),l=s+a);const u=Math.min(o,a);return i=i||u,Qr(i<=u),t=t||new r(l),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,e,t,n,i),this.gl.bindBuffer(36662,null),t}bind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index,offset:n=0,size:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?void 0!==i?this.gl.bindBufferRange(t,e,this.handle,n,i):(Qr(0===n),this.gl.bindBufferBase(t,e,this.handle)):this.gl.bindBuffer(t,this.handle),this}unbind(){let{target:t=this.target,index:e=this.accessor&&this.accessor.index}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 35345===t||35982===t?this.gl.bindBufferBase(t,e,null):this.gl.bindBuffer(t,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(10,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.byteLength+e;Qr(ArrayBuffer.isView(t)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,this.usage),this.gl.bufferSubData(i,e,t),this.gl.bindBuffer(i,null),this.debugData=t.slice(0,10),this.bytesUsed=n,this._trackAllocatedMemory(n);const r=uo(t);return Qr(r),this.setAccessor(new mo(this.accessor,{type:r})),this}_setByteLength(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.usage;Qr(t>=0),this._trackDeallocatedMemory();let n=t;0===t&&(n=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,n,e),this.gl.bindBuffer(i,null),this.usage=e,this.debugData=null,this.bytesUsed=t,this._trackAllocatedMemory(t),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(t){const e=t/co(this.accessor.type||5126,{clamped:!1}).BYTES_PER_ELEMENT;return this.getElementCount()-e}_inferType(t){this.accessor.type||this.setAccessor(new mo(this.accessor,{type:uo(t)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(t){this.gl.bindBuffer(this.target,this.handle);const e=this.gl.getBufferParameter(this.target,t);return this.gl.bindBuffer(this.target,null),e}get type(){return er.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return er.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(t){return er.deprecated("setByteLength","reallocate")(),this.reallocate(t)}updateAccessor(t){return er.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new mo(this.accessor,t),this}}const xo={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},wo={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},Eo={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1},So=[9729,9728],Po=globalThis.WebGLBuffer||function(){};class Co extends ao{get[Symbol.toStringTag](){return"Texture"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{format:n,linearFiltering:i}=e;let r=!0;return n&&(r=r&&function(t,e){const n=xo[e];if(!n)return!1;if(void 0===n.gl1&&void 0===n.gl2)return!0;const i=sr(t)&&n.gl2||n.gl1;return"string"==typeof i?t.getExtension(i):i}(t,n),r=r&&(!i||function(t,e){const n=xo[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}(t,n))),r}constructor(t,e){const{id:n=no("texture"),handle:i,target:r}=e;super(t,{id:n,handle:i}),this.target=r,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.data;if(e instanceof Promise)return e.then((e=>this.initialize(Object.assign({},t,{pixels:e,data:e})))),this;const n="undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement;if(n&&e.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,e.addEventListener("loadeddata",(()=>this.initialize(t))),this;const{pixels:i=null,format:r=6408,border:o=0,recreate:s=!1,parameters:a={},pixelStore:l={},textureUnit:u}=t;e||(e=i);let{width:c,height:h,dataFormat:f,type:d,compressed:p=!1,mipmaps:g=!0}=t;const{depth:m=0}=t;return({width:c,height:h,compressed:p,dataFormat:f,type:d}=this._deduceParameters({format:r,type:d,dataFormat:f,compressed:p,data:e,width:c,height:h})),this.width=c,this.height=h,this.depth=m,this.format=r,this.type=d,this.dataFormat=f,this.border=o,this.textureUnit=u,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),g&&this._isNPOT()&&(er.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),g=!1,this._updateForNPOT(a)),this.mipmaps=g,this.setImageData({data:e,width:c,height:h,depth:m,format:r,type:d,dataFormat:f,border:o,mipmaps:g,parameters:l,compressed:p}),g&&this.generateMipmap(),this.setParameters(a),s&&(this.data=e),n&&(this._video={video:e,parameters:a,lastTime:e.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?e.currentTime:-1}),this}update(){if(this._video){const{video:t,parameters:e,lastTime:n}=this._video;if(n===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:e}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}resize(t){let{height:e,width:n,mipmaps:i=!1}=t;return n!==this.width||e!==this.height?this.initialize({width:n,height:e,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isNPOT()?(er.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),jr(this.gl,t,(()=>{this.gl.generateMipmap(this.target)})),this.gl.bindTexture(this.target,null),this)}setImageData(t){this._trackDeallocatedMemory("Texture");const{target:e=this.target,pixels:n=null,level:i=0,format:r=this.format,border:o=this.border,offset:s=0,parameters:a={}}=t;let{data:l=null,type:u=this.type,width:c=this.width,height:h=this.height,dataFormat:f=this.dataFormat,compressed:d=!1}=t;l||(l=n),({type:u,dataFormat:f,compressed:d,width:c,height:h}=this._deduceParameters({format:r,type:u,dataFormat:f,compressed:d,data:l,width:c,height:h}));const{gl:p}=this;p.bindTexture(this.target,this.handle);let g,m=null;({data:l,dataType:m}=this._getDataType({data:l,compressed:d}));let y=0;if(jr(this.gl,a,(()=>{switch(m){case"null":p.texImage2D(e,i,r,c,h,o,f,u,l);break;case"typed-array":p.texImage2D(e,i,r,c,h,o,f,u,l,s);break;case"buffer":g=lr(p),g.bindBuffer(35052,l.handle||l),g.texImage2D(e,i,r,c,h,o,f,u,s),g.bindBuffer(35052,null);break;case"browser-object":sr(p)?p.texImage2D(e,i,r,c,h,o,f,u,l):p.texImage2D(e,i,r,f,u,l);break;case"compressed":for(const[t,n]of l.entries())p.compressedTexImage2D(e,t,n.format,n.width,n.height,o,n.data),y+=n.levelSize;break;default:Qr(!1,"Unknown image data type")}})),"compressed"===m)this._trackAllocatedMemory(y,"Texture");else if(l&&l.byteLength)this._trackAllocatedMemory(l.byteLength,"Texture");else{const t=wo[this.dataFormat]||4,e=Eo[this.type]||1;this._trackAllocatedMemory(this.width*this.height*t*e,"Texture")}return this.loaded=!0,this}setSubImageData(t){let{target:e=this.target,pixels:n=null,data:i=null,x:r=0,y:o=0,width:s=this.width,height:a=this.height,level:l=0,format:u=this.format,type:c=this.type,dataFormat:h=this.dataFormat,compressed:f=!1,offset:d=0,border:p=this.border,parameters:g={}}=t;if(({type:c,dataFormat:h,compressed:f,width:s,height:a}=this._deduceParameters({format:u,type:c,dataFormat:h,compressed:f,data:i,width:s,height:a})),Qr(0===this.depth,"texSubImage not supported for 3D textures"),i||(i=n),i&&i.data){const t=i;i=t.data,s=t.shape[0],a=t.shape[1]}i instanceof bo&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),jr(this.gl,g,(()=>{if(f)this.gl.compressedTexSubImage2D(e,l,r,o,s,a,u,i);else if(null===i)this.gl.texSubImage2D(e,l,r,o,s,a,h,c,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(e,l,r,o,s,a,h,c,i,d);else if(i instanceof Po){const t=lr(this.gl);t.bindBuffer(35052,i),t.texSubImage2D(e,l,r,o,s,a,h,c,d),t.bindBuffer(35052,null)}else sr(this.gl)?lr(this.gl).texSubImage2D(e,l,r,o,s,a,h,c,i):this.gl.texSubImage2D(e,l,r,o,h,c,i)})),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return er.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,this.handle),t}unbind(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.textureUnit;const{gl:e}=this;return void 0!==t&&(this.textureUnit=t,e.activeTexture(33984+t)),e.bindTexture(this.target,null),t}_getDataType(t){let{data:e,compressed:n=!1}=t;return n?{data:e,dataType:"compressed"}:null===e?{data:e,dataType:"null"}:ArrayBuffer.isView(e)?{data:e,dataType:"typed-array"}:e instanceof bo?{data:e.handle,dataType:"buffer"}:e instanceof Po?{data:e,dataType:"buffer"}:{data:e,dataType:"browser-object"}}_deduceParameters(t){const{format:e,data:n}=t;let{width:i,height:r,dataFormat:o,type:s,compressed:a}=t;const l=xo[e];return o=o||l&&l.dataFormat,s=s||l&&l.types[0],a=a||l&&l.compressed,({width:i,height:r}=this._deduceImageSize(n,i,r)),{dataFormat:o,type:s,compressed:a,width:i,height:r,format:e,data:n}}_deduceImageSize(t,e,n){let i;return i="undefined"!=typeof ImageData&&t instanceof ImageData?{width:t.width,height:t.height}:"undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement?{width:t.naturalWidth,height:t.naturalHeight}:"undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?{width:t.width,height:t.height}:"undefined"!=typeof HTMLVideoElement&&t instanceof HTMLVideoElement?{width:t.videoWidth,height:t.videoHeight}:t?{width:e,height:n}:{width:e>=0?e:1,height:n>=0?n:1},Qr(i,"Could not deduced texture size"),Qr(void 0===e||i.width===e,"Deduced texture width does not match supplied width"),Qr(void 0===n||i.height===n,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(t){switch(t){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const e=this.gl.getTexParameter(this.target,t);return this.gl.bindTexture(this.target,null),e}}_setParameter(t,e){switch(this.gl.bindTexture(this.target,this.handle),e=this._getNPOTParam(t,e),t){case 33082:case 33083:this.gl.texParameterf(this.handle,t,e);break;case 4096:case 4097:Qr(!1);break;default:this.gl.texParameteri(this.target,t,e)}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return!(sr(this.gl)||!this.width||!this.height||io(this.width)&&io(this.height))}_updateForNPOT(t){void 0===t[this.gl.TEXTURE_MIN_FILTER]&&(t[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),void 0===t[this.gl.TEXTURE_WRAP_S]&&(t[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),void 0===t[this.gl.TEXTURE_WRAP_T]&&(t[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(t,e){if(this._isNPOT())switch(t){case 10241:-1===So.indexOf(e)&&(e=9729);break;case 10242:case 10243:33071!==e&&(e=33071)}return e}}class Io extends Co{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(t,e){return Co.isSupported(t,e)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;ar(t),(e instanceof Promise||"string"==typeof e)&&(e={data:e}),"string"==typeof e.data&&(e=Object.assign({},e,{data:(n=e.data,Qr("string"==typeof n),n=""+n,new Promise(((t,e)=>{try{const i=new Image;i.onload=()=>t(i),i.onerror=()=>e(new Error("Could not load image ".concat(n,"."))),i.crossOrigin="anonymous",i.src=n}catch(t){e(t)}})))})),super(t,Object.assign({},e,{target:3553})),this.initialize(e),Object.seal(this)}}const To="EXT_color_buffer_float",Mo={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:To,bpp:2},33327:{gl2:To,bpp:4},34842:{gl2:To,bpp:8},33326:{gl2:To,bpp:4},33328:{gl2:To,bpp:8},34836:{gl2:To,bpp:16},35898:{gl2:To,bpp:4}};class Lo extends ao{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(t){let{format:e}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{format:null};return!e||function(t,e,n){const i=n[e];if(!i)return!1;const r=sr(t)&&i.gl2||i.gl1;return"string"==typeof r?t.getExtension(r):r}(t,e,Mo)}static getSamplesForFormat(t,e){let{format:n}=e;return t.getInternalformatParameter(36161,n,32937)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.initialize(e),Object.seal(this)}initialize(t){let{format:e,width:n=1,height:i=1,samples:r=0}=t;return Qr(e,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),0!==r&&sr(this.gl)?this.gl.renderbufferStorageMultisample(36161,r,e,n,i):this.gl.renderbufferStorage(36161,e,n,i),this.format=e,this.width=n,this.height=i,this.samples=r,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*Mo[this.format].bpp),this}resize(t){let{width:e,height:n}=t;return e!==this.width||n!==this.height?this.initialize({width:e,height:n,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(t){this.gl.bindRenderbuffer(36161,t)}_syncHandle(t){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(t){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,t)}}const Ao=256,Oo=1024,No=16384,Ro=6144,ko=6145,Do=6146,Fo=34041,zo="clear: bad arguments";function Bo(t){let{framebuffer:e=null,color:n=null,depth:i=null,stencil:r=null}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const o={};e&&(o.framebuffer=e);let s=0;n&&(s|=No,!0!==n&&(o.clearColor=n)),i&&(s|=Ao,!0!==i&&(o.clearDepth=i)),r&&(s|=Oo,!0!==i&&(o.clearStencil=i)),Qr(0!==s,zo),jr(t,o,(()=>{t.clear(s)}))}const jo=[34069,34070,34071,34072,34073,34074];class Uo extends Co{get[Symbol.toStringTag](){return"TextureCube"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ar(t),super(t,Object.assign({},e,{target:34067})),this.initialize(e),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{mipmaps:e=!0,parameters:n={}}=t;return this.opts=t,this.setCubeMapImageData(t).then((()=>{this.loaded=!0,e&&this.generateMipmap(t),this.setParameters(n)})),this}subImage(t){let{face:e,data:n,x:i=0,y:r=0,mipmapLevel:o=0}=t;return this._subImage({target:e,data:n,x:i,y:r,mipmapLevel:o})}async setCubeMapImageData(t){let{width:e,height:n,pixels:i,data:r,border:o=0,format:s=6408,type:a=5121}=t;const{gl:l}=this,u=i||r,c=await Promise.all(jo.map((t=>{const e=u[t];return Promise.all(Array.isArray(e)?e:[e])})));this.bind(),jo.forEach(((t,i)=>{c[i].length>1&&!1!==this.opts.mipmaps&&er.warn("".concat(this.id," has mipmap and multiple LODs."))(),c[i].forEach(((i,r)=>{e&&n?l.texImage2D(t,r,s,e,n,o,s,a,i):l.texImage2D(t,r,s,s,a,i)}))})),this.unbind()}setImageDataForFace(t){const{face:e,width:n,height:i,pixels:r,data:o,border:s=0,format:a=6408,type:l=5121}=t,{gl:u}=this,c=r||o;return this.bind(),c instanceof Promise?c.then((n=>this.setImageDataForFace(Object.assign({},t,{face:e,data:n,pixels:n})))):this.width||this.height?u.texImage2D(e,0,a,n,i,s,a,l,c):u.texImage2D(e,0,a,a,l,c),this}}Uo.FACES=jo;class Vo extends Co{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(t){return sr(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};lr(t),e=Object.assign({depth:1},e,{target:32879,unpackFlipY:!1}),super(t,e),this.initialize(e),Object.seal(this)}setImageData(t){let{level:e=0,dataFormat:n=6408,width:i,height:r,depth:o=1,border:s=0,format:a,type:l=5121,offset:u=0,data:c,parameters:h={}}=t;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),jr(this.gl,h,(()=>{ArrayBuffer.isView(c)&&this.gl.texImage3D(this.target,e,n,i,r,o,s,a,l,c),c instanceof bo&&(this.gl.bindBuffer(35052,c.handle),this.gl.texImage3D(this.target,e,n,i,r,o,s,a,l,u))})),c&&c.byteLength)this._trackAllocatedMemory(c.byteLength,"Texture");else{const t=wo[this.dataFormat]||4,e=Eo[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*t*e,"Texture")}return this.loaded=!0,this}}function Go(t,e){const{gl:n,width:i,height:r,id:o}=t;return new ts(n,Object.assign({},e,{id:"framebuffer-for-".concat(o),width:i,height:r,attachments:{36064:t}}))}function qo(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{sourceX:n=0,sourceY:i=0,sourceFormat:r=6408}=e;let{sourceAttachment:o=36064,target:s=null,sourceWidth:a,sourceHeight:l,sourceType:u}=e;const{framebuffer:c,deleteFramebuffer:h}=Ho(t);Qr(c);const{gl:f,handle:d,attachments:p}=c;a=a||c.width,l=l||c.height,36064===o&&null===d&&(o=1028),Qr(p[o]),u=u||p[o].type,s=function(t,e,n,i,r){if(t)return t;const o=co(e=e||5121,{clamped:!1}),s=function(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Qr(!1),0}}(n);return new o(i*r*s)}(s,u,r,a,l),u=u||uo(s);const g=f.bindFramebuffer(36160,d);return f.readPixels(n,i,a,l,r,u,s),f.bindFramebuffer(36160,g||null),h&&c.delete(),s}function Wo(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=qo(t,{sourceAttachment:e}),{width:r,height:o}=t;for(;o>n;)({data:i,width:r,height:o}=ho({data:i,width:r,height:o}));!function(t){let{data:e,width:n,height:i,bytesPerPixel:r=4,temp:o}=t;const s=n*r;o=o||new Uint8Array(s);for(let t=0;t<i/2;++t){const n=t*s,r=(i-t-1)*s;o.set(e.subarray(n,n+s)),e.copyWithin(n,r,r+s),e.set(o,r)}}({data:i,width:r,height:o});const s=document.createElement("canvas");s.width=r,s.height=o;const a=s.getContext("2d"),l=a.createImageData(r,o);return l.data.set(i),a.putImageData(l,0,0),s.toDataURL()}function Ho(t){return t instanceof ts?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:Go(t),deleteFramebuffer:!0}}const Xo="TIMER_QUERY",Yo="ELEMENT_INDEX_UINT32",Zo={WEBGL2:[!1,!0],VERTEX_ARRAY_OBJECT:["OES_vertex_array_object",!0],[Xo]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],INSTANCED_RENDERING:["ANGLE_instanced_arrays",!0],MULTIPLE_RENDER_TARGETS:["WEBGL_draw_buffers",!0],[Yo]:["OES_element_index_uint",!0],BLEND_EQUATION_MINMAX:["EXT_blend_minmax",!0],FLOAT_BLEND:["EXT_float_blend"],COLOR_ENCODING_SRGB:["EXT_sRGB",!0],TEXTURE_DEPTH:["WEBGL_depth_texture",!0],TEXTURE_FLOAT:["OES_texture_float",!0],TEXTURE_HALF_FLOAT:["OES_texture_half_float",!0],TEXTURE_FILTER_LINEAR_FLOAT:["OES_texture_float_linear"],TEXTURE_FILTER_LINEAR_HALF_FLOAT:["OES_texture_half_float_linear"],TEXTURE_FILTER_ANISOTROPIC:["EXT_texture_filter_anisotropic"],COLOR_ATTACHMENT_RGBA32F:[function(t){const e=new Io(t,{format:6408,type:5126,dataFormat:6408}),n=new ts(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),i=n.getStatus();return e.delete(),n.delete(),36053===i},"EXT_color_buffer_float"],COLOR_ATTACHMENT_FLOAT:[!1,"EXT_color_buffer_float"],COLOR_ATTACHMENT_HALF_FLOAT:["EXT_color_buffer_half_float"],GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},Ko=2;function $o(t,e){return(e=Array.isArray(e)?e:[e]).every((e=>Qo(t,e)))}function Qo(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},void 0===t.luma.caps[e]&&(t.luma.caps[e]=function(t,e){const n=Zo[e];let i;Qr(n,e);const r=sr(t)&&n[1]||n[0];if("function"==typeof r)i=r(t);else if(Array.isArray(r)){i=!0;for(const e of r)i=i&&Boolean(t.getExtension(e))}else"string"==typeof r?i=Boolean(t.getExtension(r)):"boolean"==typeof r?i=r:Qr(!1);return i}(t,e)),t.luma.caps[e]||er.log(Ko,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}const Jo="Multiple render targets not supported";class ts extends ao{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{colorBufferFloat:n,colorBufferHalfFloat:i}=e;let r=!0;return n&&(r=Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("WEBGL_color_buffer_float")||t.getExtension("OES_texture_float"))),i&&(r=r&&Boolean(t.getExtension("EXT_color_buffer_float")||t.getExtension("EXT_color_buffer_half_float"))),r}static getDefaultFramebuffer(t){return t.luma=t.luma||{},t.luma.defaultFramebuffer=t.luma.defaultFramebuffer||new ts(t,{id:"default-framebuffer",handle:null,attachments:{}}),t.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const t=lr(this.gl);return t.getParameter(t.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const t=lr(this.gl);return t.getParameter(t.MAX_DRAW_BUFFERS)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(e),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(t){let{width:e=1,height:n=1,attachments:i=null,color:r=!0,depth:o=!0,stencil:s=!1,check:a=!0,readBuffer:l,drawBuffers:u}=t;if(Qr(e>=0&&n>=0,"Width and height need to be integers"),this.width=e,this.height=n,i)for(const t in i){const r=i[t];(Array.isArray(r)?r[0]:r).resize({width:e,height:n})}else i=this._createDefaultAttachments(r,o,s,e,n);this.update({clearAttachments:!0,attachments:i,readBuffer:l,drawBuffers:u}),i&&a&&this.checkStatus()}delete(){for(const t of this.ownResources)t.delete();return super.delete(),this}update(t){let{attachments:e={},readBuffer:n,drawBuffers:i,clearAttachments:r=!1,resizeAttachments:o=!0}=t;this.attach(e,{clearAttachments:r,resizeAttachments:o});const{gl:s}=this,a=s.bindFramebuffer(36160,this.handle);return n&&this._setReadBuffer(n),i&&this._setDrawBuffers(i),s.bindFramebuffer(36160,a||null),this}resize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:e,height:n}=t;if(null===this.handle)return Qr(void 0===e&&void 0===n),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;void 0===e&&(e=this.gl.drawingBufferWidth),void 0===n&&(n=this.gl.drawingBufferHeight),e!==this.width&&n!==this.height&&er.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(e,"x").concat(n))();for(const t in this.attachments)this.attachments[t].resize({width:e,height:n});return this.width=e,this.height=n,this}attach(t){let{clearAttachments:e=!1,resizeAttachments:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i={};e&&Object.keys(this.attachments).forEach((t=>{i[t]=null})),Object.assign(i,t);const r=this.gl.bindFramebuffer(36160,this.handle);for(const t in i){Qr(void 0!==t,"Misspelled framebuffer binding point?");const e=Number(t),r=i[e];let o=r;if(o)if(o instanceof Lo)this._attachRenderbuffer({attachment:e,renderbuffer:o});else if(Array.isArray(r)){const[t,n=0,i=0]=r;o=t,this._attachTexture({attachment:e,texture:t,layer:n,level:i})}else this._attachTexture({attachment:e,texture:o,layer:0,level:0});else this._unattach(e);n&&o&&o.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,r||null),Object.assign(this.attachments,t),Object.keys(this.attachments).filter((t=>!this.attachments[t])).forEach((t=>{delete this.attachments[t]}))}checkStatus(){const{gl:t}=this,e=this.getStatus();if(36053!==e)throw new Error(function(t){return(ts.STATUS||{})[t]||"Framebuffer error ".concat(t)}(e));return this}getStatus(){const{gl:t}=this,e=t.bindFramebuffer(36160,this.handle),n=t.checkFramebufferStatus(36160);return t.bindFramebuffer(36160,e||null),n}clear(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{color:e,depth:n,stencil:i,drawBuffers:r=[]}=t,o=this.gl.bindFramebuffer(36160,this.handle);return(e||n||i)&&Bo(this.gl,{color:e,depth:n,stencil:i}),r.forEach(((t,e)=>{!function(t){let{framebuffer:e=null,buffer:n=Ro,drawBuffer:i=0,value:r=[0,0,0,0]}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};lr(t),jr(t,{framebuffer:e},(()=>{switch(n){case Ro:switch(r.constructor){case Int32Array:t.clearBufferiv(n,i,r);break;case Uint32Array:t.clearBufferuiv(n,i,r);break;case Float32Array:default:t.clearBufferfv(n,i,r)}break;case ko:t.clearBufferfv(ko,0,[r]);break;case Do:t.clearBufferiv(Do,0,[r]);break;case Fo:const[e,o]=r;t.clearBufferfi(Fo,0,e,o);break;default:Qr(!1,zo)}}))}(this.gl,{drawBuffer:e,value:t})})),this.gl.bindFramebuffer(36160,o||null),this}readPixels(){return er.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return er.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return er.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return er.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return er.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return er.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(t){let{attachments:e=[],x:n=0,y:i=0,width:r,height:o}=t;const s=lr(this.gl),a=s.bindFramebuffer(36008,this.handle);return 0===n&&0===i&&void 0===r&&void 0===o?s.invalidateFramebuffer(36008,e):s.invalidateFramebuffer(36008,e,n,i,r,o),s.bindFramebuffer(36008,a),this}getAttachmentParameter(t,e,n){let i=this._getAttachmentParameterFallback(e);return null===i&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,t,e),this.gl.bindFramebuffer(36160,null)),n&&i>1e3&&(i=to(this.gl,i)),i}getAttachmentParameters(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:36064,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const r of n)i[e?to(this.gl,r):r]=this.getAttachmentParameter(t,r,e);return i}getParameters(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const e=Object.keys(this.attachments),n={};for(const i of e){const e=Number(i);n[t?to(this.gl,e):e]=this.getAttachmentParameters(e,t)}return n}show(){return"undefined"!=typeof window&&window.open(Wo(this),"luma-debug-texture"),this}log(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(t>er.level||"undefined"==typeof window)return this;e=e||"Framebuffer ".concat(this.id);const n=Wo(this,{targetMaxHeight:100});return er.image({logLevel:t,message:e,image:n},e)(),this}bind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,this.handle),this}unbind(){let{target:t=36160}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.gl.bindFramebuffer(t,null),this}_createDefaultAttachments(t,e,n,i,r){let o=null;return t&&(o=o||{},o[36064]=new Io(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:r,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(o[36064])),e&&n?(o=o||{},o[33306]=new Lo(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(o[33306])):e?(o=o||{},o[36096]=new Lo(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:r}),this.ownResources.push(o[36096])):n&&Qr(!1),o}_unattach(t){const e=this.attachments[t];e&&(e instanceof Lo?this.gl.framebufferRenderbuffer(36160,t,36161,null):this.gl.framebufferTexture2D(36160,t,3553,null,0),delete this.attachments[t])}_attachRenderbuffer(t){let{attachment:e=36064,renderbuffer:n}=t;const{gl:i}=this;i.framebufferRenderbuffer(36160,e,36161,n.handle),this.attachments[e]=n}_attachTexture(t){let{attachment:e=36064,texture:n,layer:i,level:r}=t;const{gl:o}=this;switch(o.bindTexture(n.target,n.handle),n.target){case 35866:case 32879:lr(o).framebufferTextureLayer(36160,e,n.target,r,i);break;case 34067:const t=function(t){return t<34069?t+34069:t}(i);o.framebufferTexture2D(36160,e,t,n.handle,r);break;case 3553:o.framebufferTexture2D(36160,e,3553,n.handle,r);break;default:Qr(!1,"Illegal texture type")}o.bindTexture(n.target,null),this.attachments[e]=n}_setReadBuffer(t){const e=sr(n=this.gl)?n:null;var n;e?e.readBuffer(t):Qr(36064===t||1029===t,Jo),this.readBuffer=t}_setDrawBuffers(t){const{gl:e}=this,n=lr(e);if(n)n.drawBuffers(t);else{const n=e.getExtension("WEBGL_draw_buffers");n?n.drawBuffersWEBGL(t):Qr(1===t.length&&(36064===t[0]||1029===t[0]),Jo)}this.drawBuffers=t}_getAttachmentParameterFallback(t){const e=function(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Zo)void 0===t.luma.caps[e]&&(t.luma.caps[e]=Qo(t,e));return t.luma.caps}(this.gl);switch(t){case 36052:return e.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return e.WEBGL2?null:8;case 33297:return e.WEBGL2?null:5125;case 33296:return e.WEBGL2||e.EXT_sRGB?null:9729;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(t){return this.gl.bindFramebuffer(36160,t)}}ts.ATTACHMENT_PARAMETERS=[36049,36048,33296,33298,33299,33300,33301,33302,33303];const es={5126:gs.bind(null,"uniform1fv",as,1,ms),35664:gs.bind(null,"uniform2fv",as,2,ms),35665:gs.bind(null,"uniform3fv",as,3,ms),35666:gs.bind(null,"uniform4fv",as,4,ms),5124:gs.bind(null,"uniform1iv",ls,1,ms),35667:gs.bind(null,"uniform2iv",ls,2,ms),35668:gs.bind(null,"uniform3iv",ls,3,ms),35669:gs.bind(null,"uniform4iv",ls,4,ms),35670:gs.bind(null,"uniform1iv",ls,1,ms),35671:gs.bind(null,"uniform2iv",ls,2,ms),35672:gs.bind(null,"uniform3iv",ls,3,ms),35673:gs.bind(null,"uniform4iv",ls,4,ms),35674:gs.bind(null,"uniformMatrix2fv",as,4,ys),35675:gs.bind(null,"uniformMatrix3fv",as,9,ys),35676:gs.bind(null,"uniformMatrix4fv",as,16,ys),35678:ps,35680:ps,5125:gs.bind(null,"uniform1uiv",us,1,ms),36294:gs.bind(null,"uniform2uiv",us,2,ms),36295:gs.bind(null,"uniform3uiv",us,3,ms),36296:gs.bind(null,"uniform4uiv",us,4,ms),35685:gs.bind(null,"uniformMatrix2x3fv",as,6,ys),35686:gs.bind(null,"uniformMatrix2x4fv",as,8,ys),35687:gs.bind(null,"uniformMatrix3x2fv",as,6,ys),35688:gs.bind(null,"uniformMatrix3x4fv",as,12,ys),35689:gs.bind(null,"uniformMatrix4x2fv",as,8,ys),35690:gs.bind(null,"uniformMatrix4x3fv",as,12,ys),35678:ps,35680:ps,35679:ps,35682:ps,36289:ps,36292:ps,36293:ps,36298:ps,36299:ps,36300:ps,36303:ps,36306:ps,36307:ps,36308:ps,36311:ps},ns={},is={},rs={},os=[0];function ss(t,e,n,i){1===e&&"boolean"==typeof t&&(t=t?1:0),Number.isFinite(t)&&(os[0]=t,t=os);const r=t.length;if(r%e&&er.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let o=i[r];o||(o=new n(r),i[r]=o);for(let e=0;e<r;e++)o[e]=t[e];return o}function as(t,e){return ss(t,e,Float32Array,ns)}function ls(t,e){return ss(t,e,Int32Array,is)}function us(t,e){return ss(t,e,Uint32Array,rs)}function cs(t,e,n){const i=es[n.type];if(!i)throw new Error("Unknown GLSL uniform type ".concat(n.type));return i().bind(null,t,e)}function hs(t){if("]"!==t[t.length-1])return{name:t,length:1,isArray:!1};const e=t.match(/([^[]*)(\[[0-9]+\])?/);if(!e||e.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:e[1],length:e[2]||1,isArray:Boolean(e[2])}}function fs(t){return Array.isArray(t)||ArrayBuffer.isView(t)?function(t){if(0===t.length)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t):!!isFinite(t)||!0===t||!1===t||t instanceof Co||t instanceof Lo||t instanceof ts&&Boolean(t.texture)}function ds(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const i=t[e];for(let t=0,e=n.length;t<e;++t)i[t]=n[t]}else t[e]=n.slice();else t[e]=n}function ps(){let t=null;return(e,n,i)=>{const r=t!==i;return r&&(e.uniform1i(n,i),t=i),r}}function gs(t,e,n,i){let r=null,o=null;return(s,a,l)=>{const u=e(l,n),c=u.length;let h=!1;if(null===r)r=new Float32Array(c),o=c,h=!0;else{Qr(o===c,"Uniform length cannot change.");for(let t=0;t<c;++t)if(u[t]!==r[t]){h=!0;break}}return h&&(i(s,t,a,u),r.set(u)),h}}function ms(t,e,n,i){t[e](n,i)}function ys(t,e,n,i){t[e](n,!1,i)}function vs(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unnamed";const n=t.match(/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/);return n?n[1]:e}const _s=35632,bs=35633;function xs(t,e){let n="";for(let i=0;i<e.length;i++){const r=e[i];if((t[i+3]||t[i+2]||t[i+1])&&(n+="".concat(r,"\n"),t[i+1])){const e=t[i+1],r=e.split(":",3),o=r[0],s=parseInt(r[1],10)||0,a=e.substring(r.join(":").length+1).trim();n+=ws("^^^ ".concat(o,": ").concat(a,"\n\n"),s)}}return n}function ws(t,e){let n="";for(let t=0;t<e;++t)n+=" ";return"".concat(n).concat(t)}class Es extends ao{get[Symbol.toStringTag](){return"Shader"}static getTypeName(t){switch(t){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Qr(!1),"unknown"}}constructor(t,e){ar(t),Qr("string"==typeof e.source,"Shader: GLSL source code must be a JavaScript string"),super(t,{id:vs(e.source,null)||e.id||no("unnamed ".concat(Es.getTypeName(e.shaderType)))}),this.shaderType=e.shaderType,this.source=e.source,this.initialize(e)}initialize(t){let{source:e}=t;const n=vs(e,null);n&&(this.id=no(n)),this._compile(e)}getParameter(t){return this.gl.getShaderParameter(this.handle,t)}toString(){return"".concat(Es.getTypeName(this.shaderType),":").concat(this.id)}getName(){return vs(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const t=this.gl.getExtension("WEBGL_debug_shaders");return t?t.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.source;if(t.startsWith("#version ")||(t="#version 100\n".concat(t)),this.source=t,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const t=this.gl.getShaderInfoLog(this.handle),{shaderName:e,errors:n,warnings:i}=function(t,e,n,i){const r=t.split(/\r?\n/),o={},s={},a=i||vs(e)||"(unnamed)",l="".concat(function(t){switch(t){case _s:return"fragment";case bs:return"vertex";default:return"unknown type"}}(n)," shader ").concat(a);for(let e=0;e<r.length;e++){const n=r[e];if(n.length<=1)continue;const i=n.split(":"),a=i[0],u=parseInt(i[2],10);if(isNaN(u))throw new Error("GLSL compilation error in ".concat(l,": ").concat(t));"WARNING"!==a?o[u]=n:s[u]=n}const u=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:": ";const i=t.split(/\r?\n/),r=String(i.length+e-1).length;return i.map(((t,i)=>{const o=String(i+e),s=o.length;return ws(o,r-s)+n+t}))}(e);return{shaderName:l,errors:xs(o,u),warnings:xs(s,u)}}(t,this.source,this.shaderType,this.id);throw er.error("GLSL compilation errors in ".concat(e,"\n").concat(n))(),er.warn("GLSL compilation warnings in ".concat(e,"\n").concat(i))(),new Error("GLSL compilation errors in ".concat(e))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class Ss extends Es{get[Symbol.toStringTag](){return"VertexShader"}constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class Ps extends Es{get[Symbol.toStringTag](){return"FragmentShader"}constructor(t,e){"string"==typeof e&&(e={source:e}),super(t,Object.assign({},e,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Cs=5120,Is=5121,Ts=5122,Ms=5123,Ls=0,As=1,Os=2,Ns=3,Rs=4,ks=5,Ds=6,Fs=5126,zs=5124,Bs=5125,js={[Fs]:[Fs,1,"float"],35664:[Fs,2,"vec2"],35665:[Fs,3,"vec3"],35666:[Fs,4,"vec4"],[zs]:[zs,1,"int"],35667:[zs,2,"ivec2"],35668:[zs,3,"ivec3"],35669:[zs,4,"ivec4"],[Bs]:[Bs,1,"uint"],36294:[Bs,2,"uvec2"],36295:[Bs,3,"uvec3"],36296:[Bs,4,"uvec4"],35670:[Fs,1,"bool"],35671:[Fs,2,"bvec2"],35672:[Fs,3,"bvec3"],35673:[Fs,4,"bvec4"],35674:[Fs,8,"mat2"],35685:[Fs,8,"mat2x3"],35686:[Fs,8,"mat2x4"],35675:[Fs,12,"mat3"],35687:[Fs,12,"mat3x2"],35688:[Fs,12,"mat3x4"],35676:[Fs,16,"mat4"],35689:[Fs,16,"mat4x2"],35690:[Fs,16,"mat4x3"]};function Us(t){const e=js[t];if(!e)return null;const[n,i]=e;return{type:n,components:i}}function Vs(t,e){switch(t){case Cs:case Is:case Ts:case Ms:t=Fs}for(const n in js){const[i,r,o]=js[n];if(i===t&&r===e)return{glType:n,name:o}}return null}class Gs{constructor(t){this.id=t.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(t),this._readVaryingsFromProgram(t)}getAttributeInfo(t){const e=Number(t);return Number.isFinite(e)?this.attributeInfosByLocation[e]:this.attributeInfosByName[t]||null}getAttributeLocation(t){const e=this.getAttributeInfo(t);return e?e.location:-1}getAttributeAccessor(t){const e=this.getAttributeInfo(t);return e?e.accessor:null}getVaryingInfo(t){const e=Number(t);return Number.isFinite(e)?this.varyingInfos[e]:this.varyingInfosByName[t]||null}getVaryingIndex(t){const e=this.getVaryingInfo();return e?e.location:-1}getVaryingAccessor(t){const e=this.getVaryingInfo();return e?e.accessor:null}_readAttributesFromProgram(t){const{gl:e}=t,n=e.getProgramParameter(t.handle,35721);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getActiveAttrib(t.handle,i),s=e.getAttribLocation(t.handle,n);s>=0&&this._addAttribute(s,n,r,o)}this.attributeInfos.sort(((t,e)=>t.location-e.location))}_readVaryingsFromProgram(t){const{gl:e}=t;if(!sr(e))return;const n=e.getProgramParameter(t.handle,35971);for(let i=0;i<n;i++){const{name:n,type:r,size:o}=e.getTransformFeedbackVarying(t.handle,i);this._addVarying(i,n,r,o)}this.varyingInfos.sort(((t,e)=>t.location-e.location))}_addAttribute(t,e,n,i){const{type:r,components:o}=Us(n),s={type:r,size:i*o};this._inferProperties(t,e,s);const a={location:t,name:e,accessor:new mo(s)};this.attributeInfos.push(a),this.attributeInfosByLocation[t]=a,this.attributeInfosByName[a.name]=a}_inferProperties(t,e,n){/instance/i.test(e)&&(n.divisor=1)}_addVarying(t,e,n,i){const{type:r,components:o}=Us(n),s={location:t,name:e,accessor:new mo({type:r,size:i*o})};this.varyingInfos.push(s),this.varyingInfosByName[s.name]=s}}const qs=35981,Ws=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class Hs extends ao{get[Symbol.toStringTag](){return"Program"}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(t,e),this.stubRemovedMethods("Program","v6.0",Ws),this._isCached=!1,this.initialize(e),Object.seal(this),this._setId(e.id)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hash:e,vs:n,fs:i,varyings:r,bufferMode:o=qs}=t;return this.hash=e||"",this.vs="string"==typeof n?new Ss(this.gl,{id:"".concat(t.id,"-vs"),source:n}):n,this.fs="string"==typeof i?new Ps(this.gl,{id:"".concat(t.id,"-fs"),source:i}):i,Qr(this.vs instanceof Ss),Qr(this.fs instanceof Ps),this.uniforms={},this._textureUniforms={},r&&r.length>0&&(lr(this.gl),this.varyings=r,this.gl2.transformFeedbackVaryings(this.handle,r,o)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new Gs(this),this.setProps(t)}delete(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this._isCached?this:super.delete(t)}setProps(t){return"uniforms"in t&&this.setUniforms(t.uniforms),this}draw(t){let{logPriority:e,drawMode:n=4,vertexCount:i,offset:r=0,start:o,end:s,isIndexed:a=!1,indexType:l=5123,instanceCount:u=0,isInstanced:c=u>0,vertexArray:h=null,transformFeedback:f,framebuffer:d,parameters:p={},uniforms:g,samplers:m}=t;if((g||m)&&(er.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(g||{})),er.priority>=e){const t=d?d.id:"default",r="mode=".concat(to(this.gl,n)," verts=").concat(i," ")+"instances=".concat(u," indexType=").concat(to(this.gl,l)," ")+"isInstanced=".concat(c," isIndexed=").concat(a," ")+"Framebuffer=".concat(t);er.log(e,r)()}return Qr(h),this.gl.useProgram(this.handle),!(!this._areTexturesRenderable()||0===i||c&&0===u||(h.bindForDraw(i,u,(()=>{if(void 0!==d&&(p=Object.assign({},p,{framebuffer:d})),f){const t=function(t){switch(t){case Ls:return Ls;case As:case Ns:case Os:return As;case Rs:case ks:case Ds:return Rs;default:return Qr(!1),0}}(n);f.begin(t)}this._bindTextures(),jr(this.gl,p,(()=>{a&&c?this.gl2.drawElementsInstanced(n,i,l,r,u):a&&sr(this.gl)&&!isNaN(o)&&!isNaN(s)?this.gl2.drawRangeElements(n,o,s,i,l,r):a?this.gl.drawElements(n,i,l,r):c?this.gl2.drawArraysInstanced(n,r,i,u):this.gl.drawArrays(n,r,i)})),f&&f.end()})),0))}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};er.priority>=2&&function(t,e,n){for(const i in t){const r=t[i];if((!n||Boolean(n[i]))&&!fs(r))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(i),r),new Error("".concat(e," Bad uniform ").concat(i))}}(t,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const e in t){const n=t[e],i=this._uniformSetters[e];if(i){let t=n,r=!1;if(t instanceof ts&&(t=t.texture),t instanceof Co)if(r=this.uniforms[e]!==n,r){void 0===i.textureIndex&&(i.textureIndex=this._textureIndexCounter++);const n=t,{textureIndex:r}=i;n.bind(r),t=r,this._textureUniforms[e]=n}else t=i.textureIndex;else this._textureUniforms[e]&&delete this._textureUniforms[e];(i(t)||r)&&ds(this.uniforms,e,n)}}return this}_areTexturesRenderable(){let t=!0;for(const e in this._textureUniforms){const n=this._textureUniforms[e];n.update(),t=t&&n.loaded}return t}_bindTextures(){for(const t in this._textureUniforms){const e=this._uniformSetters[t].textureIndex;this._textureUniforms[t].bind(e)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(t){const e=this.gl.getAttachedShaders(t),n={};for(const t of e)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:n.vs=new Ss({handle:t});break;case 35632:n.fs=new Ps({handle:t})}return n}_getParameter(t){return this.gl.getProgramParameter(this.handle,t)}_setId(t){if(!t){const t=this._getName();this.id=no(t)}}_getName(){let t=this.vs.getName()||this.fs.getName();return t=t.replace(/shader/i,""),t=t?"".concat(t,"-program"):"program",t}_compileAndLink(){const{gl:t}=this;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),er.time(4,"linkProgram for ".concat(this._getName()))(),t.linkProgram(this.handle),er.timeEnd(4,"linkProgram for ".concat(this._getName()))(),t.debug||er.level>0){if(!t.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(t.getProgramInfoLog(this.handle)));if(t.validateProgram(this.handle),!t.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(t.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:t}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let e=0;e<this._uniformCount;e++){const n=this.gl.getActiveUniform(this.handle,e),{name:i}=hs(n.name);let r=t.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=cs(t,r,n),n.size>1)for(let e=0;e<n.size;e++)r=t.getUniformLocation(this.handle,"".concat(i,"[").concat(e,"]")),this._uniformSetters["".concat(i,"[").concat(e,"]")]=cs(t,r,n)}this._textureIndexCounter=0}getActiveUniforms(t,e){return this.gl2.getActiveUniforms(this.handle,t,e)}getUniformBlockIndex(t){return this.gl2.getUniformBlockIndex(this.handle,t)}getActiveUniformBlockParameter(t,e){return this.gl2.getActiveUniformBlockParameter(this.handle,t,e)}uniformBlockBinding(t,e){this.gl2.uniformBlockBinding(this.handle,t,e)}}class Xs{static getDefaultProgramManager(t){return t.luma=t.luma||{},t.luma.defaultProgramManager=t.luma.defaultProgramManager||new Xs(t),t.luma.defaultProgramManager}constructor(t){this.gl=t,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(t){this._defaultModules.find((e=>e.name===t.name))||this._defaultModules.push(t),this.stateHash++}removeDefaultModule(t){const e="string"==typeof t?t:t.name;this._defaultModules=this._defaultModules.filter((t=>t.name!==e)),this.stateHash++}addShaderHook(t,e){e&&(t=Object.assign(e,{hook:t})),this._hookFunctions.push(t),this.stateHash++}get(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{vs:e="",fs:n="",defines:i={},inject:r={},varyings:o=[],bufferMode:s=35981,transpileToGLSL100:a=!1}=t,l=this._getModuleList(t.modules),u=this._getHash(e),c=this._getHash(n),h=l.map((t=>this._getHash(t.name))).sort(),f=o.map((t=>this._getHash(t))),d=Object.keys(i).sort(),p=Object.keys(r).sort(),g=[],m=[];for(const t of d)g.push(this._getHash(t)),g.push(this._getHash(i[t]));for(const t of p)m.push(this._getHash(t)),m.push(this._getHash(r[t]));const y="".concat(u,"/").concat(c,"D").concat(g.join("/"),"M").concat(h.join("/"),"I").concat(m.join("/"),"V").concat(f.join("/"),"H").concat(this.stateHash,"B").concat(s).concat(a?"T":"");if(!this._programCache[y]){const t=function(t,e){const{vs:n,fs:i}=e,r=bi(e.modules||[]);return{gl:t,vs:Ji(t,Object.assign({},e,{source:n,type:di,modules:r})),fs:Ji(t,Object.assign({},e,{source:i,type:pi,modules:r})),getUniforms:tr(r)}}(this.gl,{vs:e,fs:n,modules:l,inject:r,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:a});this._programCache[y]=new Hs(this.gl,{hash:y,vs:t.vs,fs:t.fs,varyings:o,bufferMode:s}),this._getUniforms[y]=t.getUniforms||(t=>{}),this._useCounts[y]=0}return this._useCounts[y]++,this._programCache[y]}getUniforms(t){return this._getUniforms[t.hash]||null}release(t){const e=t.hash;this._useCounts[e]--,0===this._useCounts[e]&&(this._programCache[e].delete(),delete this._programCache[e],delete this._getUniforms[e],delete this._useCounts[e])}_getHash(t){return void 0===this._hashes[t]&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}_getModuleList(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const e=new Array(this._defaultModules.length+t.length),n={};let i=0;for(let t=0,r=this._defaultModules.length;t<r;++t){const r=this._defaultModules[t],o=r.name;e[i++]=r,n[o]=!0}for(let r=0,o=t.length;r<o;++r){const o=t[r],s=o.name;n[s]||(e[i++]=o,n[s]=!0)}return e.length=i,e}}const Ys="#define SMOOTH_EDGE_RADIUS 0.5",Zs={name:"geometry",vs:"\n".concat(Ys,"\n\nstruct VertexGeometry {\n  vec4 position;\n  vec3 worldPosition;\n  vec3 worldPositionAlt;\n  vec3 normal;\n  vec2 uv;\n  vec3 pickingColor;\n} geometry = VertexGeometry(\n  vec4(0.0, 0.0, 1.0, 0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec3(0.0),\n  vec2(0.0),\n  vec3(0.0)\n);\n"),fs:"\n".concat(Ys,"\n\nstruct FragmentGeometry {\n  vec2 uv;\n} geometry;\n\nfloat smoothedge(float edge, float x) {\n  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);\n}\n")},Ks=Object.keys(ri).map((t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(ri[t],";"))).join(""),$s=Object.keys(oi).map((t=>"const int PROJECTION_MODE_".concat(t," = ").concat(oi[t],";"))).join(""),Qs=Object.keys(si).map((t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(si[t],";"))).join(""),Js="".concat(Ks,"\n").concat($s,"\n").concat(Qs,"\n\nuniform int project_uCoordinateSystem;\nuniform int project_uProjectionMode;\nuniform float project_uScale;\nuniform bool project_uWrapLongitude;\nuniform vec3 project_uCommonUnitsPerMeter;\nuniform vec3 project_uCommonUnitsPerWorldUnit;\nuniform vec3 project_uCommonUnitsPerWorldUnit2;\nuniform vec4 project_uCenter;\nuniform mat4 project_uModelMatrix;\nuniform mat4 project_uViewProjectionMatrix;\nuniform vec2 project_uViewportSize;\nuniform float project_uDevicePixelRatio;\nuniform float project_uFocalDistance;\nuniform vec3 project_uCameraPosition;\nuniform vec3 project_uCoordinateOrigin;\nuniform vec3 project_uCommonOrigin;\nuniform bool project_uPseudoMeters;\n\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / (PI * 2.0);\nconst vec3 ZERO_64_LOW = vec3(0.0);\nconst float EARTH_RADIUS = 6370972.0;\nconst float GLOBE_RADIUS = 256.0;\nfloat project_size_at_latitude(float lat) {\n  float y = clamp(lat, -89.9, 89.9);\n  return 1.0 / cos(radians(y));\n}\n\nfloat project_size() {\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&\n    project_uPseudoMeters == false) {\n    \n    if (geometry.position.w == 0.0) {\n      return project_size_at_latitude(geometry.worldPosition.y);\n    }\n  \n    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;\n    float y2 = y * y;\n    float y4 = y2 * y2;\n    float y6 = y4 * y2;\n    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;\n  }\n  return 1.0;\n}\n\nfloat project_size_at_latitude(float meters, float lat) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);\n}\nfloat project_size(float meters) {\n  return meters * project_uCommonUnitsPerMeter.z * project_size();\n}\n\nvec2 project_size(vec2 meters) {\n  return meters * project_uCommonUnitsPerMeter.xy * project_size();\n}\n\nvec3 project_size(vec3 meters) {\n  return meters * project_uCommonUnitsPerMeter * project_size();\n}\n\nvec4 project_size(vec4 meters) {\n  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);\n}\nmat3 project_get_orientation_matrix(vec3 up) {\n  vec3 uz = normalize(up);\n  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));\n  vec3 uy = cross(uz, ux);\n  return mat3(ux, uy, uz);\n}\n\nbool project_needs_rotation(vec3 commonPosition, out mat3 transform) {\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    transform = project_get_orientation_matrix(commonPosition);\n    return true;\n  }\n  return false;\n}\nvec3 project_normal(vec3 vector) {\n  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);\n  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);\n  mat3 rotation;\n  if (project_needs_rotation(geometry.position.xyz, rotation)) {\n    n = rotation * n;\n  }\n  return n;\n}\n\nvec4 project_offset_(vec4 offset) {\n  float dy = offset.y;\n  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;\n  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);\n}\nvec2 project_mercator_(vec2 lnglat) {\n  float x = lnglat.x;\n  if (project_uWrapLongitude) {\n    x = mod(x + 180., 360.0) - 180.;\n  }\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\nvec3 project_globe_(vec3 lnglatz) {\n  float lambda = radians(lnglatz.x);\n  float phi = radians(lnglatz.y);\n  float cosPhi = cos(phi);\n  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;\n\n  return vec3(\n    sin(lambda) * cosPhi,\n    -cos(lambda) * cosPhi,\n    sin(phi)\n  ) * D;\n}\nvec4 project_position(vec4 position, vec3 position64Low) {\n  vec4 position_world = project_uModelMatrix * position;\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_mercator_(position_world.xy),\n        project_size_at_latitude(position_world.z, position_world.y),\n        position_world.w\n      );\n    }\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {\n      position_world.xyz += project_uCoordinateOrigin;\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      return vec4(\n        project_globe_(position_world.xyz),\n        position_world.w\n      );\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {\n    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {\n      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {\n        return vec4(\n          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,\n          project_size(position_world.z),\n          position_world.w\n        );\n      }\n    }\n  }\n  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||\n    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&\n    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {\n    position_world.xyz -= project_uCoordinateOrigin;\n  }\n  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));\n}\n\nvec4 project_position(vec4 position) {\n  return project_position(position, ZERO_64_LOW);\n}\n\nvec3 project_position(vec3 position, vec3 position64Low) {\n  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);\n  return projected_position.xyz;\n}\n\nvec3 project_position(vec3 position) {\n  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);\n  return projected_position.xyz;\n}\n\nvec2 project_position(vec2 position) {\n  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);\n  return projected_position.xy;\n}\n\nvec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {\n  return viewProjectionMatrix * position + center;\n}\nvec4 project_common_position_to_clipspace(vec4 position) {\n  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);\n}\nvec2 project_pixel_size_to_clipspace(vec2 pixels) {\n  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;\n  return offset * project_uFocalDistance;\n}\n\nfloat project_size_to_pixel(float meters) {\n  return project_size(meters) * project_uScale;\n}\nfloat project_size_to_pixel(float size, int unit) {\n  if (unit == UNIT_METERS) return project_size_to_pixel(size);\n  if (unit == UNIT_COMMON) return size * project_uScale;\n  return size;\n}\nfloat project_pixel_size(float pixels) {\n  return pixels / project_uScale;\n}\nvec2 project_pixel_size(vec2 pixels) {\n  return pixels / project_uScale;\n}\n");function ta(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}function ea(t){let e,n={};return i=>{for(const r in i)if(!ta(i[r],n[r])){e=t(i),n=i;break}return e}}const na=[0,0,0,0],ia=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],ra=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],oa=[0,0,0],sa=[0,0,0],aa=ea((function({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:i}){const{projectionCenter:r,viewProjectionMatrix:o,originCommon:s,cameraPosCommon:a,shaderCoordinateOrigin:l,geospatialOrigin:u}=function(t,e,n){const{viewMatrixUncentered:i,projectionMatrix:r}=t;let{viewMatrix:o,viewProjectionMatrix:s}=t,a=na,l=na,u=t.cameraPosition;const{geospatialOrigin:c,shaderCoordinateOrigin:h,offsetMode:f}=la(t,e,n);return f&&(l=t.projectPosition(c||h),u=[u[0]-l[0],u[1]-l[1],u[2]-l[2]],l[3]=1,a=w([],l,s),o=i||o,s=T([],r,o),s=T([],s,ia)),{viewMatrix:o,viewProjectionMatrix:s,projectionCenter:a,originCommon:l,cameraPosCommon:u,shaderCoordinateOrigin:h,geospatialOrigin:c}}(t,n,i),c=t.getDistanceScales(),h=[t.width*e,t.height*e],f=w([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,d={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:l,project_uCommonOrigin:s.slice(0,3),project_uCenter:r,project_uPseudoMeters:Boolean(t._pseudoMeters),project_uViewportSize:h,project_uDevicePixelRatio:e,project_uFocalDistance:f,project_uCommonUnitsPerMeter:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit:c.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:oa,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:o,project_uModelMatrix:ra,project_uCameraPosition:a};if(u){const e=t.getDistanceScales(u);switch(n){case ri.METER_OFFSETS:d.project_uCommonUnitsPerWorldUnit=e.unitsPerMeter,d.project_uCommonUnitsPerWorldUnit2=e.unitsPerMeter2;break;case ri.LNGLAT:case ri.LNGLAT_OFFSETS:t._pseudoMeters||(d.project_uCommonUnitsPerMeter=e.unitsPerMeter),d.project_uCommonUnitsPerWorldUnit=e.unitsPerDegree,d.project_uCommonUnitsPerWorldUnit2=e.unitsPerDegree2;break;case ri.CARTESIAN:d.project_uCommonUnitsPerWorldUnit=[1,1,e.unitsPerMeter[2]],d.project_uCommonUnitsPerWorldUnit2=[0,0,e.unitsPerMeter2[2]]}}return d}));function la(t,e,n=sa){n.length<3&&(n=[n[0],n[1],0]);let i,r=n,o=!0;switch(i=e===ri.LNGLAT_OFFSETS||e===ri.METER_OFFSETS?n:t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case oi.WEB_MERCATOR:e!==ri.LNGLAT&&e!==ri.CARTESIAN||(i=[0,0,0],o=!1);break;case oi.WEB_MERCATOR_AUTO_OFFSET:e===ri.LNGLAT?r=i:e===ri.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case oi.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case oi.GLOBE:o=!1,i=null;break;default:o=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:o}}const ua={},ca={name:"project",dependencies:[{name:"fp32",vs:"#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\nconst float TWO_PI = 6.2831854820251465;\nconst float PI_2 = 1.5707963705062866;\nconst float PI_16 = 0.1963495463132858;\n\nconst float SIN_TABLE_0 = 0.19509032368659973;\nconst float SIN_TABLE_1 = 0.3826834261417389;\nconst float SIN_TABLE_2 = 0.5555702447891235;\nconst float SIN_TABLE_3 = 0.7071067690849304;\n\nconst float COS_TABLE_0 = 0.9807852506637573;\nconst float COS_TABLE_1 = 0.9238795042037964;\nconst float COS_TABLE_2 = 0.8314695954322815;\nconst float COS_TABLE_3 = 0.7071067690849304;\n\nconst float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;\nconst float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;\nconst float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;\nconst float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;\n\nfloat sin_taylor_fp32(float a) {\n  float r, s, t, x;\n\n  if (a == 0.0) {\n    return 0.0;\n  }\n\n  x = -a * a;\n  s = a;\n  r = a;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_3;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_5;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_7;\n  s = s + t;\n\n  r = r * x;\n  t = r * INVERSE_FACTORIAL_9;\n  s = s + t;\n\n  return s;\n}\n\nvoid sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {\n  if (a == 0.0) {\n    sin_t = 0.0;\n    cos_t = 1.0;\n  }\n  sin_t = sin_taylor_fp32(a);\n  cos_t = sqrt(1.0 - sin_t * sin_t);\n}\n\nfloat tan_taylor_fp32(float a) {\n    float sin_a;\n    float cos_a;\n\n    if (a == 0.0) {\n        return 0.0;\n    }\n    float z = floor(a / TWO_PI);\n    float r = a - TWO_PI * z;\n\n    float t;\n    float q = floor(r / PI_2 + 0.5);\n    int j = int(q);\n\n    if (j < -2 || j > 2) {\n        return 1.0 / 0.0;\n    }\n\n    t = r - PI_2 * q;\n\n    q = floor(t / PI_16 + 0.5);\n    int k = int(q);\n    int abs_k = int(abs(float(k)));\n\n    if (abs_k > 4) {\n        return 1.0 / 0.0;\n    } else {\n        t = t - PI_16 * q;\n    }\n\n    float u = 0.0;\n    float v = 0.0;\n\n    float sin_t, cos_t;\n    float s, c;\n    sincos_taylor_fp32(t, sin_t, cos_t);\n\n    if (k == 0) {\n        s = sin_t;\n        c = cos_t;\n    } else {\n        if (abs(float(abs_k) - 1.0) < 0.5) {\n            u = COS_TABLE_0;\n            v = SIN_TABLE_0;\n        } else if (abs(float(abs_k) - 2.0) < 0.5) {\n            u = COS_TABLE_1;\n            v = SIN_TABLE_1;\n        } else if (abs(float(abs_k) - 3.0) < 0.5) {\n            u = COS_TABLE_2;\n            v = SIN_TABLE_2;\n        } else if (abs(float(abs_k) - 4.0) < 0.5) {\n            u = COS_TABLE_3;\n            v = SIN_TABLE_3;\n        }\n        if (k > 0) {\n            s = u * sin_t + v * cos_t;\n            c = u * cos_t - v * sin_t;\n        } else {\n            s = u * sin_t - v * cos_t;\n            c = u * cos_t + v * sin_t;\n        }\n    }\n\n    if (j == 0) {\n        sin_a = s;\n        cos_a = c;\n    } else if (j == 1) {\n        sin_a = c;\n        cos_a = -s;\n    } else if (j == -1) {\n        sin_a = -c;\n        cos_a = s;\n    } else {\n        sin_a = -s;\n        cos_a = -c;\n    }\n    return sin_a / cos_a;\n}\n#endif\n\nfloat tan_fp32(float a) {\n#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND\n  return tan_taylor_fp32(a);\n#else\n  return tan(a);\n#endif\n}\n",fs:null},Zs],vs:Js,getUniforms:function(t=ua){return"viewport"in t?function({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:i=ri.DEFAULT,coordinateOrigin:r=sa,autoWrapLongitude:o=!1}){i===ri.DEFAULT&&(i=t.isGeospatial?ri.LNGLAT:ri.CARTESIAN);const s=aa({viewport:t,devicePixelRatio:e,coordinateSystem:i,coordinateOrigin:r});return s.project_uWrapLongitude=o,s.project_uModelMatrix=n||ra,s}(t):{}}},ha=[ca],fa=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function da(t){const e=Xs.getDefaultProgramManager(t);for(const t of ha)e.addDefaultModule(t);for(const t of fa)e.addShaderHook(t);return e}class pa{constructor(t,{deck:e,stats:n,viewport:i,timeline:r}={}){u(this,"layers",void 0),u(this,"context",void 0),u(this,"resourceManager",void 0),u(this,"_lastRenderedLayers",[]),u(this,"_needsRedraw",!1),u(this,"_needsUpdate",!1),u(this,"_nextLayers",null),u(this,"_debug",!1),u(this,"activateViewport",(t=>{te("layerManager.activateViewport",this,t),t&&(this.context.viewport=t)})),this.layers=[],this.resourceManager=new Ln({gl:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:t,deck:e,programManager:t&&da(t),stats:n||new se({id:"deck.gl"}),viewport:i||new fi({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:r||new Et,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(const n of this.layers){const i=n.getNeedsRedraw(t);e=e||i}return e}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter((e=>t.find((t=>0===e.id.indexOf(t))))):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,e){te("layerManager.setLayers",this,e,t),this._lastRenderedLayers=t;const n=ee(t,Boolean);for(const t of n)t.context=this.context;this._updateLayers(this.layers,n)}updateLayers(){const t=this.needsUpdate();t&&(this.setNeedsRedraw("updating layers: ".concat(t)),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}_handleError(t,e,n){n.raiseError(e,"".concat(t," of ").concat(n))}_updateLayers(t,e){const n={};for(const e of t)n[e.id]?$t.warn("Multiple old layers with same id ".concat(e.id))():n[e.id]=e;const i=[];this._updateSublayersRecursively(e,n,i),this._finalizeOldLayers(n);let r=!1;for(const t of i)if(t.hasUniformTransition()){r="Uniform transition in ".concat(t);break}this._needsUpdate=r,this.layers=i}_updateSublayersRecursively(t,e,n){for(const i of t){i.context=this.context;const t=e[i.id];null===t&&$t.warn("Multiple new layers with same id ".concat(i.id))(),e[i.id]=null;let r=null;try{this._debug&&t!==i&&i.validateProps(),t?(this._transferLayerState(t,i),this._updateLayer(i)):this._initializeLayer(i),n.push(i),r=i.isComposite?i.getSubLayers():null}catch(t){this._handleError("matching",t,i)}r&&this._updateSublayersRecursively(r,e,n)}}_finalizeOldLayers(t){for(const e in t){const n=t[e];n&&this._finalizeLayer(n)}}_initializeLayer(t){try{t._initialize(),t.lifecycle="Initialized"}catch(e){this._handleError("initialization",e,t)}}_transferLayerState(t,e){e._transferState(t),e.lifecycle="Matched. State transferred from previous layer",e!==t&&(t.lifecycle="Discarded. Awaiting garbage collection")}_updateLayer(t){try{t._update()}catch(e){this._handleError("update",e,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||"finalized ".concat(t),t.lifecycle="No longer matched. Awaiting garbage collection";try{t._finalize(),t.lifecycle="Finalized! Awaiting garbage collection"}catch(e){this._handleError("finalization",e,t)}}}function ga(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!ga(t[i],e[i],n-1))return!1;return!0}if(Array.isArray(e))return!1;if("object"==typeof t&&"object"==typeof e){const i=Object.keys(t),r=Object.keys(e);if(i.length!==r.length)return!1;for(const r of i){if(!e.hasOwnProperty(r))return!1;if(!ga(t[r],e[r],n-1))return!1}return!0}return!1}class ma{constructor(t){u(this,"width",void 0),u(this,"height",void 0),u(this,"views",void 0),u(this,"viewState",void 0),u(this,"controllers",void 0),u(this,"timeline",void 0),u(this,"_viewports",void 0),u(this,"_viewportMap",void 0),u(this,"_isUpdating",void 0),u(this,"_needsRedraw",void 0),u(this,"_needsUpdate",void 0),u(this,"_eventManager",void 0),u(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(const t in this.controllers){const e=this.controllers[t];e&&e.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(const t in this.controllers){const e=this.controllers[t];e&&e.updateTransition()}}getViewports(t){return t?this._viewports.filter((e=>e.containsPixel(t))):this._viewports}getViews(){const t={};return this.views.forEach((e=>{t[e.id]=e})),t}getView(t){return this.views.find((e=>e.id===t))}getViewState(t){const e="string"==typeof t?this.getView(t):t,n=e&&this.viewState[e.getViewStateId()]||this.viewState;return e?e.filterViewState(n):n}getViewport(t){return this._viewportMap[t]}unproject(t,e){const n=this.getViewports(),i={x:t[0],y:t[1]};for(let r=n.length-1;r>=0;--r){const o=n[r];if(o.containsPixel(i)){const n=t.slice();return n[0]-=o.x,n[1]-=o.y,o.unproject(n,e)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,e){t===this.width&&e===this.height||(this.width=t,this.height=e,this.setNeedsUpdate("Size changed"))}_setViews(t){t=ee(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!ga(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):$t.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(t,e){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...e,viewId:t})}_createController(t,e){return new(0,e.type)({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,e.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:e=>{var n;return null===(n=this.getView(t.id))||void 0===n?void 0:n.makeViewport({viewState:e,width:this.width,height:this.height})}})}_updateController(t,e,n,i){const r=t.controller;if(r){const o={...e,...r,id:t.id,x:n.x,y:n.y,width:n.width,height:n.height};return i||(i=this._createController(t,o)),i&&i.setProps(o),i}return null}_rebuildViewports(){const{views:t}=this,e=this.controllers;this._viewports=[],this.controllers={};let n=!1;for(let i=t.length;i--;){const r=t[i],o=this.getViewState(r),s=r.makeViewport({viewState:o,width:this.width,height:this.height});let a=e[r.id];const l=Boolean(r.controller);l&&!a&&(n=!0),!n&&l||!a||(a.finalize(),a=null),this.controllers[r.id]=this._updateController(r,o,s,a),this._viewports.unshift(s)}for(const t in e){const n=e[t];n&&!this.controllers[t]&&n.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach((t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)}))}_diffViews(t,e){return t.length!==e.length||t.some(((n,i)=>!t[i].equals(e[i])))}}const ya=/([0-9]+\.?[0-9]*)(%|px)/;function va(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=ya.exec(t);if(e&&e.length>=3){const t="%"===e[2],n=parseFloat(e[1]);return{position:t?n/100:n,relative:t}}default:throw new Error("Could not parse position string ".concat(t))}}function _a(t,e){return t.relative?Math.round(t.position*e):t.position}class ba{constructor(t){u(this,"id",void 0),u(this,"viewportInstance",void 0),u(this,"_x",void 0),u(this,"_y",void 0),u(this,"_width",void 0),u(this,"_height",void 0),u(this,"_padding",void 0),u(this,"props",void 0);const{id:e,x:n=0,y:i=0,width:r="100%",height:o="100%",padding:s=null,viewportInstance:a}=t||{};m(!a||a instanceof fi),this.viewportInstance=a,this.id=e||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=va(n),this._y=va(i),this._width=va(r),this._height=va(o),this._padding=s&&{left:va(s.left||0),right:va(s.right||0),top:va(s.top||0),bottom:va(s.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t||(this.viewportInstance?!!t.viewportInstance&&this.viewportInstance.equals(t.viewportInstance):this.ViewportType===t.ViewportType&&ga(this.props,t.props,2))}makeViewport({width:t,height:e,viewState:n}){if(this.viewportInstance)return this.viewportInstance;n=this.filterViewState(n);const i=this.getDimensions({width:t,height:e});return new this.ViewportType({...n,...this.props,...i})}getViewStateId(){const{viewState:t}=this.props;return"string"==typeof t?t:(null==t?void 0:t.id)||this.id}filterViewState(t){if(this.props.viewState&&"object"==typeof this.props.viewState){if(!this.props.viewState.id)return this.props.viewState;const e={...t};for(const t in this.props.viewState)"id"!==t&&(e[t]=this.props.viewState[t]);return e}return t}getDimensions({width:t,height:e}){const n={x:_a(this._x,t),y:_a(this._y,e),width:_a(this._width,t),height:_a(this._height,e)};return this._padding&&(n.padding={left:_a(this._padding.left,t),top:_a(this._padding.top,e),right:_a(this._padding.right,t),bottom:_a(this._padding.bottom,e)}),n}get controller(){const t=this.props.controller;return t?!0===t?{type:this.ControllerType}:"function"==typeof t?{type:t}:{type:this.ControllerType,...t}:null}}class xa extends fi{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:i=0,pitch:r=0,bearing:o=0,nearZMultiplier:s=.1,farZMultiplier:a=1.01,orthographic:l=!1,projectionMatrix:c,repeat:h=!1,worldOffset:f=0,position:p,padding:g,legacyMeterSizes:m=!1}=t;let{width:y,height:v,altitude:_=1.5}=t;const b=Math.pow(2,i);let x;y=y||1,v=v||1;let w=null;if(c)_=c[5]/2,x=lt(_);else{let n;if(t.fovy?(x=t.fovy,_=ut(x)):x=lt(_),g){const{top:t=0,bottom:e=0}=g;n=[0,d((t+v-e)/2,0,v)-v/2]}w=function(t){const{width:e,height:n,altitude:i,pitch:r=0,offset:o,center:s,scale:a,nearZMultiplier:l=1,farZMultiplier:u=1}=t;let{fovy:c=lt(tt)}=t;void 0!==i&&(c=lt(i));const h=c*Z,f=r*Z,d=ut(c);let p=d;s&&(p+=s[2]*a/Math.cos(f)/n);const g=h*(.5+(o?o[1]:0)/n),m=Math.sin(g)*p/Math.sin(P(Math.PI/2-f-g,.01,Math.PI-.01)),y=Math.sin(f)*m+p,v=10*p;return{fov:h,aspect:e/n,focalDistance:d,near:l,far:Math.min(y*u,v)}}({width:y,height:v,scale:b,center:p&&[0,0,p[2]*ot(e)],offset:n,pitch:r,fovy:x,nearZMultiplier:s,farZMultiplier:a})}let E=function(t){const{height:e,pitch:n,bearing:i,altitude:r,scale:o,center:s}=t,a=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];M(a,a,[0,0,-r]),A(a,a,-n*Z),O(a,a,i*Z);const l=o/e;return L(a,a,[l,l,l]),s&&M(a,a,function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}([],s)),a}({height:v,pitch:r,bearing:o,scale:b,altitude:_});f&&(E=(new ti).translate([512*f,0,0]).multiplyLeft(E)),super({...t,width:y,height:v,viewMatrix:E,longitude:n,latitude:e,zoom:i,...w,fovy:x,focalDistance:_}),u(this,"longitude",void 0),u(this,"latitude",void 0),u(this,"pitch",void 0),u(this,"bearing",void 0),u(this,"altitude",void 0),u(this,"fovy",void 0),u(this,"orthographic",void 0),u(this,"_subViewports",void 0),u(this,"_pseudoMeters",void 0),this.latitude=e,this.longitude=n,this.zoom=i,this.pitch=r,this.bearing=o,this.altitude=_,this.fovy=x,this.orthographic=l,this._subViewports=h?[]:null,this._pseudoMeters=m,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const t=this.getBounds(),e=Math.floor((t[0]+180)/360),n=Math.ceil((t[2]-180)/360);for(let t=e;t<=n;t++){const e=t?new xa({...this,worldOffset:t}):this;this._subViewports.push(e)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);const[e,n]=this.projectFlat(t);return[e,n,(t[2]||0)*ot(t[1])]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);const[e,n]=this.unprojectFlat(t);return[e,n,(t[2]||0)/ot(n)]}addMetersToLngLat(t,e){return at(t,e)}panByPosition(t,e){const n=ht(e,this.pixelUnprojectionMatrix),i=N([],this.projectFlat(t),function(t,e){return t[0]=-e[0],t[1]=-e[1],t}([],n)),r=N([],this.center,i),[o,s]=this.unprojectFlat(r);return{longitude:o,latitude:s}}getBounds(t={}){const e=function(t,e=0){const{width:n,height:i,unproject:r}=t,o={targetZ:e},s=r([0,i],o),a=r([n,i],o);let l,u;return(t.fovy?.5*t.fovy*ft:Math.atan(.5/t.altitude))>(90-t.pitch)*ft-.01?(l=dt(t,0,e),u=dt(t,n,e)):(l=r([0,0],o),u=r([n,0],o)),[s,a,u,l]}(this,t.z||0);return[Math.min(e[0][0],e[1][0],e[2][0],e[3][0]),Math.min(e[0][1],e[1][1],e[2][1],e[3][1]),Math.max(e[0][0],e[1][0],e[2][0],e[3][0]),Math.max(e[0][1],e[1][1],e[2][1],e[3][1])]}fitBounds(t,e={}){const{width:n,height:i}=this,{longitude:r,latitude:o,zoom:s}=function(t){const{width:e,height:n,bounds:i,minExtent:r=0,maxZoom:o=24,offset:s=[0,0]}=t,[[a,l],[u,c]]=i,h=function(t=0){return"number"==typeof t?{top:t,bottom:t,left:t,right:t}:(H(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}(t.padding),f=it([a,P(c,-J,J)]),d=it([u,P(l,-J,J)]),p=[Math.max(Math.abs(d[0]-f[0]),r),Math.max(Math.abs(d[1]-f[1]),r)],g=[e-h.left-h.right-2*Math.abs(s[0]),n-h.top-h.bottom-2*Math.abs(s[1])];H(g[0]>0&&g[1]>0);const m=g[0]/p[0],y=g[1]/p[1],v=(h.right-h.left)/2/m,_=(h.top-h.bottom)/2/y,b=rt([(d[0]+f[0])/2+v,(d[1]+f[1])/2+_]),x=Math.min(o,C(Math.abs(Math.min(m,y))));return H(Number.isFinite(x)),{longitude:b[0],latitude:b[1],zoom:x}}({width:n,height:i,bounds:t,...e});return new xa({width:n,height:i,longitude:r,latitude:o,zoom:s})}}u(xa,"displayName","WebMercatorViewport");class wa{constructor(t){u(this,"_inProgress",void 0),u(this,"_handle",void 0),u(this,"_timeline",void 0),u(this,"time",void 0),u(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=t,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(t){var e,n;this.cancel(),this.settings=t,this._inProgress=!0,null===(e=(n=this.settings).onStart)||void 0===e||e.call(n,this)}end(){var t,e;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,null===(t=(e=this.settings).onEnd)||void 0===t||t.call(e,this))}cancel(){var t,e;this._inProgress&&(null===(t=(e=this.settings).onInterrupt)||void 0===t||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var t,e;if(!this._inProgress)return!1;if(null===this._handle){const{_timeline:t,settings:e}=this;this._handle=t.addChannel({delay:t.getTime(),duration:e.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),null===(t=(e=this.settings).onUpdate)||void 0===t||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const Ea=()=>{},Sa=t=>t;class Pa{constructor(t){u(this,"getControllerState",void 0),u(this,"props",void 0),u(this,"propsInTransition",void 0),u(this,"transition",void 0),u(this,"onViewStateChange",void 0),u(this,"onStateChange",void 0),u(this,"_onTransitionUpdate",(t=>{const{time:e,settings:{interpolator:n,startProps:i,endProps:r,duration:o,easing:s}}=t,a=s(e/o),l=n.interpolateProps(i,r,a);this.propsInTransition=this.getControllerState({...this.props,...l}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})})),this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new wa(t.timeline),this.onViewStateChange=t.onViewStateChange||Ea,this.onStateChange=t.onStateChange||Ea}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let e=!1;const n=this.props;if(this.props=t,!n||this._shouldIgnoreViewportChange(n,t))return!1;if(this._isTransitionEnabled(t)){let i=n;if(this.transition.inProgress){const{interruption:t,endProps:e}=this.transition.settings;i={...n,...2===t?e:this.propsInTransition||n}}this._triggerTransition(i,t),e=!0}else this.transition.cancel();return e}updateTransition(){this.transition.update()}_isTransitionEnabled(t){const{transitionDuration:e,transitionInterpolator:n}=t;return(e>0||"auto"===e)&&Boolean(n)}_isUpdateDueToCurrentTransition(t){return!(!this.transition.inProgress||!this.propsInTransition)&&this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition)}_shouldIgnoreViewportChange(t,e){return this.transition.inProgress?3===this.transition.settings.interruption||this._isUpdateDueToCurrentTransition(e):!this._isTransitionEnabled(e)||e.transitionInterpolator.arePropsEqual(t,e)}_triggerTransition(t,e){const n=this.getControllerState(t),i=this.getControllerState(e).shortestPathFrom(n),r=e.transitionInterpolator,o=r.getDuration?r.getDuration(t,e):e.transitionDuration;if(0===o)return;const s=r.initializeProps(t,i);this.propsInTransition={};const a={duration:o,easing:e.transitionEasing||Sa,interpolator:r,interruption:e.transitionInterruption||1,startProps:s.start,endProps:s.end,onStart:e.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(e.onTransitionInterrupt),onEnd:this._onTransitionEnd(e.onTransitionEnd)};this.transition.start(a),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return e=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),null==t||t(e)}}}const Ca=["longitude","latitude","zoom","bearing","pitch"],Ia=["longitude","latitude","zoom"];class Ta extends y{constructor(t={}){const e=Array.isArray(t)?t:t.transitionProps,n=Array.isArray(t)?{}:t;n.transitionProps=Array.isArray(e)?{compare:e,required:e}:e||{compare:Ca,required:Ia},super(n.transitionProps),u(this,"opts",void 0),this.opts=n}initializeProps(t,e){const n=super.initializeProps(t,e),{makeViewport:i,around:r}=this.opts;if(i&&r){const o=i(t),s=i(e),a=o.unproject(r);n.start.around=r,Object.assign(n.end,{around:s.project(a),aroundPosition:a,width:e.width,height:e.height})}return n}interpolateProps(t,e,n){const i={};for(const r of this._propsToExtract)i[r]=p(t[r]||0,e[r]||0,n);if(e.aroundPosition&&this.opts.makeViewport){const r=this.opts.makeViewport({...e,...i});Object.assign(i,r.panByPosition(e.aroundPosition,p(t.around,e.around,n)))}return i}}const Ma={transitionDuration:0},La=t=>1-(1-t)*(1-t),Aa=["wheel"],Oa=["panstart","panmove","panend"],Na=["pinchstart","pinchmove","pinchend"],Ra=["tripanstart","tripanmove","tripanend"],ka=["doubletap"],Da=["keydown"],Fa={};class za{constructor(t){u(this,"props",void 0),u(this,"state",{}),u(this,"transitionManager",void 0),u(this,"eventManager",void 0),u(this,"onViewStateChange",void 0),u(this,"onStateChange",void 0),u(this,"makeViewport",void 0),u(this,"_controllerState",void 0),u(this,"_events",{}),u(this,"_interactionState",{isDragging:!1}),u(this,"_customEvents",[]),u(this,"_eventStartBlocked",null),u(this,"_panMove",!1),u(this,"invertPan",!1),u(this,"dragMode","rotate"),u(this,"inertia",0),u(this,"scrollZoom",!0),u(this,"dragPan",!0),u(this,"dragRotate",!0),u(this,"doubleClickZoom",!0),u(this,"touchZoom",!0),u(this,"touchRotate",!1),u(this,"keyboard",!0),this.transitionManager=new Pa({...t,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(const e in this._events){var t;this._events[e]&&(null===(t=this.eventManager)||void 0===t||t.off(e,this.handleEvent))}this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;const e=this._eventStartBlocked;switch(t.type){case"panstart":return!e&&this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return!e&&this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return!e&&this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){const{x:e,y:n}=this.props,{offsetCenter:i}=t;return[i.x-e,i.y-n]}isPointInBounds(t,e){const{width:n,height:i}=this.props;if(e&&e.handled)return!1;const r=t[0]>=0&&t[0]<=n&&t[1]>=0&&t[1]<=i;return r&&e&&e.stopPropagation(),r}isFunctionKeyPressed(t){const{srcEvent:e}=t;return Boolean(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){const e=setTimeout((()=>{this._eventStartBlocked===e&&(this._eventStartBlocked=null)}),t);this._eventStartBlocked=e}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);const{inertia:e}=t;this.inertia=Number.isFinite(e)?e:!0===e?300:0;const{scrollZoom:n=!0,dragPan:i=!0,dragRotate:r=!0,doubleClickZoom:o=!0,touchZoom:s=!0,touchRotate:a=!1,keyboard:l=!0}=t,u=Boolean(this.onViewStateChange);this.toggleEvents(Aa,u&&n),this.toggleEvents(Oa,u&&(i||r)),this.toggleEvents(Na,u&&(s||a)),this.toggleEvents(Ra,u&&a),this.toggleEvents(ka,u&&o),this.toggleEvents(Da,u&&l),this.scrollZoom=n,this.dragPan=i,this.dragRotate=r,this.doubleClickZoom=o,this.touchZoom=s,this.touchRotate=a,this.keyboard=l}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,e){this.eventManager&&t.forEach((t=>{this._events[t]!==e&&(this._events[t]=e,e?this.eventManager.on(t,this.handleEvent):this.eventManager.off(t,this.handleEvent))}))}updateViewport(t,e=null,n={}){const i={...t.getViewportProps(),...e},r=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(n),r){const t=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:t})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;let n=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||"pan"===this.dragMode)&&(n=!n);const i=this.controllerState[n?"panStart":"rotateStart"]({pos:e});return this._panMove=n,this.updateViewport(i,Ma,{isDragging:!0}),!0}_onPan(t){return!!this.isDragging()&&(this._panMove?this._onPanMove(t):this._onPanRotate(t))}_onPanEnd(t){return!!this.isDragging()&&(this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t))}_onPanMove(t){if(!this.dragPan)return!1;const e=this.getCenter(t),n=this.controllerState.pan({pos:e});return this.updateViewport(n,Ma,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){const{inertia:e}=this;if(this.dragPan&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:La},{isDragging:!1,isPanning:!0})}else{const t=this.controllerState.panEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;const e=this.getCenter(t),n=this.controllerState.rotate({pos:e});return this.updateViewport(n,Ma,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){const{inertia:e}=this;if(this.dragRotate&&e&&t.velocity){const n=this.getCenter(t),i=[n[0]+t.velocityX*e/2,n[1]+t.velocityY*e/2],r=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:La},{isDragging:!1,isRotating:!0})}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;t.srcEvent.preventDefault();const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const{speed:n=.01,smooth:i=!1}=!0===this.scrollZoom?{}:this.scrollZoom,{delta:r}=t;let o=2/(1+Math.exp(-Math.abs(r*n)));r<0&&0!==o&&(o=1/o);const s=this.controllerState.zoom({pos:e,scale:o});return this.updateViewport(s,{...this._getTransitionProps({around:e}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.rotateStart({pos:e});return this.updateViewport(n,Ma,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate)return!1;if(!this.isDragging())return!1;const e=this.getCenter(t);e[0]-=t.deltaX;const n=this.controllerState.rotate({pos:e});return this.updateViewport(n,Ma,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this;if(this.touchRotate&&e&&t.velocityY){const n=this.getCenter(t),i=[n[0],n[1]+=t.velocityY*e/2],r=this.controllerState.rotate({pos:i});this.updateViewport(r,{...this._getTransitionProps(),transitionDuration:e,transitionEasing:La},{isDragging:!1,isRotating:!0}),this.blockEvents(e)}else{const t=this.controllerState.rotateEnd();this.updateViewport(t,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.controllerState.zoomStart({pos:e}).rotateStart({pos:e});return Fa._startPinchRotation=t.rotation,Fa._lastPinchEvent=t,this.updateViewport(n,Ma,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate)return!1;if(!this.isDragging())return!1;let e=this.controllerState;if(this.touchZoom){const{scale:n}=t,i=this.getCenter(t);e=e.zoom({pos:i,scale:n})}if(this.touchRotate){const{rotation:n}=t;e=e.rotate({deltaAngleX:Fa._startPinchRotation-n})}return this.updateViewport(e,Ma,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Fa._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;const{inertia:e}=this,{_lastPinchEvent:n}=Fa;if(this.touchZoom&&e&&n&&t.scale!==n.scale){const i=this.getCenter(t);let r=this.controllerState.rotateEnd();const o=Math.log2(t.scale),s=(o-Math.log2(n.scale))/(t.deltaTime-n.deltaTime),a=Math.pow(2,o+s*e/2);r=r.zoom({pos:i,scale:a}).zoomEnd(),this.updateViewport(r,{...this._getTransitionProps({around:i}),transitionDuration:e,transitionEasing:La},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(e)}else{const t=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(t,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Fa._startPinchRotation=null,Fa._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;const e=this.getCenter(t);if(!this.isPointInBounds(e,t))return!1;const n=this.isFunctionKeyPressed(t),i=this.controllerState.zoom({pos:e,scale:n?.5:2});return this.updateViewport(i,this._getTransitionProps({around:e}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;const e=this.isFunctionKeyPressed(t),{zoomSpeed:n,moveSpeed:i,rotateSpeedX:r,rotateSpeedY:o}=!0===this.keyboard?{}:this.keyboard,{controllerState:s}=this;let a;const l={};switch(t.srcEvent.code){case"Minus":a=e?s.zoomOut(n).zoomOut(n):s.zoomOut(n),l.isZooming=!0;break;case"Equal":a=e?s.zoomIn(n).zoomIn(n):s.zoomIn(n),l.isZooming=!0;break;case"ArrowLeft":e?(a=s.rotateLeft(r),l.isRotating=!0):(a=s.moveLeft(i),l.isPanning=!0);break;case"ArrowRight":e?(a=s.rotateRight(r),l.isRotating=!0):(a=s.moveRight(i),l.isPanning=!0);break;case"ArrowUp":e?(a=s.rotateUp(o),l.isRotating=!0):(a=s.moveUp(i),l.isPanning=!0);break;case"ArrowDown":e?(a=s.rotateDown(o),l.isRotating=!0):(a=s.moveDown(i),l.isPanning=!0);break;default:return!1}return this.updateViewport(a,this._getTransitionProps(),l),!0}_getTransitionProps(t){const{transition:e}=this;return e&&e.transitionInterpolator?t?{...e,transitionInterpolator:new Ta({...t,...e.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:e:Ma}}class Ba{constructor(t,e){u(this,"_viewportProps",void 0),u(this,"_state",void 0),this._viewportProps=this.applyConstraints(t),this._state=e}getViewportProps(){return this._viewportProps}getState(){return this._state}}class ja extends Ba{constructor(t){const{width:e,height:n,latitude:i,longitude:r,zoom:o,bearing:s=0,pitch:a=0,altitude:l=1.5,position:c=[0,0,0],maxZoom:h=20,minZoom:f=0,maxPitch:d=60,minPitch:p=0,startPanLngLat:g,startZoomLngLat:y,startRotatePos:v,startBearing:_,startPitch:b,startZoom:x,normalize:w=!0}=t;m(Number.isFinite(r)),m(Number.isFinite(i)),m(Number.isFinite(o)),super({width:e,height:n,latitude:i,longitude:r,zoom:o,bearing:s,pitch:a,altitude:l,maxZoom:h,minZoom:f,maxPitch:d,minPitch:p,normalize:w,position:c},{startPanLngLat:g,startZoomLngLat:y,startRotatePos:v,startBearing:_,startPitch:b,startZoom:x}),u(this,"makeViewport",void 0),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:e}){const n=this.getState().startPanLngLat||this._unproject(e);if(!n)return this;const i=this.makeViewport(this.getViewportProps()).panByPosition(n,t);return this._getUpdatedState(i)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:e=0,deltaAngleY:n=0}){const{startRotatePos:i,startBearing:r,startPitch:o}=this.getState();if(!i||void 0===r||void 0===o)return this;let s;return s=t?this._getNewRotation(t,i,o,r):{bearing:r+e,pitch:o+n},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:e,scale:n}){let{startZoom:i,startZoomLngLat:r}=this.getState();if(r||(i=this.getViewportProps().zoom,r=this._unproject(e)||this._unproject(t)),!r)return this;const{maxZoom:o,minZoom:s}=this.getViewportProps();let a=i+Math.log2(n);a=d(a,s,o);const l=this.makeViewport({...this.getViewportProps(),zoom:a});return this._getUpdatedState({zoom:a,...l.panByPosition(r,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){const e=t.getViewportProps(),n={...this.getViewportProps()},{bearing:i,longitude:r}=n;return Math.abs(i-e.bearing)>180&&(n.bearing=i<0?i+360:i-360),Math.abs(r-e.longitude)>180&&(n.longitude=r<0?r+360:r-360),n}applyConstraints(t){const{maxZoom:e,minZoom:n,zoom:i}=t;t.zoom=d(i,n,e);const{maxPitch:r,minPitch:o,pitch:s}=t;t.pitch=d(s,o,r);const{normalize:a=!0}=t;return a&&Object.assign(t,function(t){const{width:e,height:n,pitch:i=0}=t;let{longitude:r,latitude:o,zoom:s,bearing:a=0}=t;(r<-180||r>180)&&(r=S(r+180,360)-180),(a<-180||a>180)&&(a=S(a+180,360)-180);const l=C(n/512);if(s<=l)s=l,o=0;else{const t=n/2/Math.pow(2,s),e=rt([0,t])[1];if(o<e)o=e;else{const e=rt([0,512-t])[1];o>e&&(o=e)}}return{width:e,height:n,longitude:r,latitude:o,zoom:s,pitch:i,bearing:a}}(t)),t}_zoomFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.zoom({pos:[e/2,n/2],scale:t})}_panFromCenter(t){const{width:e,height:n}=this.getViewportProps();return this.pan({startPos:[e/2,n/2],pos:[e/2+t[0],n/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){const e=this.makeViewport(this.getViewportProps());return t&&e.unproject(t)}_getNewRotation(t,e,n,i){const r=t[0]-e[0],o=t[1]-e[1],s=t[1],a=e[1],{width:l,height:u}=this.getViewportProps(),c=r/l;let h=0;o>0?Math.abs(u-a)>5&&(h=o/(a-u)*1.2):o<0&&a>5&&(h=1-s/a),h=d(h,-1,1);const{minPitch:f,maxPitch:p}=this.getViewportProps();let g=n;return h>0?g=n+h*(p-n):h<0&&(g=n-h*(f-n)),{pitch:g,bearing:i+180*c}}}class Ua extends za{constructor(...t){super(...t),u(this,"ControllerState",ja),u(this,"transition",{transitionDuration:300,transitionInterpolator:new Ta({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),u(this,"dragMode","pan")}setProps(t){t.position=t.position||[0,0,0];const e=this.props;super.setProps(t),(!e||e.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}}class Va extends ba{get ViewportType(){return xa}get ControllerType(){return Ua}}u(Va,"displayName","MapView");const Ga=[255,255,255],qa=1;let Wa=0;class Ha{constructor(t={}){u(this,"id",void 0),u(this,"color",void 0),u(this,"intensity",void 0),u(this,"type","ambient");const{color:e=Ga}=t,{intensity:n=qa}=t;this.id=t.id||"ambient-".concat(Wa++),this.color=e,this.intensity=n}}const Xa=[255,255,255],Ya=1,Za=[0,0,-1];let Ka=0;class $a{constructor(t={}){u(this,"id",void 0),u(this,"color",void 0),u(this,"intensity",void 0),u(this,"type","directional"),u(this,"direction",void 0),u(this,"shadow",void 0);const{color:e=Xa}=t,{intensity:n=Ya}=t,{direction:i=Za}=t,{_shadow:r=!1}=t;this.id=t.id||"directional-".concat(Ka++),this.color=e,this.intensity=n,this.type="directional",this.direction=new Un(i).normalize().toArray(),this.shadow=r}getProjectedLight(t){return this}}class Qa{constructor(t,e={id:"pass"}){u(this,"id",void 0),u(this,"gl",void 0),u(this,"props",void 0);const{id:n}=e;this.id=n,this.gl=t,this.props={...e}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}}class Ja extends Qa{constructor(...t){super(...t),u(this,"_lastRenderIndex",-1)}render(t){return Br(this.gl,{framebuffer:t.target}),this._drawLayers(t)}_drawLayers(t){const{target:e,moduleParameters:n,viewports:i,views:r,onViewportActive:o,clearStack:s=!0,clearCanvas:a=!0}=t;t.pass=t.pass||"unknown";const l=this.gl;a&&function(t,e){Br(t,{viewport:[0,0,e?e.width:t.drawingBufferWidth,e?e.height:t.drawingBufferHeight]}),t.clear(16640)}(l,e),s&&(this._lastRenderIndex=-1);const u=[];for(const s of i){const i=r&&r[s.id];null==o||o(s);const a=this._getDrawLayerParams(s,t),c=s.subViewports||[s];for(const r of c){const o=this._drawLayersInViewport(l,{target:e,moduleParameters:n,viewport:r,view:i,pass:t.pass,layers:t.layers},a);u.push(o)}}return u}_getDrawLayerParams(t,{layers:e,pass:n,isPicking:i=!1,layerFilter:r,cullRect:o,effects:s,moduleParameters:a},l=!1){const u=[],c=tl(this._lastRenderIndex+1),h={layer:e[0],viewport:t,isPicking:i,renderPass:n,cullRect:o},f={};for(let i=0;i<e.length;i++){const o=e[i],d=this._shouldDrawLayer(o,h,r,f),p={shouldDrawLayer:d};d&&!l&&(p.layerRenderIndex=c(o,d),p.moduleParameters=this._getModuleParameters(o,s,n,a),p.layerParameters=this.getLayerParameters(o,i,t)),u[i]=p}return u}_drawLayersInViewport(t,{layers:e,moduleParameters:n,pass:i,target:r,viewport:o,view:s},a){const l=function(t,{moduleParameters:e,target:n,viewport:i}){const r=n&&"default-framebuffer"!==n.id,o=e&&e.devicePixelRatio||Ur(t),s=r?n.height:t.drawingBufferHeight,a=i;return[a.x*o,s-(a.y+a.height)*o,a.width*o,a.height*o]}(t,{moduleParameters:n,target:r,viewport:o});if(s&&s.props.clear){const e=!0===s.props.clear?{color:!0,depth:!0}:s.props.clear;jr(t,{scissorTest:!0,scissor:l},(()=>Bo(t,e)))}const u={totalCount:e.length,visibleCount:0,compositeCount:0,pickableCount:0};Br(t,{viewport:l});for(let t=0;t<e.length;t++){const n=e[t],{shouldDrawLayer:r,layerRenderIndex:s,moduleParameters:l,layerParameters:c}=a[t];if(r&&n.props.pickable&&u.pickableCount++,n.isComposite)u.compositeCount++;else if(r){u.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,s),l.viewport=o;try{n._drawLayer({moduleParameters:l,uniforms:{layerIndex:s},parameters:c})}catch(t){n.raiseError(t,"drawing ".concat(n," to ").concat(i))}}}return u}shouldDrawLayer(t){return!0}getModuleParameters(t,e){return null}getLayerParameters(t,e,n){return t.props.parameters}_shouldDrawLayer(t,e,n,i){if(!t.props.visible||!this.shouldDrawLayer(t))return!1;e.layer=t;let r=t.parent;for(;r;){if(!r.props.visible||!r.filterSubLayer(e))return!1;e.layer=r,r=r.parent}if(n){const t=e.layer.id;if(t in i||(i[t]=n(e)),!i[t])return!1}return t.activateViewport(e.viewport),!0}_getModuleParameters(t,e,n,i){var r;const o=Object.assign(Object.create((null===(r=t.internalState)||void 0===r?void 0:r.propsInTransition)||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,pickingActive:0,devicePixelRatio:Ur(this.gl)});if(e)for(const n of e){var s;Object.assign(o,null===(s=n.getModuleParameters)||void 0===s?void 0:s.call(n,t))}return Object.assign(o,this.getModuleParameters(t,e),i)}}function tl(t=0,e={}){const n={},i=(r,o)=>{const s=r.props._offset,a=r.id,l=r.parent&&r.parent.id;let u;if(l&&!(l in e)&&i(r.parent,!1),l in n){const t=n[l]=n[l]||tl(e[l],e);u=t(r,o),n[a]=t}else Number.isFinite(s)?(u=s+(e[l]||0),n[a]=null):u=t;return o&&u>=t&&(t=u+1),e[a]=u,u};return i}class el extends Ja{constructor(t,e){super(t,e),u(this,"shadowMap",void 0),u(this,"depthBuffer",void 0),u(this,"fbo",void 0),this.shadowMap=new Io(t,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new Lo(t,{format:33189,width:1,height:1}),this.fbo=new ts(t,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(t){const e=this.fbo;jr(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},(()=>{const n=t.viewports[0],i=Ur(this.gl),r=n.width*i,o=n.height*i;r===e.width&&o===e.height||e.resize({width:r,height:o}),super.render({...t,target:e,pass:"shadow"})}))}shouldDrawLayer(t){return!1!==t.props.shadowEnabled}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const nl=ea((function({viewport:t,center:e}){return new ti(t.viewProjectionMatrix).invert().transform(e)})),il=ea((function({viewport:t,shadowMatrices:e}){const n=[],i=t.pixelUnprojectionMatrix,r=t.isGeospatial?void 0:1,o=[[0,0,r],[t.width,0,r],[0,t.height,r],[t.width,t.height,r],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map((t=>function(t,e){const[n,i,r]=t,o=ht([n,i,r],e);return Number.isFinite(r)?o:[o[0],o[1],0]}(t,i)));for(const i of e){const e=i.clone().translate(new Un(t.center).negate()),r=o.map((t=>e.transform(t))),s=(new ti).ortho({left:Math.min(...r.map((t=>t[0]))),right:Math.max(...r.map((t=>t[0]))),bottom:Math.min(...r.map((t=>t[1]))),top:Math.max(...r.map((t=>t[1]))),near:Math.min(...r.map((t=>-t[2]))),far:Math.max(...r.map((t=>-t[2])))});n.push(s.multiplyRight(i))}return n})),rl=[0,0,0,1],ol=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],sl={name:"shadow",dependencies:[ca],vs:"\nconst int max_lights = 2;\nuniform mat4 shadow_uViewProjectionMatrices[max_lights];\nuniform vec4 shadow_uProjectCenters[max_lights];\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform int shadow_uLightId;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nvec4 shadow_setVertexPosition(vec4 position_commonspace) {\n  if (shadow_uDrawShadowMap) {\n    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);\n  }\n  if (shadow_uUseShadowMap) {\n    for (int i = 0; i < max_lights; i++) {\n      if(i < int(shadow_uLightCount)) {\n        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);\n        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;\n      }\n    }\n  }\n  return gl_Position;\n}\n",fs:"\nconst int max_lights = 2;\nuniform bool shadow_uDrawShadowMap;\nuniform bool shadow_uUseShadowMap;\nuniform sampler2D shadow_uShadowMap0;\nuniform sampler2D shadow_uShadowMap1;\nuniform vec4 shadow_uColor;\nuniform float shadow_uLightCount;\n\nvarying vec3 shadow_vPosition[max_lights];\n\nconst vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);\nconst vec4 bitUnpackShift = 1.0 / bitPackShift;\nconst vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);\n\nfloat shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {\n  vec4 rgbaDepth = texture2D(shadowMap, position.xy);\n\n  float z = dot(rgbaDepth, bitUnpackShift);\n  return smoothstep(0.001, 0.01, position.z - z);\n}\n\nvec4 shadow_filterShadowColor(vec4 color) {\n  if (shadow_uDrawShadowMap) {\n    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);\n    rgbaDepth -= rgbaDepth.gbaa * bitMask;\n    return rgbaDepth;\n  }\n  if (shadow_uUseShadowMap) {\n    float shadowAlpha = 0.0;\n    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);\n    if(shadow_uLightCount > 1.0) {\n      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);\n    }\n    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;\n    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);\n\n    return vec4(\n      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),\n      blendedAlpha\n    );\n  }\n  return color;\n}\n",inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    position = shadow_setVertexPosition(geometry.position);\n    ","fs:DECKGL_FILTER_COLOR":"\n    color = shadow_filterShadowColor(color);\n    "},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?function(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const i={shadow_uDrawShadowMap:Boolean(t.drawToShadowMap),shadow_uUseShadowMap:!!t.shadowMaps&&t.shadowMaps.length>0,shadow_uColor:t.shadowColor||rl,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},r=nl({viewport:t.viewport,center:e.project_uCenter}),o=[],s=il({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let n=0;n<t.shadowMatrices.length;n++){const i=s[n],a=i.clone().translate(new Un(t.viewport.center).negate());e.project_uCoordinateSystem===ri.LNGLAT&&e.project_uProjectionMode===oi.WEB_MERCATOR?(s[n]=a,o[n]=r):(s[n]=i.clone().multiplyRight(ol),o[n]=a.transform(r))}for(let e=0;e<s.length;e++)i["shadow_uViewProjectionMatrices[".concat(e,"]")]=s[e],i["shadow_uProjectCenters[".concat(e,"]")]=o[e],t.shadowMaps&&t.shadowMaps.length>0?i["shadow_uShadowMap".concat(e)]=t.shadowMaps[e]:i["shadow_uShadowMap".concat(e)]=t.dummyShadowMap;return i}(t,e):{}},al={color:[255,255,255],intensity:1},ll=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],ul=[0,0,0,200/255];class cl{constructor(t={}){u(this,"id","lighting-effect"),u(this,"props",void 0),u(this,"shadowColor",ul),u(this,"shadow",void 0),u(this,"ambientLight",void 0),u(this,"directionalLights",void 0),u(this,"pointLights",void 0),u(this,"shadowPasses",[]),u(this,"shadowMaps",[]),u(this,"dummyShadowMap",null),u(this,"programManager",void 0),u(this,"shadowMatrices",void 0),this.setProps(t)}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const e in t){const n=t[e];switch(n.type){case"ambient":this.ambientLight=n;break;case"directional":this.directionalLights.push(n);break;case"point":this.pointLights.push(n)}}this._applyDefaultLights(),this.shadow=this.directionalLights.some((t=>t.shadow)),this.props=t}preRender(t,{layers:e,layerFilter:n,viewports:i,onViewportActive:r,views:o}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),0===this.shadowPasses.length&&this._createShadowPasses(t),this.programManager||(this.programManager=Xs.getDefaultProgramManager(t),sl&&this.programManager.addDefaultModule(sl)),this.dummyShadowMap||(this.dummyShadowMap=new Io(t,{width:1,height:1}));for(let t=0;t<this.shadowPasses.length;t++)this.shadowPasses[t].render({layers:e,layerFilter:n,viewports:i,onViewportActive:r,views:o,moduleParameters:{shadowLightId:t,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){const e=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return e.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map((e=>e.getProjectedLight({layer:t}))),pointLights:this.pointLights.map((e=>e.getProjectedLight({layer:t})))},e}cleanup(){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(sl),this.programManager=null)}_calculateMatrices(){const t=[];for(const e of this.directionalLights){const n=(new ti).lookAt({eye:new Un(e.direction).negate()});t.push(n)}return t}_createShadowPasses(t){for(let e=0;e<this.directionalLights.length;e++){const n=new el(t);this.shadowPasses[e]=n,this.shadowMaps[e]=n.shadowMap}}_applyDefaultLights(){const{ambientLight:t,pointLights:e,directionalLights:n}=this;t||0!==e.length||0!==n.length||(this.ambientLight=new Ha(al),this.directionalLights.push(new $a(ll[0]),new $a(ll[1])))}}const hl=new cl;class fl{constructor(){u(this,"effects",void 0),u(this,"_resolvedEffects",[]),u(this,"_defaultEffects",[]),u(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){const e=this._defaultEffects;if(!e.find((e=>e.id===t.id))){const n=e.findIndex((e=>{return n=t,(null!==(i=e.order)&&void 0!==i?i:1/0)-(null!==(r=n.order)&&void 0!==r?r:1/0)>0;var n,i,r}));n<0?e.push(t):e.splice(n,0,t),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(ga(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}getEffects(){return this._resolvedEffects}_setEffects(t){const e={};for(const t of this.effects)e[t.id]=t;const n=[];for(const i of t){const t=e[i.id];t&&t!==i?t.setProps?(t.setProps(i.props),n.push(t)):(t.cleanup(),n.push(i)):n.push(i),delete e[i.id]}for(const t in e)e[t].cleanup();this.effects=n,this._resolvedEffects=n.concat(this._defaultEffects),t.some((t=>t instanceof cl))||this._resolvedEffects.push(hl),this._needsRedraw="effects changed"}finalize(){for(const t of this._resolvedEffects)t.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class dl extends Ja{shouldDrawLayer(t){const{operation:e}=t.props;return e.includes("draw")||e.includes("terrain")}}const pl={blendFunc:[1,0,32771,0],blendEquation:32774};class gl extends Ja{constructor(...t){super(...t),u(this,"pickZ",void 0),u(this,"_colorEncoderState",null)}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,pickingFBO:o,deviceRect:{x:s,y:a,width:l,height:u},cullRect:c,effects:h,pass:f="picking",pickZ:d,moduleParameters:p}){const g=this.gl;this.pickZ=d;const m=this._resetColorEncoder(d),y=jr(g,{scissorTest:!0,scissor:[s,a,l,u],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...pl,blend:!d},(()=>super.render({target:o,layers:t,layerFilter:e,views:n,viewports:i,onViewportActive:r,cullRect:c,effects:null==h?void 0:h.filter((t=>t.useInPicking)),pass:f,isPicking:!0,moduleParameters:p})));return this._colorEncoderState=null,{decodePickingColor:m&&ml.bind(null,m),stats:y}}shouldDrawLayer(t){const{pickable:e,operation:n}=t.props;return e&&n.includes("draw")||n.includes("terrain")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(t,e,n){const i={...t.props.parameters},{pickable:r,operation:o}=t.props;return this._colorEncoderState?r&&o.includes("draw")&&(Object.assign(i,pl),i.blend=!0,i.blendColor=function(t,e,n){const{byLayer:i,byAlpha:r}=t;let o,s=i.get(e);return s?(s.viewports.push(n),o=s.a):(o=i.size+1,o<=255?(s={a:o,layer:e,viewports:[n]},i.set(e,s),r[o]=s):($t.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}(this._colorEncoderState,t,n)):i.blend=!1,o.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function ml(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}class yl{constructor(t){u(this,"gl",void 0),u(this,"layerFilter",void 0),u(this,"drawPickingColors",void 0),u(this,"drawLayersPass",void 0),u(this,"pickLayersPass",void 0),u(this,"renderCount",void 0),u(this,"_needsRedraw",void 0),u(this,"renderBuffers",void 0),u(this,"lastPostProcessEffect",void 0),this.gl=t,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new dl(t),this.pickLayersPass=new gl(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){const e=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,n={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t,target:t.target||ts.getDefaultFramebuffer(this.gl)};n.effects&&this._preRender(n.effects,n);const i=this.lastPostProcessEffect?this.renderBuffers[0]:n.target,r=e.render({...n,target:i});n.effects&&this._postRender(n.effects,n),this.renderCount++,te("deckRenderer.renderLayers",this,r,t)}needsRedraw(t={clearRedrawFlags:!1}){const e=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),e}finalize(){const{renderBuffers:t}=this;for(const e of t)e.delete();t.length=0}_preRender(t,e){this.lastPostProcessEffect=null,e.preRenderStats=e.preRenderStats||{};for(const n of t)e.preRenderStats[n.id]=n.preRender(this.gl,e),n.postRender&&(this.lastPostProcessEffect=n.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:t}=this;0===t.length&&t.push(new ts(this.gl),new ts(this.gl));for(const e of t)e.resize()}_postRender(t,e){const{renderBuffers:n}=this,i={...e,inputBuffer:n[0],swapBuffer:n[1],target:null};for(const r of t)if(r.postRender){if(r.id===this.lastPostProcessEffect){i.target=e.target,r.postRender(this.gl,i);break}const t=r.postRender(this.gl,i);i.inputBuffer=t,i.swapBuffer=t===n[0]?n[1]:n[0]}}}const vl={pickedColor:null,pickedObjectIndex:-1};function _l({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:i,deviceRadius:r,deviceRect:o}){const{x:s,y:a,width:l,height:u}=o;let c=r*r,h=-1,f=0;for(let e=0;e<u;e++){const r=e+a-i,o=r*r;if(o>c)f+=4*l;else for(let e=0;e<l;e++){if(t[f+3]-1>=0){const t=e+s-n,i=t*t+o;i<=c&&(c=i,h=f)}f+=4}}if(h>=0){const n=t.slice(h,h+4),i=e(n);if(i){const t=Math.floor(h/4/l),e=h/4-t*l;return{...i,pickedColor:n,pickedX:s+e,pickedY:a+t}}$t.error("Picked non-existent layer. Is picking buffer corrupt?")()}return vl}function bl({pickInfo:t,viewports:e,pixelRatio:n,x:i,y:r,z:o}){let s,a=e[0];if(e.length>1&&(a=function(t,e){for(let n=t.length-1;n>=0;n--){const i=t[n];if(i.containsPixel(e))return i}return t[0]}((null==t?void 0:t.pickedViewports)||e,{x:i,y:r})),a){const t=[i-a.x,r-a.y];void 0!==o&&(t[2]=o),s=a.unproject(t)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:i,y:r,pixel:[i,r],coordinate:s,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function xl(t){const{pickInfo:e,lastPickedInfo:n,mode:i,layers:r}=t,{pickedColor:o,pickedLayer:s,pickedObjectIndex:a}=e,l=s?[s]:[];if("hover"===i){const t=n.index,e=n.layerId,i=s?s.props.id:null;if(i!==e||a!==t){if(i!==e){const t=r.find((t=>t.props.id===e));t&&l.unshift(t)}n.layerId=i,n.index=a,n.info=null}}const u=bl(t),c=new Map;return c.set(null,u),l.forEach((t=>{let e={...u};t===s&&(e.color=o,e.index=a,e.picked=!0),e=wl({layer:t,info:e,mode:i});const r=e.layer;t===s&&"hover"===i&&(n.info=e),c.set(r.id,e),"hover"===i&&r.updateAutoHighlight(e)})),c}function wl({layer:t,info:e,mode:n}){for(;t&&e;){const i=e.layer||null;e.sourceLayer=i,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:i}),t=t.parent}return e}class El{constructor(t){u(this,"gl",void 0),u(this,"pickingFBO",void 0),u(this,"depthFBO",void 0),u(this,"pickLayersPass",void 0),u(this,"layerFilter",void 0),u(this,"lastPickedInfo",void 0),u(this,"_pickable",!0),this.gl=t,this.pickLayersPass=new gl(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:e,layers:n,viewports:i},r=this.lastPickedInfo.info){const o=r&&r.layer&&r.layer.id,s=r&&r.viewport&&r.viewport.id,a=o?n.find((t=>t.id===o)):null,l=s&&i.find((t=>t.id===s))||i[0],u=l&&l.unproject([t-l.x,e-l.y]),c={x:t,y:e,viewport:l,coordinate:u,layer:a};return{...r,...c}}_resizeBuffer(){var t,e;const{gl:n}=this;if(!this.pickingFBO&&(this.pickingFBO=new ts(n),ts.isSupported(n,{colorBufferFloat:!0}))){const t=new ts(n);t.attach({36064:new Io(n,{format:sr(n)?34836:6408,type:5126})}),this.depthFBO=t}null===(t=this.pickingFBO)||void 0===t||t.resize({width:n.canvas.width,height:n.canvas.height}),null===(e=this.depthFBO)||void 0===e||e.resize({width:n.canvas.width,height:n.canvas.height})}_getPickable(t){if(!1===this._pickable)return null;const e=t.filter((t=>this.pickLayersPass.shouldDrawLayer(t)&&!t.isComposite));return e.length?e:null}_pickClosestObject({layers:t,views:e,viewports:n,x:i,y:r,radius:o=0,depth:s=1,mode:a="query",unproject3D:l,onViewportActive:u,effects:c}){const h=this._getPickable(t),f=Ur(this.gl);if(!h)return{result:[],emptyInfo:bl({viewports:n,x:i,y:r,pixelRatio:f})};this._resizeBuffer();const d=Vr(this.gl,[i,r],!0),p=[d.x+Math.floor(d.width/2),d.y+Math.floor(d.height/2)],g=Math.round(o*f),{width:m,height:y}=this.pickingFBO,v=this._getPickingRect({deviceX:p[0],deviceY:p[1],deviceRadius:g,deviceWidth:m,deviceHeight:y}),_={x:i-o,y:r-o,width:2*o+1,height:2*o+1};let b;const x=[],w=new Set;for(let t=0;t<s;t++){let o,d;if(o=v?_l({...this._drawAndSample({layers:h,views:e,viewports:n,onViewportActive:u,deviceRect:v,cullRect:_,effects:c,pass:"picking:".concat(a)}),deviceX:p[0],deviceY:p[1],deviceRadius:g,deviceRect:v}):{pickedColor:null,pickedObjectIndex:-1},o.pickedLayer&&l&&this.depthFBO){const{pickedColors:t}=this._drawAndSample({layers:[o.pickedLayer],views:e,viewports:n,onViewportActive:u,deviceRect:{x:o.pickedX,y:o.pickedY,width:1,height:1},cullRect:_,effects:c,pass:"picking:".concat(a,":z")},!0);t[3]&&(d=t[0])}o.pickedLayer&&t+1<s&&(w.add(o.pickedLayer),o.pickedLayer.disablePickingIndex(o.pickedObjectIndex)),b=xl({pickInfo:o,lastPickedInfo:this.lastPickedInfo,mode:a,layers:h,viewports:n,x:i,y:r,z:d,pixelRatio:f});for(const t of b.values())t.layer&&x.push(t);if(!o.pickedColor)break}for(const t of w)t.restorePickingColors();return{result:x,emptyInfo:b.get(null)}}_pickVisibleObjects({layers:t,views:e,viewports:n,x:i,y:r,width:o=1,height:s=1,mode:a="query",maxObjects:l=null,onViewportActive:u,effects:c}){const h=this._getPickable(t);if(!h)return[];this._resizeBuffer();const f=Ur(this.gl),d=Vr(this.gl,[i,r],!0),p=d.x,g=d.y+d.height,m=Vr(this.gl,[i+o,r+s],!0),y=m.x+m.width,v=m.y,_={x:p,y:v,width:y-p,height:g-v},b=function({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t)for(let i=0;i<t.length;i+=4)if(t[i+3]-1>=0){const r=t.slice(i,i+4),o=r.join(",");if(!n.has(o)){const t=e(r);t?n.set(o,{...t,color:r}):$t.error("Picked non-existent layer. Is picking buffer corrupt?")()}}return Array.from(n.values())}(this._drawAndSample({layers:h,views:e,viewports:n,onViewportActive:u,deviceRect:_,cullRect:{x:i,y:r,width:o,height:s},effects:c,pass:"picking:".concat(a)})),x=new Map,w=Number.isFinite(l);for(let t=0;t<b.length&&!(w&&l&&x.size>=l);t++){const e=b[t];let n={color:e.pickedColor,layer:null,index:e.pickedObjectIndex,picked:!0,x:i,y:r,pixelRatio:f};n=wl({layer:e.pickedLayer,info:n,mode:a}),x.has(n.object)||x.set(n.object,n)}return Array.from(x.values())}_drawAndSample({layers:t,views:e,viewports:n,onViewportActive:i,deviceRect:r,cullRect:o,effects:s,pass:a},l=!1){const u=l?this.depthFBO:this.pickingFBO,c={layers:t,layerFilter:this.layerFilter,views:e,viewports:n,onViewportActive:i,pickingFBO:u,deviceRect:r,cullRect:o,effects:s,pass:a,pickZ:l,preRenderStats:{}};for(const t of s)t.useInPicking&&(c.preRenderStats[t.id]=t.preRender(this.gl,c));const{decodePickingColor:h}=this.pickLayersPass.render(c),{x:f,y:d,width:p,height:g}=r,m=new(l?Float32Array:Uint8Array)(p*g*4);return qo(u,{sourceX:f,sourceY:d,sourceWidth:p,sourceHeight:g,target:m}),{pickedColors:m,decodePickingColor:h}}_getPickingRect({deviceX:t,deviceY:e,deviceRadius:n,deviceWidth:i,deviceHeight:r}){const o=Math.max(0,t-n),s=Math.max(0,e-n),a=Math.min(i,t+n+1)-o,l=Math.min(r,e+n+1)-s;return a<=0||l<=0?null:{x:o,y:s,width:a,height:l}}}const Sl={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class Pl{constructor(t){u(this,"el",null),u(this,"isVisible",!1);const e=t.parentElement;e&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,Sl),e.appendChild(this.el))}setTooltip(t,e,n){const i=this.el;if(i){if("string"==typeof t)i.innerText=t;else{if(!t)return this.isVisible=!1,void(i.style.display="none");t.text&&(i.innerText=t.text),t.html&&(i.innerHTML=t.html),t.className&&(i.className=t.className),Object.assign(i.style,t.style)}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(e,"px, ").concat(n,"px)")}}remove(){this.el&&(this.el.remove(),this.el=null)}}const{_parseImageNode:Cl}=globalThis,Il="undefined"!=typeof Image,Tl="undefined"!=typeof ImageBitmap,Ml=Boolean(Cl),Ll=!!Oe||Ml;function Al(t){const e=function(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}(t);if(!e)throw new Error("Not an image");return e}const Ol=/^data:image\/svg\+xml/,Nl=/\.svg((\?|#).*)?$/;function Rl(t){return t&&(Ol.test(t)||Nl.test(t))}function kl(t,e){if(Rl(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Dl(t,e,n){const i=function(t,e){if(Rl(e)){let e=(new TextDecoder).decode(t);try{"function"==typeof unescape&&"function"==typeof encodeURIComponent&&(e=unescape(encodeURIComponent(e)))}catch(t){throw new Error(t.message)}return"data:image/svg+xml;base64,".concat(btoa(e))}return kl(t,e)}(t,n),r=self.URL||self.webkitURL,o="string"!=typeof i&&r.createObjectURL(i);try{return await async function(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise(((e,i)=>{try{n.onload=()=>e(n),n.onerror=e=>i(new Error("Could not load image ".concat(t,": ").concat(e)))}catch(t){i(t)}}))}(o||i,e)}finally{o&&r.revokeObjectURL(o)}}const Fl={};let zl=!0;const Bl=!1,jl=!0;function Ul(t){const e=Vl(t);return function(t){const e=Vl(t);return e.byteLength>=24&&2303741511===e.getUint32(0,Bl)?{mimeType:"image/png",width:e.getUint32(16,Bl),height:e.getUint32(20,Bl)}:null}(e)||function(t){const e=Vl(t);if(!(e.byteLength>=3&&65496===e.getUint16(0,Bl)&&255===e.getUint8(2)))return null;const{tableMarkers:n,sofMarkers:i}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}();let r=2;for(;r+9<e.byteLength;){const t=e.getUint16(r,Bl);if(i.has(t))return{mimeType:"image/jpeg",height:e.getUint16(r+5,Bl),width:e.getUint16(r+7,Bl)};if(!n.has(t))return null;r+=2,r+=e.getUint16(r,Bl)}return null}(e)||function(t){const e=Vl(t);return e.byteLength>=10&&1195984440===e.getUint32(0,Bl)?{mimeType:"image/gif",width:e.getUint16(6,jl),height:e.getUint16(8,jl)}:null}(e)||function(t){const e=Vl(t);return e.byteLength>=14&&16973===e.getUint16(0,Bl)&&e.getUint32(2,jl)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,jl),height:e.getUint32(22,jl)}:null}(e)}function Vl(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}const Gl={id:"image",module:"images",name:"Images",version:"3.3.1",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,n){const i=((e=e||{}).image||{}).type||"auto",{url:r}=n||{};let o;switch(function(t){switch(t){case"auto":case"data":return function(){if(Tl)return"imagebitmap";if(Il)return"image";if(Ll)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return function(t){switch(t){case"auto":return Tl||Il||Ll;case"imagebitmap":return Tl;case"image":return Il;case"data":return Ll;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}(t),t}}(i)){case"imagebitmap":o=await async function(t,e,n){let i;i=Rl(n)?await Dl(t,e,n):kl(t,n);const r=e&&e.imagebitmap;return await async function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!function(t){for(const e in t||Fl)return!1;return!0}(e)&&zl||(e=null),e)try{return await createImageBitmap(t,e)}catch(t){console.warn(t),zl=!1}return await createImageBitmap(t)}(i,r)}(t,e,r);break;case"image":o=await Dl(t,e,r);break;case"data":o=await async function(t,e){const{mimeType:n}=Ul(t)||{},i=globalThis._parseImageNode;return me(i),await i(t,n)}(t);break;default:me(!1)}return"data"===i&&(o=function(t){switch(Al(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}(o)),o},tests:[t=>Boolean(Ul(new DataView(t)))],options:{image:{type:"auto",decode:!0}}},ql={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:function(t){const e=t[0],n=t[t.length-1];return"{"===e&&"}"===n||"["===e&&"]"===n},parseTextSync:JSON.parse},Wl=function(){const t="8.9.2",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||($t.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:$t,_registerLoggers:Jt},function(t){const e=yn();t=Array.isArray(t)?t:[t];for(const n of t){const t=ve(n);e.find((e=>t===e))||e.unshift(t)}}([ql,[Gl,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}(),Hl=globalThis;function Xl(t){if(!t&&!At())return"Node";if(Lt(t))return"Electron";const e="undefined"!=typeof navigator?navigator:{},n=t||e.userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const i=-1!==n.indexOf("MSIE "),r=-1!==n.indexOf("Trident/");return i||r?"IE":Hl.chrome?"Chrome":Hl.safari?"Safari":Hl.mozInnerScreenX?"Firefox":"Unknown"}class Yl extends ao{get[Symbol.toStringTag](){return"Query"}static isSupported(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=sr(t),i=$o(t,Xo);let r=n||i;for(const t of e)switch(t){case"queries":r=r&&n;break;case"timers":r=r&&i;break;default:Qr(!1)}return r}constructor(t){super(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(35007)}beginOcclusionQuery(){let{conservative:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.begin(t?36202:35887)}beginTransformFeedbackQuery(){return this.begin(35976)}begin(t){return this._queryPending||(this.target=t,this.gl2.beginQuery(this.target,this.handle)),this}end(){return this._queryPending||this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this}isResultAvailable(){if(!this._queryPending)return!1;const t=this.gl2.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.gl2.getParameter(36795)}getResult(){return this.gl2.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let e=0;return this._pollingPromise=new Promise(((n,i)=>{const r=()=>{this.isResultAvailable()?(n(this.getResult()),this._pollingPromise=null):e++>t?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(r)};requestAnimationFrame(r)})),this._pollingPromise}_createHandle(){return Yl.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}const Zl=At()&&"undefined"!=typeof document;let Kl=0;class $l{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{onCreateContext:e=(t=>Yr(t)),onAddHTML:n=null,onInitialize:i=(()=>{}),onRender:r=(()=>{}),onFinalize:o=(()=>{}),onError:s,gl:a=null,glOptions:l={},debug:u=!1,createFramebuffer:c=!1,autoResizeViewport:h=!0,autoResizeDrawingBuffer:f=!0,stats:d=$r.get("animation-loop-".concat(Kl++))}=t;let{useDevicePixels:p=!0}=t;"useDevicePixelRatio"in t&&(er.deprecated("useDevicePixelRatio","useDevicePixels")(),p=t.useDevicePixelRatio),this.props={onCreateContext:e,onAddHTML:n,onInitialize:i,onRender:r,onFinalize:o,onError:s,gl:a,glOptions:l,debug:u,createFramebuffer:c},this.gl=a,this.needsRedraw=null,this.timeline=null,this.stats=d,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:h,autoResizeDrawingBuffer:f,useDevicePixels:p}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(t){return Qr("string"==typeof t),this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.autoResizeViewport=t.autoResizeViewport),"autoResizeDrawingBuffer"in t&&(this.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer),"useDevicePixels"in t&&(this.useDevicePixels=t.useDevicePixels),this}start(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._running)return this;this._running=!0;const e=this._getPageLoadPromise().then((()=>!this._running||this._initialized?null:(this._createWebGLContext(t),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=Yl.isSupported(this.gl,["timers"])?new Yl(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps)))).then((t=>{this._running&&(this._addCallbackData(t||{}),!1!==t&&this._startLoop())}));return this.props.onError&&e.catch(this.props.onError),this}redraw(){return this.isContextLost()||(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers()),this}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise((t=>{this._resolveNextFrame=t}))),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;const n=document.getElementById(t);return n?Number(n.value):e}setViewParameters(){return er.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const t=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(t))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(t)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=Zl?new Promise(((t,e)=>{Zl&&"complete"===document.readyState?t(document):window.addEventListener("load",(()=>{t(document)}))})):Promise.resolve({})),this._pageLoadPromise}_setDisplay(t){this.display&&(this.display.delete(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_cancelAnimationFrame(t){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e));var e}_requestAnimationFrame(t){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(t):(e=t,"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60));var e}_renderFrame(){this.display?this.display._renderFrame(...arguments):this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:t,height:e,aspect:n}=this._getSizeAndAspect();t===this.animationProps.width&&e===this.animationProps.height||this.setNeedsRedraw("drawing buffer resized"),n!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=e,this.animationProps.aspect=n,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(t){"object"==typeof t&&null!==t&&(this.animationProps=Object.assign({},this.animationProps,t))}_createWebGLContext(t){if(this.offScreen=t.canvas&&"undefined"!=typeof OffscreenCanvas&&t.canvas instanceof OffscreenCanvas,t=Object.assign({},t,this.props.glOptions),this.gl=this.props.gl?Zr(this.props.gl,t):this.onCreateContext(t),!or(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");Br(this.gl,xr),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";const e=document.createElement("div");e.style.position="absolute",e.style.left="10px",e.style.bottom="10px",e.style.width="300px",e.style.background="white",t.appendChild(this.gl.canvas),t.appendChild(e);const n=this.props.onAddHTML(e);n&&(e.innerHTML=n)}}_getSizeAndAspect(){const t=this.gl.drawingBufferWidth,e=this.gl.drawingBufferHeight;let n=1;const{canvas:i}=this.gl;return i&&i.clientHeight?n=i.clientWidth/i.clientHeight:t>0&&e>0&&(n=t/e),{width:t,height:e,aspect:n}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(t.canvas)return void function(t,e,n){let i="width"in n?n.width:t.canvas.clientWidth,r="height"in n?n.height:t.canvas.clientHeight;i&&r||(er.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,i=t.canvas.width||1,r=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const o=t.luma.canvasSizeInfo;if(o.clientWidth!==i||o.clientHeight!==r||o.devicePixelRatio!==e){let n=e;const o=Math.floor(i*n),s=Math.floor(r*n);t.canvas.width=o,t.canvas.height=s,t.drawingBufferWidth===o&&t.drawingBufferHeight===s||(er.warn("Device pixel ratio clamped")(),n=Math.min(t.drawingBufferWidth/i,t.drawingBufferHeight/r),t.canvas.width=Math.floor(i*n),t.canvas.height=Math.floor(r*n)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:i,clientHeight:r,devicePixelRatio:e})}}(t,function(t){const e="undefined"==typeof window?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}(e.useDevicePixels),e);const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new ts(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:t}=this.gl;t&&(t.addEventListener("mousemove",this._onMousemove),t.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(t){this.animationProps._mousePosition=[t.offsetX,t.offsetY]}_onMouseleave(t){this.animationProps._mousePosition=null}}var Ql=s(840);const Jl={mousedown:1,mousemove:2,mouseup:4};!function(t){const e=t.prototype.handler;t.prototype.handler=function(t){const n=this.store;t.button>0&&"pointerdown"===t.type&&(function(e,n){for(let n=0;n<e.length;n++)if(e[n].pointerId===t.pointerId)return!0;return!1}(n)||n.push(t)),e.call(this,t)}}(Ql.PointerEventInput),Ql.MouseInput.prototype.handler=function(t){let e=Jl[t.type];1&e&&t.button>=0&&(this.pressed=!0),2&e&&0===t.which&&(e=4),this.pressed&&(4&e&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))};const tu=Ql.Manager,eu=Ql;class nu{constructor(t,e,n){this.element=t,this.callback=e,this.options={enable:!0,...n}}}const iu=eu?[[eu.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[eu.Rotate,{enable:!1}],[eu.Pinch,{enable:!1}],[eu.Swipe,{enable:!1}],[eu.Pan,{threshold:0,enable:!1}],[eu.Press,{enable:!1}],[eu.Tap,{event:"doubletap",taps:2,enable:!1}],[eu.Tap,{event:"anytap",enable:!1}],[eu.Tap,{enable:!1}]]:null,ru={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},ou={doubletap:["tap"]},su={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},au={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},lu={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},uu={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},cu="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",hu="undefined"!=typeof window?window:s.g;void 0!==s.g?s.g:window,"undefined"!=typeof document&&document;let fu=!1;try{const t={get passive(){return fu=!0,!0}};hu.addEventListener("test",null,t),hu.removeEventListener("test",null)}catch(t){fu=!1}const du=-1!==cu.indexOf("firefox"),{WHEEL_EVENTS:pu}=au,gu="wheel",mu=4.000244140625;class yu extends nu{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{if(!this.options.enable)return;let e=t.deltaY;hu.WheelEvent&&(du&&t.deltaMode===hu.WheelEvent.DOM_DELTA_PIXEL&&(e/=hu.devicePixelRatio),t.deltaMode===hu.WheelEvent.DOM_DELTA_LINE&&(e*=40)),0!==e&&e%mu==0&&(e=Math.floor(e/mu)),t.shiftKey&&e&&(e*=.25),this.callback({type:gu,center:{x:t.clientX,y:t.clientY},delta:-e,srcEvent:t,pointerType:"mouse",target:t.target})},this.events=(this.options.events||[]).concat(pu),this.events.forEach((e=>t.addEventListener(e,this.handleEvent,!!fu&&{passive:!1})))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===gu&&(this.options.enable=e)}}const{MOUSE_EVENTS:vu}=au,_u="pointermove",bu="pointerover",xu="pointerout",wu="pointerenter",Eu="pointerleave";class Su extends nu{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.handleOverEvent(t),this.handleOutEvent(t),this.handleEnterEvent(t),this.handleLeaveEvent(t),this.handleMoveEvent(t)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(vu),this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===_u&&(this.enableMoveEvent=e),t===bu&&(this.enableOverEvent=e),t===xu&&(this.enableOutEvent=e),t===wu&&(this.enableEnterEvent=e),t===Eu&&(this.enableLeaveEvent=e)}handleOverEvent(t){this.enableOverEvent&&"mouseover"===t.type&&this._emit(bu,t)}handleOutEvent(t){this.enableOutEvent&&"mouseout"===t.type&&this._emit(xu,t)}handleEnterEvent(t){this.enableEnterEvent&&"mouseenter"===t.type&&this._emit(wu,t)}handleLeaveEvent(t){this.enableLeaveEvent&&"mouseleave"===t.type&&this._emit(Eu,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":0===t.which&&(this.pressed=!1),this.pressed||this._emit(_u,t);break;case"mouseup":this.pressed=!1}}_emit(t,e){this.callback({type:t,center:{x:e.clientX,y:e.clientY},srcEvent:e,pointerType:"mouse",target:e.target})}}const{KEY_EVENTS:Pu}=au,Cu="keydown",Iu="keyup";class Tu extends nu{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{const e=t.target||t.srcElement;"INPUT"===e.tagName&&"text"===e.type||"TEXTAREA"===e.tagName||(this.enableDownEvent&&"keydown"===t.type&&this.callback({type:Cu,srcEvent:t,key:t.key,target:t.target}),this.enableUpEvent&&"keyup"===t.type&&this.callback({type:Iu,srcEvent:t,key:t.key,target:t.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Pu),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach((e=>t.addEventListener(e,this.handleEvent)))}destroy(){this.events.forEach((t=>this.element.removeEventListener(t,this.handleEvent)))}enableEventType(t,e){t===Cu&&(this.enableDownEvent=e),t===Iu&&(this.enableUpEvent=e)}}const Mu="contextmenu";class Lu extends nu{constructor(t,e,n){super(t,e,n),this.handleEvent=t=>{this.options.enable&&this.callback({type:Mu,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,e){t===Mu&&(this.options.enable=e)}}const Au=1,Ou=2,Nu=4,Ru={pointerdown:Au,pointermove:Ou,pointerup:Nu,mousedown:Au,mousemove:Ou,mouseup:Nu},ku=1,Du=2,Fu=3,zu=0,Bu=1,ju=2,Uu=1,Vu=2,Gu=4;function qu(t){const e=Ru[t.srcEvent.type];if(!e)return null;const{buttons:n,button:i,which:r}=t.srcEvent;let o=!1,s=!1,a=!1;return e===Nu||e===Ou&&!Number.isFinite(n)?(o=r===ku,s=r===Du,a=r===Fu):e===Ou?(o=Boolean(n&Uu),s=Boolean(n&Gu),a=Boolean(n&Vu)):e===Au&&(o=i===zu,s=i===Bu,a=i===ju),{leftButton:o,middleButton:s,rightButton:a}}function Wu(t,e){const n=t.center;if(!n)return null;const i=e.getBoundingClientRect(),r=i.width/e.offsetWidth||1,o=i.height/e.offsetHeight||1;return{center:n,offsetCenter:{x:(n.x-i.left-e.clientLeft)/r,y:(n.y-i.top-e.clientTop)/o}}}const Hu={srcElement:"root",priority:0};class Xu{constructor(t){this.handleEvent=t=>{if(this.isEmpty())return;const e=this._normalizeEvent(t);let n=t.srcEvent.target;for(;n&&n!==e.rootElement;){if(this._emit(e,n),e.handled)return;n=n.parentNode}this._emit(e,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,e,n,i=!1,r=!1){const{handlers:o,handlersByElement:s}=this;let a=Hu;"string"==typeof n||n&&n.addEventListener?a={...Hu,srcElement:n}:n&&(a={...Hu,...n});let l=s.get(a.srcElement);l||(l=[],s.set(a.srcElement,l));const u={type:t,handler:e,srcElement:a.srcElement,priority:a.priority};i&&(u.once=!0),r&&(u.passive=!0),o.push(u),this._active=this._active||!u.passive;let c=l.length-1;for(;c>=0&&!(l[c].priority>=u.priority);)c--;l.splice(c+1,0,u)}remove(t,e){const{handlers:n,handlersByElement:i}=this;for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.type===t&&o.handler===e){n.splice(r,1);const t=i.get(o.srcElement);t.splice(t.indexOf(o),1),0===t.length&&i.delete(o.srcElement)}}this._active=n.some((t=>!t.passive))}_emit(t,e){const n=this.handlersByElement.get(e);if(n){let e=!1;const i=()=>{t.handled=!0},r=()=>{t.handled=!0,e=!0},o=[];for(let s=0;s<n.length;s++){const{type:a,handler:l,once:u}=n[s];if(l({...t,type:a,stopPropagation:i,stopImmediatePropagation:r}),u&&o.push(n[s]),e)break}for(let t=0;t<o.length;t++){const{type:e,handler:n}=o[t];this.remove(e,n)}}}_normalizeEvent(t){const e=this.eventManager.getElement();return{...t,...qu(t),...Wu(t,e),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:e}}}const Yu={events:null,recognizers:null,recognizerOptions:{},Manager:tu,touchAction:"none",tabIndex:0};class Zu{constructor(t=null,e){this._onBasicInput=t=>{const{srcEvent:e}=t,n=su[e.type];n&&this.manager.emit(n,t)},this._onOtherEvent=t=>{this.manager.emit(t.type,t)},this.options={...Yu,...e},this.events=new Map,this.setElement(t);const{events:n}=this.options;n&&this.on(n)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;const{options:e}=this,n=e.Manager;this.manager=new n(t,{touchAction:e.touchAction,recognizers:e.recognizers||iu}).on("hammer.input",this._onBasicInput),e.recognizers||Object.keys(ru).forEach((t=>{const e=this.manager.get(t);e&&ru[t].forEach((t=>{e.recognizeWith(t)}))}));for(const t in e.recognizerOptions){const n=this.manager.get(t);if(n){const i=e.recognizerOptions[t];delete i.enable,n.set(i)}}this.wheelInput=new yu(t,this._onOtherEvent,{enable:!1}),this.moveInput=new Su(t,this._onOtherEvent,{enable:!1}),this.keyInput=new Tu(t,this._onOtherEvent,{enable:!1,tabIndex:e.tabIndex}),this.contextmenuInput=new Lu(t,this._onOtherEvent,{enable:!1});for(const[t,e]of this.events)e.isEmpty()||(this._toggleRecognizer(e.recognizerName,!0),this.manager.on(t,e.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,e,n){this._addEventHandler(t,e,n,!1)}once(t,e,n){this._addEventHandler(t,e,n,!0)}watch(t,e,n){this._addEventHandler(t,e,n,!1,!0)}off(t,e){this._removeEventHandler(t,e)}_toggleRecognizer(t,e){const{manager:n}=this;if(!n)return;const i=n.get(t);if(i&&i.options.enable!==e){i.set({enable:e});const r=ou[t];r&&!this.options.recognizers&&r.forEach((r=>{const o=n.get(r);e?(o.requireFailure(t),i.dropRequireFailure(r)):o.dropRequireFailure(t)}))}this.wheelInput.enableEventType(t,e),this.moveInput.enableEventType(t,e),this.keyInput.enableEventType(t,e),this.contextmenuInput.enableEventType(t,e)}_addEventHandler(t,e,n,i,r){if("string"!=typeof t){n=e;for(const e in t)this._addEventHandler(e,t[e],n,i,r);return}const{manager:o,events:s}=this,a=uu[t]||t;let l=s.get(a);l||(l=new Xu(this),s.set(a,l),l.recognizerName=lu[a]||a,o&&o.on(a,l.handleEvent)),l.add(t,e,n,i,r),l.isEmpty()||this._toggleRecognizer(l.recognizerName,!0)}_removeEventHandler(t,e){if("string"!=typeof t){for(const e in t)this._removeEventHandler(e,t[e]);return}const{events:n}=this,i=uu[t]||t,r=n.get(i);if(r&&(r.remove(t,e),r.isEmpty())){const{recognizerName:t}=r;let e=!1;for(const i of n.values())if(i.recognizerName===t&&!i.isEmpty()){e=!0;break}e||this._toggleRecognizer(t,!1)}}}function Ku(){}const $u={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:Ku,onResize:Ku,onViewStateChange:Ku,onInteractionStateChange:Ku,onBeforeRender:Ku,onAfterRender:Ku,onLoad:Ku,onError:t=>$t.error(t.message)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:({isDragging:t})=>t?"grabbing":"grab",getTooltip:null,debug:!1,drawPickingColors:!1};class Qu{constructor(t){u(this,"props",void 0),u(this,"width",0),u(this,"height",0),u(this,"userData",{}),u(this,"canvas",null),u(this,"viewManager",null),u(this,"layerManager",null),u(this,"effectManager",null),u(this,"deckRenderer",null),u(this,"deckPicker",null),u(this,"eventManager",null),u(this,"tooltip",null),u(this,"metrics",void 0),u(this,"animationLoop",void 0),u(this,"stats",void 0),u(this,"viewState",void 0),u(this,"cursorState",void 0),u(this,"_needsRedraw",void 0),u(this,"_pickRequest",void 0),u(this,"_lastPointerDownInfo",null),u(this,"_metricsCounter",void 0),u(this,"_onPointerMove",(t=>{const{_pickRequest:e}=this;if("pointerleave"===t.type)e.x=-1,e.y=-1,e.radius=0;else{if(t.leftButton||t.rightButton)return;{const n=t.offsetCenter;if(!n)return;e.x=n.x,e.y=n.y,e.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:e.x,y:e.y}),e.event=t})),u(this,"_onEvent",(t=>{const e=ai[t.type],n=t.offsetCenter;if(!e||!n||!this.layerManager)return;const i=this.layerManager.getLayers(),r=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:i,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:o}=r,s=o&&(o[e.handler]||o.props[e.handler]),a=this.props[e.handler];let l=!1;s&&(l=s.call(o,r,t)),!l&&a&&a(r,t)})),u(this,"_onPointerDown",(t=>{const e=t.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:e.x,y:e.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo})),this.props={...$u,...t},t=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},t.viewState&&t.initialViewState&&$t.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),"IE"===Xl()&&$t.warn("IE 11 is not supported")(),this.viewState=t.initialViewState,t.gl||"undefined"!=typeof document&&(this.canvas=this._createCanvas(t)),this.animationLoop=this._createAnimationLoop(t),this.stats=new se({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(t),t._typedArrayManagerProps&&An.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){var t,e,n,i,r,o,s,a;this.animationLoop.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,null===(t=this.layerManager)||void 0===t||t.finalize(),this.layerManager=null,null===(e=this.viewManager)||void 0===e||e.finalize(),this.viewManager=null,null===(n=this.effectManager)||void 0===n||n.finalize(),this.effectManager=null,null===(i=this.deckRenderer)||void 0===i||i.finalize(),this.deckRenderer=null,null===(r=this.deckPicker)||void 0===r||r.finalize(),this.deckPicker=null,null===(o=this.eventManager)||void 0===o||o.destroy(),this.eventManager=null,null===(s=this.tooltip)||void 0===s||s.remove(),this.tooltip=null,this.props.canvas||this.props.gl||!this.canvas||(null===(a=this.canvas.parentElement)||void 0===a||a.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&$t.removed("onLayerHover","onHover")(),"onLayerClick"in t&&$t.removed("onLayerClick","onClick")(),t.initialViewState&&!ga(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);const e=Object.create(this.props);Object.assign(e,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(e),this.layerManager&&(this.viewManager.setProps(e),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(e),this.effectManager.setProps(e),this.deckRenderer.setProps(e),this.deckPicker.setProps(e)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let e=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);const n=this.viewManager.needsRedraw(t),i=this.layerManager.needsRedraw(t),r=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return e=e||n||i||r||o,e}redraw(t){if(!this.layerManager)return;let e=this.needsRedraw({clearRedrawFlags:!0});e=t||e,e&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(e):this._drawLayers(e))}get isInitialized(){return null!==this.viewManager}getViews(){return m(this.viewManager),this.viewManager.views}getViewports(t){return m(this.viewManager),this.viewManager.getViewports(t)}pickObject(t){const e=this._pick("pickObject","pickObject Time",t).result;return e.length?e[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,e=!1){for(const n in t)this.layerManager.resourceManager.add({resourceId:n,data:t[n],forceUpdate:e})}_removeResources(t){for(const e of t)this.layerManager.resourceManager.remove(e)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_pick(t,e,n){m(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(e).timeStart();const r=this.deckPicker[t]({layers:this.layerManager.getLayers(n),views:this.viewManager.getViews(),viewports:this.getViewports(n),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...n});return i.get(e).timeEnd(),r}_createCanvas(t){let e=t.canvas;return"string"==typeof e&&(e=document.getElementById(e),m(e)),e||(e=document.createElement("canvas"),e.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(e)),Object.assign(e.style,t.style),e}_setCanvasSize(t){if(!this.canvas)return;const{width:e,height:n}=t;if(e||0===e){const t=Number.isFinite(e)?"".concat(e,"px"):e;this.canvas.style.width=t}if(n||0===n){var i;const e=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.position=(null===(i=t.style)||void 0===i?void 0:i.position)||"absolute",this.canvas.style.height=e}}_updateCanvasSize(){const{canvas:t}=this;if(!t)return;const e=t.clientWidth||t.width,n=t.clientHeight||t.height;var i;e===this.width&&n===this.height||(this.width=e,this.height=n,null===(i=this.viewManager)||void 0===i||i.setProps({width:e,height:n}),this.props.onResize({width:e,height:n}))}_createAnimationLoop(t){const{width:e,height:n,gl:i,glOptions:r,debug:o,onError:s,onBeforeRender:a,onAfterRender:l,useDevicePixels:u}=t;return new $l({width:e,height:n,useDevicePixels:u,autoResizeViewport:!1,gl:i,onCreateContext:t=>Yr({...r,...t,canvas:this.canvas,debug:o,onContextLost:()=>this._onContextLost()}),onInitialize:t=>this._setGLContext(t.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:a,onAfterRender:l,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let t=this.props.views||[new Va({id:"default-view"})];return t=Array.isArray(t)?t:[t],t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:t}=this;if(t.event){const{result:n,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=n.length>0;let r=i,o=!1;for(const i of n){var e;r=i,o=(null===(e=i.layer)||void 0===e?void 0:e.onHover(i,t.event))||o}if(!o&&this.props.onHover&&this.props.onHover(r,t.event),this.props.getTooltip&&this.tooltip){const t=this.props.getTooltip(r);this.tooltip.setTooltip(t,r.x,r.y)}t.event=null}}_updateCursor(){const t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(t){if(this.layerManager)return;this.canvas||(this.canvas=t.canvas,Zr(t,{enable:!0,copyState:!0})),this.tooltip=new Pl(this.canvas),Br(t,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(t);const e=new Et;e.play(),this.animationLoop.attachTimeline(e),this.eventManager=new Zu(this.props.parent||t.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const t in ai)this.eventManager.on(t,this._onEvent);this.viewManager=new ma({timeline:e,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const n=this.viewManager.getViewports()[0];this.layerManager=new pa(t,{deck:this,stats:this.stats,viewport:n,timeline:e}),this.effectManager=new fl,this.deckRenderer=new yl(t),this.deckPicker=new El(t),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,e){const{gl:n}=this.layerManager.context;Br(n,this.props.parameters),this.props.onBeforeRender({gl:n}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...e}),this.props.onAfterRender({gl:n})}_onRenderFrame(t){this._getFrameStats(),this._metricsCounter++%60==0&&(this._getMetrics(),this.stats.reset(),$t.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){const e=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:e},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){const{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();const e=this.animationLoop.stats;t.get("GPU Time").addTime(e.get("GPU Time").lastTiming),t.get("CPU Time").addTime(e.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:t,stats:e}=this;t.fps=e.get("frameRate").getHz(),t.setPropsTime=e.get("setProps Time").time,t.updateAttributesTime=e.get("Update Attributes").time,t.framesRedrawn=e.get("Redraw Count").count,t.pickTime=e.get("pickObject Time").time+e.get("pickMultipleObjects Time").time+e.get("pickObjects Time").time,t.pickCount=e.get("Pick Count").count,t.gpuTime=e.get("GPU Time").time,t.cpuTime=e.get("CPU Time").time,t.gpuTimePerFrame=e.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=e.get("CPU Time").getAverageTime();const n=$r.get("Memory Usage");t.bufferMemory=n.get("Buffer Memory").count,t.textureMemory=n.get("Texture Memory").count,t.renderbufferMemory=n.get("Renderbuffer Memory").count,t.gpuMemory=n.get("GPU Memory").count}}u(Qu,"defaultProps",$u),u(Qu,"VERSION",Wl);const Ju="undefined"!=typeof window?t.useLayoutEffect:t.useEffect;function tc(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}class ec{constructor(t,e){u(this,"opts",void 0),u(this,"source",void 0),this.opts=e,this.source=t}get value(){return this.source.value}getValue(){const t=this.source.getBuffer(),e=this.getAccessor();if(t)return[t,e];const{value:n}=this.source,{size:i}=e;let r=n;if(n&&n.length!==i){r=new Float32Array(i);const t=e.elementOffset||0;for(let e=0;e<i;++e)r[e]=n[t+e]}return r}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function nc(t){return t.stride||t.size*t.bytesPerElement}function ic(t,e){e.offset&&$t.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=nc(t),i=(void 0!==e.vertexOffset?e.vertexOffset:t.vertexOffset||0)*n+(e.elementOffset||0)*t.bytesPerElement+(t.offset||0);return{...e,offset:i,stride:n}}class rc{constructor(t,e,n){u(this,"gl",void 0),u(this,"id",void 0),u(this,"size",void 0),u(this,"settings",void 0),u(this,"value",void 0),u(this,"doublePrecision",void 0),u(this,"_buffer",void 0),u(this,"state",void 0),this.gl=t,this.id=e.id||"",this.size=e.size||1;const i=e.logicalType||e.type,r=5130===i;let o,{defaultValue:s}=e;s=Number.isFinite(s)?[s]:s||new Array(this.size).fill(0),o=r?5126:!i&&e.isIndexed?t&&function(t,e){return $o(t,e)}(t,Yo)?5125:5123:i||5126;let a=function(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}(i||o||5126);this.doublePrecision=r,r&&!1===e.fp64&&(a=Float32Array),this.value=null,this.settings={...e,defaultType:a,defaultValue:s,logicalType:i,type:o,size:this.size,bytesPerElement:a.BYTES_PER_ELEMENT},this.state={...n,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:t,type:e}=this.settings;this._buffer=new bo(this.gl,{id:this.id,target:t?34963:34962,accessor:{type:e}})}return this._buffer}get byteOffset(){const t=this.getAccessor();return t.vertexOffset?t.vertexOffset*nc(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),An.release(this.state.allocatedValue)}getShaderAttributes(t,e){if(this.doublePrecision){const n={},i=this.value instanceof Float64Array,r=function(t,e){const n=ic(t,e);return{high:n,low:{...n,offset:n.offset+4*t.size}}}(this.getAccessor(),e||{});return n[t]=new ec(this,r.high),n["".concat(t,"64Low")]=i?new ec(this,r.low):new Float32Array(this.size),n}if(e){const n=ic(this.getAccessor(),e);return{[t]:new ec(this,n)}}return{[t]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){const e=Array.from(this.value);t=[e,e]}else{const{value:e,numInstances:n,size:i}=this,r=n*i;if(e&&r&&e.length>=r){const n=new Array(i).fill(1/0),o=new Array(i).fill(-1/0);for(let t=0;t<r;)for(let r=0;r<i;r++){const i=e[t++];i<n[r]&&(n[r]=i),i>o[r]&&(o[r]=i)}t=[n,o]}}return this.state.bounds=t,t}setData(t){const{state:e}=this;let n;n=ArrayBuffer.isView(t)?{value:t}:t instanceof bo?{buffer:t}:t;const i={...this.settings,...n};if(e.bufferAccessor=i,e.bounds=null,n.constant){let t=n.value;if(t=this._normalizeValue(t,[],0),this.settings.normalized&&(t=this.normalizeConstant(t)),e.constant&&this._areValuesEqual(t,this.value))return!1;e.externalBuffer=null,e.constant=!0,this.value=t}else if(n.buffer){const t=n.buffer;e.externalBuffer=t,e.constant=!1,this.value=n.value||null;const r=n.value instanceof Float64Array;i.type=n.type||t.accessor.type,i.bytesPerElement=t.accessor.BYTES_PER_ELEMENT*(r?2:1),i.stride=nc(i)}else if(n.value){this._checkExternalBuffer(n);let t=n.value;e.externalBuffer=null,e.constant=!1,this.value=t,i.bytesPerElement=t.BYTES_PER_ELEMENT,i.stride=nc(i);const{buffer:r,byteOffset:o}=this;this.doublePrecision&&t instanceof Float64Array&&(t=Wn(t,i));const s=t.byteLength+o+2*i.stride;r.byteLength<s&&r.reallocate(s),r.setAccessor(null),r.subData({data:t,offset:o}),i.type=n.type||r.accessor.type}return!0}updateSubBuffer(t={}){this.state.bounds=null;const e=this.value,{startOffset:n=0,endOffset:i}=t;this.buffer.subData({data:this.doublePrecision&&e instanceof Float64Array?Wn(e,{size:this.size,startIndex:n,endIndex:i}):e.subarray(n,i),offset:n*e.BYTES_PER_ELEMENT+this.byteOffset})}allocate(t,e=!1){const{state:n}=this,i=n.allocatedValue,r=An.allocate(i,t+1,{size:this.size,type:this.settings.defaultType,copy:e});this.value=r;const{buffer:o,byteOffset:s}=this;return o.byteLength<r.byteLength+s&&(o.reallocate(r.byteLength+s),e&&i&&o.subData({data:i instanceof Float64Array?Wn(i,this):i,offset:s})),n.allocatedValue=r,n.constant=!1,n.externalBuffer=null,n.bufferAccessor=this.settings,!0}_checkExternalBuffer(t){const{value:e}=t;if(!ArrayBuffer.isView(e))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const n=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=e.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(e.constructor.name));e instanceof n||!this.settings.normalized||"normalized"in t||$t.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(t){switch(this.settings.type){case 5120:return new Float32Array(t).map((t=>(t+128)/255*2-1));case 5122:return new Float32Array(t).map((t=>(t+32768)/65535*2-1));case 5121:return new Float32Array(t).map((t=>t/255));case 5123:return new Float32Array(t).map((t=>t/65535));default:return t}}_normalizeValue(t,e,n){const{defaultValue:i,size:r}=this.settings;if(Number.isFinite(t))return e[n]=t,e;if(!t)return e[n]=i[0],e;switch(r){case 4:e[n+3]=Number.isFinite(t[3])?t[3]:i[3];case 3:e[n+2]=Number.isFinite(t[2])?t[2]:i[2];case 2:e[n+1]=Number.isFinite(t[1])?t[1]:i[1];case 1:e[n+0]=Number.isFinite(t[0])?t[0]:i[0];break;default:let o=r;for(;--o>=0;)e[n+o]=Number.isFinite(t[o])?t[o]:i[o]}return e}_areValuesEqual(t,e){if(!t||!e)return!1;const{size:n}=this;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}}const oc=[],sc=[];function ac(t,e=0,n=1/0){let i=oc;const r={index:-1,data:t,target:[]};return t?"function"==typeof t[Symbol.iterator]?i=t:t.length>0&&(sc.length=t.length,i=sc):i=oc,(e>0||Number.isFinite(n))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(e,n),r.index=e-1),{iterable:i,objectInfo:r}}function lc(t){return t&&t[Symbol.asyncIterator]}function uc(t,e){const{size:n,stride:i,offset:r,startIndices:o,nested:s}=e,a=t.BYTES_PER_ELEMENT,l=i?i/a:n,u=r?r/a:0,c=Math.floor((t.length-u)/l);return(e,{index:i,target:r})=>{if(!o){const e=i*l+u;for(let i=0;i<n;i++)r[i]=t[e+i];return r}const a=o[i],h=o[i+1]||c;let f;if(s){f=new Array(h-a);for(let e=a;e<h;e++){const i=e*l+u;r=new Array(n);for(let e=0;e<n;e++)r[e]=t[i+e];f[e-a]=r}}else if(l===n)f=t.subarray(a*n+u,h*n+u);else{f=new t.constructor((h-a)*n);let e=0;for(let i=a;i<h;i++){const r=i*l+u;for(let i=0;i<n;i++)f[e++]=t[r+i]}}return f}}const cc=[],hc=[[0,1/0]];function fc(t){const{source:e,target:n,start:i=0,size:r,getData:o}=t,s=t.end||n.length,a=e.length,l=s-i;if(a>l)return void n.set(e.subarray(0,l),i);if(n.set(e,i),!o)return;let u=a;for(;u<l;){const t=o(u,e);for(let e=0;e<r;e++)n[i+u]=t[e]||0,u++}}const dc={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function pc(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...dc[n],...e,...t,type:n}}function gc(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function mc(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function yc(t){t.push(t.shift())}function vc(t,e){const{doublePrecision:n,settings:i,value:r,size:o}=t,s=n&&r instanceof Float64Array?2:1;return(i.noAlloc?r.length:e*o)*s}function _c({buffer:t,numInstances:e,attribute:n,fromLength:i,fromStartIndices:r,getData:o=(t=>t)}){const s=n.doublePrecision&&n.value instanceof Float64Array?2:1,a=n.size*s,l=n.byteOffset,u=n.startIndices,c=r&&u,h=vc(n,e),f=n.isConstant;if(!c&&i>=h)return;const d=f?n.value:n.getBuffer().getData({srcByteOffset:l});if(n.settings.normalized&&!f){const t=o;o=(e,i)=>n.normalizeConstant(t(e,i))}const p=f?(t,e)=>o(d,e):(t,e)=>o(d.subarray(t,t+a),e),g=t.getData({length:i}),m=new Float32Array(h);!function({source:t,target:e,size:n,getData:i,sourceStartIndices:r,targetStartIndices:o}){if(!Array.isArray(o))return fc({source:t,target:e,size:n,getData:i}),e;let s=0,a=0;const l=i&&((t,e)=>i(t+a,e)),u=Math.min(r.length,o.length);for(let i=1;i<u;i++){const u=r[i]*n,c=o[i]*n;fc({source:t.subarray(s,u),target:e,start:a,end:c,size:n,getData:l}),s=u,a=c}a<e.length&&fc({source:[],target:e,start:a,size:n,getData:l})}({source:g,target:m,sourceStartIndices:r,targetStartIndices:u,size:a,getData:p}),t.byteLength<m.byteLength+l&&t.reallocate(m.byteLength+l),t.subData({data:m,offset:l})}class bc extends rc{constructor(t,e){super(t,e,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:hc}),u(this,"constant",!1),this.settings.update=e.update||(e.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){const e=this.state.needsRedraw;return this.state.needsRedraw=e&&!t,e}getUpdateTriggers(){const{accessor:t}=this.settings;return[this.id].concat("function"!=typeof t&&t||[])}supportsTransition(){return Boolean(this.settings.transition)}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;const{accessor:e}=this.settings,n=this.settings.transition;return pc(Array.isArray(e)?t[e.find((e=>t[e]))]:t[e],n)}setNeedsUpdate(t=this.id,e){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),e){const{startRow:t=0,endRow:n=1/0}=e;this.state.updateRanges=function(t,e){if(t===hc)return t;if(e[0]<0&&(e[0]=0),e[0]>=e[1])return t;const n=[],i=t.length;let r=0;for(let o=0;o<i;o++){const i=t[o];i[1]<e[0]?(n.push(i),r=o+1):i[0]>e[1]?n.push(i):e=[Math.min(i[0],e[0]),Math.max(i[1],e[1])]}return n.splice(r,0,e),n}(this.state.updateRanges,[t,n])}else this.state.updateRanges=hc}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=cc}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){const{state:e,settings:n}=this;return!n.noAlloc&&!!n.update&&(super.allocate(t,e.updateRanges!==hc),!0)}updateBuffer({numInstances:t,data:e,props:n,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:r},settings:{update:o,noAlloc:s}}=this;let a=!0;if(o){for(const[s,a]of r)o.call(i,this,{data:e,startRow:s,endRow:a,props:n,numInstances:t});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[e,n]of r){const i=Number.isFinite(e)?this.getVertexOffset(e):0,r=Number.isFinite(n)?this.getVertexOffset(n):s||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:i,endOffset:r})}this._checkAttributeArray()}else a=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),a}setConstantValue(t){return void 0!==t&&"function"!=typeof t&&(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){const{state:e}=this;return t?(this.clearNeedsUpdate(),e.lastExternalBuffer===t||(e.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(e.lastExternalBuffer=null,!1)}setBinaryValue(t,e=null){const{state:n,settings:i}=this;if(!t)return n.binaryValue=null,n.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(n.binaryValue===t)return this.clearNeedsUpdate(),!0;if(n.binaryValue=t,this.setNeedsRedraw(),i.transform||e!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});const r=t;m(ArrayBuffer.isView(r.value),"invalid ".concat(i.accessor));const o=Boolean(r.size)&&r.size!==this.size;return n.binaryAccessor=uc(r.value,{size:r.size||this.size,stride:r.stride,offset:r.offset,startIndices:e,nested:o}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){const{startIndices:e}=this;return(e?t<e.length?e[t]:this.numInstances:t)*this.size}getShaderAttributes(){const t=this.settings.shaderAttributes||{[this.id]:null},e={};for(const n in t)Object.assign(e,super.getShaderAttributes(n,t[n]));return e}_autoUpdater(t,{data:e,startRow:n,endRow:i,props:r,numInstances:o}){if(t.constant)return;const{settings:s,state:a,value:l,size:u,startIndices:c}=t,{accessor:h,transform:f}=s,d=a.binaryAccessor||("function"==typeof h?h:r[h]);m("function"==typeof d,'accessor "'.concat(h,'" is not a function'));let p=t.getVertexOffset(n);const{iterable:g,objectInfo:y}=ac(e,n,i);for(const e of g){y.index++;let n=d(e,y);if(f&&(n=f.call(this,n)),c){const e=(y.index<c.length-1?c[y.index+1]:o)-c[y.index];if(n&&Array.isArray(n[0])){let e=p;for(const i of n)t._normalizeValue(i,l,e),e+=u}else n&&n.length>u?l.set(n,p):(t._normalizeValue(n,y.target,0),ie({target:l,source:y.target,start:p,count:e}));p+=e*u}else t._normalizeValue(n,l,p),p+=u}}_validateAttributeUpdaters(){const{settings:t}=this;if(!t.noAlloc&&"function"!=typeof t.update)throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:t}=this,e=Math.min(4,this.size);if(t&&t.length>=e){let n=!0;switch(e){case 4:n=n&&Number.isFinite(t[3]);case 3:n=n&&Number.isFinite(t[2]);case 2:n=n&&Number.isFinite(t[1]);case 1:n=n&&Number.isFinite(t[0]);break;default:n=!1}if(!n)throw new Error("Illegal attribute generated for ".concat(this.id))}}}const xc="void main() {gl_FragColor = vec4(0);}",wc="out vec4 transform_output;\nvoid main() {\n  transform_output = vec4(0);\n}",Ec="#version 300 es\n".concat(wc);function Sc(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[i,r,o]=n;return e.includes(i)&&r&&o?{qualifier:i,type:r,name:o.split(";")[0]}:null}function Pc(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{version:e=100,input:n,inputType:i,output:r}=t;if(!n)return 300===e?Ec:e>300?"#version ".concat(e,"\n").concat(wc):xc;const o=function(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return gi(!1),null}}(n,i);return e>=300?"#version ".concat(e," ").concat(300===e?"es":"","\nin ").concat(i," ").concat(n,";\nout vec4 ").concat(r,";\nvoid main() {\n  ").concat(r," = ").concat(o,";\n}"):"varying ".concat(i," ").concat(n,";\nvoid main() {\n  gl_FragColor = ").concat(o,";\n}")}class Cc extends ao{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(t){return sr(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};lr(t),super(t,e),this.initialize(e),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,ro(this.buffers)||this.bind((()=>this._unbindBuffers())),this.setProps(t),this}setProps(t){"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"bindOnUse"in t&&(t=t.bindOnUse),"buffers"in t&&this.setBuffers(t.buffers)}setBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.bind((()=>{for(const e in t)this.setBuffer(e,t[e])})),this}setBuffer(t,e){const n=this._getVaryingIndex(t),{buffer:i,byteSize:r,byteOffset:o}=this._getBufferParams(e);return n<0?(this.unused[t]=i,er.warn("".concat(this.id," unused varying buffer ").concat(t))(),this):(this.buffers[n]=e,this.bindOnUse||this._bindBuffer(n,i,o,r),this)}begin(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(t),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(t){let e,n,i;return t instanceof bo==0?(i=t.buffer,n=t.byteSize,e=t.byteOffset):i=t,void 0===e&&void 0===n||(e=e||0,n=n||i.byteLength-e),{buffer:i,byteOffset:e,byteSize:n}}_getVaryingInfo(t){return this.configuration&&this.configuration.getVaryingInfo(t)}_getVaryingIndex(t){if(this.configuration)return this.configuration.getVaryingInfo(t).location;const e=Number(t);return Number.isFinite(e)?e:-1}_bindBuffers(){if(this.bindOnUse)for(const t in this.buffers){const{buffer:e,byteSize:n,byteOffset:i}=this._getBufferParams(this.buffers[t]);this._bindBuffer(t,e,i,n)}}_unbindBuffers(){if(this.bindOnUse)for(const t in this.buffers)this._bindBuffer(t,null)}_bindBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const r=e&&e.handle;return r&&void 0!==i?this.gl.bindBufferRange(35982,t,r,n,i):this.gl.bindBufferBase(35982,t,r),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(t){this.gl.bindTransformFeedback(36386,this.handle)}}class Ic{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}setupResources(t){for(const e of this.bindings)this._setupTransformFeedback(e,t)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyings:e}=this;return e.length>0&&(t=Object.assign({},t,{varyings:e})),t}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.bindings[this.currentIndex],{sourceBuffers:n,transformFeedback:i}=e;return{attributes:Object.assign({},n,t.attributes),transformFeedback:i}}swap(){return!!this.feedbackMap&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t)}getBuffer(t){const{feedbackBuffers:e}=this.bindings[this.currentIndex],n=t?e[t]:null;return n?n instanceof bo?n:n.buffer:null}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{varyingName:e}=t,n=this.getBuffer(e);return n?n.getData():null}delete(){for(const t in this.resources)this.resources[t].delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupBuffers(t),this.varyings=t.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Qr(sr(this.gl))}_getFeedbackBuffers(t){const{sourceBuffers:e={}}=t,n={};if(this.bindings[this.currentIndex]&&Object.assign(n,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const t in this.feedbackMap){const i=this.feedbackMap[t];t in e&&(n[i]=t)}Object.assign(n,t.feedbackBuffers);for(const t in n){const i=n[t];if("string"==typeof i){const r=e[i],{byteLength:o,usage:s,accessor:a}=r;n[t]=this._createNewBuffer(t,{byteLength:o,usage:s,accessor:a})}}return n}_setupBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e=null}=t;Object.assign(this.feedbackMap,t.feedbackMap);const n=this._getFeedbackBuffers(t);this._updateBindings({sourceBuffers:e,feedbackBuffers:n})}_setupTransformFeedback(t,e){let{model:n}=e;const{program:i}=n;t.transformFeedback=new Cc(this.gl,{program:i,buffers:t.feedbackBuffers})}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this.feedbackMap){const{sourceBuffers:t,feedbackBuffers:e}=this._swapBuffers(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceBuffers:t,feedbackBuffers:e})}}_updateBinding(t,e){return t?(Object.assign(t.sourceBuffers,e.sourceBuffers),Object.assign(t.feedbackBuffers,e.feedbackBuffers),t.transformFeedback&&t.transformFeedback.setBuffers(t.feedbackBuffers),t):{sourceBuffers:Object.assign({},e.sourceBuffers),feedbackBuffers:Object.assign({},e.feedbackBuffers)}}_swapBuffers(t){if(!this.feedbackMap)return null;const e=Object.assign({},t.sourceBuffers),n=Object.assign({},t.feedbackBuffers);for(const i in this.feedbackMap){const r=this.feedbackMap[i];e[i]=t.feedbackBuffers[r],n[r]=t.sourceBuffers[i],Qr(n[r]instanceof bo)}return{sourceBuffers:e,feedbackBuffers:n}}_createNewBuffer(t,e){const n=new bo(this.gl,e);return this.resources[t]&&this.resources[t].delete(),this.resources[t]=n,n}_getNextIndex(){return(this.currentIndex+1)%2}}function Tc(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&"#version"===n[0]){const t=parseInt(n[1],10);Number.isFinite(t)&&(e=t)}return e}const Mc={name:"transform",vs:"attribute float transform_elementID;\nvec2 transform_getPixelSizeHalf(vec2 size) {\n  return vec2(1.) / (2. * size);\n}\n\nvec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {\n  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);\n  float xIndex = transform_elementID - (yIndex * texSize[0]);\n  return vec2(xIndex, yIndex);\n}\nvec2 transform_getTexCoord(vec2 size) {\n  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);\n  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);\n  vec2 coord = indices / size + pixelSizeHalf;\n  return coord;\n}\nvec2 transform_getPos(vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);\n  return pos;\n}\nvec4 transform_getInput(sampler2D texSampler, vec2 size) {\n  vec2 texCoord = transform_getTexCoord(size);\n  vec4 textureColor = texture2D(texSampler, texCoord);\n  return textureColor;\n}\n",fs:null},Lc="transform_uSampler_",Ac="transform_uSize_",Oc="transform_position";const Nc={10241:9728,10240:9728,10242:33071,10243:33071};class Rc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(e),Object.seal(this)}updateModelProps(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this._processVertexShader(t);return Object.assign({},t,e)}getDrawOptions(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,sourceTextures:n,framebuffer:i,targetTexture:r}=this.bindings[this.currentIndex],o=Object.assign({},e,t.attributes),s=Object.assign({},t.uniforms),a=Object.assign({},t.parameters);let l=t.discard;if(this.hasSourceTextures||this.hasTargetTexture){o.transform_elementID=this.elementIDBuffer;for(const t in this.samplerTextureMap){const e=this.samplerTextureMap[t];s[t]=n[e]}this._setSourceTextureParameters();const t=function(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:i}=t;const r={};let o,s;n&&(({width:o,height:s}=i),r["".concat(Ac).concat(n)]=[o,s]);for(const t in e)({width:o,height:s}=e[t]),r["".concat(Ac).concat(t)]=[o,s];return r}({sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r});Object.assign(s,t)}return this.hasTargetTexture&&(l=!1,a.viewport=[0,0,i.width,i.height]),{attributes:o,framebuffer:i,uniforms:s,discard:l,parameters:a}}swap(){return!!this._swapTexture&&(this.currentIndex=this._getNextIndex(),!0)}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setupTextures(t)}getTargetTexture(){const{targetTexture:t}=this.bindings[this.currentIndex];return t}getData(){let{packed:t=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{framebuffer:e}=this.bindings[this.currentIndex],n=qo(e);if(!t)return n;const i=n.constructor,r=function(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return gi(!1),null}}(this.targetTextureType),o=new i(n.length*r/4);let s=0;for(let t=0;t<n.length;t+=4)for(let e=0;e<r;e++)o[s++]=n[t+e];return o}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{_targetTextureVarying:e,_swapTexture:n}=t;this._swapTexture=n,this.targetTextureVarying=e,this.hasTargetTexture=e,this._setupTextures(t)}_createTargetTexture(t){const{sourceTextures:e,textureOrReference:n}=t;if(n instanceof Io)return n;const i=e[n];return i?(this._targetRefTexName=n,this._createNewTexture(i)):null}_setupTextures(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceBuffers:e,_sourceTextures:n={},_targetTexture:i}=t,r=this._createTargetTexture({sourceTextures:n,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||n&&Object.keys(n).length>0,this._updateBindings({sourceBuffers:e,sourceTextures:n,targetTexture:r}),"elementCount"in t&&this._updateElementIDBuffer(t.elementCount)}_updateElementIDBuffer(t){if("number"!=typeof t||this.elementCount>=t)return;const e=new Float32Array(t);e.forEach(((t,e,n)=>{n[e]=e})),this.elementIDBuffer?this.elementIDBuffer.setData({data:e}):this.elementIDBuffer=new bo(this.gl,{data:e,accessor:{size:1}}),this.elementCount=t}_updateBindings(t){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],t),this._swapTexture){const{sourceTextures:t,targetTexture:e}=this._swapTextures(this.bindings[this.currentIndex]),n=this._getNextIndex();this.bindings[n]=this._updateBinding(this.bindings[n],{sourceTextures:t,targetTexture:e})}}_updateBinding(t,e){const{sourceBuffers:n,sourceTextures:i,targetTexture:r}=e;if(t||(t={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(t.sourceTextures,i),Object.assign(t.sourceBuffers,n),r){t.targetTexture=r;const{width:e,height:n}=r,{framebuffer:i}=t;i?(i.update({attachments:{36064:r},resizeAttachments:!1}),i.resize({width:e,height:n})):t.framebuffer=new ts(this.gl,{id:"transform-framebuffer",width:e,height:n,attachments:{36064:r}})}return t}_setSourceTextureParameters(){const t=this.currentIndex,{sourceTextures:e}=this.bindings[t];for(const t in e)e[t].setParameters(Nc)}_swapTextures(t){if(!this._swapTexture)return null;const e=Object.assign({},t.sourceTextures);return e[this._swapTexture]=t.targetTexture,{sourceTextures:e,targetTexture:t.sourceTextures[this._swapTexture]}}_createNewTexture(t){const e=function(t,e){Qr(t instanceof Io||t instanceof Uo||t instanceof Vo);const n=t.constructor,{gl:i,width:r,height:o,format:s,type:a,dataFormat:l,border:u,mipmaps:c}=t;return new n(i,Object.assign({width:r,height:o,format:s,type:a,dataFormat:l,border:u,mipmaps:c},{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}}))}(t);return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=e,e}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{sourceTextures:e,targetTexture:n}=this.bindings[this.currentIndex],{vs:i,uniforms:r,targetTextureType:o,inject:s,samplerTextureMap:a}=function(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:i,targetTexture:r}=t,o=Object.keys(n).length,s=null;const a={};let l=e,u={};if(o>0||i){const t=l.split("\n"),e=t.slice();if(t.forEach(((t,r,l)=>{if(o>0){const i=function(t,e){const n={},i=function(t){return Sc(t,["attribute","in"])}(t);if(!i)return null;const{type:r,name:o}=i;if(o&&e[o]){const e="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:i,sizeName:s,uniformDeclerations:a}=function(t){const e="".concat(Lc).concat(t),n="".concat(Ac).concat(t);return{samplerName:e,sizeName:n,uniformDeclerations:"  uniform sampler2D ".concat(e,";\n  uniform vec2 ").concat(n,";")}}(o),l=function(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return gi(!1),null}}(r),u="  ".concat(r," ").concat(o," = transform_getInput(").concat(i,", ").concat(s,").").concat(l,";\n");return n[i]=o,{updatedLine:e,inject:{"vs:#decl":a,"vs:#main-start":u},samplerTextureMap:n}}return null}(t,n);if(i){const{updatedLine:t,inject:n}=i;e[r]=t,u=zi([u,n]),Object.assign(a,i.samplerTextureMap),o--}}i&&!s&&(s=function(t,e){const n=Sc(t,["varying","out"]);return n&&n.name===e?n.type:null}(t,i))})),i){Qr(r);const t="".concat(Ac).concat(i),e="uniform vec2 ".concat(t,";\n"),n="     vec2 ".concat(Oc," = transform_getPos(").concat(t,");\n     gl_Position = vec4(").concat(Oc,", 0, 1.);\n");u=zi([u,{"vs:#decl":e,"vs:#main-start":n}])}l=e.join("\n")}return{vs:l,targetTextureType:s,inject:u,samplerTextureMap:a}}({vs:t.vs,sourceTextureMap:e,targetTextureVarying:this.targetTextureVarying,targetTexture:n}),l=zi([t.inject||{},s]);return this.targetTextureType=o,this.samplerTextureMap=a,{vs:i,fs:t._fs||Pc({version:Tc(i),input:this.targetTextureVarying,inputType:o,output:"transform_output"}),modules:this.hasSourceTextures||this.targetTextureVarying?[Mc].concat(t.modules||[]):t.modules,uniforms:r,inject:l}}}let kc=null;class Dc extends ao{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(t){return!(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).constantAttributeZero||sr(t)||"Chrome"===Xl()}static getDefaultArray(t){return t.luma=t.luma||{},t.luma.defaultVertexArray||(t.luma.defaultVertexArray=new Dc(t,{handle:null,isDefaultArray:!0})),t.luma.defaultVertexArray}static getMaxAttributes(t){return Dc.MAX_ATTRIBUTES=Dc.MAX_ATTRIBUTES||t.getParameter(34921),Dc.MAX_ATTRIBUTES}static setConstant(t,e,n){switch(n.constructor){case Float32Array:Dc._setConstantFloatArray(t,e,n);break;case Int32Array:Dc._setConstantIntArray(t,e,n);break;case Uint32Array:Dc._setConstantUintArray(t,e,n);break;default:Qr(!1)}}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;super(t,Object.assign({},e,{id:n})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=e.isDefaultArray||!1,this.gl2=t,this.initialize(e),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return Dc.getMaxAttributes(this.gl)}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.setProps(t)}setProps(t){return this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Qr(!t||34963===t.target,"elements must be GL.ELEMENT_ARRAY_BUFFER"),this.bind((()=>{this.gl.bindBuffer(34963,t?t.handle:null)})),this}setBuffer(t,e,n){if(34963===e.target)return this.setElementBuffer(e,n);const{size:i,type:r,stride:o,offset:s,normalized:a,integer:l,divisor:u}=n,{gl:c,gl2:h}=this;return t=Number(t),this.bind((()=>{c.bindBuffer(34962,e.handle),l?(Qr(sr(c)),h.vertexAttribIPointer(t,i,r,o,s)):c.vertexAttribPointer(t,i,r,a,o,s),c.enableVertexAttribArray(t),h.vertexAttribDivisor(t,u||0)})),this}enable(t){let e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return!e&&0===t&&!Dc.isSupported(this.gl,{constantAttributeZero:!0})||(t=Number(t),this.bind((()=>e?this.gl.enableVertexAttribArray(t):this.gl.disableVertexAttribArray(t)))),this}getConstantBuffer(t,e){const n=this._normalizeConstantArrayValue(e),i=n.byteLength*t,r=n.length*t;let o=!this.buffer;if(this.buffer=this.buffer||new bo(this.gl,i),o=o||this.buffer.reallocate(i),o=o||!this._compareConstantArrayValues(n,this.bufferValue),o){const t=function(t,e){var n;return new t((n=t.BYTES_PER_ELEMENT*e,(!kc||kc.byteLength<n)&&(kc=new ArrayBuffer(n)),kc),0,e)}(e.constructor,r);!function(t){let{target:e,source:n,start:i=0,count:r=1}=t;const o=n.length,s=r*o;let a=0;for(let t=i;a<o;a++)e[t++]=n[a];for(;a<s;)a<s-a?(e.copyWithin(i+a,i,i+a),a*=2):(e.copyWithin(i+a,i,i+s-a),a=s)}({target:t,source:n,start:0,count:r}),this.buffer.subData(t),this.bufferValue=e}return this.buffer}_normalizeConstantArrayValue(t){return Array.isArray(t)?new Float32Array(t):t}_compareConstantArrayValues(t,e){if(!t||!e||t.length!==e.length||t.constructor!==e.constructor)return!1;for(let n=0;n<t.length;++n)if(t[n]!==e[n])return!1;return!0}static _setConstantFloatArray(t,e,n){switch(n.length){case 1:t.vertexAttrib1fv(e,n);break;case 2:t.vertexAttrib2fv(e,n);break;case 3:t.vertexAttrib3fv(e,n);break;case 4:t.vertexAttrib4fv(e,n);break;default:Qr(!1)}}static _setConstantIntArray(t,e,n){switch(Qr(sr(t)),n.length){case 1:t.vertexAttribI1iv(e,n);break;case 2:t.vertexAttribI2iv(e,n);break;case 3:t.vertexAttribI3iv(e,n);break;case 4:t.vertexAttribI4iv(e,n);break;default:Qr(!1)}}static _setConstantUintArray(t,e,n){switch(Qr(sr(t)),n.length){case 1:t.vertexAttribI1uiv(e,n);break;case 2:t.vertexAttribI2uiv(e,n);break;case 3:t.vertexAttribI3uiv(e,n);break;case 4:t.vertexAttribI4uiv(e,n);break;default:Qr(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(t){return this.gl2.deleteVertexArray(t),[this.elements]}_bindHandle(t){this.gl2.bindVertexArray(t)}_getParameter(t,e){let{location:n}=e;return Qr(Number.isFinite(n)),this.bind((()=>34373===t?this.gl.getVertexAttribOffset(n,t):this.gl.getVertexAttrib(n,t)))}}const Fc=/^(.+)__LOCATION_([0-9]+)$/,zc=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class Bc{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.id||e.program&&e.program.id;this.id=n,this.gl=t,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new Dc(t),oo(this,"VertexArray","v6.0",zc),this.initialize(e),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(t)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:t}=this.vertexArrayObject;return this.values=new Array(t).fill(null),this.accessors=new Array(t).fill(null),this.unused={},this.drawParams=null,this}setProps(t){return"program"in t&&(this.configuration=t.program&&t.program.configuration),"configuration"in t&&(this.configuration=t.configuration),"attributes"in t&&this.setAttributes(t.attributes),"elements"in t&&this.setElementBuffer(t.elements),"bindOnUse"in t&&(t=t.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(t){return Object.assign(this.attributes,t),this.vertexArrayObject.bind((()=>{for(const e in t){const n=t[e];this._setAttribute(e,n)}this.gl.bindBuffer(34962,null)})),this}setElementBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.elements=t,this.elementsAccessor=e,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(t,e),this}setBuffer(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(34963===e.target)return this.setElementBuffer(e,n);const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,e.accessor,n);return i>=0&&(this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,e,r)),this}setConstant(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{location:i,accessor:r}=this._resolveLocationAndAccessor(t,e,Object.assign({size:e.length},n));return i>=0&&(e=this.vertexArrayObject._normalizeConstantArrayValue(e),this.values[i]=e,this.accessors[i]=r,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new bo(this.gl,{accessor:{size:4}});for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)this.values[t]instanceof bo&&(this.gl.disableVertexAttribArray(t),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(t,1,5126,!1,0,0))})),this}bindBuffers(){return this.vertexArrayObject.bind((()=>{this.elements&&this.setElementBuffer(this.elements);for(let t=0;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++){const e=this.values[t];e instanceof bo&&this.setBuffer(t,e)}})),this}bindForDraw(t,e,n){let i;return this.vertexArrayObject.bind((()=>{this._setConstantAttributes(t,e),i=n()})),i}_resolveLocationAndAccessor(t,e,n,i){const r={location:-1,accessor:null},{location:o,name:s}=this._getAttributeIndex(t);if(!Number.isFinite(o)||o<0)return this.unused[t]=e,er.once(3,(()=>"unused value ".concat(t," in ").concat(this.id)))(),r;const a=this._getAttributeInfo(s||o);if(!a)return r;const l=this.accessors[o]||{},u=mo.resolve(a.accessor,l,n,i),{size:c,type:h}=u;return Qr(Number.isFinite(c)&&Number.isFinite(h)),{location:o,accessor:u}}_getAttributeInfo(t){return this.configuration&&this.configuration.getAttributeInfo(t)}_getAttributeIndex(t){const e=Number(t);if(Number.isFinite(e))return{location:e};const n=Fc.exec(t),i=n?n[1]:t,r=n?Number(n[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+r,name:i}:{location:-1}}_setAttribute(t,e){if(e instanceof bo)this.setBuffer(t,e);else if(Array.isArray(e)&&e.length&&e[0]instanceof bo){const n=e[0],i=e[1];this.setBuffer(t,n,i)}else if(ArrayBuffer.isView(e)||Array.isArray(e)){const n=e;this.setConstant(t,n)}else{if(!(e.buffer instanceof bo))throw new Error("VertexArray: attributes must be Buffers or constants (i.e. typed array)");{const n=e;this.setBuffer(t,n.buffer,n)}}}_setConstantAttributes(t,e){const n=Math.max(0|t,0|e);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,n);for(let t=1;t<this.vertexArrayObject.MAX_ATTRIBUTES;t++)i=this.values[t],ArrayBuffer.isView(i)&&this._setConstantAttribute(t,i)}_setConstantAttributeZero(t,e){if(Dc.isSupported(this.gl,{constantAttributeZero:!0}))return void this._setConstantAttribute(0,t);const n=this.vertexArrayObject.getConstantBuffer(e,t);this.vertexArrayObject.setBuffer(0,n,this.accessors[0])}_setConstantAttribute(t,e){Dc.setConstant(this.gl,t,e)}_updateDrawParams(){const t={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this._updateDrawParamsForLocation(t,e);return this.elements&&(t.elementCount=this.elements.getElementCount(this.elements.accessor),t.isIndexed=!0,t.indexType=this.elementsAccessor.type||this.elements.accessor.type,t.indexOffset=this.elementsAccessor.offset||0),t.indexCount===1/0&&(t.indexCount=0),t.vertexCount===1/0&&(t.vertexCount=0),t.instanceCount===1/0&&(t.instanceCount=0),t}_updateDrawParamsForLocation(t,e){const n=this.values[e],i=this.accessors[e];if(!n)return;const{divisor:r}=i,o=r>0;if(t.isInstanced=t.isInstanced||o,n instanceof bo){const e=n;if(o){const n=e.getVertexCount(i);t.instanceCount=Math.min(t.instanceCount,n)}else{const n=e.getVertexCount(i);t.vertexCount=Math.min(t.vertexCount,n)}}}setElements(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return er.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(t,e)}}function jc(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{isInteger:n=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return function(t,e){const{maxElts:n=16,size:i=1}=e;let r="[";for(let o=0;o<t.length&&o<n;++o)o>0&&(r+=",".concat(o%i==0?" ":"")),r+=jc(t[o],e);const o=t.length>n?"...":"]";return"".concat(r).concat(o)}(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<1e-16)return n?"0":"0.";if(n)return t.toFixed(0);if(Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function Uc(t,e,n,i){const{gl:r}=t;if(!e)return{[i]:"null","Format ":"N/A"};let o,s,a,l="NOT PROVIDED",u=1,c=0,h=0;if(n&&(l=n.type,u=n.size,l=String(l).replace("Array",""),o=-1!==l.indexOf("nt")),e instanceof bo){const t=e,{data:f,changed:d}=t.getDebugData();let p;if(s=d?"*":"",a=f,h=t.byteLength,c=h/f.BYTES_PER_ELEMENT/u,n){const t=n.divisor>0;p="".concat(t?"I ":"P "," ").concat(c," (x").concat(u,"=").concat(h," bytes ").concat(to(r,l),")")}else o=!0,p="".concat(h," bytes");return{[i]:"".concat(s).concat(jc(a,{size:u,isInteger:o})),"Format ":p}}return a=e,u=e.length,l=String(e.constructor.name).replace("Array",""),o=-1!==l.indexOf("nt"),{[i]:"".concat(jc(a,{size:u,isInteger:o})," (constant)"),"Format ":"".concat(u,"x").concat(l," (constant)")}}function Vc(t,e){const{type:n,size:i}=e,r=Vs(n,i);return r?"".concat(t," (").concat(r.name,")"):t}function Gc(t){let{header:e="Uniforms",program:n,uniforms:i,undefinedOnly:r=!1}=t;Qr(n);const o=".*Matrix",s=n._uniformSetters,a={},l=Object.keys(s).sort();let u=0;for(const t of l)t.match(".*_.*")||t.match(o)||qc({table:a,header:e,uniforms:i,uniformName:t,undefinedOnly:r})&&u++;for(const t of l)t.match(o)&&qc({table:a,header:e,uniforms:i,uniformName:t,undefinedOnly:r})&&u++;for(const t of l)a[t]||qc({table:a,header:e,uniforms:i,uniformName:t,undefinedOnly:r})&&u++;let c=0;const h={};if(!r)for(const t in i){const n=i[t];a[t]||(c++,h[t]={Type:"NOT USED: ".concat(n),[e]:jc(n)})}return{table:a,count:u,unusedTable:h,unusedCount:c}}function qc(t){let{table:e,header:n,uniforms:i,uniformName:r,undefinedOnly:o}=t;const s=i[r],a=function(t){return null!=t}(s);return!(o&&a||(e[r]={[n]:a?jc(s):"N/A","Uniform Type":a?s:"NOT PROVIDED"},0))}function Wc(t){const{type:e,size:n}=t.accessor,i=Vs(e,n);return i?"".concat(i.name," ").concat(t.name):t.name}const Hc={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function Xc(t,e){const{attributeMap:n=Hc}=e||{};return n&&n[t]||t}function Yc(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors"}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2}Qr(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const Zc=()=>{},Kc={};class $c{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{id:n=no("model")}=e;Qr(or(t)),this.id=n,this.gl=t,this.id=e.id||no("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(e)}initialize(t){this.props={},this.programManager=t.programManager||Xs.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:e=null,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:u}=t;this.programProps={program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:u},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(t.moduleSettings))),this.drawMode=void 0!==t.drawMode?t.drawMode:4,this.vertexCount=t.vertexCount||0,this.geometryBuffers={},this.isInstanced=t.isInstanced||t.instanced||t.instanceCount>0,this._setModelProps(t),this.geometry={},Qr(void 0!==this.drawMode&&Number.isFinite(this.vertexCount),"Model needs drawMode and vertexCount")}setProps(t){this._setModelProps(t)}delete(){for(const t in this._attributes)this._attributes[t]!==this.attributes[t]&&this._attributes[t].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(t){const{program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:u}=t;this.programProps={program:e,vs:n,fs:i,modules:r,defines:o,inject:s,varyings:a,bufferMode:l,transpileToGLSL100:u},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(t){return this.drawMode=t,this}setVertexCount(t){return Qr(Number.isFinite(t)),this.vertexCount=t,this}setInstanceCount(t){return Qr(Number.isFinite(t)),this.instanceCount=t,this}setGeometry(t){return this.drawMode=t.drawMode,this.vertexCount=t.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=function(t,e,n){const i={};let r=e.indices;for(const n in e.attributes){const o=e.attributes[n],s=Xc(n,undefined);if("indices"===n)r=o;else if(o.constant)i[s]=o.value;else{const e=o.value,r={...o};delete r.value,i[s]=[new bo(t,e),r],Yc(n,r)}}if(r){const e=r.value||r;Qr(e instanceof Uint16Array||e instanceof Uint32Array,'attribute array for "indices" must be of integer type');const n={size:1,isIndexed:void 0===r.isIndexed||r.isIndexed};i.indices=[new bo(t,{data:e,target:34963}),n]}return i}(this.gl,t),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(ro(t))return this;const e={};for(const n in t){const i=t[n];e[n]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(e),this}setUniforms(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.uniforms,t),this}getModuleUniforms(t){this._checkProgram();const e=this.programManager.getUniforms(this.program);return e?e(t):{}}updateModuleSettings(t){const e=this.getModuleUniforms(t||{});return this.setUniforms(e)}clear(t){return Bo(this.program.gl,t),this}draw(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._checkProgram();const{moduleSettings:e=null,framebuffer:n,uniforms:i={},attributes:r={},transformFeedback:o=this.transformFeedback,parameters:s={},vertexArray:a=this.vertexArray}=t;let l;this.setAttributes(r),this.updateModuleSettings(e),this.setUniforms(i),er.priority>=2&&(l=this._logDrawCallStart(2));const u=this.vertexArray.getDrawParams(),{isIndexed:c=u.isIndexed,indexType:h=u.indexType,indexOffset:f=u.indexOffset,vertexArrayInstanced:d=u.isInstanced}=this.props;d&&!this.isInstanced&&er.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:p,instanceCount:g}=this,{onBeforeRender:m=Zc,onAfterRender:y=Zc}=this.props;m(),this.program.setUniforms(this.uniforms);const v=this.program.draw(Object.assign(Kc,t,{logPriority:l,uniforms:null,framebuffer:n,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:a,transformFeedback:o,isIndexed:c,indexType:h,isInstanced:p,instanceCount:g,offset:c?f:0}));return y(),er.priority>=2&&this._logDrawCallEnd(l,a,n),v}transform(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{discard:e=!0,feedbackBuffers:n,unbindModels:i=[]}=t;let{parameters:r}=t;n&&this._setFeedbackBuffers(n),e&&(r=Object.assign({},r,{35977:e})),i.forEach((t=>t.vertexArray.unbindBuffers()));try{this.draw(Object.assign({},t,{parameters:r}))}finally{i.forEach((t=>t.vertexArray.bindBuffers()))}return this}render(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return er.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(t).draw()}_setModelProps(t){Object.assign(this.props,t),"uniforms"in t&&this.setUniforms(t.uniforms),"pickable"in t&&(this.pickable=t.pickable),"instanceCount"in t&&(this.instanceCount=t.instanceCount),"geometry"in t&&this.setGeometry(t.geometry),"attributes"in t&&this.setAttributes(t.attributes),"_feedbackBuffers"in t&&this._setFeedbackBuffers(t._feedbackBuffers)}_checkProgram(){if(!this._programDirty&&this.programManager.stateHash===this._programManagerState)return;let{program:t}=this.programProps;if(t)this._managedProgram=!1;else{const{vs:e,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}=this.programProps;t=this.programManager.get({vs:e,fs:n,modules:i,inject:r,defines:o,varyings:s,bufferMode:a,transpileToGLSL100:l}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Qr(t instanceof Hs,"Model needs a program"),this._programDirty=!1,t!==this.program&&(this.program=t,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new Bc(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const t in this.geometryBuffers){const e=this.geometryBuffers[t][0]||this.geometryBuffers[t];e instanceof bo&&e.delete()}}_setAnimationProps(t){this.animated&&Qr(t,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(ro(t))return this;const{gl:e}=this.program;return this.transformFeedback=this.transformFeedback||new Cc(e,{program:this.program}),this.transformFeedback.setBuffers(t),this}_logDrawCallStart(t){const e=t>3?0:1e4;if(!(Date.now()-this.lastLogTime<e))return this.lastLogTime=Date.now(),er.group(2,">>> DRAWING MODEL ".concat(this.id),{collapsed:er.level<=2})(),t}_logDrawCallEnd(t,e,n,i){if(void 0===t)return;const r=function(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const i={};e.elements&&(i.ELEMENT_ARRAY_BUFFER=Uc(e,e.elements,null,n));const r=e.values;for(const t in r){const o=e._getAttributeInfo(t);if(o){let s="".concat(t,": ").concat(o.name);const a=e.accessors[o.location];a&&(s="".concat(t,": ").concat(Vc(o.name,a))),i[s]=Uc(e,r[t],a,n)}}return i}({vertexArray:e,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:o,unusedTable:s,unusedCount:a}=Gc({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n)}),{table:l,count:u}=Gc({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,n),undefinedOnly:!0});u>0&&er.log("MISSING UNIFORMS",Object.keys(l))(),a>0&&er.log("UNUSED UNIFORMS",Object.keys(s))();const c=function(t){const e={},n="Accessors for ".concat(t.id);for(const i of t.attributeInfos)if(i){const t=Wc(i);e["in ".concat(t)]={[n]:JSON.stringify(i.accessor)}}for(const i of t.varyingInfos)if(i){const t=Wc(i);e["out ".concat(t)]={[n]:JSON.stringify(i.accessor)}}return e}(this.vertexArray.configuration);er.table(t,r)(),er.table(t,o)(),er.table(t+1,c)(),i&&i.log({logLevel:2,message:"Rendered to ".concat(i.id)}),er.groupEnd(2)()}}class Qc{static isSupported(t){return sr(t)}constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.gl=t,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(e),Object.seal(this)}delete(){const{model:t,bufferTransform:e,textureTransform:n}=this;t&&t.delete(),e&&e.delete(),n&&n.delete()}run(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{clearRenderTarget:e=!0}=t,n=this._updateDrawOptions(t);e&&n.framebuffer&&n.framebuffer.clear({color:!0}),this.model.transform(n)}swap(){let t=!1;const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)t=t||n.swap();Qr(t,"Nothing to swap")}getBuffer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(t)}getData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e){const e=n.getData(t);if(e)return e}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};"elementCount"in t&&this.model.setVertexCount(t.elementCount);const e=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const n of e)n.update(t)}_initialize(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{gl:e}=this;this._buildResourceTransforms(e,t),t=this._updateModelProps(t),this.model=new $c(e,Object.assign({},t,{fs:t.fs||Pc({version:Tc(t.vs)}),id:t.id||"transform-model",drawMode:t.drawMode||0,vertexCount:t.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=t.updateModelProps(e);return e}_buildResourceTransforms(t,e){(function(t){return!(ro(t.feedbackBuffers)&&ro(t.feedbackMap)&&!(t.varyings&&t.varyings.length>0))})(e)&&(this.bufferTransform=new Ic(t,e)),function(t){return!(ro(t._sourceTextures)&&!t._targetTexture&&!t._targetTextureVarying)}(e)&&(this.textureTransform=new Rc(t,e)),Qr(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(t){let e=Object.assign({},t);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const t of n)e=Object.assign(e,t.getDrawOptions(e));return e}}const Jc={interpolation:class{constructor({gl:t,attribute:e,timeline:n}){u(this,"gl",void 0),u(this,"type","interpolation"),u(this,"attributeInTransition",void 0),u(this,"settings",void 0),u(this,"attribute",void 0),u(this,"transition",void 0),u(this,"currentStartIndices",void 0),u(this,"currentLength",void 0),u(this,"transform",void 0),u(this,"buffers",void 0),this.gl=t,this.transition=new wa(n),this.attribute=e,this.attributeInTransition=new bc(t,e.settings),this.currentStartIndices=e.startIndices,this.currentLength=0,this.transform=function(t,e){const n=mc(e.size);return new Qc(t,{vs:"\n#define SHADER_NAME interpolation-transition-vertex-shader\n\nuniform float time;\nattribute ATTRIBUTE_TYPE aFrom;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vCurrent;\n\nvoid main(void) {\n  vCurrent = mix(aFrom, aTo, time);\n  gl_Position = vec4(0.0);\n}\n",defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}(t,e);const i={byteLength:0,usage:35050};this.buffers=[new bo(t,i),new bo(t,i)]}get inProgress(){return this.transition.inProgress}start(t,e){if(t.duration<=0)return void this.transition.cancel();this.settings=t;const{gl:n,buffers:i,attribute:r}=this;yc(i);const o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of i)_c({buffer:t,...o});this.currentStartIndices=r.startIndices,this.currentLength=vc(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start(t),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aFrom:i[0],aTo:gc(0,r)},feedbackBuffers:{vCurrent:i[1]}})}update(){const t=this.transition.update();if(t){const{duration:t,easing:e}=this.settings,{time:n}=this.transition;let i=n/t;e&&(i=e(i)),this.transform.run({uniforms:{time:i}})}return t}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0}},spring:class{constructor({gl:t,attribute:e,timeline:n}){u(this,"gl",void 0),u(this,"type","spring"),u(this,"attributeInTransition",void 0),u(this,"settings",void 0),u(this,"attribute",void 0),u(this,"transition",void 0),u(this,"currentStartIndices",void 0),u(this,"currentLength",void 0),u(this,"texture",void 0),u(this,"framebuffer",void 0),u(this,"transform",void 0),u(this,"buffers",void 0),this.gl=t,this.type="spring",this.transition=new wa(n),this.attribute=e,this.attributeInTransition=new bc(t,{...e.settings,normalized:!1}),this.currentStartIndices=e.startIndices,this.currentLength=0,this.texture=function(t){return new Io(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}(t),this.framebuffer=function(t,e){return new ts(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}(t,this.texture),this.transform=function(t,e,n){const i=mc(e.size);return new Qc(t,{framebuffer:n,vs:"\n#define SHADER_NAME spring-transition-vertex-shader\n\n#define EPSILON 0.00001\n\nuniform float stiffness;\nuniform float damping;\nattribute ATTRIBUTE_TYPE aPrev;\nattribute ATTRIBUTE_TYPE aCur;\nattribute ATTRIBUTE_TYPE aTo;\nvarying ATTRIBUTE_TYPE vNext;\nvarying float vIsTransitioningFlag;\n\nATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {\n  ATTRIBUTE_TYPE velocity = cur - prev;\n  ATTRIBUTE_TYPE delta = dest - cur;\n  ATTRIBUTE_TYPE spring = delta * stiffness;\n  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;\n  return spring + damper + velocity + cur;\n}\n\nvoid main(void) {\n  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;\n  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;\n\n  vNext = getNextValue(aCur, aPrev, aTo);\n  gl_Position = vec4(0, 0, 0, 1);\n  gl_PointSize = 100.0;\n}\n",fs:"\n#define SHADER_NAME spring-transition-is-transitioning-fragment-shader\n\nvarying float vIsTransitioningFlag;\n\nvoid main(void) {\n  if (vIsTransitioningFlag == 0.0) {\n    discard;\n  }\n  gl_FragColor = vec4(1.0);\n}",defines:{ATTRIBUTE_TYPE:i},varyings:["vNext"]})}(t,e,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new bo(t,i),new bo(t,i),new bo(t,i)]}get inProgress(){return this.transition.inProgress}start(t,e){const{gl:n,buffers:i,attribute:r}=this,o={numInstances:e,attribute:r,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:t.enter};for(const t of i)_c({buffer:t,...o});this.settings=t,this.currentStartIndices=r.startIndices,this.currentLength=vc(r,e),this.attributeInTransition.setData({buffer:i[1],value:r.value}),this.transition.start({...t,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/r.size),sourceBuffers:{aTo:gc(0,r)}})}update(){const{buffers:t,transform:e,framebuffer:n,transition:i}=this;if(!i.update())return!1;const r=this.settings;return e.update({sourceBuffers:{aPrev:t[0],aCur:t[1]},feedbackBuffers:{vNext:t[2]}}),e.run({framebuffer:n,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:r.stiffness,damping:r.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),yc(t),this.attributeInTransition.setData({buffer:t[1],value:this.attribute.value}),qo(n)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const t of this.buffers)t.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}};class th{constructor(t,{id:e,timeline:n}){u(this,"id",void 0),u(this,"isSupported",void 0),u(this,"gl",void 0),u(this,"timeline",void 0),u(this,"transitions",void 0),u(this,"needsRedraw",void 0),u(this,"numInstances",void 0),this.id=e,this.gl=t,this.timeline=n,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=Qc.isSupported(t)}finalize(){for(const t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:e,numInstances:n}){this.numInstances=n||1;for(const n in t){const i=t[n],r=i.getTransitionSetting(e);r&&this._updateAttribute(n,i,r)}for(const n in this.transitions){const i=t[n];i&&i.getTransitionSetting(e)||this._removeTransition(n)}}hasAttribute(t){const e=this.transitions[t];return e&&e.inProgress}getAttributes(){const t={};for(const e in this.transitions){const n=this.transitions[e];n.inProgress&&(t[e]=n.attributeInTransition)}return t}run(){if(!this.isSupported||0===this.numInstances)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].cancel(),delete this.transitions[t]}_updateAttribute(t,e,n){const i=this.transitions[t];let r=!i||i.type!==n.type;if(r){if(!this.isSupported)return void $t.warn("WebGL2 not supported by this browser. Transition for ".concat(t," is disabled."))();i&&this._removeTransition(t);const o=Jc[n.type];o?this.transitions[t]=new o({attribute:e,timeline:this.timeline,gl:this.gl}):($t.error("unsupported transition type '".concat(n.type,"'"))(),r=!1)}(r||e.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(n,this.numInstances))}}const eh="attributeManager.invalidate";class nh{constructor(t,{id:e="attribute-manager",stats:n,timeline:i}={}){u(this,"id",void 0),u(this,"gl",void 0),u(this,"attributes",void 0),u(this,"updateTriggers",void 0),u(this,"needsRedraw",void 0),u(this,"userData",void 0),u(this,"stats",void 0),u(this,"attributeTransitionManager",void 0),u(this,"mergeBoundsMemoized",ea(Hn)),this.id=e,this.gl=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=n,this.attributeTransitionManager=new th(t,{id:"".concat(e,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){const e=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,e&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{instanced:1})}remove(t){for(const e of t)void 0!==this.attributes[e]&&(this.attributes[e].delete(),delete this.attributes[e])}invalidate(t,e){const n=this._invalidateTrigger(t,e);te(eh,this,t,n)}invalidateAll(t){for(const e in this.attributes)this.attributes[e].setNeedsUpdate(e,t);te(eh,this,"all")}update({data:t,numInstances:e,startIndices:n=null,transitions:i,props:r={},buffers:o={},context:s={}}){let a=!1;te("attributeManager.updateStart",this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const i in this.attributes){const l=this.attributes[i],u=l.settings.accessor;l.startIndices=n,l.numInstances=e,r[i]&&$t.removed("props.".concat(i),"data.attributes.".concat(i))(),l.setExternalBuffer(o[i])||l.setBinaryValue("string"==typeof u?o[u]:void 0,t.startIndices)||"string"==typeof u&&!o[u]&&l.setConstantValue(r[u])||l.needsUpdate()&&(a=!0,this._updateAttribute({attribute:l,numInstances:e,data:t,props:r,context:s})),this.needsRedraw=this.needsRedraw||l.needsRedraw()}a&&te("attributeManager.updateEnd",this,e),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:e,transitions:i})}updateTransition(){const{attributeTransitionManager:t}=this,e=t.run();return this.needsRedraw=this.needsRedraw||e,e}getAttributes(){return this.attributes}getBounds(t){const e=t.map((t=>{var e;return null===(e=this.attributes[t])||void 0===e?void 0:e.getBounds()}));return this.mergeBoundsMemoized(e)}getChangedAttributes(t={clearChangedFlags:!1}){const{attributes:e,attributeTransitionManager:n}=this,i={...n.getAttributes()};for(const r in e){const o=e[r];o.needsRedraw(t)&&!n.hasAttribute(r)&&(i[r]=o)}return i}getShaderAttributes(t,e={}){t||(t=this.getAttributes());const n={};for(const i in t)e[i]||Object.assign(n,t[i].getShaderAttributes());return n}_add(t,e={}){for(const n in t){const i=t[n];this.attributes[n]=this._createAttribute(n,i,e)}this._mapUpdateTriggersToAttributes()}_createAttribute(t,e,n){const i={...e,id:t,size:(e.isIndexed?1:e.size)||1,divisor:n.instanced?1:e.divisor||0};return new bc(this.gl,i)}_mapUpdateTriggersToAttributes(){const t={};for(const e in this.attributes)this.attributes[e].getUpdateTriggers().forEach((n=>{t[n]||(t[n]=[]),t[n].push(e)}));this.updateTriggers=t}_invalidateTrigger(t,e){const{attributes:n,updateTriggers:i}=this,r=i[t];return r&&r.forEach((t=>{const i=n[t];i&&i.setNeedsUpdate(i.id,e)})),r}_updateAttribute(t){const{attribute:e,numInstances:n}=t;te("attribute.updateStart",e),e.constant?e.setConstantValue(e.value):(e.allocate(n)&&te("attribute.allocate",e,n),e.updateBuffer(t)&&(this.needsRedraw=!0,te("attribute.updateEnd",e,n)))}}const ih=1e-5;function rh(t,e,n,i,r){const o=e-t;return(n-e)*r+-o*i+o+e}function oh(t,e){if(Array.isArray(t)){let n=0;for(let i=0;i<t.length;i++){const r=t[i]-e[i];n+=r*r}return Math.sqrt(n)}return Math.abs(t-e)}const sh={interpolation:class extends wa{get value(){return this._value}_onUpdate(){const{time:t,settings:{fromValue:e,toValue:n,duration:i,easing:r}}=this,o=r(t/i);this._value=p(e,n,o)}},spring:class extends wa{get value(){return this._currValue}_onUpdate(){const{fromValue:t,toValue:e,damping:n,stiffness:i}=this.settings,{_prevValue:r=t,_currValue:o=t}=this;let s=function(t,e,n,i,r){if(Array.isArray(n)){const o=[];for(let s=0;s<n.length;s++)o[s]=rh(t[s],e[s],n[s],i,r);return o}return rh(t,e,n,i,r)}(r,o,e,n,i);const a=oh(s,e),l=oh(s,o);a<ih&&l<ih&&(s=e,this.end()),this._prevValue=o,this._currValue=s}}};class ah{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,e,n,i){const{transitions:r}=this;if(r.has(t)){const n=r.get(t),{value:i=n.settings.fromValue}=n;e=i,this.remove(t)}if(!(i=pc(i)))return;const o=sh[i.type];if(!o)return void $t.error("unsupported transition type '".concat(i.type,"'"))();const s=new o(this.timeline);s.start({...i,fromValue:e,toValue:n}),r.set(t,s)}remove(t){const{transitions:e}=this;e.has(t)&&(e.get(t).cancel(),e.delete(t))}update(){const t={};for(const[e,n]of this.transitions)n.update(),t[e]=n.value,n.inProgress||this.remove(e);return t}clear(){for(const t of this.transitions.keys())this.remove(t)}}function lh(t,e){if(!t.transitions)return!1;const n={},i=t[Pt];let r=!1;for(const o in t.transitions){const s=i[o],a=s&&s.type;("number"===a||"color"===a||"array"===a)&&ch(t[o],e[o],s)&&(n[o]=!0,r=!0)}return!!r&&n}function uh({newProps:t,oldProps:e,ignoreProps:n={},propTypes:i={},triggerName:r="props"}){if(e===t)return!1;if("object"!=typeof t||null===t)return"".concat(r," changed shallowly");if("object"!=typeof e||null===e)return"".concat(r," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(r,".").concat(o," added");const n=ch(t[o],e[o],i[o]);if(n)return"".concat(r,".").concat(o," ").concat(n)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(r,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const n=ch(t[o],e[o],i[o]);if(n)return"".concat(r,".").concat(o," ").concat(n)}}return!1}function ch(t,e,n){let i=n&&n.equal;return i&&!i(t,e,n)?"changed deeply":i||(i=t&&e&&t.equals,!i||i.call(t,e))?i||e===t?null:"changed shallowly":"changed deeply"}function hh(t,e){if(null===e)return!0;const n=e.extensions,{extensions:i}=t;if(i===n)return!1;if(!n||!i)return!0;if(i.length!==n.length)return!0;for(let t=0;t<i.length;t++)if(!i[t].equals(n[t]))return!0;return!1}function fh(t,e,n){let i=t.updateTriggers[n];i=null==i?{}:i;let r=e.updateTriggers[n];return r=null==r?{}:r,uh({oldProps:r,newProps:i,triggerName:n})}const dh="count(): argument not an object",ph="count(): argument not a container";function gh(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some((t=>"project64"===t.name)))){const t=n.modules.findIndex((t=>"project32"===t.name));t>=0&&n.modules.splice(t,1)}if("inject"in e)if(t.inject){const i={...t.inject};for(const t in e.inject)i[t]=(i[t]||"")+e.inject[t];n.inject=i}else n.inject=e.inject;return n}const mh=[0,0,0];function yh(t,e,n=!1){const i=e.projectPosition(t);if(n&&e instanceof xa){const[n,r,o=0]=t,s=e.getDistanceScales([n,r]);i[2]=o*s.unitsPerMeter[2]}return i}function vh(t,{viewport:e,modelMatrix:n,coordinateSystem:i,coordinateOrigin:r,offsetMode:o}){let[s,a,l=0]=t;switch(n&&([s,a,l]=w([],[s,a,l,1],n)),i){case ri.LNGLAT:return yh([s,a,l],e,o);case ri.LNGLAT_OFFSETS:return yh([s+r[0],a+r[1],l+(r[2]||0)],e,o);case ri.METER_OFFSETS:return yh(at(r,[s,a,l]),e,o);case ri.CARTESIAN:default:return e.isGeospatial?[s+r[0],a+r[1],l+r[2]]:e.projectPosition([s,a,l])}}const _h={10241:9987,10240:9729,10242:33071,10243:33071},bh={},xh={boolean:{validate:(t,e)=>!0,equal:(t,e,n)=>Boolean(t)===Boolean(e)},number:{validate:(t,e)=>Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)},color:{validate:(t,e)=>e.optional&&!t||Sh(t)&&(3===t.length||4===t.length),equal:(t,e,n)=>ga(t,e,1)},accessor:{validate(t,e){const n=Ph(t);return"function"===n||n===Ph(e.value)},equal:(t,e,n)=>"function"==typeof e||ga(t,e,1)},array:{validate:(t,e)=>e.optional&&!t||Sh(t),equal(t,e,n){const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?ga(t,e,r):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:i}=n,r=Number.isInteger(i)?i:i?1:0;return i?ga(t,e,r):t===e}},function:{validate:(t,e)=>e.optional&&!t||"function"==typeof t,equal:(t,e,n)=>!n.compare&&!1!==n.ignore||t===e},data:{transform:(t,e,n)=>{const{dataTransform:i}=n.props;return i&&t?i(t):t}},image:{transform:(t,e,n)=>{const i=n.context;return i&&i.gl?function(t,e,n){if(e instanceof Io)return e;e.constructor&&"Object"!==e.constructor.name&&(e={data:e});let i=null;e.compressed&&(i={10241:e.data.length>1?9985:9729});const r=new Io(t,{...e,parameters:{..._h,...i,...n}});return bh[r.id]=!0,r}(i.gl,t,{...e.parameters,...n.props.textureParameters}):null},release:t=>{var e;(e=t)&&e instanceof Io&&bh[e.id]&&(e.delete(),delete bh[e.id])}}};function wh(t,e){switch(Ph(e)){case"object":return Eh(t,e);case"array":return Eh(t,{type:"array",value:e,compare:!1});case"boolean":return Eh(t,{type:"boolean",value:e});case"number":return Eh(t,{type:"number",value:e});case"function":return Eh(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function Eh(t,e){return"type"in e?{name:t,...xh[e.type],...e}:"value"in e?{name:t,type:Ph(e.value),...e}:{name:t,type:"object",value:e}}function Sh(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function Ph(t){return Sh(t)?"array":null===t?"null":typeof t}const Ch="_mergedDefaultProps";function Ih(t,e){let n=Ch;if(e)for(const t of e){const e=t.constructor;e&&(n+=":".concat(e.extensionName||e.name))}return Lh(t,n)||(t[n]=function(t,e){if(!t.prototype)return null;const n=Ih(Object.getPrototypeOf(t)),i=function(t){const e={},n={},i={};for(const[r,o]of Object.entries(t)){const t=null==o?void 0:o.deprecatedFor;if(t)i[r]=Array.isArray(t)?t:[t];else{const t=wh(r,o);e[r]=t,n[r]=t.value}}return{propTypes:e,defaultProps:n,deprecatedProps:i}}(Lh(t,"defaultProps")||{}),r=Object.assign(Object.create(null),n,i.defaultProps),o=Object.assign(Object.create(null),null==n?void 0:n[Pt],i.propTypes),s=Object.assign(Object.create(null),null==n?void 0:n[Ct],i.deprecatedProps);for(const t of e){const e=Ih(t.constructor);e&&(Object.assign(r,e),Object.assign(o,e[Pt]),Object.assign(s,e[Ct]))}return function(t,e){const n=function(t){const e=Lh(t,"layerName")||Lh(t,"componentName");return e||$t.once(0,"".concat(t.name,".componentName not specified"))(),e||t.name}(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}(r,t),function(t,e){const n={},i={};for(const t in e){const r=e[t],{name:o,value:s}=r;r.async&&(n[o]=s,i[o]=Th(o))}t[It]=n,t[Tt]={},Object.defineProperties(t,i)}(r,o),function(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(t){const i="".concat(this.id,": ").concat(n);for(const i of e[n])Mh(this,i)||(this[i]=t);$t.deprecated(i,e[n].join("/"))()}})}(r,s),r[Pt]=o,r[Ct]=s,0!==e.length||Mh(t,"_propTypes")||(t._propTypes=o),r}(t,e||[]))}function Th(t){return{enumerable:!0,set(e){"string"==typeof e||e instanceof Promise||lc(e)?this[Tt][t]=e:this[Mt][t]=e},get(){if(this[Mt]){if(t in this[Mt])return this[Mt][t]||this[It][t];if(t in this[Tt]){const e=this[St]&&this[St].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[It][t]}}return this[It][t]}}}function Mh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Lh(t,e){return Mh(t,e)&&t[e]}let Ah=0;class Oh{constructor(...t){u(this,"id",void 0),u(this,"props",void 0),u(this,"count",void 0),this.props=function(t,e){let n;for(let t=e.length-1;t>=0;t--){const i=e[t];"extensions"in i&&(n=i.extensions)}const i=Ih(t.constructor,n),r=Object.create(i);r[St]=t,r[Tt]={},r[Mt]={};for(let t=0;t<e.length;++t){const n=e[t];for(const t in n)r[t]=n[t]}return Object.freeze(r),r}(this,t),this.id=this.props.id,this.count=Ah++}clone(t){const{props:e}=this,n={};for(const t in e[It])t in e[Mt]?n[t]=e[Mt][t]:t in e[Tt]&&(n[t]=e[Tt][t]);return new this.constructor({...e,...n,...t})}}u(Oh,"componentName","Component"),u(Oh,"defaultProps",{});const Nh=Object.freeze({});class Rh{constructor(t){u(this,"component",void 0),u(this,"onAsyncPropUpdated",void 0),u(this,"asyncProps",void 0),u(this,"oldProps",void 0),u(this,"oldAsyncProps",void 0),this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const t in this.asyncProps){const e=this.asyncProps[t];e&&e.type&&e.type.release&&e.type.release(e.resolvedValue,e.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||Nh}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){const e=this.asyncProps[t];return e&&e.resolvedValue}isAsyncPropLoading(t){if(t){const e=this.asyncProps[t];return Boolean(e&&e.pendingLoadCount>0&&e.pendingLoadCount!==e.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(t,e){this._watchPromise(t,Promise.resolve(e))}setAsyncProps(t){this.component=t[St]||this.component;const e=t[Mt]||{},n=t[Tt]||t,i=t[It]||{};for(const t in e){const n=e[t];this._createAsyncPropData(t,i[t]),this._updateAsyncProp(t,n),e[t]=this.getAsyncProp(t)}for(const t in n){const e=n[t];this._createAsyncPropData(t,i[t]),this._updateAsyncProp(t,e)}}_fetch(t,e){return null}_onResolve(t,e){}_onError(t,e){}_updateAsyncProp(t,e){this._didAsyncInputValueChange(t,e)&&("string"==typeof e&&(e=this._fetch(t,e)),e instanceof Promise?this._watchPromise(t,e):lc(e)?this._resolveAsyncIterable(t,e):this._setPropValue(t,e))}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,e){const n=this.asyncProps[t];return e!==n.resolvedValue&&e!==n.lastValue&&(n.lastValue=e,!0)}_setPropValue(t,e){this._freezeAsyncOldProps();const n=this.asyncProps[t];n&&(e=this._postProcessValue(n,e),n.resolvedValue=e,n.pendingLoadCount++,n.resolvedLoadCount=n.pendingLoadCount)}_setAsyncPropValue(t,e,n){const i=this.asyncProps[t];i&&n>=i.resolvedLoadCount&&void 0!==e&&(this._freezeAsyncOldProps(),i.resolvedValue=e,i.resolvedLoadCount=n,this.onAsyncPropUpdated(t,e))}_watchPromise(t,e){const n=this.asyncProps[t];if(n){n.pendingLoadCount++;const i=n.pendingLoadCount;e.then((e=>{this.component&&(e=this._postProcessValue(n,e),this._setAsyncPropValue(t,e,i),this._onResolve(t,e))})).catch((e=>{this._onError(t,e)}))}}async _resolveAsyncIterable(t,e){if("data"!==t)return void this._setPropValue(t,e);const n=this.asyncProps[t];if(!n)return;n.pendingLoadCount++;const i=n.pendingLoadCount;let r=[],o=0;for await(const n of e){if(!this.component)return;const{dataTransform:e}=this.component.props;r=e?e(n,r):r.concat(n),Object.defineProperty(r,"__diff",{enumerable:!1,value:[{startRow:o,endRow:r.length}]}),o=r.length,this._setAsyncPropValue(t,r,i)}this._onResolve(t,r)}_postProcessValue(t,e){const n=t.type;return n&&this.component&&(n.release&&n.release(t.resolvedValue,n,this.component),n.transform)?n.transform(e,n,this.component):e}_createAsyncPropData(t,e){if(!this.asyncProps[t]){const n=this.component&&this.component.props[Pt];this.asyncProps[t]={type:n&&n[t],lastValue:null,resolvedValue:e,pendingLoadCount:0,resolvedLoadCount:0}}}}class kh extends Rh{constructor({attributeManager:t,layer:e}){super(e),u(this,"attributeManager",void 0),u(this,"needsRedraw",void 0),u(this,"needsUpdate",void 0),u(this,"subLayers",void 0),u(this,"usesPickingColorCache",void 0),u(this,"hasPickingBuffer",void 0),u(this,"changeFlags",void 0),u(this,"viewport",void 0),u(this,"uniformTransitions",void 0),u(this,"propsInTransition",void 0),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,e){const n=this.layer,i=null==n?void 0:n.props.fetch;return i?i(e,{propName:t,layer:n}):super._fetch(t,e)}_onResolve(t,e){const n=this.layer;if(n){const i=n.props.onDataLoad;"data"===t&&i&&i(e,{propName:t,layer:n})}}_onError(t,e){const n=this.layer;n&&n.raiseError(e,"loading ".concat(t," of ").concat(this.layer))}}const Dh=2**24-1,Fh=Object.freeze([]),zh=ea((({oldViewport:t,viewport:e})=>t.equals(e)));let Bh=new Uint8ClampedArray(0);const jh={data:{type:"data",value:Fh,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:i,loadOptions:r,signal:o})=>{const{resourceManager:s}=n.context;var a;r=r||n.getLoadOptions(),i=i||n.props.loaders,o&&(r={...r,fetch:{...null===(a=r)||void 0===a?void 0:a.fetch,signal:o}});let l=s.contains(t);return l||r||(s.add({resourceId:t,data:Tn(t,i),persistent:!1}),l=!0),l?s.subscribe({resourceId:t,onChange:t=>{var i;return null===(i=n.internalState)||void 0===i?void 0:i.reloadAsyncProp(e,t)},consumerId:n.id,requestId:e}):Tn(t,i,r)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:ri.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,100*-t]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Uh extends Oh{constructor(...t){super(...t),u(this,"internalState",null),u(this,"lifecycle","Awaiting state"),u(this,"context",void 0),u(this,"state",void 0),u(this,"parent",null)}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){const t=this.constructor.layerName||this.constructor.name;return"".concat(t,"({id: '").concat(this.props.id,"'})")}project(t){m(this.internalState);const e=this.internalState.viewport||this.context.viewport,n=vh(t,{viewport:e,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,r,o]=ct(n,e.pixelProjectionMatrix);return 2===t.length?[i,r]:[i,r,o]}unproject(t){return m(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,e){return m(this.internalState),function(t,e){const{viewport:n,coordinateSystem:i,coordinateOrigin:r,modelMatrix:o,fromCoordinateSystem:s,fromCoordinateOrigin:a}=function(t){const{viewport:e,modelMatrix:n,coordinateOrigin:i}=t;let{coordinateSystem:r,fromCoordinateSystem:o,fromCoordinateOrigin:s}=t;return r===ri.DEFAULT&&(r=e.isGeospatial?ri.LNGLAT:ri.CARTESIAN),void 0===o&&(o=r),void 0===s&&(s=i),{viewport:e,coordinateSystem:r,coordinateOrigin:i,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:s}}(e),{autoOffset:l=!0}=e,{geospatialOrigin:u=mh,shaderCoordinateOrigin:c=mh,offsetMode:h=!1}=l?la(n,i,r):{},f=vh(t,{viewport:n,modelMatrix:o,coordinateSystem:s,coordinateOrigin:a,offsetMode:h});if(h){const t=n.projectPosition(u||c);G(f,f,t)}return f}(t,{viewport:this.internalState.viewport||this.context.viewport,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...e})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return!!this.internalState&&!this.internalState.isAsyncPropLoading()}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(t){for(const e of this.getModels())e.updateModuleSettings(t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:t}=this.props;return t===ri.DEFAULT||t===ri.LNGLAT||t===ri.CARTESIAN}onHover(t,e){return this.props.onHover&&this.props.onHover(t,e)||!1}onClick(t,e){return this.props.onClick&&this.props.onClick(t,e)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,e=[]){return e[0]=t+1&255,e[1]=t+1>>8&255,e[2]=t+1>>8>>8&255,e}decodePickingColor(t){m(t instanceof Uint8Array);const[e,n,i]=t;return e+256*n+65536*i-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&void 0!==this.state.numInstances?this.state.numInstances:function(t){if(null===(e=t)||"object"!=typeof e)throw new Error(dh);var e;if("function"==typeof t.count)return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(function(t){return null!==t&&"object"==typeof t&&t.constructor===Object}(t))return Object.keys(t).length;throw new Error(ph)}(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var t;return null===(t=this.getAttributeManager())||void 0===t?void 0:t.getBounds(["positions","instancePositions"])}getShaders(t){for(const e of this.props.extensions)t=gh(t,e.getShaders.call(this,e));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){const e=this.getAttributeManager(),{dataChanged:n}=t.changeFlags;if(n&&e)if(Array.isArray(n))for(const t of n)e.invalidateAll(t);else e.invalidateAll();if(e){const{props:n}=t,i=this.internalState.hasPickingBuffer,r=Number.isInteger(n.highlightedObjectIndex)||n.pickable||n.extensions.some((t=>t.getNeedsPickingBuffer.call(this,t)));if(i!==r){this.internalState.hasPickingBuffer=r;const{pickingColors:t,instancePickingColors:n}=e.attributes,i=t||n;i&&(r&&i.constant&&(i.constant=!1,e.invalidate(i.id)),i.value||r||(i.constant=!0,i.value=[0,0,0]))}}}finalizeState(t){for(const t of this.getModels())t.delete();const e=this.getAttributeManager();e&&e.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(const e of this.getModels())e.draw(t)}getPickingInfo({info:t,mode:e,sourceLayer:n}){const{index:i}=t;return i>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[i]),t}raiseError(t,e){var n,i,r,o;e&&(t.message="".concat(e,": ").concat(t.message)),null!==(n=(i=this.props).onError)&&void 0!==n&&n.call(i,t)||null===(r=this.context)||void 0===r||null===(o=r.onError)||void 0===o||o.call(r,t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return!!this.internalState&&(this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()))}hasUniformTransition(){var t;return(null===(t=this.internalState)||void 0===t?void 0:t.uniformTransitions.active)||!1}activateViewport(t){if(!this.internalState)return;const e=this.internalState.viewport;this.internalState.viewport=t,e&&zh({oldViewport:e,viewport:t})||(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){const e=this.getAttributeManager();e&&("all"===t?e.invalidateAll():e.invalidate(t))}updateAttributes(t){for(const e of this.getModels())this._setModelAttributes(e,t)}_updateAttributes(){const t=this.getAttributeManager();if(!t)return;const e=this.props,n=this.getNumInstances(),i=this.getStartIndices();t.update({data:e.data,numInstances:n,startIndices:i,props:e,transitions:e.transitions,buffers:e.data.attributes,context:this});const r=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(r)}_updateAttributeTransition(){const t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){const{uniformTransitions:t}=this.internalState;if(t.active){const e=t.update(),n=Object.create(this.props);for(const t in e)Object.defineProperty(n,t,{value:e[t]});return n}return this.props}calculateInstancePickingColors(t,{numInstances:e}){if(t.constant)return;const n=Math.floor(Bh.length/3);if(this.internalState.usesPickingColorCache=!0,n<e){e>Dh&&$t.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Bh=An.allocate(Bh,e,{size:3,copy:!0,maxCount:Math.max(e,Dh)});const t=Math.floor(Bh.length/3),i=[];for(let e=n;e<t;e++)this.encodePickingColor(e,i),Bh[3*e+0]=i[0],Bh[3*e+1]=i[1],Bh[3*e+2]=i[2]}t.value=Bh.subarray(0,3*e)}_setModelAttributes(t,e){const n=this.getAttributeManager(),i=t.userData.excludeAttributes||{},r=n.getShaderAttributes(e,i);t.setAttributes(r)}disablePickingIndex(t){this._disablePickingIndex(t)}_disablePickingIndex(t){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,i=e||n;if(!i)return;const r=i.getVertexOffset(t),o=i.getVertexOffset(t+1);i.buffer.subData({data:new Uint8Array(o-r),offset:r})}restorePickingColors(){const{pickingColors:t,instancePickingColors:e}=this.getAttributeManager().attributes,n=t||e;n&&(this.internalState.usesPickingColorCache&&n.value.buffer!==Bh.buffer&&(n.value=Bh.subarray(0,n.value.length)),n.updateSubBuffer({startOffset:0}))}_initialize(){m(!this.internalState),m(Number.isFinite(this.props.coordinateSystem)),te("layer.initialize",this);const t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new kh({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>($t.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new ah(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){te("layer.matched",this,this===t);const{state:e,internalState:n}=t;this!==t&&(this.internalState=n,this.state=e,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const t=this.needsUpdate();if(te("layer.update",this,t),!t)return;const e=this.props,n=this.context,i=this.internalState,r=n.viewport,o=this._updateUniformTransition();i.propsInTransition=o,n.viewport=i.viewport||r,this.props=o;try{const t=this._getUpdateParams(),o=this.getModels();if(n.gl)this.updateState(t);else try{this.updateState(t)}catch(t){}for(const e of this.props.extensions)e.updateState.call(this,t,e);const s=this.getModels()[0]!==o[0];this._postUpdate(t,s)}finally{n.viewport=r,this.props=e,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){te("layer.finalize",this),this.finalizeState(this.context);for(const t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({moduleParameters:t=null,uniforms:e={},parameters:n={}}){this._updateAttributeTransition();const i=this.props,r=this.context;this.props=this.internalState.propsInTransition||i;const o=this.props.opacity;e.opacity=Math.pow(o,1/2.2);try{t&&this.setModuleParameters(t);const{getPolygonOffset:o}=this.props,s=o&&o(e)||[0,0];Br(r.gl,{polygonOffset:s}),jr(r.gl,n,(()=>{const i={moduleParameters:t,uniforms:e,parameters:n,context:r};for(const t of this.props.extensions)t.draw.call(this,i,t);this.draw(i)}))}finally{this.props=i}}getChangeFlags(){var t;return null===(t=this.internalState)||void 0===t?void 0:t.changeFlags}setChangeFlags(t){if(!this.internalState)return;const{changeFlags:e}=this.internalState;for(const n in t)if(t[n]){let i=!1;if("dataChanged"===n){const r=t[n],o=e[n];r&&Array.isArray(o)&&(e.dataChanged=Array.isArray(r)?o.concat(r):r,i=!0)}e[n]||(e[n]=t[n],i=!0),i&&te("layer.changeFlag",this,n,t)}const n=Boolean(e.dataChanged||e.updateTriggersChanged||e.propsChanged||e.extensionsChanged);e.propsOrDataChanged=n,e.somethingChanged=n||e.viewportChanged||e.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,e){const n=function(t,e){const n=uh({newProps:t,oldProps:e,propTypes:t[Pt],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=function(t,e){if(null===e)return"oldProps is null, initial diff";let n=!1;const{dataComparator:i,_dataDiff:r}=t;return i?i(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&r&&(n=r(t.data,e.data)||n),n}(t,e);let r=!1;return i||(r=function(t,e){if(null===e)return{all:!0};if("all"in t.updateTriggers&&fh(t,e,"all"))return{all:!0};const n={};let i=!1;for(const r in t.updateTriggers)"all"!==r&&fh(t,e,r)&&(n[r]=!0,i=!0);return!!i&&n}(t,e)),{dataChanged:i,propsChanged:n,updateTriggersChanged:r,extensionsChanged:hh(t,e),transitionsChanged:lh(t,e)}}(t,e);if(n.updateTriggersChanged)for(const t in n.updateTriggersChanged)n.updateTriggersChanged[t]&&this.invalidateAttribute(t);if(n.transitionsChanged)for(const r in n.transitionsChanged){var i;this.internalState.uniformTransitions.add(r,e[r],t[r],null===(i=t.transitions)||void 0===i?void 0:i[r])}return this.setChangeFlags(n)}validateProps(){!function(t){const e=t[Pt];for(const n in e){const i=e[n],{validate:r}=i;if(r&&!r(t[n],i))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){const e={pickingSelectedColor:t.picked?t.color:null},{highlightColor:n}=this.props;t.picked&&"function"==typeof n&&(e.pickingHighlightColor=n(t)),this.setModuleParameters(e),this.setNeedsRedraw()}_getAttributeManager(){const t=this.context;return new nh(t.gl,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,e){const{props:n,oldProps:i}=t;this.setNeedsRedraw(),this._updateAttributes();const{model:r}=this.state;null==r||r.setInstanceCount(this.getNumInstances());const{autoHighlight:o,highlightedObjectIndex:s,highlightColor:a}=n;if(e||i.autoHighlight!==o||i.highlightedObjectIndex!==s||i.highlightColor!==a){const t={};o||(t.pickingSelectedColor=null),Array.isArray(a)&&(t.pickingHighlightColor=a),(e||s!==i.highlightedObjectIndex)&&(t.pickingSelectedColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setModuleParameters(t)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let e=!1;e=e||this.internalState.needsRedraw&&this.id;const n=this.getAttributeManager(),i=!!n&&n.getNeedsRedraw(t);if(e=e||i,e)for(const t of this.props.extensions)t.onNeedsRedraw.call(this,t);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,e}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}u(Uh,"defaultProps",jh),u(Uh,"layerName","Layer");const Vh={position:"absolute",zIndex:-1};function Gh(e,n){if("function"==typeof e)return e(n);if(Array.isArray(e))return e.map((t=>Gh(t,n)));if(qh(e)){if(function(t){const e=t.type,n=e&&e.defaultProps;return n&&n.mapStyle}(e))return n.style=Vh,(0,t.cloneElement)(e,n);if(function(t){const e=t.type;return e&&e.deckGLViewProps}(e))return(0,t.cloneElement)(e,n)}return e}function qh(t){return t&&"object"==typeof t&&"type"in t||!1}function Wh(e){if("function"==typeof e)return(0,t.createElement)(ba,{},e);if(Array.isArray(e))return e.map(Wh);if(qh(e)){if(e.type===t.Fragment)return Wh(e.props.children);if(tc(e.type,ba))return e}return e}const Hh={mixBlendMode:null};function Xh(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}const Yh=(0,t.forwardRef)(((e,n)=>{const[i,r]=(0,t.useState)(0),o=(0,t.useRef)({control:null,version:i,forceUpdate:()=>r((t=>t+1))}).current,s=(0,t.useRef)(null),a=(0,t.useRef)(null),l=(0,t.useMemo)((()=>function({children:e,layers:n=[],views:i=null}){const r=[],o=[],s={};return t.Children.forEach(Wh(e),(t=>{if(qh(t)){const e=t.type;if(tc(e,Uh)){const n=function(t,e){const n={},i=t.defaultProps||{};for(const t in e)i[t]!==e[t]&&(n[t]=e[t]);return new t(n)}(e,t.props);o.push(n)}else r.push(t);if(tc(e,ba)&&e!==ba&&t.props.id){const n=new e(t.props);s[n.id]=n}}else t&&r.push(t)})),Object.keys(s).length>0&&(Array.isArray(i)?i.forEach((t=>{s[t.id]=t})):i&&(s[i.id]=i),i=Object.values(s)),{layers:n=o.length>0?[...o,...n]:n,children:r,views:i}}(e)),[e.layers,e.views,e.children]);let u=!0;const c=t=>{var n;return u&&e.viewState?(o.viewStateUpdateRequested=t,null):(o.viewStateUpdateRequested=null,null===(n=e.onViewStateChange)||void 0===n?void 0:n.call(e,t))},h=t=>{var n;u?o.interactionStateUpdateRequested=t:(o.interactionStateUpdateRequested=null,null===(n=e.onInteractionStateChange)||void 0===n||n.call(e,t))},f=(0,t.useMemo)((()=>{const t={...e,style:null,width:"100%",height:"100%",parent:s.current,canvas:a.current,layers:l.layers,views:l.views,onViewStateChange:c,onInteractionStateChange:h};return delete t._customRender,o.deck&&o.deck.setProps(t),t}),[e]);(0,t.useEffect)((()=>{const t=e.Deck||Qu;return o.deck=function(t,e,n){const i=new e({...n,_customRender:e=>{t.redrawReason=e;const n=i.getViewports();t.lastRenderedViewports!==n?t.forceUpdate():Xh(t)}});return i}(o,t,{...f,parent:s.current,canvas:a.current}),()=>{var t;return null===(t=o.deck)||void 0===t?void 0:t.finalize()}}),[]),Ju((()=>{Xh(o);const{viewStateUpdateRequested:t,interactionStateUpdateRequested:e}=o;t&&c(t),e&&h(e)})),(0,t.useImperativeHandle)(n,(()=>function(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}(o)),[]);const d=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:p,width:g,height:m,id:y,style:v}=e,{containerStyle:_,canvasStyle:b}=(0,t.useMemo)((()=>function({width:t,height:e,style:n}){const i={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},r={left:0,top:0};if(n)for(const t in n)t in Hh?r[t]=n[t]:i[t]=n[t];return{containerStyle:i,canvasStyle:r}}({width:g,height:m,style:v})),[g,m,v]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===d||o.version!==i){o.lastRenderedViewports=d,o.version=i;const e=function({children:e,deck:n,ContextProvider:i}){const{viewManager:r}=n||{};if(!r||!r.views.length)return[];const o={},s=r.views[0].id;for(const t of e){let e=s,n=t;qh(t)&&tc(t.type,ba)&&(e=t.props.id||s,n=t.props.children);const i=r.getViewport(e),a=r.getViewState(e);if(i){a.padding=i.padding;const{x:t,y:r,width:s,height:l}=i;n=Gh(n,{x:t,y:r,width:s,height:l,viewport:i,viewState:a}),o[e]||(o[e]={viewport:i,children:[]}),o[e].children.push(n)}}return Object.keys(o).map((e=>{const{viewport:r,children:s}=o[e],{x:a,y:l,width:u,height:c}=r,h={position:"absolute",left:a,top:l,width:u,height:c},f="view-".concat(e),d=(0,t.createElement)("div",{key:f,id:f,style:h},...s);if(i){const o={viewport:r,container:n.canvas.offsetParent,eventManager:n.eventManager,onViewStateChange:t=>{t.viewId=e,n._onViewStateChange(t)}};return(0,t.createElement)(i,{key:f,value:o},d)}return d}))}({children:l.children,deck:o.deck,ContextProvider:p}),n=(0,t.createElement)("canvas",{key:"canvas",id:y||"deckgl-overlay",ref:a,style:b});o.control=(0,t.createElement)("div",{id:"".concat(y||"deckgl","-wrapper"),ref:s,style:_},[n,e])}return u=!1,o.control}));Yh.defaultProps=Qu.defaultProps;const Zh=Yh;function Kh(t,e,n){if(null!==t)for(var i,r,o,s,a,l,u,c,h=0,f=0,d=t.type,p="FeatureCollection"===d,g="Feature"===d,m=p?t.features.length:1,y=0;y<m;y++){a=(c=!!(u=p?t.features[y].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var v=0;v<a;v++){var _=0,b=0;if(null!==(s=c?u.geometries[v]:u)){l=s.coordinates;var x=s.type;switch(h=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(l,f,y,_,b))return!1;f++,_++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],f,y,_,b))return!1;f++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-h;r++){if(!1===e(l[i][r],f,y,_,b))return!1;f++}"MultiLineString"===x&&_++,"Polygon"===x&&b++}"Polygon"===x&&_++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(b=0,r=0;r<l[i].length;r++){for(o=0;o<l[i][r].length-h;o++){if(!1===e(l[i][r][o],f,y,_,b))return!1;f++}b++}_++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===Kh(s.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function $h(t){var e=[1/0,1/0,-1/0,-1/0];return Kh(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}$h.default=$h;const Qh=$h;function Jh(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var i,r=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),o="Feature"===(i=e).type?i.geometry:i,s=o.type,a=e.bbox,l=o.coordinates;if(a&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(r,a))return!1;"Polygon"===s&&(l=[l]);for(var u=!1,c=0;c<l.length&&!u;c++)if(tf(r,l[c][0],n.ignoreBoundary)){for(var h=!1,f=1;f<l[c].length&&!h;)tf(r,l[c][f],!n.ignoreBoundary)&&(h=!0),f++;h||(u=!0)}return u}function tf(t,e,n){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var r=0,o=e.length-1;r<e.length;o=r++){var s=e[r][0],a=e[r][1],l=e[o][0],u=e[o][1];if(t[1]*(s-l)+a*(l-t[0])+u*(t[0]-s)==0&&(s-t[0])*(l-t[0])<=0&&(a-t[1])*(u-t[1])<=0)return!n;a>t[1]!=u>t[1]&&t[0]<(l-s)*(t[1]-a)/(u-a)+s&&(i=!i)}return i}s(7418),s(2273),Object.prototype.hasOwnProperty;var ef=new ArrayBuffer(16);function nf(t,e){void 0===e&&(e={});var n=Number(t[0]),i=Number(t[1]),r=Number(t[2]),o=Number(t[3]);if(6===t.length)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[n,i];return function(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return function(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}({type:"Polygon",coordinates:t},e,n)}([[s,[r,i],[r,o],[n,o],s]],e.properties,{bbox:t,id:e.id})}new Float64Array(ef),new Uint32Array(ef),s(5510),function(){function t(t){this.points=t.points||[],this.duration=t.duration||1e4,this.sharpness=t.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=t.stepLength||60,this.length=this.points.length,this.delay=0;for(var e=0;e<this.length;e++)this.points[e].z=this.points[e].z||0;for(e=0;e<this.length-1;e++){var n=this.points[e],i=this.points[e+1];this.centers.push({x:(n.x+i.x)/2,y:(n.y+i.y)/2,z:(n.z+i.z)/2})}for(this.controls.push([this.points[0],this.points[0]]),e=0;e<this.centers.length-1;e++){var r=this.points[e+1].x-(this.centers[e].x+this.centers[e+1].x)/2,o=this.points[e+1].y-(this.centers[e].y+this.centers[e+1].y)/2,s=this.points[e+1].z-(this.centers[e].y+this.centers[e+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e].z+s)},{x:(1-this.sharpness)*this.points[e+1].x+this.sharpness*(this.centers[e+1].x+r),y:(1-this.sharpness)*this.points[e+1].y+this.sharpness*(this.centers[e+1].y+o),z:(1-this.sharpness)*this.points[e+1].z+this.sharpness*(this.centers[e+1].z+s)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}t.prototype.cacheSteps=function(t){var e=[],n=this.pos(0);e.push(0);for(var i=0;i<this.duration;i+=10){var r=this.pos(i);Math.sqrt((r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y)+(r.z-n.z)*(r.z-n.z))>t&&(e.push(i),n=r)}return e},t.prototype.vector=function(t){var e=this.pos(t+10),n=this.pos(t-10);return{angle:180*Math.atan2(e.y-n.y,e.x-n.x)/3.14,speed:Math.sqrt((n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y)+(n.z-e.z)*(n.z-e.z))}},t.prototype.pos=function(t){var e=t-this.delay;e<0&&(e=0),e>this.duration&&(e=this.duration-1);var n=e/this.duration;if(n>=1)return this.points[this.length-1];var i=Math.floor((this.points.length-1)*n);return function(t,e,n,i,r){var o=function(t){var e=t*t;return[e*t,3*e*(1-t),3*t*(1-t)*(1-t),(1-t)*(1-t)*(1-t)]}(t);return{x:r.x*o[0]+i.x*o[1]+n.x*o[2]+e.x*o[3],y:r.y*o[0]+i.y*o[1]+n.y*o[2]+e.y*o[3],z:r.z*o[0]+i.z*o[1]+n.z*o[2]+e.z*o[3]}}((this.length-1)*n-i,this.points[i],this.controls[i][1],this.controls[i+1][0],this.points[i+1])}}();function rf(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}const of=function(t,e){void 0===e&&(e={});var n=Qh(t);return function(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!rf(t[0])||!rf(t[1]))throw new Error("coordinates must contain numbers");return function(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}({type:"Point",coordinates:t},e,n)}([(n[0]+n[2])/2,(n[1]+n[3])/2],e.properties,e)};var sf=s(9187),af=s.n(sf);s(1787);var lf=Math.PI/180,uf=180/Math.PI,cf=function(t,e){this.lon=t,this.lat=e,this.x=lf*t,this.y=lf*e};cf.prototype.view=function(){return String(this.lon).slice(0,4)+","+String(this.lat).slice(0,4)},cf.prototype.antipode=function(){var t=-1*this.lat,e=this.lon<0?180+this.lon:-1*(180-this.lon);return new cf(e,t)};var hf=function(){this.coords=[],this.length=0};hf.prototype.move_to=function(t){this.length++,this.coords.push(t)};var ff=function(t){this.properties=t||{},this.geometries=[]};ff.prototype.json=function(){if(this.geometries.length<=0)return{geometry:{type:"LineString",coordinates:null},type:"Feature",properties:this.properties};if(1===this.geometries.length)return{geometry:{type:"LineString",coordinates:this.geometries[0].coords},type:"Feature",properties:this.properties};for(var t=[],e=0;e<this.geometries.length;e++)t.push(this.geometries[e].coords);return{geometry:{type:"MultiLineString",coordinates:t},type:"Feature",properties:this.properties}},ff.prototype.wkt=function(){for(var t="",e="LINESTRING(",n=function(t){e+=t[0]+" "+t[1]+","},i=0;i<this.geometries.length;i++){if(0===this.geometries[i].coords.length)return"LINESTRING(empty)";this.geometries[i].coords.forEach(n),t+=e.substring(0,e.length-1)+")"}return t};var df=function(t,e,n){if(!t||void 0===t.x||void 0===t.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");if(!e||void 0===e.x||void 0===e.y)throw new Error("GreatCircle constructor expects two args: start and end objects with x and y properties");this.start=new cf(t.x,t.y),this.end=new cf(e.x,e.y),this.properties=n||{};var i=this.start.x-this.end.x,r=this.start.y-this.end.y,o=Math.pow(Math.sin(r/2),2)+Math.cos(this.start.y)*Math.cos(this.end.y)*Math.pow(Math.sin(i/2),2);if(this.g=2*Math.asin(Math.sqrt(o)),this.g===Math.PI)throw new Error("it appears "+t.view()+" and "+e.view()+" are 'antipodal', e.g diametrically opposite, thus there is no single route but rather infinite");if(isNaN(this.g))throw new Error("could not calculate great circle between "+t+" and "+e)};function pf(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!gf(t[0])||!gf(t[1]))throw new Error("coordinates must contain numbers");return function(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}({type:"Point",coordinates:t},e,n)}function gf(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}df.prototype.interpolate=function(t){var e=Math.sin((1-t)*this.g)/Math.sin(this.g),n=Math.sin(t*this.g)/Math.sin(this.g),i=e*Math.cos(this.start.y)*Math.cos(this.start.x)+n*Math.cos(this.end.y)*Math.cos(this.end.x),r=e*Math.cos(this.start.y)*Math.sin(this.start.x)+n*Math.cos(this.end.y)*Math.sin(this.end.x),o=e*Math.sin(this.start.y)+n*Math.sin(this.end.y),s=uf*Math.atan2(o,Math.sqrt(Math.pow(i,2)+Math.pow(r,2)));return[uf*Math.atan2(r,i),s]},df.prototype.Arc=function(t,e){var n=[];if(!t||t<=2)n.push([this.start.lon,this.start.lat]),n.push([this.end.lon,this.end.lat]);else for(var i=1/(t-1),r=0;r<t;++r){var o=i*r,s=this.interpolate(o);n.push(s)}for(var a=!1,l=0,u=e&&e.offset?e.offset:10,c=180-u,h=-180+u,f=360-u,d=1;d<n.length;++d){var p=n[d-1][0],g=n[d][0],m=Math.abs(g-p);m>f&&(g>c&&p<h||p>c&&g<h)?a=!0:m>l&&(l=m)}var y=[];if(a&&l<u){var v=[];y.push(v);for(var _=0;_<n.length;++_){var b=parseFloat(n[_][0]);if(_>0&&Math.abs(b-n[_-1][0])>f){var x=parseFloat(n[_-1][0]),w=parseFloat(n[_-1][1]),E=parseFloat(n[_][0]),S=parseFloat(n[_][1]);if(x>-180&&x<h&&180===E&&_+1<n.length&&n[_-1][0]>-180&&n[_-1][0]<h){v.push([-180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(x>c&&x<180&&-180===E&&_+1<n.length&&n[_-1][0]>c&&n[_-1][0]<180){v.push([180,n[_][1]]),_++,v.push([n[_][0],n[_][1]]);continue}if(x<h&&E>c){var P=x;x=E,E=P;var C=w;w=S,S=C}if(x>c&&E<h&&(E+=360),x<=180&&E>=180&&x<E){var I=(180-x)/(E-x),T=I*S+(1-I)*w;v.push([n[_-1][0]>c?180:-180,T]),(v=[]).push([n[_-1][0]>c?-180:180,T]),y.push(v)}else v=[],y.push(v);v.push([b,n[_][1]])}else v.push([n[_][0],n[_][1]])}}else{var M=[];y.push(M);for(var L=0;L<n.length;++L)M.push([n[L][0],n[L][1]])}for(var A=new ff(this.properties),O=0;O<y.length;++O){var N=new hf;A.geometries.push(N);for(var R=y[O],k=0;k<R.length;++k)N.move_to(R[k])}return A},s(251);var mf=[],yf=[],vf=[],_f=[],bf=[],xf=[],wf=[],Ef=[],Sf=[],Pf=[],Cf=[],If=[],Tf=[],Mf=[],Lf=[],Af=[],Of=[],Nf=[],Rf=[],kf=[],Df=[],Ff=[],zf=[],Bf=[];wf[85]=Pf[85]=-1,Ef[85]=Cf[85]=0,Sf[85]=If[85]=1,Rf[85]=Ff[85]=1,kf[85]=zf[85]=0,Df[85]=Bf[85]=1,mf[85]=_f[85]=0,yf[85]=bf[85]=-1,vf[85]=Lf[85]=0,Af[85]=Tf[85]=0,Of[85]=Mf[85]=1,xf[85]=Nf[85]=1,Ff[1]=Ff[169]=0,zf[1]=zf[169]=-1,Bf[1]=Bf[169]=0,Tf[1]=Tf[169]=-1,Mf[1]=Mf[169]=0,Lf[1]=Lf[169]=0,Pf[4]=Pf[166]=0,Cf[4]=Cf[166]=-1,If[4]=If[166]=1,Af[4]=Af[166]=1,Of[4]=Of[166]=0,Nf[4]=Nf[166]=0,wf[16]=wf[154]=0,Ef[16]=Ef[154]=1,Sf[16]=Sf[154]=1,_f[16]=_f[154]=1,bf[16]=bf[154]=0,xf[16]=xf[154]=1,Rf[64]=Rf[106]=0,kf[64]=kf[106]=1,Df[64]=Df[106]=0,mf[64]=mf[106]=-1,yf[64]=yf[106]=0,vf[64]=vf[106]=1,Rf[2]=Rf[168]=0,kf[2]=kf[168]=-1,Df[2]=Df[168]=1,Ff[2]=Ff[168]=0,zf[2]=zf[168]=-1,Bf[2]=Bf[168]=0,Tf[2]=Tf[168]=-1,Mf[2]=Mf[168]=0,Lf[2]=Lf[168]=0,Af[2]=Af[168]=-1,Of[2]=Of[168]=0,Nf[2]=Nf[168]=1,wf[8]=wf[162]=0,Ef[8]=Ef[162]=-1,Sf[8]=Sf[162]=0,Pf[8]=Pf[162]=0,Cf[8]=Cf[162]=-1,If[8]=If[162]=1,Tf[8]=Tf[162]=1,Mf[8]=Mf[162]=0,Lf[8]=Lf[162]=1,Af[8]=Af[162]=1,Of[8]=Of[162]=0,Nf[8]=Nf[162]=0,wf[32]=wf[138]=0,Ef[32]=Ef[138]=1,Sf[32]=Sf[138]=1,Pf[32]=Pf[138]=0,Cf[32]=Cf[138]=1,If[32]=If[138]=0,mf[32]=mf[138]=1,yf[32]=yf[138]=0,vf[32]=vf[138]=0,_f[32]=_f[138]=1,bf[32]=bf[138]=0,xf[32]=xf[138]=1,Ff[128]=Ff[42]=0,zf[128]=zf[42]=1,Bf[128]=Bf[42]=1,Rf[128]=Rf[42]=0,kf[128]=kf[42]=1,Df[128]=Df[42]=0,mf[128]=mf[42]=-1,yf[128]=yf[42]=0,vf[128]=vf[42]=1,_f[128]=_f[42]=-1,bf[128]=bf[42]=0,xf[128]=xf[42]=0,Pf[5]=Pf[165]=-1,Cf[5]=Cf[165]=0,If[5]=If[165]=0,Ff[5]=Ff[165]=1,zf[5]=zf[165]=0,Bf[5]=Bf[165]=0,Af[20]=Af[150]=0,Of[20]=Of[150]=1,Nf[20]=Nf[150]=1,_f[20]=_f[150]=0,bf[20]=bf[150]=-1,xf[20]=xf[150]=1,wf[80]=wf[90]=-1,Ef[80]=Ef[90]=0,Sf[80]=Sf[90]=1,Rf[80]=Rf[90]=1,kf[80]=kf[90]=0,Df[80]=Df[90]=1,Tf[65]=Tf[105]=0,Mf[65]=Mf[105]=1,Lf[65]=Lf[105]=0,mf[65]=mf[105]=0,yf[65]=yf[105]=-1,vf[65]=vf[105]=0,wf[160]=wf[10]=-1,Ef[160]=Ef[10]=0,Sf[160]=Sf[10]=1,Pf[160]=Pf[10]=-1,Cf[160]=Cf[10]=0,If[160]=If[10]=0,Ff[160]=Ff[10]=1,zf[160]=zf[10]=0,Bf[160]=Bf[10]=0,Rf[160]=Rf[10]=1,kf[160]=kf[10]=0,Df[160]=Df[10]=1,Af[130]=Af[40]=0,Of[130]=Of[40]=1,Nf[130]=Nf[40]=1,Tf[130]=Tf[40]=0,Mf[130]=Mf[40]=1,Lf[130]=Lf[40]=0,mf[130]=mf[40]=0,yf[130]=yf[40]=-1,vf[130]=vf[40]=0,_f[130]=_f[40]=0,bf[130]=bf[40]=-1,xf[130]=xf[40]=1,Pf[37]=Pf[133]=0,Cf[37]=Cf[133]=1,If[37]=If[133]=1,Ff[37]=Ff[133]=0,zf[37]=zf[133]=1,Bf[37]=Bf[133]=0,mf[37]=mf[133]=-1,yf[37]=yf[133]=0,vf[37]=vf[133]=0,_f[37]=_f[133]=1,bf[37]=bf[133]=0,xf[37]=xf[133]=0,Af[148]=Af[22]=-1,Of[148]=Of[22]=0,Nf[148]=Nf[22]=0,Ff[148]=Ff[22]=0,zf[148]=zf[22]=-1,Bf[148]=Bf[22]=1,Rf[148]=Rf[22]=0,kf[148]=kf[22]=1,Df[148]=Df[22]=1,_f[148]=_f[22]=-1,bf[148]=bf[22]=0,xf[148]=xf[22]=1,wf[82]=wf[88]=0,Ef[82]=Ef[88]=-1,Sf[82]=Sf[88]=1,Af[82]=Af[88]=1,Of[82]=Of[88]=0,Nf[82]=Nf[88]=1,Tf[82]=Tf[88]=-1,Mf[82]=Mf[88]=0,Lf[82]=Lf[88]=1,Rf[82]=Rf[88]=0,kf[82]=kf[88]=-1,Df[82]=Df[88]=0,wf[73]=wf[97]=0,Ef[73]=Ef[97]=1,Sf[73]=Sf[97]=0,Pf[73]=Pf[97]=0,Cf[73]=Cf[97]=-1,If[73]=If[97]=0,Tf[73]=Tf[97]=1,Mf[73]=Mf[97]=0,Lf[73]=Lf[97]=0,mf[73]=mf[97]=1,yf[73]=yf[97]=0,vf[73]=vf[97]=1,wf[145]=wf[25]=0,Ef[145]=Ef[25]=-1,Sf[145]=Sf[25]=0,Tf[145]=Tf[25]=1,Mf[145]=Mf[25]=0,Lf[145]=Lf[25]=1,Ff[145]=Ff[25]=0,zf[145]=zf[25]=1,Bf[145]=Bf[25]=1,_f[145]=_f[25]=-1,bf[145]=bf[25]=0,xf[145]=xf[25]=0,Pf[70]=Pf[100]=0,Cf[70]=Cf[100]=1,If[70]=If[100]=0,Af[70]=Af[100]=-1,Of[70]=Of[100]=0,Nf[70]=Nf[100]=1,Rf[70]=Rf[100]=0,kf[70]=kf[100]=-1,Df[70]=Df[100]=1,mf[70]=mf[100]=1,yf[70]=yf[100]=0,vf[70]=vf[100]=0,Pf[101]=Pf[69]=0,Cf[101]=Cf[69]=1,If[101]=If[69]=0,mf[101]=mf[69]=1,yf[101]=yf[69]=0,vf[101]=vf[69]=0,Ff[149]=Ff[21]=0,zf[149]=zf[21]=1,Bf[149]=Bf[21]=1,_f[149]=_f[21]=-1,bf[149]=bf[21]=0,xf[149]=xf[21]=0,Af[86]=Af[84]=-1,Of[86]=Of[84]=0,Nf[86]=Nf[84]=1,Rf[86]=Rf[84]=0,kf[86]=kf[84]=-1,Df[86]=Df[84]=1,wf[89]=wf[81]=0,Ef[89]=Ef[81]=-1,Sf[89]=Sf[81]=0,Tf[89]=Tf[81]=1,Mf[89]=Mf[81]=0,Lf[89]=Lf[81]=1,wf[96]=wf[74]=0,Ef[96]=Ef[74]=1,Sf[96]=Sf[74]=0,Pf[96]=Pf[74]=-1,Cf[96]=Cf[74]=0,If[96]=If[74]=1,Rf[96]=Rf[74]=1,kf[96]=kf[74]=0,Df[96]=Df[74]=0,mf[96]=mf[74]=1,yf[96]=yf[74]=0,vf[96]=vf[74]=1,wf[24]=wf[146]=0,Ef[24]=Ef[146]=-1,Sf[24]=Sf[146]=1,Af[24]=Af[146]=1,Of[24]=Of[146]=0,Nf[24]=Nf[146]=1,Tf[24]=Tf[146]=0,Mf[24]=Mf[146]=1,Lf[24]=Lf[146]=1,_f[24]=_f[146]=0,bf[24]=bf[146]=-1,xf[24]=xf[146]=0,Pf[6]=Pf[164]=-1,Cf[6]=Cf[164]=0,If[6]=If[164]=1,Af[6]=Af[164]=-1,Of[6]=Of[164]=0,Nf[6]=Nf[164]=0,Ff[6]=Ff[164]=0,zf[6]=zf[164]=-1,Bf[6]=Bf[164]=1,Rf[6]=Rf[164]=1,kf[6]=kf[164]=0,Df[6]=Df[164]=0,Tf[129]=Tf[41]=0,Mf[129]=Mf[41]=1,Lf[129]=Lf[41]=1,Ff[129]=Ff[41]=0,zf[129]=zf[41]=1,Bf[129]=Bf[41]=0,mf[129]=mf[41]=-1,yf[129]=yf[41]=0,vf[129]=vf[41]=0,_f[129]=_f[41]=0,bf[129]=bf[41]=-1,xf[129]=xf[41]=0,Af[66]=Af[104]=0,Of[66]=Of[104]=1,Nf[66]=Nf[104]=0,Tf[66]=Tf[104]=-1,Mf[66]=Mf[104]=0,Lf[66]=Lf[104]=1,Rf[66]=Rf[104]=0,kf[66]=kf[104]=-1,Df[66]=Df[104]=0,mf[66]=mf[104]=0,yf[66]=yf[104]=-1,vf[66]=vf[104]=1,wf[144]=wf[26]=-1,Ef[144]=Ef[26]=0,Sf[144]=Sf[26]=0,Ff[144]=Ff[26]=1,zf[144]=zf[26]=0,Bf[144]=Bf[26]=1,Rf[144]=Rf[26]=0,kf[144]=kf[26]=1,Df[144]=Df[26]=1,_f[144]=_f[26]=-1,bf[144]=bf[26]=0,xf[144]=xf[26]=1,Pf[36]=Pf[134]=0,Cf[36]=Cf[134]=1,If[36]=If[134]=1,Af[36]=Af[134]=0,Of[36]=Of[134]=1,Nf[36]=Nf[134]=0,mf[36]=mf[134]=0,yf[36]=yf[134]=-1,vf[36]=vf[134]=1,_f[36]=_f[134]=1,bf[36]=bf[134]=0,xf[36]=xf[134]=0,wf[9]=wf[161]=-1,Ef[9]=Ef[161]=0,Sf[9]=Sf[161]=0,Pf[9]=Pf[161]=0,Cf[9]=Cf[161]=-1,If[9]=If[161]=0,Tf[9]=Tf[161]=1,Mf[9]=Mf[161]=0,Lf[9]=Lf[161]=0,Ff[9]=Ff[161]=1,zf[9]=zf[161]=0,Bf[9]=Bf[161]=1,wf[136]=0,Ef[136]=1,Sf[136]=1,Pf[136]=0,Cf[136]=1,If[136]=0,Af[136]=-1,Of[136]=0,Nf[136]=1,Tf[136]=-1,Mf[136]=0,Lf[136]=0,Ff[136]=0,zf[136]=-1,Bf[136]=0,Rf[136]=0,kf[136]=-1,Df[136]=1,mf[136]=1,yf[136]=0,vf[136]=0,_f[136]=1,bf[136]=0,xf[136]=1,wf[34]=0,Ef[34]=-1,Sf[34]=0,Pf[34]=0,Cf[34]=-1,If[34]=1,Af[34]=1,Of[34]=0,Nf[34]=0,Tf[34]=1,Mf[34]=0,Lf[34]=1,Ff[34]=0,zf[34]=1,Bf[34]=1,Rf[34]=0,kf[34]=1,Df[34]=0,mf[34]=-1,yf[34]=0,vf[34]=1,_f[34]=-1,bf[34]=0,xf[34]=0,wf[35]=0,Ef[35]=1,Sf[35]=1,Pf[35]=0,Cf[35]=-1,If[35]=1,Af[35]=1,Of[35]=0,Nf[35]=0,Tf[35]=-1,Mf[35]=0,Lf[35]=0,Ff[35]=0,zf[35]=-1,Bf[35]=0,Rf[35]=0,kf[35]=1,Df[35]=0,mf[35]=-1,yf[35]=0,vf[35]=1,_f[35]=1,bf[35]=0,xf[35]=1,wf[153]=0,Ef[153]=1,Sf[153]=1,Tf[153]=-1,Mf[153]=0,Lf[153]=0,Ff[153]=0,zf[153]=-1,Bf[153]=0,_f[153]=1,bf[153]=0,xf[153]=1,Pf[102]=0,Cf[102]=-1,If[102]=1,Af[102]=1,Of[102]=0,Nf[102]=0,Rf[102]=0,kf[102]=1,Df[102]=0,mf[102]=-1,yf[102]=0,vf[102]=1,wf[155]=0,Ef[155]=-1,Sf[155]=0,Tf[155]=1,Mf[155]=0,Lf[155]=1,Ff[155]=0,zf[155]=1,Bf[155]=1,_f[155]=-1,bf[155]=0,xf[155]=0,Pf[103]=0,Cf[103]=1,If[103]=0,Af[103]=-1,Of[103]=0,Nf[103]=1,Rf[103]=0,kf[103]=-1,Df[103]=1,mf[103]=1,yf[103]=0,vf[103]=0,wf[152]=0,Ef[152]=1,Sf[152]=1,Af[152]=-1,Of[152]=0,Nf[152]=1,Tf[152]=-1,Mf[152]=0,Lf[152]=0,Ff[152]=0,zf[152]=-1,Bf[152]=0,Rf[152]=0,kf[152]=-1,Df[152]=1,_f[152]=1,bf[152]=0,xf[152]=1,wf[156]=0,Ef[156]=-1,Sf[156]=1,Af[156]=1,Of[156]=0,Nf[156]=1,Tf[156]=-1,Mf[156]=0,Lf[156]=0,Ff[156]=0,zf[156]=-1,Bf[156]=0,Rf[156]=0,kf[156]=1,Df[156]=1,_f[156]=-1,bf[156]=0,xf[156]=1,wf[137]=0,Ef[137]=1,Sf[137]=1,Pf[137]=0,Cf[137]=1,If[137]=0,Tf[137]=-1,Mf[137]=0,Lf[137]=0,Ff[137]=0,zf[137]=-1,Bf[137]=0,mf[137]=1,yf[137]=0,vf[137]=0,_f[137]=1,bf[137]=0,xf[137]=1,wf[139]=0,Ef[139]=1,Sf[139]=1,Pf[139]=0,Cf[139]=-1,If[139]=0,Tf[139]=1,Mf[139]=0,Lf[139]=0,Ff[139]=0,zf[139]=1,Bf[139]=0,mf[139]=-1,yf[139]=0,vf[139]=0,_f[139]=1,bf[139]=0,xf[139]=1,wf[98]=0,Ef[98]=-1,Sf[98]=0,Pf[98]=0,Cf[98]=-1,If[98]=1,Af[98]=1,Of[98]=0,Nf[98]=0,Tf[98]=1,Mf[98]=0,Lf[98]=1,Rf[98]=0,kf[98]=1,Df[98]=0,mf[98]=-1,yf[98]=0,vf[98]=1,wf[99]=0,Ef[99]=1,Sf[99]=0,Pf[99]=0,Cf[99]=-1,If[99]=1,Af[99]=1,Of[99]=0,Nf[99]=0,Tf[99]=-1,Mf[99]=0,Lf[99]=1,Rf[99]=0,kf[99]=-1,Df[99]=0,mf[99]=1,yf[99]=0,vf[99]=1,Pf[38]=0,Cf[38]=-1,If[38]=1,Af[38]=1,Of[38]=0,Nf[38]=0,Ff[38]=0,zf[38]=1,Bf[38]=1,Rf[38]=0,kf[38]=1,Df[38]=0,mf[38]=-1,yf[38]=0,vf[38]=1,_f[38]=-1,bf[38]=0,xf[38]=0,Pf[39]=0,Cf[39]=1,If[39]=1,Af[39]=-1,Of[39]=0,Nf[39]=0,Ff[39]=0,zf[39]=-1,Bf[39]=1,Rf[39]=0,kf[39]=1,Df[39]=0,mf[39]=-1,yf[39]=0,vf[39]=1,_f[39]=1,bf[39]=0,xf[39]=0;var jf=function(t){return[[t.bottomleft,0],[0,0],[0,t.leftbottom]]},Uf=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0]]},Vf=function(t){return[[t.topright,1],[1,1],[1,t.righttop]]},Gf=function(t){return[[0,t.lefttop],[0,1],[t.topleft,1]]},qf=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop]]},Wf=function(t){return[[t.bottomright,0],[t.bottomleft,0],[1,t.righttop],[1,t.rightbottom]]},Hf=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.topleft,1],[t.topright,1]]},Xf=function(t){return[[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},Yf=[],Zf=[],Kf=[],$f=[],Qf=[],Jf=[],td=[],ed=[];$f[1]=Qf[1]=18,$f[169]=Qf[169]=18,Kf[4]=Zf[4]=12,Kf[166]=Zf[166]=12,Yf[16]=ed[16]=4,Yf[154]=ed[154]=4,Jf[64]=td[64]=22,Jf[106]=td[106]=22,Kf[2]=Jf[2]=17,$f[2]=Qf[2]=18,Kf[168]=Jf[168]=17,$f[168]=Qf[168]=18,Yf[8]=$f[8]=9,Zf[8]=Kf[8]=12,Yf[162]=$f[162]=9,Zf[162]=Kf[162]=12,Yf[32]=ed[32]=4,Zf[32]=td[32]=1,Yf[138]=ed[138]=4,Zf[138]=td[138]=1,Qf[128]=ed[128]=21,Jf[128]=td[128]=22,Qf[42]=ed[42]=21,Jf[42]=td[42]=22,Zf[5]=Qf[5]=14,Zf[165]=Qf[165]=14,Kf[20]=ed[20]=6,Kf[150]=ed[150]=6,Yf[80]=Jf[80]=11,Yf[90]=Jf[90]=11,$f[65]=td[65]=3,$f[105]=td[105]=3,Yf[160]=Jf[160]=11,Zf[160]=Qf[160]=14,Yf[10]=Jf[10]=11,Zf[10]=Qf[10]=14,Kf[130]=ed[130]=6,$f[130]=td[130]=3,Kf[40]=ed[40]=6,$f[40]=td[40]=3,Zf[101]=td[101]=1,Zf[69]=td[69]=1,Qf[149]=ed[149]=21,Qf[21]=ed[21]=21,Kf[86]=Jf[86]=17,Kf[84]=Jf[84]=17,Yf[89]=$f[89]=9,Yf[81]=$f[81]=9,Yf[96]=td[96]=0,Zf[96]=Jf[96]=15,Yf[74]=td[74]=0,Zf[74]=Jf[74]=15,Yf[24]=Kf[24]=8,$f[24]=ed[24]=7,Yf[146]=Kf[146]=8,$f[146]=ed[146]=7,Zf[6]=Jf[6]=15,Kf[6]=Qf[6]=16,Zf[164]=Jf[164]=15,Kf[164]=Qf[164]=16,$f[129]=ed[129]=7,Qf[129]=td[129]=20,$f[41]=ed[41]=7,Qf[41]=td[41]=20,Kf[66]=td[66]=2,$f[66]=Jf[66]=19,Kf[104]=td[104]=2,$f[104]=Jf[104]=19,Yf[144]=Qf[144]=10,Jf[144]=ed[144]=23,Yf[26]=Qf[26]=10,Jf[26]=ed[26]=23,Zf[36]=ed[36]=5,Kf[36]=td[36]=2,Zf[134]=ed[134]=5,Kf[134]=td[134]=2,Yf[9]=Qf[9]=10,Zf[9]=$f[9]=13,Yf[161]=Qf[161]=10,Zf[161]=$f[161]=13,Zf[37]=ed[37]=5,Qf[37]=td[37]=20,Zf[133]=ed[133]=5,Qf[133]=td[133]=20,Kf[148]=Qf[148]=16,Jf[148]=ed[148]=23,Kf[22]=Qf[22]=16,Jf[22]=ed[22]=23,Yf[82]=Kf[82]=8,$f[82]=Jf[82]=19,Yf[88]=Kf[88]=8,$f[88]=Jf[88]=19,Yf[73]=td[73]=0,Zf[73]=$f[73]=13,Yf[97]=td[97]=0,Zf[97]=$f[97]=13,Yf[145]=$f[145]=9,Qf[145]=ed[145]=21,Yf[25]=$f[25]=9,Qf[25]=ed[25]=21,Zf[70]=td[70]=1,Kf[70]=Jf[70]=17,Zf[100]=td[100]=1,Kf[100]=Jf[100]=17,Yf[34]=$f[34]=9,Zf[34]=Kf[34]=12,Qf[34]=ed[34]=21,Jf[34]=td[34]=22,Yf[136]=ed[136]=4,Zf[136]=td[136]=1,Kf[136]=Jf[136]=17,$f[136]=Qf[136]=18,Yf[35]=ed[35]=4,Zf[35]=Kf[35]=12,$f[35]=Qf[35]=18,Jf[35]=td[35]=22,Yf[153]=ed[153]=4,$f[153]=Qf[153]=18,Zf[102]=Kf[102]=12,Jf[102]=td[102]=22,Yf[155]=$f[155]=9,Qf[155]=ed[155]=23,Zf[103]=td[103]=1,Kf[103]=Jf[103]=17,Yf[152]=ed[152]=4,Kf[152]=Jf[152]=17,$f[152]=Qf[152]=18,Yf[156]=Kf[156]=8,$f[156]=Qf[156]=18,Jf[156]=ed[156]=23,Yf[137]=ed[137]=4,Zf[137]=td[137]=1,$f[137]=Qf[137]=18,Yf[139]=ed[139]=4,Zf[139]=$f[139]=13,Qf[139]=td[139]=20,Yf[98]=$f[98]=9,Zf[98]=Kf[98]=12,Jf[98]=td[98]=22,Yf[99]=td[99]=0,Zf[99]=Kf[99]=12,$f[99]=Jf[99]=19,Zf[38]=Kf[38]=12,Qf[38]=ed[38]=21,Jf[38]=td[38]=22,Zf[39]=ed[39]=5,Kf[39]=Qf[39]=16,Jf[39]=td[39]=22;var nd=[];function id(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}function rd(t,e,n){if(void 0===n&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!od(t[0])||!od(t[1]))throw new Error("coordinates must contain numbers");return id({type:"Point",coordinates:t},e,n)}function od(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function sd(t,e,n){var i,r=e[0]-t[0],o=e[1]-t[1],s=n[0]-e[0];return((i=r*(n[1]-e[1])-s*o)>0)-(i<0)||+i}function ad(t,e){return e.geometry.coordinates[0].every((function(e){return Jh(rd(e),t)}))}nd[1]=nd[169]=jf,nd[4]=nd[166]=Uf,nd[16]=nd[154]=Vf,nd[64]=nd[106]=Gf,nd[168]=nd[2]=qf,nd[162]=nd[8]=Wf,nd[138]=nd[32]=Hf,nd[42]=nd[128]=Xf,nd[5]=nd[165]=function(t){return[[0,0],[0,t.leftbottom],[1,t.rightbottom],[1,0]]},nd[20]=nd[150]=function(t){return[[1,0],[t.bottomright,0],[t.topright,1],[1,1]]},nd[80]=nd[90]=function(t){return[[1,1],[1,t.righttop],[0,t.lefttop],[0,1]]},nd[65]=nd[105]=function(t){return[[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},nd[160]=nd[10]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.leftbottom],[0,t.lefttop]]},nd[130]=nd[40]=function(t){return[[t.topleft,1],[t.topright,1],[t.bottomright,0],[t.bottomleft,0]]},nd[85]=function(){return[[0,0],[0,1],[1,1],[1,0]]},nd[101]=nd[69]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,1],[t.topleft,1]]},nd[149]=nd[21]=function(t){return[[t.topright,1],[1,1],[1,0],[0,0],[0,t.leftbottom]]},nd[86]=nd[84]=function(t){return[[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[1,1]]},nd[89]=nd[81]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,1]]},nd[96]=nd[74]=function(t){return[[1,t.righttop],[1,t.rightbottom],[0,t.lefttop],[0,1],[t.topleft,1]]},nd[24]=nd[146]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[t.topright,1]]},nd[6]=nd[164]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop]]},nd[129]=nd[41]=function(t){return[[t.topright,1],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1]]},nd[66]=nd[104]=function(t){return[[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},nd[144]=nd[26]=function(t){return[[1,1],[1,t.righttop],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},nd[36]=nd[134]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[t.topleft,1],[t.topright,1]]},nd[9]=nd[161]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom]]},nd[37]=nd[133]=function(t){return[[1,t.rightbottom],[1,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},nd[148]=nd[22]=function(t){return[[1,1],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},nd[82]=nd[88]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1]]},nd[73]=nd[97]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,1],[t.topleft,1]]},nd[145]=nd[25]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},nd[70]=nd[100]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},nd[34]=function(t){return[Xf(t),Wf(t)]},nd[35]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]},nd[136]=function(t){return[Hf(t),qf(t)]},nd[153]=function(t){return[Vf(t),jf(t)]},nd[102]=function(t){return[Uf(t),Gf(t)]},nd[155]=function(t){return[[1,1],[1,t.righttop],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topright,1]]},nd[103]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.lefttop],[0,1],[t.topleft,1]]},nd[152]=function(t){return[Vf(t),qf(t)]},nd[156]=function(t){return[[1,1],[1,t.righttop],[t.bottomright,0],[t.bottomleft,0],[0,t.leftbottom],[0,t.lefttop],[t.topright,1]]},nd[137]=function(t){return[Hf(t),jf(t)]},nd[139]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomleft,0],[0,0],[0,t.leftbottom],[t.topleft,1],[t.topright,1]]},nd[98]=function(t){return[Wf(t),Gf(t)]},nd[99]=function(t){return[[1,t.righttop],[1,t.rightbottom],[t.bottomright,0],[t.bottomleft,0],[0,t.lefttop],[0,1],[t.topleft,1]]},nd[38]=function(t){return[Uf(t),Xf(t)]},nd[39]=function(t){return[[1,t.rightbottom],[1,0],[t.bottomright,0],[0,t.leftbottom],[0,t.lefttop],[t.topleft,1],[t.topright,1]]};const ld=function(){function t(e){this.id=t.buildId(e),this.coordinates=e,this.innerEdges=[],this.outerEdges=[],this.outerEdgesSorted=!1}return t.buildId=function(t){return t.join(",")},t.prototype.removeInnerEdge=function(t){this.innerEdges=this.innerEdges.filter((function(e){return e.from.id!==t.from.id}))},t.prototype.removeOuterEdge=function(t){this.outerEdges=this.outerEdges.filter((function(e){return e.to.id!==t.to.id}))},t.prototype.addOuterEdge=function(t){this.outerEdges.push(t),this.outerEdgesSorted=!1},t.prototype.sortOuterEdges=function(){var t=this;this.outerEdgesSorted||(this.outerEdges.sort((function(e,n){var i=e.to,r=n.to;if(i.coordinates[0]-t.coordinates[0]>=0&&r.coordinates[0]-t.coordinates[0]<0)return 1;if(i.coordinates[0]-t.coordinates[0]<0&&r.coordinates[0]-t.coordinates[0]>=0)return-1;if(i.coordinates[0]-t.coordinates[0]==0&&r.coordinates[0]-t.coordinates[0]==0)return i.coordinates[1]-t.coordinates[1]>=0||r.coordinates[1]-t.coordinates[1]>=0?i.coordinates[1]-r.coordinates[1]:r.coordinates[1]-i.coordinates[1];var o=sd(t.coordinates,i.coordinates,r.coordinates);return o<0?1:o>0?-1:Math.pow(i.coordinates[0]-t.coordinates[0],2)+Math.pow(i.coordinates[1]-t.coordinates[1],2)-(Math.pow(r.coordinates[0]-t.coordinates[0],2)+Math.pow(r.coordinates[1]-t.coordinates[1],2))})),this.outerEdgesSorted=!0)},t.prototype.getOuterEdges=function(){return this.sortOuterEdges(),this.outerEdges},t.prototype.getOuterEdge=function(t){return this.sortOuterEdges(),this.outerEdges[t]},t.prototype.addInnerEdge=function(t){this.innerEdges.push(t)},t}(),ud=function(){function t(t,e){this.from=t,this.to=e,this.next=void 0,this.label=void 0,this.symetric=void 0,this.ring=void 0,this.from.addOuterEdge(this),this.to.addInnerEdge(this)}return t.prototype.getSymetric=function(){return this.symetric||(this.symetric=new t(this.to,this.from),this.symetric.symetric=this),this.symetric},t.prototype.deleteEdge=function(){this.from.removeOuterEdge(this),this.to.removeInnerEdge(this)},t.prototype.isEqual=function(t){return this.from.id===t.from.id&&this.to.id===t.to.id},t.prototype.toString=function(){return"Edge { "+this.from.id+" -> "+this.to.id+" }"},t.prototype.toLineString=function(){return function(t,e,n){if(void 0===n&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return id({type:"LineString",coordinates:t},e,n)}([this.from.coordinates,this.to.coordinates])},t.prototype.compareTo=function(t){return sd(t.from.coordinates,t.to.coordinates,this.to.coordinates)},t}();var cd=function(){function t(){this.edges=[],this.polygon=void 0,this.envelope=void 0}return t.prototype.push=function(t){this.edges.push(t),this.polygon=this.envelope=void 0},t.prototype.get=function(t){return this.edges[t]},Object.defineProperty(t.prototype,"length",{get:function(){return this.edges.length},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.edges.forEach(t)},t.prototype.map=function(t){return this.edges.map(t)},t.prototype.some=function(t){return this.edges.some(t)},t.prototype.isValid=function(){return!0},t.prototype.isHole=function(){var t=this,e=this.edges.reduce((function(e,n,i){return n.from.coordinates[1]>t.edges[e].from.coordinates[1]&&(e=i),e}),0),n=(0===e?this.length:e)-1,i=(e+1)%this.length,r=sd(this.edges[n].from.coordinates,this.edges[e].from.coordinates,this.edges[i].from.coordinates);return 0===r?this.edges[n].from.coordinates[0]>this.edges[i].from.coordinates[0]:r>0},t.prototype.toMultiPoint=function(){return t=this.edges.map((function(t){return t.from.coordinates})),void 0===n&&(n={}),id({type:"MultiPoint",coordinates:t},e,n);var t,e,n},t.prototype.toPolygon=function(){if(this.polygon)return this.polygon;var t=this.edges.map((function(t){return t.from.coordinates}));return t.push(this.edges[0].from.coordinates),this.polygon=function(t,e,n){void 0===n&&(n={});for(var i=0,r=t;i<r.length;i++){var o=r[i];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return id({type:"Polygon",coordinates:t},e,n)}([t])},t.prototype.getEnvelope=function(){return this.envelope?this.envelope:this.envelope=(t=this.toPolygon(),nf(Qh(t)));var t},t.findEdgeRingContaining=function(t,e){var n,i,r=t.getEnvelope();return e.forEach((function(e){var o,s,a,l,u,c,h=e.getEnvelope();if(i&&(n=i.getEnvelope()),s=r,a=(o=h).geometry.coordinates[0].map((function(t){return t[0]})),l=o.geometry.coordinates[0].map((function(t){return t[1]})),u=s.geometry.coordinates[0].map((function(t){return t[0]})),c=s.geometry.coordinates[0].map((function(t){return t[1]})),(Math.max.apply(null,a)!==Math.max.apply(null,u)||Math.max.apply(null,l)!==Math.max.apply(null,c)||Math.min.apply(null,a)!==Math.min.apply(null,u)||Math.min.apply(null,l)!==Math.min.apply(null,c))&&ad(h,r)){for(var f=t.map((function(t){return t.from.coordinates})),d=void 0,p=function(t){e.some((function(e){return n=t,i=e.from.coordinates,n[0]===i[0]&&n[1]===i[1];var n,i}))||(d=t)},g=0,m=f;g<m.length;g++)p(m[g]);d&&e.inside(rd(d))&&(i&&!ad(n,h)||(i=e))}})),i},t.prototype.inside=function(t){return Jh(t,this.toPolygon())},t}();const hd=cd;function fd(t,e,n){if(null!==t)for(var i,r,o,s,a,l,u,c,h=0,f=0,d=t.type,p="FeatureCollection"===d,g="Feature"===d,m=p?t.features.length:1,y=0;y<m;y++){a=(c=!!(u=p?t.features[y].geometry:g?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var v=0;v<a;v++){var _=0,b=0;if(null!==(s=c?u.geometries[v]:u)){l=s.coordinates;var x=s.type;switch(h=!n||"Polygon"!==x&&"MultiPolygon"!==x?0:1,x){case null:break;case"Point":if(!1===e(l,f,y,_,b))return!1;f++,_++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],f,y,_,b))return!1;f++,"MultiPoint"===x&&_++}"LineString"===x&&_++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(r=0;r<l[i].length-h;r++){if(!1===e(l[i][r],f,y,_,b))return!1;f++}"MultiLineString"===x&&_++,"Polygon"===x&&b++}"Polygon"===x&&_++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for(b=0,r=0;r<l[i].length;r++){for(o=0;o<l[i][r].length-h;o++){if(!1===e(l[i][r][o],f,y,_,b))return!1;f++}b++}_++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===fd(s.geometries[i],e,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function dd(t,e){!function(t,e){var n,i,r,o,s,a,l,u,c,h,f=0,d="FeatureCollection"===t.type,p="Feature"===t.type,g=d?t.features.length:1;for(n=0;n<g;n++){for(a=d?t.features[n].geometry:p?t.geometry:t,u=d?t.features[n].properties:p?t.properties:{},c=d?t.features[n].bbox:p?t.bbox:void 0,h=d?t.features[n].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,u,c,h))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],f,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,u,c,h))return!1;f++}}(t,(function(t,n,i,r,o){var s,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==e(id(t,i,{bbox:r,id:o}),n,0)&&void 0}switch(a){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var l=0;l<t.coordinates.length;l++){var u=t.coordinates[l];if(!1===e(id({type:s,coordinates:u},i),n,l))return!1}}))}function pd(t){for(var e=t,n=[];e.parent;)n.unshift(e),e=e.parent;return n}!function(){function t(){this.edges=[],this.nodes={}}t.fromGeoJson=function(e){!function(t){if(!t)throw new Error("No geojson passed");if("FeatureCollection"!==t.type&&"GeometryCollection"!==t.type&&"MultiLineString"!==t.type&&"LineString"!==t.type&&"Feature"!==t.type)throw new Error("Invalid input type '"+t.type+"'. Geojson must be FeatureCollection, GeometryCollection, LineString, MultiLineString or Feature")}(e);var n=new t;return dd(e,(function(t){var e,i,r;!function(t,e,n){if(!t)throw new Error("No feature passed");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}(t,"LineString","Graph::fromGeoJson"),e=function(t,e){if(t){var i=n.getNode(t),r=n.getNode(e);n.addEdge(i,r)}return e},r=i,fd(t,(function(t,n,i,o,s){r=0===n?t:e(r,t)}),undefined)})),n},t.prototype.getNode=function(t){var e=ld.buildId(t),n=this.nodes[e];return n||(n=this.nodes[e]=new ld(t)),n},t.prototype.addEdge=function(t,e){var n=new ud(t,e),i=n.getSymetric();this.edges.push(n),this.edges.push(i)},t.prototype.deleteDangles=function(){var t=this;Object.keys(this.nodes).map((function(e){return t.nodes[e]})).forEach((function(e){return t._removeIfDangle(e)}))},t.prototype._removeIfDangle=function(t){var e=this;if(t.innerEdges.length<=1){var n=t.getOuterEdges().map((function(t){return t.to}));this.removeNode(t),n.forEach((function(t){return e._removeIfDangle(t)}))}},t.prototype.deleteCutEdges=function(){var t=this;this._computeNextCWEdges(),this._findLabeledEdgeRings(),this.edges.forEach((function(e){e.label===e.symetric.label&&(t.removeEdge(e.symetric),t.removeEdge(e))}))},t.prototype._computeNextCWEdges=function(t){var e=this;void 0===t?Object.keys(this.nodes).forEach((function(t){return e._computeNextCWEdges(e.nodes[t])})):t.getOuterEdges().forEach((function(e,n){t.getOuterEdge((0===n?t.getOuterEdges().length:n)-1).symetric.next=e}))},t.prototype._computeNextCCWEdges=function(t,e){for(var n,i,r=t.getOuterEdges(),o=r.length-1;o>=0;--o){var s=r[o],a=s.symetric,l=void 0,u=void 0;s.label===e&&(l=s),a.label===e&&(u=a),l&&u&&(u&&(i=u),l&&(i&&(i.next=l,i=void 0),n||(n=l)))}i&&(i.next=n)},t.prototype._findLabeledEdgeRings=function(){var t=[],e=0;return this.edges.forEach((function(n){if(!(n.label>=0)){t.push(n);var i=n;do{i.label=e,i=i.next}while(!n.isEqual(i));e++}})),t},t.prototype.getEdgeRings=function(){var t=this;this._computeNextCWEdges(),this.edges.forEach((function(t){t.label=void 0})),this._findLabeledEdgeRings().forEach((function(e){t._findIntersectionNodes(e).forEach((function(n){t._computeNextCCWEdges(n,e.label)}))}));var e=[];return this.edges.forEach((function(n){n.ring||e.push(t._findEdgeRing(n))})),e},t.prototype._findIntersectionNodes=function(t){var e=[],n=t,i=function(){var i=0;n.from.getOuterEdges().forEach((function(e){e.label===t.label&&++i})),i>1&&e.push(n.from),n=n.next};do{i()}while(!t.isEqual(n));return e},t.prototype._findEdgeRing=function(t){var e=t,n=new hd;do{n.push(e),e.ring=n,e=e.next}while(!t.isEqual(e));return n},t.prototype.removeNode=function(t){var e=this;t.getOuterEdges().forEach((function(t){return e.removeEdge(t)})),t.innerEdges.forEach((function(t){return e.removeEdge(t)})),delete this.nodes[t.id]},t.prototype.removeEdge=function(t){this.edges=this.edges.filter((function(e){return!e.isEqual(t)})),t.deleteEdge()}}(),s(9657),s(2606),s(1160);var gd={search:function(t,e,n,i){t.cleanDirty();var r=(i=i||{}).heuristic||gd.heuristics.manhattan,o=i.closest||!1,s=new vd((function(t){return t.f})),a=e;for(e.h=r(e,n),s.push(e);s.size()>0;){var l=s.pop();if(l===n)return pd(l);l.closed=!0;for(var u=t.neighbors(l),c=0,h=u.length;c<h;++c){var f=u[c];if(!f.closed&&!f.isWall()){var d=l.g+f.getCost(l),p=f.visited;(!p||d<f.g)&&(f.visited=!0,f.parent=l,f.h=f.h||r(f,n),f.g=d,f.f=f.g+f.h,t.markDirty(f),o&&(f.h<a.h||f.h===a.h&&f.g<a.g)&&(a=f),p?s.rescoreElement(f):s.push(f))}}}return o?pd(a):[]},heuristics:{manhattan:function(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)},diagonal:function(t,e){var n=Math.sqrt(2),i=Math.abs(e.x-t.x),r=Math.abs(e.y-t.y);return 1*(i+r)+(n-2)*Math.min(i,r)}},cleanNode:function(t){t.f=0,t.g=0,t.h=0,t.visited=!1,t.closed=!1,t.parent=null}};function md(t,e){e=e||{},this.nodes=[],this.diagonal=!!e.diagonal,this.grid=[];for(var n=0;n<t.length;n++){this.grid[n]=[];for(var i=0,r=t[n];i<r.length;i++){var o=new yd(n,i,r[i]);this.grid[n][i]=o,this.nodes.push(o)}}this.init()}function yd(t,e,n){this.x=t,this.y=e,this.weight=n}function vd(t){this.content=[],this.scoreFunction=t}function _d(){this._=null}function bd(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function xd(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function wd(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Ed(t){for(;t.L;)t=t.L;return t}md.prototype.init=function(){this.dirtyNodes=[];for(var t=0;t<this.nodes.length;t++)gd.cleanNode(this.nodes[t])},md.prototype.cleanDirty=function(){for(var t=0;t<this.dirtyNodes.length;t++)gd.cleanNode(this.dirtyNodes[t]);this.dirtyNodes=[]},md.prototype.markDirty=function(t){this.dirtyNodes.push(t)},md.prototype.neighbors=function(t){var e=[],n=t.x,i=t.y,r=this.grid;return r[n-1]&&r[n-1][i]&&e.push(r[n-1][i]),r[n+1]&&r[n+1][i]&&e.push(r[n+1][i]),r[n]&&r[n][i-1]&&e.push(r[n][i-1]),r[n]&&r[n][i+1]&&e.push(r[n][i+1]),this.diagonal&&(r[n-1]&&r[n-1][i-1]&&e.push(r[n-1][i-1]),r[n+1]&&r[n+1][i-1]&&e.push(r[n+1][i-1]),r[n-1]&&r[n-1][i+1]&&e.push(r[n-1][i+1]),r[n+1]&&r[n+1][i+1]&&e.push(r[n+1][i+1])),e},md.prototype.toString=function(){for(var t,e,n,i,r=[],o=this.grid,s=0,a=o.length;s<a;s++){for(t=[],n=0,i=(e=o[s]).length;n<i;n++)t.push(e[n].weight);r.push(t.join(" "))}return r.join("\n")},yd.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},yd.prototype.getCost=function(t){return t&&t.x!==this.x&&t.y!==this.y?1.41421*this.weight:this.weight},yd.prototype.isWall=function(){return 0===this.weight},vd.prototype={push:function(t){this.content.push(t),this.sinkDown(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return this.content.length>0&&(this.content[0]=e,this.bubbleUp(0)),t},remove:function(t){var e=this.content.indexOf(t),n=this.content.pop();e!==this.content.length-1&&(this.content[e]=n,this.scoreFunction(n)<this.scoreFunction(t)?this.sinkDown(e):this.bubbleUp(e))},size:function(){return this.content.length},rescoreElement:function(t){this.sinkDown(this.content.indexOf(t))},sinkDown:function(t){for(var e=this.content[t];t>0;){var n=(t+1>>1)-1,i=this.content[n];if(!(this.scoreFunction(e)<this.scoreFunction(i)))break;this.content[n]=e,this.content[t]=i,t=n}},bubbleUp:function(t){for(var e=this.content.length,n=this.content[t],i=this.scoreFunction(n);;){var r,o=t+1<<1,s=o-1,a=null;if(s<e){var l=this.content[s];(r=this.scoreFunction(l))<i&&(a=s)}if(o<e){var u=this.content[o];this.scoreFunction(u)<(null===a?i:r)&&(a=o)}if(null===a)break;this.content[t]=this.content[a],this.content[a]=n,t=a}}},_d.prototype={constructor:_d,insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Ed(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(xd(this,n),n=(t=n).U),n.C=!1,i.C=!0,wd(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(wd(this,n),n=(t=n).U),n.C=!1,i.C=!0,xd(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,s=t.R;if(n=o?s?Ed(s):o:s,r?r.L===t?r.L=n:r.R=n:this._=n,o&&s?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=s,s.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,xd(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,wd(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,xd(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,wd(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,xd(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,wd(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}};const Sd=_d;function Pd(t,e,n,i){var r=[null,null],o=Zd.push(r)-1;return r.left=t,r.right=e,n&&Id(r,t,e,n),i&&Id(r,e,t,i),Xd[t.index].halfedges.push(o),Xd[e.index].halfedges.push(o),r}function Cd(t,e,n){var i=[e,n];return i.left=t,i}function Id(t,e,n,i){t[0]||t[1]?t.left===n?t[1]=i:t[0]=i:(t[0]=i,t.left=e,t.right=n)}function Td(t,e,n,i,r){var o,s=t[0],a=t[1],l=s[0],u=s[1],c=0,h=1,f=a[0]-l,d=a[1]-u;if(o=e-l,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=i-l,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}if(o=n-u,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<h&&(h=o)}else if(d>0){if(o>h)return;o>c&&(c=o)}if(o=r-u,d||!(o<0)){if(o/=d,d<0){if(o>h)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<h&&(h=o)}return!(c>0||h<1)||(c>0&&(t[0]=[l+c*f,u+c*d]),h<1&&(t[1]=[l+h*f,u+h*d]),!0)}}}}}function Md(t,e,n,i,r){var o=t[1];if(o)return!0;var s,a,l=t[0],u=t.left,c=t.right,h=u[0],f=u[1],d=c[0],p=c[1],g=(h+d)/2,m=(f+p)/2;if(p===f){if(g<e||g>=i)return;if(h>d){if(l){if(l[1]>=r)return}else l=[g,n];o=[g,r]}else{if(l){if(l[1]<n)return}else l=[g,r];o=[g,n]}}else if(a=m-(s=(h-d)/(p-f))*g,s<-1||s>1)if(h>d){if(l){if(l[1]>=r)return}else l=[(n-a)/s,n];o=[(r-a)/s,r]}else{if(l){if(l[1]<n)return}else l=[(r-a)/s,r];o=[(n-a)/s,n]}else if(f<p){if(l){if(l[0]>=i)return}else l=[e,s*e+a];o=[i,s*i+a]}else{if(l){if(l[0]<e)return}else l=[i,s*i+a];o=[e,s*e+a]}return t[0]=l,t[1]=o,!0}function Ld(t,e){var n=t.site,i=e.left,r=e.right;return n===r&&(r=i,i=n),r?Math.atan2(r[1]-i[1],r[0]-i[0]):(n===i?(i=e[1],r=e[0]):(i=e[0],r=e[1]),Math.atan2(i[0]-r[0],r[1]-i[1]))}function Ad(t,e){return e[+(e.left!==t.site)]}function Od(t,e){return e[+(e.left===t.site)]}var Nd,Rd=[];function kd(){bd(this),this.x=this.y=this.arc=this.site=this.cy=null}function Dd(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var s=r[0],a=r[1],l=i[0]-s,u=i[1]-a,c=o[0]-s,h=o[1]-a,f=2*(l*h-u*c);if(!(f>=-$d)){var d=l*l+u*u,p=c*c+h*h,g=(h*d-u*p)/f,m=(l*p-c*d)/f,y=Rd.pop()||new kd;y.arc=t,y.site=r,y.x=g+s,y.y=(y.cy=m+a)+Math.sqrt(g*g+m*m),t.circle=y;for(var v=null,_=Yd._;_;)if(y.y<_.y||y.y===_.y&&y.x<=_.x){if(!_.L){v=_.P;break}_=_.L}else{if(!_.R){v=_;break}_=_.R}Yd.insert(v,y),v||(Nd=y)}}}}function Fd(t){var e=t.circle;e&&(e.P||(Nd=e.N),Yd.remove(e),Rd.push(e),bd(e),t.circle=null)}var zd=[];function Bd(){bd(this),this.edge=this.site=this.circle=null}function jd(t){var e=zd.pop()||new Bd;return e.site=t,e}function Ud(t){Fd(t),Hd.remove(t),zd.push(t),bd(t)}function Vd(t){var e=t.circle,n=e.x,i=e.cy,r=[n,i],o=t.P,s=t.N,a=[t];Ud(t);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<Kd&&Math.abs(i-l.circle.cy)<Kd;)o=l.P,a.unshift(l),Ud(l),l=o;a.unshift(l),Fd(l);for(var u=s;u.circle&&Math.abs(n-u.circle.x)<Kd&&Math.abs(i-u.circle.cy)<Kd;)s=u.N,a.push(u),Ud(u),u=s;a.push(u),Fd(u);var c,h=a.length;for(c=1;c<h;++c)u=a[c],l=a[c-1],Id(u.edge,l.site,u.site,r);l=a[0],(u=a[h-1]).edge=Pd(l.site,u.site,null,r),Dd(l),Dd(u)}function Gd(t){for(var e,n,i,r,o=t[0],s=t[1],a=Hd._;a;)if((i=qd(a,s)-o)>Kd)a=a.L;else{if(!((r=o-Wd(a,s))>Kd)){i>-Kd?(e=a.P,n=a):r>-Kd?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}!function(t){Xd[t.index]={site:t,halfedges:[]}}(t);var l=jd(t);if(Hd.insert(e,l),e||n){if(e===n)return Fd(e),n=jd(e.site),Hd.insert(l,n),l.edge=n.edge=Pd(e.site,l.site),Dd(e),void Dd(n);if(n){Fd(e),Fd(n);var u=e.site,c=u[0],h=u[1],f=t[0]-c,d=t[1]-h,p=n.site,g=p[0]-c,m=p[1]-h,y=2*(f*m-d*g),v=f*f+d*d,_=g*g+m*m,b=[(m*v-d*_)/y+c,(f*_-g*v)/y+h];Id(n.edge,u,p,b),l.edge=Pd(u,t,null,b),n.edge=Pd(t,p,null,b),Dd(e),Dd(n)}else l.edge=Pd(e.site,l.site)}}function qd(t,e){var n=t.site,i=n[0],r=n[1],o=r-e;if(!o)return i;var s=t.P;if(!s)return-1/0;var a=(n=s.site)[0],l=n[1],u=l-e;if(!u)return a;var c=a-i,h=1/o-1/u,f=c/u;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*u)-l+u/2+r-o/2)))/h+i:(i+a)/2}function Wd(t,e){var n=t.N;if(n)return qd(n,e);var i=t.site;return i[1]===e?i[0]:1/0}var Hd,Xd,Yd,Zd,Kd=1e-6,$d=1e-12;function Qd(t,e){return e[1]-t[1]||e[0]-t[0]}function Jd(t,e){var n,i,r,o=t.sort(Qd).pop();for(Zd=[],Xd=new Array(t.length),Hd=new Sd,Yd=new Sd;;)if(r=Nd,o&&(!r||o[1]<r.y||o[1]===r.y&&o[0]<r.x))o[0]===n&&o[1]===i||(Gd(o),n=o[0],i=o[1]),o=t.pop();else{if(!r)break;Vd(r.arc)}if(function(){for(var t,e,n,i,r=0,o=Xd.length;r<o;++r)if((t=Xd[r])&&(i=(e=t.halfedges).length)){var s=new Array(i),a=new Array(i);for(n=0;n<i;++n)s[n]=n,a[n]=Ld(t,Zd[e[n]]);for(s.sort((function(t,e){return a[e]-a[t]})),n=0;n<i;++n)a[n]=e[s[n]];for(n=0;n<i;++n)e[n]=a[n]}}(),e){var s=+e[0][0],a=+e[0][1],l=+e[1][0],u=+e[1][1];!function(t,e,n,i){for(var r,o=Zd.length;o--;)Md(r=Zd[o],t,e,n,i)&&Td(r,t,e,n,i)&&(Math.abs(r[0][0]-r[1][0])>Kd||Math.abs(r[0][1]-r[1][1])>Kd)||delete Zd[o]}(s,a,l,u),function(t,e,n,i){var r,o,s,a,l,u,c,h,f,d,p,g,m=Xd.length,y=!0;for(r=0;r<m;++r)if(o=Xd[r]){for(s=o.site,a=(l=o.halfedges).length;a--;)Zd[l[a]]||l.splice(a,1);for(a=0,u=l.length;a<u;)p=(d=Od(o,Zd[l[a]]))[0],g=d[1],h=(c=Ad(o,Zd[l[++a%u]]))[0],f=c[1],(Math.abs(p-h)>Kd||Math.abs(g-f)>Kd)&&(l.splice(a,0,Zd.push(Cd(s,d,Math.abs(p-t)<Kd&&i-g>Kd?[t,Math.abs(h-t)<Kd?f:i]:Math.abs(g-i)<Kd&&n-p>Kd?[Math.abs(f-i)<Kd?h:n,i]:Math.abs(p-n)<Kd&&g-e>Kd?[n,Math.abs(h-n)<Kd?f:e]:Math.abs(g-e)<Kd&&p-t>Kd?[Math.abs(f-e)<Kd?h:t,e]:null))-1),++u);u&&(y=!1)}if(y){var v,_,b,x=1/0;for(r=0,y=null;r<m;++r)(o=Xd[r])&&(b=(v=(s=o.site)[0]-t)*v+(_=s[1]-e)*_)<x&&(x=b,y=o);if(y){var w=[t,e],E=[t,i],S=[n,i],P=[n,e];y.halfedges.push(Zd.push(Cd(s=y.site,w,E))-1,Zd.push(Cd(s,E,S))-1,Zd.push(Cd(s,S,P))-1,Zd.push(Cd(s,P,w))-1)}}for(r=0;r<m;++r)(o=Xd[r])&&(o.halfedges.length||delete Xd[r])}(s,a,l,u)}this.edges=Zd,this.cells=Xd,Hd=Yd=Zd=Xd=null}Jd.prototype={constructor:Jd,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return Ad(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,i){if(o=(r=n.halfedges).length)for(var r,o,s,a,l,u,c=n.site,h=-1,f=e[r[o-1]],d=f.left===c?f.right:f.left;++h<o;)s=d,d=(f=e[r[h]]).left===c?f.right:f.left,s&&d&&i<s.index&&i<d.index&&(l=s,u=d,((a=c)[0]-u[0])*(l[1]-a[1])-(a[0]-l[0])*(u[1]-a[1])<0)&&t.push([c.data,s.data,d.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var i,r,o=this,s=o._found||0,a=o.cells.length;!(r=o.cells[s]);)if(++s>=a)return null;var l=t-r.site[0],u=e-r.site[1],c=l*l+u*u;do{r=o.cells[i=s],s=null,r.halfedges.forEach((function(n){var i=o.edges[n],a=i.left;if(a!==r.site&&a||(a=i.right)){var l=t-a[0],u=e-a[1],h=l*l+u*u;h<c&&(c=h,s=a.index)}}))}while(null!==s);return o._found=i,null==n||c<=n*n?r.site:null}},s(2676);var tp=s(675),ep=6371008.8,np={centimeters:100*ep,centimetres:100*ep,degrees:ep/111325,feet:3.28084*ep,inches:39.37*ep,kilometers:ep/1e3,kilometres:ep/1e3,meters:ep,metres:ep,miles:ep/1609.344,millimeters:1e3*ep,millimetres:1e3*ep,nauticalmiles:ep/1852,radians:1,yards:1.0936*ep};function ip(t,e){void 0===e&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function rp(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var n=0;n<t.features.length&&!1!==e(t.features[n],n);n++);}function op(t,e){var n,i,r,o,s,a,l,u,c,h,f=0,d="FeatureCollection"===t.type,p="Feature"===t.type,g=d?t.features.length:1;for(n=0;n<g;n++){for(a=d?t.features[n].geometry:p?t.geometry:t,u=d?t.features[n].properties:p?t.properties:{},c=d?t.features[n].bbox:p?t.bbox:void 0,h=d?t.features[n].id:p?t.id:void 0,s=(l=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,r=0;r<s;r++)if(null!==(o=l?a.geometries[r]:a))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,f,u,c,h))return!1;break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===e(o.geometries[i],f,u,c,h))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,u,c,h))return!1;f++}}function sp(){return new ap}function ap(){this.reset()}ap.prototype={constructor:ap,reset:function(){this.s=this.t=0},add:function(t){up(lp,t,this.t),up(this,lp.s,this.s),this.s?this.t+=lp.t:this.s=lp.t},valueOf:function(){return this.s}};var lp=new ap;function up(t,e,n){var i=t.s=e+n,r=i-e,o=i-r;t.t=e-o+(n-r)}var cp=1e-6,hp=Math.PI,fp=hp/2,dp=hp/4,pp=2*hp,gp=180/hp,mp=hp/180,yp=Math.abs,vp=Math.atan,_p=Math.atan2,bp=Math.cos,xp=(Math.ceil,Math.exp,Math.floor,Math.log,Math.pow,Math.sin),wp=(Math.sign,Math.sqrt);Math.tan;function Ep(t){return t>1?0:t<-1?hp:Math.acos(t)}function Sp(t){return t>1?fp:t<-1?-fp:Math.asin(t)}function Pp(){}function Cp(t,e){t&&Lp.hasOwnProperty(t.type)&&Lp[t.type](t,e)}var Ip,Tp,Mp={Feature:function(t,e){Cp(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)Cp(n[i].geometry,e)}},Lp={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Ap(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Ap(n[i],e,0)},Polygon:function(t,e){Op(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)Op(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)Cp(n[i],e)}};function Ap(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function Op(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)Ap(t[n],e,1);e.polygonEnd()}function Np(t){return[_p(t[1],t[0]),Sp(t[2])]}function Rp(t){var e=t[0],n=t[1],i=bp(n);return[i*bp(e),i*xp(e),xp(n)]}function kp(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Dp(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Fp(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function zp(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Bp(t){var e=wp(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function jp(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Up(t,e){return[t>hp?t-pp:t<-hp?t+pp:t,e]}function Vp(t){return function(e,n){return[(e+=t)>hp?e-pp:e<-hp?e+pp:e,n]}}function Gp(t){var e=Vp(t);return e.invert=Vp(-t),e}function qp(t,e){var n=bp(t),i=xp(t),r=bp(e),o=xp(e);function s(t,e){var s=bp(e),a=bp(t)*s,l=xp(t)*s,u=xp(e),c=u*n+a*i;return[_p(l*r-c*o,a*n-u*i),Sp(c*r+l*o)]}return s.invert=function(t,e){var s=bp(e),a=bp(t)*s,l=xp(t)*s,u=xp(e),c=u*r-l*o;return[_p(l*r+u*o,a*n+c*i),Sp(c*n-a*i)]},s}function Wp(t,e){(e=Rp(e))[0]-=t,Bp(e);var n=Ep(-e[1]);return((-e[2]<0?-n:n)+pp-cp)%pp}function Hp(){var t,e=[];return{point:function(e,n){t.push([e,n])},lineStart:function(){e.push(t=[])},lineEnd:Pp,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Xp(t,e){return yp(t[0]-e[0])<cp&&yp(t[1]-e[1])<cp}function Yp(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Zp(t,e,n,i,r){var o,s,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,i=t[0],s=t[e];if(Xp(i,s)){for(r.lineStart(),o=0;o<e;++o)r.point((i=t[o])[0],i[1]);r.lineEnd()}else a.push(n=new Yp(i,t,null,!0)),l.push(n.o=new Yp(i,null,n,!1)),a.push(n=new Yp(s,t,null,!1)),l.push(n.o=new Yp(s,null,n,!0))}})),a.length){for(l.sort(e),Kp(a),Kp(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var u,c,h=a[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;u=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(o=0,s=u.length;o<s;++o)r.point((c=u[o])[0],c[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(d)for(u=f.p.z,o=u.length-1;o>=0;--o)r.point((c=u[o])[0],c[1]);else i(f.x,f.p.x,-1,r);f=f.p}u=(f=f.o).z,d=!d}while(!f.v);r.lineEnd()}}}function Kp(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function $p(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}sp(),sp(),sp(),Up.invert=Up,1===(Ip=$p).length&&(Tp=Ip,Ip=function(t,e){return $p(Tp(t),e)});var Qp=Array.prototype;function Jp(t){for(var e,n,i,r=t.length,o=-1,s=0;++o<r;)s+=t[o].length;for(n=new Array(s);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--s]=i[e];return n}Qp.slice,Qp.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2);var tg=1e9,eg=-tg;var ng=sp();sp(),sp(),sp();var ig=1/0,rg=ig,og=-ig,sg=og;const ag={point:function(t,e){t<ig&&(ig=t),t>og&&(og=t),e<rg&&(rg=e),e>sg&&(sg=e)},lineStart:Pp,lineEnd:Pp,polygonStart:Pp,polygonEnd:Pp,result:function(){var t=[[ig,rg],[og,sg]];return og=sg=-(rg=ig=1/0),t}};function lg(t,e,n,i){return function(r,o){var s,a,l,u=e(o),c=r.invert(i[0],i[1]),h=Hp(),f=e(h),d=!1,p={point:g,lineStart:y,lineEnd:v,polygonStart:function(){p.point=_,p.lineStart=b,p.lineEnd=x,a=[],s=[]},polygonEnd:function(){p.point=g,p.lineStart=y,p.lineEnd=v,a=Jp(a);var t=function(t,e){var n=e[0],i=e[1],r=[xp(n),-bp(n),0],o=0,s=0;ng.reset();for(var a=0,l=t.length;a<l;++a)if(c=(u=t[a]).length)for(var u,c,h=u[c-1],f=h[0],d=h[1]/2+dp,p=xp(d),g=bp(d),m=0;m<c;++m,f=v,p=b,g=x,h=y){var y=u[m],v=y[0],_=y[1]/2+dp,b=xp(_),x=bp(_),w=v-f,E=w>=0?1:-1,S=E*w,P=S>hp,C=p*b;if(ng.add(_p(C*E*xp(S),g*x+C*bp(S))),o+=P?w+E*pp:w,P^f>=n^v>=n){var I=Dp(Rp(h),Rp(y));Bp(I);var T=Dp(r,I);Bp(T);var M=(P^w>=0?-1:1)*Sp(T[2]);(i>M||i===M&&(I[0]||I[1]))&&(s+=P^w>=0?1:-1)}}return(o<-cp||o<cp&&ng<-cp)^1&s}(s,c);a.length?(d||(o.polygonStart(),d=!0),Zp(a,cg,t,n,o)):t&&(d||(o.polygonStart(),d=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),d&&(o.polygonEnd(),d=!1),a=s=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function g(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&o.point(e,n)}function m(t,e){var n=r(t,e);u.point(n[0],n[1])}function y(){p.point=m,u.lineStart()}function v(){p.point=g,u.lineEnd()}function _(t,e){l.push([t,e]);var n=r(t,e);f.point(n[0],n[1])}function b(){f.lineStart(),l=[]}function x(){_(l[0][0],l[0][1]),f.lineEnd();var t,e,n,i,r=f.clean(),u=h.result(),c=u.length;if(l.pop(),s.push(l),l=null,c)if(1&r){if((e=(n=u[0]).length-1)>0){for(d||(o.polygonStart(),d=!0),o.lineStart(),t=0;t<e;++t)o.point((i=n[t])[0],i[1]);o.lineEnd()}}else c>1&&2&r&&u.push(u.pop().concat(u.shift())),a.push(u.filter(ug))}return p}}function ug(t){return t.length>1}function cg(t,e){return((t=t.x)[0]<0?t[1]-fp-cp:fp-t[1])-((e=e.x)[0]<0?e[1]-fp-cp:fp-e[1])}sp();const hg=lg((function(){return!0}),(function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?hp:-hp,l=yp(o-n);yp(l-hp)<cp?(t.point(n,i=(i+s)/2>0?fp:-fp),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),t.point(o,i),e=0):r!==a&&l>=hp&&(yp(n-r)<cp&&(n-=r*cp),yp(o-a)<cp&&(o-=a*cp),i=function(t,e,n,i){var r,o,s=xp(t-n);return yp(s)>cp?vp((xp(e)*(o=bp(i))*xp(n)-xp(i)*(r=bp(e))*xp(t))/(r*o*s)):(e+i)/2}(n,i,o,s),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(a,i),e=0),t.point(n=o,i=s),r=a},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}}),(function(t,e,n,i){var r;if(null==t)r=n*fp,i.point(-hp,r),i.point(0,r),i.point(hp,r),i.point(hp,0),i.point(hp,-r),i.point(0,-r),i.point(-hp,-r),i.point(-hp,0),i.point(-hp,r);else if(yp(t[0]-e[0])>cp){var o=t[0]<e[0]?hp:-hp;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])}),[-hp,-fp]);function fg(t){return t}function dg(t){return function(e){var n=new pg;for(var i in t)n[i]=t[i];return n.stream=e,n}}function pg(){}function gg(t,e,n){var i=e[1][0]-e[0][0],r=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),null!=o&&t.clipExtent(null),function(t,e){t&&Mp.hasOwnProperty(t.type)?Mp[t.type](t,e):Cp(t,e)}(n,t.stream(ag));var s=ag.result(),a=Math.min(i/(s[1][0]-s[0][0]),r/(s[1][1]-s[0][1])),l=+e[0][0]+(i-a*(s[1][0]+s[0][0]))/2,u=+e[0][1]+(r-a*(s[1][1]+s[0][1]))/2;return null!=o&&t.clipExtent(o),t.scale(150*a).translate([l,u])}pg.prototype={constructor:pg,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var mg=16,yg=bp(30*mp);function vg(t,e){return+e?function(t,e){function n(i,r,o,s,a,l,u,c,h,f,d,p,g,m){var y=u-i,v=c-r,_=y*y+v*v;if(_>4*e&&g--){var b=s+f,x=a+d,w=l+p,E=wp(b*b+x*x+w*w),S=Sp(w/=E),P=yp(yp(w)-1)<cp||yp(o-h)<cp?(o+h)/2:_p(x,b),C=t(P,S),I=C[0],T=C[1],M=I-i,L=T-r,A=v*M-y*L;(A*A/_>e||yp((y*M+v*L)/_-.5)>.3||s*f+a*d+l*p<yg)&&(n(i,r,o,s,a,l,I,T,P,b/=E,x/=E,w,g,m),m.point(I,T),n(I,T,P,b,x,w,u,c,h,f,d,p,g,m))}}return function(e){var i,r,o,s,a,l,u,c,h,f,d,p,g={point:m,lineStart:y,lineEnd:_,polygonStart:function(){e.polygonStart(),g.lineStart=b},polygonEnd:function(){e.polygonEnd(),g.lineStart=y}};function m(n,i){n=t(n,i),e.point(n[0],n[1])}function y(){c=NaN,g.point=v,e.lineStart()}function v(i,r){var o=Rp([i,r]),s=t(i,r);n(c,h,u,f,d,p,c=s[0],h=s[1],u=i,f=o[0],d=o[1],p=o[2],mg,e),e.point(c,h)}function _(){g.point=m,e.lineEnd()}function b(){y(),g.point=x,g.lineEnd=w}function x(t,e){v(i=t,e),r=c,o=h,s=f,a=d,l=p,g.point=v}function w(){n(c,h,u,f,d,p,r,o,i,s,a,l,mg,e),g.lineEnd=_,_()}return g}}(t,e):function(t){return dg({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var _g=dg({point:function(t,e){this.stream.point(t*mp,e*mp)}});function bg(t){return function(t){var e,n,i,r,o,s,a,l,u,c,h=150,f=480,d=250,p=0,g=0,m=0,y=0,v=0,_=null,b=hg,x=null,w=fg,E=.5,S=vg(I,E);function P(t){return[(t=o(t[0]*mp,t[1]*mp))[0]*h+n,i-t[1]*h]}function C(t){return(t=o.invert((t[0]-n)/h,(i-t[1])/h))&&[t[0]*gp,t[1]*gp]}function I(t,r){return[(t=e(t,r))[0]*h+n,i-t[1]*h]}function T(){o=jp(r=function(t,e,n){return(t%=pp)?e||n?jp(Gp(t),qp(e,n)):Gp(t):e||n?qp(e,n):Up}(m,y,v),e);var t=e(p,g);return n=f-t[0]*h,i=d+t[1]*h,M()}function M(){return u=c=null,P}return P.stream=function(t){return u&&c===t?u:u=_g(b(r,S(w(c=t))))},P.clipAngle=function(t){return arguments.length?(b=+t?function(t,e){var n=bp(t),i=n>0,r=yp(n)>cp;function o(t,e){return bp(t)*bp(e)>n}function s(t,e,i){var r=[1,0,0],o=Dp(Rp(t),Rp(e)),s=kp(o,o),a=o[0],l=s-a*a;if(!l)return!i&&t;var u=n*s/l,c=-n*a/l,h=Dp(r,o),f=zp(r,u);Fp(f,zp(o,c));var d=h,p=kp(f,d),g=kp(d,d),m=p*p-g*(kp(f,f)-1);if(!(m<0)){var y=wp(m),v=zp(d,(-p-y)/g);if(Fp(v,f),v=Np(v),!i)return v;var _,b=t[0],x=e[0],w=t[1],E=e[1];x<b&&(_=b,b=x,x=_);var S=x-b,P=yp(S-hp)<cp;if(!P&&E<w&&(_=w,w=E,E=_),P||S<cp?P?w+E>0^v[1]<(yp(v[0]-b)<cp?w:E):w<=v[1]&&v[1]<=E:S>hp^(b<=v[0]&&v[0]<=x)){var C=zp(d,(-p+y)/g);return Fp(C,f),[v,Np(C)]}}}function a(e,n){var r=i?t:hp-t,o=0;return e<-r?o|=1:e>r&&(o|=2),n<-r?o|=4:n>r&&(o|=8),o}return lg(o,(function(t){var e,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,f){var d,p=[h,f],g=o(h,f),m=i?g?0:a(h,f):g?a(h+(h<0?hp:-hp),f):0;if(!e&&(u=l=g)&&t.lineStart(),g!==l&&(!(d=s(e,p))||Xp(e,d)||Xp(p,d))&&(p[0]+=cp,p[1]+=cp,g=o(p[0],p[1])),g!==l)c=0,g?(t.lineStart(),d=s(p,e),t.point(d[0],d[1])):(d=s(e,p),t.point(d[0],d[1]),t.lineEnd()),e=d;else if(r&&e&&i^g){var y;m&n||!(y=s(p,e,!0))||(c=0,i?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!g||e&&Xp(e,p)||t.point(p[0],p[1]),e=p,l=g,n=m},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(n,i,r,o){!function(t,e,n,i,r,o){if(n){var s=bp(e),a=xp(e),l=i*n;null==r?(r=e+i*pp,o=e-l/2):(r=Wp(s,r),o=Wp(s,o),(i>0?r<o:r>o)&&(r+=i*pp));for(var u,c=r;i>0?c>o:c<o;c-=l)u=Np([s,-a*bp(c),-a*xp(c)]),t.point(u[0],u[1])}}(o,t,e,r,n,i)}),i?[0,-t]:[-hp,t-hp])}(_=t*mp,6*mp):(_=null,hg),M()):_*gp},P.clipExtent=function(t){return arguments.length?(w=null==t?(x=s=a=l=null,fg):function(t,e,n,i){function r(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function o(r,o,a,u){var c=0,h=0;if(null==r||(c=s(r,a))!==(h=s(o,a))||l(r,o)<0^a>0)do{u.point(0===c||3===c?t:n,c>1?i:e)}while((c=(c+a+4)%4)!==h);else u.point(o[0],o[1])}function s(i,r){return yp(i[0]-t)<cp?r>0?0:3:yp(i[0]-n)<cp?r>0?2:1:yp(i[1]-e)<cp?r>0?1:0:r>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=s(t,1),i=s(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var l,u,c,h,f,d,p,g,m,y,v,_=s,b=Hp(),x={point:w,lineStart:function(){x.point=E,u&&u.push(c=[]),y=!0,m=!1,p=g=NaN},lineEnd:function(){l&&(E(h,f),d&&m&&b.rejoin(),l.push(b.result())),x.point=w,m&&_.lineEnd()},polygonStart:function(){_=b,l=[],u=[],v=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,r=u.length;n<r;++n)for(var o,s,a=u[n],l=1,c=a.length,h=a[0],f=h[0],d=h[1];l<c;++l)o=f,s=d,f=(h=a[l])[0],d=h[1],s<=i?d>i&&(f-o)*(i-s)>(d-s)*(t-o)&&++e:d<=i&&(f-o)*(i-s)<(d-s)*(t-o)&&--e;return e}(),n=v&&e,r=(l=Jp(l)).length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),r&&Zp(l,a,e,o,s),s.polygonEnd()),_=s,l=u=c=null}};function w(t,e){r(t,e)&&_.point(t,e)}function E(o,s){var a=r(o,s);if(u&&c.push([o,s]),y)h=o,f=s,d=a,y=!1,a&&(_.lineStart(),_.point(o,s));else if(a&&m)_.point(o,s);else{var l=[p=Math.max(eg,Math.min(tg,p)),g=Math.max(eg,Math.min(tg,g))],b=[o=Math.max(eg,Math.min(tg,o)),s=Math.max(eg,Math.min(tg,s))];!function(t,e,n,i,r,o){var s,a=t[0],l=t[1],u=0,c=1,h=e[0]-a,f=e[1]-l;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<u)return;s<c&&(c=s)}else if(h>0){if(s>c)return;s>u&&(u=s)}if(s=r-a,h||!(s<0)){if(s/=h,h<0){if(s>c)return;s>u&&(u=s)}else if(h>0){if(s<u)return;s<c&&(c=s)}if(s=i-l,f||!(s>0)){if(s/=f,f<0){if(s<u)return;s<c&&(c=s)}else if(f>0){if(s>c)return;s>u&&(u=s)}if(s=o-l,f||!(s<0)){if(s/=f,f<0){if(s>c)return;s>u&&(u=s)}else if(f>0){if(s<u)return;s<c&&(c=s)}return u>0&&(t[0]=a+u*h,t[1]=l+u*f),c<1&&(e[0]=a+c*h,e[1]=l+c*f),!0}}}}}(l,b,t,e,n,i)?a&&(_.lineStart(),_.point(o,s),v=!1):(m||(_.lineStart(),_.point(l[0],l[1])),_.point(b[0],b[1]),a||_.lineEnd(),v=!1)}p=o,g=s,m=a}return x}}(x=+t[0][0],s=+t[0][1],a=+t[1][0],l=+t[1][1]),M()):null==x?null:[[x,s],[a,l]]},P.scale=function(t){return arguments.length?(h=+t,T()):h},P.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],T()):[f,d]},P.center=function(t){return arguments.length?(p=t[0]%360*mp,g=t[1]%360*mp,T()):[p*gp,g*gp]},P.rotate=function(t){return arguments.length?(m=t[0]%360*mp,y=t[1]%360*mp,v=t.length>2?t[2]%360*mp:0,T()):[m*gp,y*gp,v*gp]},P.precision=function(t){return arguments.length?(S=vg(I,E=t*t),M()):wp(E)},P.fitExtent=function(t,e){return gg(P,t,e)},P.fitSize=function(t,e){return function(t,e,n){return gg(t,[[0,0],e],n)}(P,t,e)},function(){return e=t.apply(this,arguments),P.invert=e.invert&&C,T()}}((function(){return t}))()}function xg(t){return function(e,n){var i=bp(e),r=bp(n),o=t(i*r);return[o*r*xp(e),o*xp(n)]}}function wg(t){return function(e,n){var i=wp(e*e+n*n),r=t(i),o=xp(r),s=bp(r);return[_p(e*o,i*s),Sp(i&&n*o/i)]}}xg((function(t){return wp(2/(1+t))})).invert=wg((function(t){return 2*Sp(t/2)}));var Eg=xg((function(t){return(t=Ep(t))&&t/xp(t)}));function Sg(t,e){return[t,e]}function Pg(t,e,n,i){var r=t.properties||{},o="Feature"===t.type?t.geometry:t;if("GeometryCollection"===o.type){var s=[];return op(t,(function(t){var r=Pg(t,e,n,i);r&&s.push(r)})),ip(s)}var a=function(t){var e=of(t).geometry.coordinates,n=[-e[0],-e[1]];return bg(Eg).scale(79.4188).clipAngle(179.999).rotate(n).scale(ep)}(o),l={type:o.type,coordinates:Ig(o.coordinates,a)},u=(new tp.GeoJSONReader).read(l),c=function(t,e){void 0===e&&(e="kilometers");var n=np[e];if(!n)throw new Error(e+" units is invalid");return t*n}(function(t,e){void 0===e&&(e="kilometers");var n=np[e];if(!n)throw new Error(e+" units is invalid");return t/n}(e,n),"meters"),h=tp.BufferOp.bufferOp(u,c,i);if(!Cg((h=(new tp.GeoJSONWriter).write(h)).coordinates))return function(t,e,n){void 0===n&&(n={});var i={type:"Feature"};return(0===n.id||n.id)&&(i.id=n.id),n.bbox&&(i.bbox=n.bbox),i.properties=e||{},i.geometry=t,i}({type:h.type,coordinates:Tg(h.coordinates,a)},r)}function Cg(t){return Array.isArray(t[0])?Cg(t[0]):isNaN(t[0])}function Ig(t,e){return"object"!=typeof t[0]?e(t):t.map((function(t){return Ig(t,e)}))}function Tg(t,e){return"object"!=typeof t[0]?e.invert(t):t.map((function(t){return Tg(t,e)}))}Eg.invert=wg((function(t){return t})),Sg.invert=Sg,wg(vp),wg(Sp),wg((function(t){return 2*vp(t)}));function Mg(t){return(e,...n)=>Ag(t,e,n)}function Lg(t,e){return Mg(kg(t,e).get)}const{apply:Ag,construct:Og,defineProperty:Ng,get:Rg,getOwnPropertyDescriptor:kg,getPrototypeOf:Dg,has:Fg,ownKeys:zg,set:Bg,setPrototypeOf:jg}=Reflect,{MAX_SAFE_INTEGER:Ug,isFinite:Vg,isNaN:Gg}=(Proxy,Number),{iterator:qg,species:Wg,toStringTag:Hg,for:Xg}=Symbol,Yg=Object,{create:Zg,defineProperty:Kg,freeze:$g,is:Qg}=Yg,Jg=Yg.prototype,tm=(Jg.__lookupGetter__&&Mg(Jg.__lookupGetter__),Yg.hasOwn||Mg(Jg.hasOwnProperty),Array),em=(tm.isArray,tm.prototype),nm=(Mg(em.join),Mg(em.push),Mg(em.toLocaleString),em[qg]),im=Mg(nm),rm=(Math.trunc,ArrayBuffer),om=(rm.isView,rm.prototype),sm=(Mg(om.slice),Lg(om,"byteLength"),"undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:null),am=(sm&&Lg(sm.prototype,"byteLength"),Dg(Uint8Array)),lm=(am.from,am.prototype),um=(lm[qg],Mg(lm.keys),Mg(lm.values),Mg(lm.entries),Mg(lm.set),Mg(lm.reverse),Mg(lm.fill),Mg(lm.copyWithin),Mg(lm.sort),Mg(lm.slice),Mg(lm.subarray),Lg(lm,"buffer"),Lg(lm,"byteOffset"),Lg(lm,"length"),Lg(lm,Hg),Uint16Array,Uint32Array),cm=Float32Array,hm=Dg([][qg]()),fm=Mg(hm.next),dm=Mg(function*(){}().next),pm=Dg(hm),gm=DataView.prototype,mm=Mg(gm.getUint16),ym=(Mg(gm.setUint16),TypeError,RangeError,WeakSet.prototype),vm=(Mg(ym.add),Mg(ym.has),WeakMap),_m=vm.prototype,bm=Mg(_m.get),xm=(Mg(_m.has),Mg(_m.set)),wm=new vm,Em=Zg(null,{next:{value:function(){const t=bm(wm,this);return fm(t)}},[qg]:{value:function(){return this}}}),Sm=new vm,Pm=Zg(pm,{next:{value:function(){const t=bm(Sm,this);return dm(t)},writable:!0,configurable:!0}});for(const t of zg(hm))"next"!==t&&Kg(Pm,t,kg(hm,t));const Cm=new rm(4),Im=new cm(Cm),Tm=new um(Cm),Mm=new um(512),Lm=new um(512);for(let t=0;t<256;++t){const e=t-127;e<-27?(Mm[t]=0,Mm[256|t]=32768,Lm[t]=24,Lm[256|t]=24):e<-14?(Mm[t]=1024>>-e-14,Mm[256|t]=1024>>-e-14|32768,Lm[t]=-e-1,Lm[256|t]=-e-1):e<=15?(Mm[t]=e+15<<10,Mm[256|t]=e+15<<10|32768,Lm[t]=13,Lm[256|t]=13):e<128?(Mm[t]=31744,Mm[256|t]=64512,Lm[t]=24,Lm[256|t]=24):(Mm[t]=31744,Mm[256|t]=64512,Lm[t]=13,Lm[256|t]=13)}const Am=new um(2048),Om=new um(64),Nm=new um(64);for(let t=1;t<1024;++t){let e=t<<13,n=0;for(;0==(8388608&e);)e<<=1,n-=8388608;e&=-8388609,n+=947912704,Am[t]=e|n}for(let t=1024;t<2048;++t)Am[t]=939524096+(t-1024<<13);for(let t=1;t<31;++t)Om[t]=t<<23;Om[31]=1199570944,Om[32]=2147483648;for(let t=33;t<63;++t)Om[t]=2147483648+(t-32<<23);Om[63]=3347054592;for(let t=1;t<64;++t)32!==t&&(Nm[t]=1024);function Rm(t,e,...n){return function(t){const e=t>>10;return Tm[0]=Am[Nm[e]+(1023&t)]+Om[e],Im[0]}(mm(t,e,...function(t){if(t[qg]===nm&&hm.next===fm)return t;const e=Zg(Em);return xm(wm,e,im(t)),e}(n)))}var km=s(8330),Dm=s(8602),Fm=s(2499);const zm=new Map;function Bm(t,e){Array.isArray(t)||(t=[t]),t.forEach((t=>zm.set(t,e)))}function jm(t,e,n,i=1){return new(Object.getPrototypeOf(t).constructor)(e*n*i)}function Um(t,e,n){return(1-n)*t+n*e}function Vm(t,e,n){let i=0;for(let r=e;r<n;++r)i+=t[r];return i}function Gm(t,e,n){switch(t){case 1:if(e<=8)return new Uint8Array(n);if(e<=16)return new Uint16Array(n);if(e<=32)return new Uint32Array(n);break;case 2:if(8===e)return new Int8Array(n);if(16===e)return new Int16Array(n);if(32===e)return new Int32Array(n);break;case 3:switch(e){case 16:case 32:return new Float32Array(n);case 64:return new Float64Array(n)}}throw Error("Unsupported data format/bitsPerSample")}Bm([void 0,1],(()=>s.e(321).then(s.bind(s,3321)).then((t=>t.default)))),Bm(5,(()=>s.e(672).then(s.bind(s,8672)).then((t=>t.default)))),Bm(6,(()=>{throw new Error("old style JPEG compression is not supported.")})),Bm(7,(()=>s.e(347).then(s.bind(s,9347)).then((t=>t.default)))),Bm([8,32946],(()=>Promise.all([s.e(497),s.e(522)]).then(s.bind(s,5522)).then((t=>t.default)))),Bm(32773,(()=>s.e(411).then(s.bind(s,7411)).then((t=>t.default)))),Bm(34887,(()=>Promise.all([s.e(497),s.e(173)]).then(s.bind(s,4173)).then((t=>t.default)))),Bm(50001,(()=>s.e(588).then(s.bind(s,1588)).then((t=>t.default))));class qm{constructor(t){this._dataView=new DataView(t)}get buffer(){return this._dataView.buffer}getUint64(t,e){const n=this.getUint32(t,e),i=this.getUint32(t+4,e);let r;if(e){if(r=n+2**32*i,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}if(r=2**32*n+i,!Number.isSafeInteger(r))throw new Error(`${r} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return r}getInt64(t,e){let n=0;const i=(128&this._dataView.getUint8(t+(e?7:0)))>0;let r=!0;for(let o=0;o<8;o++){let s=this._dataView.getUint8(t+(e?o:7-o));i&&(r?0!==s&&(s=255&~(s-1),r=!1):s=255&~s),n+=s*256**o}return i&&(n=-n),n}getUint8(t,e){return this._dataView.getUint8(t,e)}getInt8(t,e){return this._dataView.getInt8(t,e)}getUint16(t,e){return this._dataView.getUint16(t,e)}getInt16(t,e){return this._dataView.getInt16(t,e)}getUint32(t,e){return this._dataView.getUint32(t,e)}getInt32(t,e){return this._dataView.getInt32(t,e)}getFloat16(t,e){return Rm(this._dataView,t,e)}getFloat32(t,e){return this._dataView.getFloat32(t,e)}getFloat64(t,e){return this._dataView.getFloat64(t,e)}}class Wm{constructor(t,e,n,i){this._dataView=new DataView(t),this._sliceOffset=e,this._littleEndian=n,this._bigTiff=i}get sliceOffset(){return this._sliceOffset}get sliceTop(){return this._sliceOffset+this.buffer.byteLength}get littleEndian(){return this._littleEndian}get bigTiff(){return this._bigTiff}get buffer(){return this._dataView.buffer}covers(t,e){return this.sliceOffset<=t&&this.sliceTop>=t+e}readUint8(t){return this._dataView.getUint8(t-this._sliceOffset,this._littleEndian)}readInt8(t){return this._dataView.getInt8(t-this._sliceOffset,this._littleEndian)}readUint16(t){return this._dataView.getUint16(t-this._sliceOffset,this._littleEndian)}readInt16(t){return this._dataView.getInt16(t-this._sliceOffset,this._littleEndian)}readUint32(t){return this._dataView.getUint32(t-this._sliceOffset,this._littleEndian)}readInt32(t){return this._dataView.getInt32(t-this._sliceOffset,this._littleEndian)}readFloat32(t){return this._dataView.getFloat32(t-this._sliceOffset,this._littleEndian)}readFloat64(t){return this._dataView.getFloat64(t-this._sliceOffset,this._littleEndian)}readUint64(t){const e=this.readUint32(t),n=this.readUint32(t+4);let i;if(this._littleEndian){if(i=e+2**32*n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}if(i=2**32*e+n,!Number.isSafeInteger(i))throw new Error(`${i} exceeds MAX_SAFE_INTEGER. Precision may be lost. Please report if you get this message to https://github.com/geotiffjs/geotiff.js/issues`);return i}readInt64(t){let e=0;const n=(128&this._dataView.getUint8(t+(this._littleEndian?7:0)))>0;let i=!0;for(let r=0;r<8;r++){let o=this._dataView.getUint8(t+(this._littleEndian?r:7-r));n&&(i?0!==o&&(o=255&~(o-1),i=!1):o=255&~o),e+=o*256**r}return n&&(e=-e),e}readOffset(t){return this._bigTiff?this.readUint64(t):this.readUint32(t)}}const Hm="\r\n\r\n";function Xm(t){if(void 0!==Object.fromEntries)return Object.fromEntries(t);const e={};for(const[n,i]of t)e[n.toLowerCase()]=i;return e}function Ym(t){return Xm(t.split("\r\n").map((t=>{const e=t.split(":").map((t=>t.trim()));return e[0]=e[0].toLowerCase(),e})))}function Zm(t){let e,n,i;return t&&([,e,n,i]=t.match(/bytes (\d+)-(\d+)\/(\d+)/),e=parseInt(e,10),n=parseInt(n,10),i=parseInt(i,10)),{start:e,end:n,total:i}}class Km{async fetch(t,e){return Promise.all(t.map((t=>this.fetchSlice(t,e))))}async fetchSlice(t){throw new Error(`fetching of slice ${t} not possible, not implemented`)}get fileSize(){return null}async close(){}}class $m extends Map{constructor(t={}){if(super(),!(t.maxSize&&t.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof t.maxAge&&0===t.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=t.maxSize,this.maxAge=t.maxAge||Number.POSITIVE_INFINITY,this.onEviction=t.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(t){if("function"==typeof this.onEviction)for(const[e,n]of t)this.onEviction(e,n.value)}_deleteIfExpired(t,e){return"number"==typeof e.expiry&&e.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(t,e.value),this.delete(t))}_getOrDeleteIfExpired(t,e){if(!1===this._deleteIfExpired(t,e))return e.value}_getItemValue(t,e){return e.expiry?this._getOrDeleteIfExpired(t,e):e.value}_peek(t,e){const n=e.get(t);return this._getItemValue(t,n)}_set(t,e){this.cache.set(t,e),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(t,e){this.oldCache.delete(t),this._set(t,e)}*_entriesAscending(){for(const t of this.oldCache){const[e,n]=t;this.cache.has(e)||!1===this._deleteIfExpired(e,n)&&(yield t)}for(const t of this.cache){const[e,n]=t;!1===this._deleteIfExpired(e,n)&&(yield t)}}get(t){if(this.cache.has(t)){const e=this.cache.get(t);return this._getItemValue(t,e)}if(this.oldCache.has(t)){const e=this.oldCache.get(t);if(!1===this._deleteIfExpired(t,e))return this._moveToRecent(t,e),e.value}}set(t,e,{maxAge:n=this.maxAge}={}){const i="number"==typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;this.cache.has(t)?this.cache.set(t,{value:e,expiry:i}):this._set(t,{value:e,expiry:i})}has(t){return this.cache.has(t)?!this._deleteIfExpired(t,this.cache.get(t)):!!this.oldCache.has(t)&&!this._deleteIfExpired(t,this.oldCache.get(t))}peek(t){return this.cache.has(t)?this._peek(t,this.cache):this.oldCache.has(t)?this._peek(t,this.oldCache):void 0}delete(t){const e=this.cache.delete(t);return e&&this._size--,this.oldCache.delete(t)||e}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(t){if(!(t&&t>0))throw new TypeError("`maxSize` must be a number greater than 0");const e=[...this._entriesAscending()],n=e.length-t;n<0?(this.cache=new Map(e),this.oldCache=new Map,this._size=e.length):(n>0&&this._emitEvictions(e.slice(0,n)),this.oldCache=new Map(e.slice(n)),this.cache=new Map,this._size=0),this.maxSize=t}*keys(){for(const[t]of this)yield t}*values(){for(const[,t]of this)yield t}*[Symbol.iterator](){for(const t of this.cache){const[e,n]=t;!1===this._deleteIfExpired(e,n)&&(yield[e,n.value])}for(const t of this.oldCache){const[e,n]=t;this.cache.has(e)||!1===this._deleteIfExpired(e,n)&&(yield[e,n.value])}}*entriesDescending(){let t=[...this.cache];for(let e=t.length-1;e>=0;--e){const n=t[e],[i,r]=n;!1===this._deleteIfExpired(i,r)&&(yield[i,r.value])}t=[...this.oldCache];for(let e=t.length-1;e>=0;--e){const n=t[e],[i,r]=n;this.cache.has(i)||!1===this._deleteIfExpired(i,r)&&(yield[i,r.value])}}*entriesAscending(){for(const[t,e]of this._entriesAscending())yield[t,e.value]}get size(){if(!this._size)return this.oldCache.size;let t=0;for(const e of this.oldCache.keys())this.cache.has(e)||t++;return Math.min(this._size+t,this.maxSize)}entries(){return this.entriesAscending()}forEach(t,e=this){for(const[n,i]of this.entriesAscending())t.call(e,i,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}class Qm extends Error{constructor(t){super(t),Error.captureStackTrace&&Error.captureStackTrace(this,Qm),this.name="AbortError"}}class Jm extends Error{constructor(t,e){super(e),this.errors=t,this.message=e,this.name="AggregateError"}}const ty=Jm;class ey{constructor(t,e,n=null){this.offset=t,this.length=e,this.data=n}get top(){return this.offset+this.length}}class ny{constructor(t,e,n){this.offset=t,this.length=e,this.blockIds=n}}class iy extends Km{constructor(t,{blockSize:e=65536,cacheSize:n=100}={}){super(),this.source=t,this.blockSize=e,this.blockCache=new $m({maxSize:n,onEviction:(t,e)=>{this.evictedBlocks.set(t,e)}}),this.evictedBlocks=new Map,this.blockRequests=new Map,this.blockIdsToFetch=new Set,this.abortedBlockIds=new Set}get fileSize(){return this.source.fileSize}async fetch(t,e){const n=[],i=[],r=[];this.evictedBlocks.clear();for(const{offset:e,length:o}of t){let t=e+o;const{fileSize:s}=this;null!==s&&(t=Math.min(t,s));for(let o=Math.floor(e/this.blockSize)*this.blockSize;o<t;o+=this.blockSize){const t=Math.floor(o/this.blockSize);this.blockCache.has(t)||this.blockRequests.has(t)||(this.blockIdsToFetch.add(t),i.push(t)),this.blockRequests.has(t)&&n.push(this.blockRequests.get(t)),r.push(t)}}await async function(t){return new Promise((t=>setTimeout(t,undefined)))}(),this.fetchBlocks(e);const o=[];for(const t of i)this.blockRequests.has(t)&&o.push(this.blockRequests.get(t));await Promise.allSettled(n),await Promise.allSettled(o);const s=[],a=r.filter((t=>this.abortedBlockIds.has(t)||!this.blockCache.has(t)));if(a.forEach((t=>this.blockIdsToFetch.add(t))),a.length>0&&e&&!e.aborted){this.fetchBlocks(null);for(const t of a){const e=this.blockRequests.get(t);if(!e)throw new Error(`Block ${t} is not in the block requests`);s.push(e)}await Promise.allSettled(s)}if(e&&e.aborted)throw new Qm("Request was aborted");const l=r.map((t=>this.blockCache.get(t)||this.evictedBlocks.get(t))),u=l.filter((t=>!t));if(u.length)throw new ty(u,"Request failed");const c=new Map(function(t,e){const n=Array.isArray(t)?t:Array.from(t),i=Array.isArray(e)?e:Array.from(e);return n.map(((t,e)=>[t,i[e]]))}(r,l));return this.readSliceData(t,c)}fetchBlocks(t){if(this.blockIdsToFetch.size>0){const e=this.groupBlocks(this.blockIdsToFetch),n=this.source.fetch(e,t);for(let i=0;i<e.length;++i){const r=e[i];for(const e of r.blockIds)this.blockRequests.set(e,(async()=>{try{const t=(await n)[i],r=e*this.blockSize,o=r-t.offset,s=Math.min(o+this.blockSize,t.data.byteLength),a=t.data.slice(o,s),l=new ey(r,a.byteLength,a,e);this.blockCache.set(e,l),this.abortedBlockIds.delete(e)}catch(n){if("AbortError"!==n.name)throw n;n.signal=t,this.blockCache.delete(e),this.abortedBlockIds.add(e)}finally{this.blockRequests.delete(e)}})())}this.blockIdsToFetch.clear()}}groupBlocks(t){const e=Array.from(t).sort(((t,e)=>t-e));if(0===e.length)return[];let n=[],i=null;const r=[];for(const t of e)null===i||i+1===t?(n.push(t),i=t):(r.push(new ny(n[0]*this.blockSize,n.length*this.blockSize,n)),n=[t],i=t);return r.push(new ny(n[0]*this.blockSize,n.length*this.blockSize,n)),r}readSliceData(t,e){return t.map((t=>{let n=t.offset+t.length;null!==this.fileSize&&(n=Math.min(this.fileSize,n));const i=Math.floor(t.offset/this.blockSize),r=Math.floor(n/this.blockSize),o=new ArrayBuffer(t.length),s=new Uint8Array(o);for(let o=i;o<=r;++o){const i=e.get(o),r=i.offset-t.offset;let a,l=0,u=0;r<0?l=-r:r>0&&(u=r),a=i.top-n<0?i.length-l:n-i.offset-l;const c=new Uint8Array(i.data,l,a);s.set(c,u)}return o}))}}class ry{get ok(){return this.status>=200&&this.status<=299}get status(){throw new Error("not implemented")}getHeader(t){throw new Error("not implemented")}async getData(){throw new Error("not implemented")}}class oy{constructor(t){this.url=t}async request({headers:t,credentials:e,signal:n}={}){throw new Error("request is not implemented")}}class sy extends ry{constructor(t){super(),this.response=t}get status(){return this.response.status}getHeader(t){return this.response.headers.get(t)}async getData(){return this.response.arrayBuffer?await this.response.arrayBuffer():(await this.response.buffer()).buffer}}class ay extends oy{constructor(t,e){super(t),this.credentials=e}async request({headers:t,credentials:e,signal:n}={}){const i=await fetch(this.url,{headers:t,credentials:e,signal:n});return new sy(i)}}class ly extends ry{constructor(t,e){super(),this.xhr=t,this.data=e}get status(){return this.xhr.status}getHeader(t){return this.xhr.getResponseHeader(t)}async getData(){return this.data}}class uy extends oy{constructRequest(t,e){return new Promise(((n,i)=>{const r=new XMLHttpRequest;r.open("GET",this.url),r.responseType="arraybuffer";for(const[e,n]of Object.entries(t))r.setRequestHeader(e,n);r.onload=()=>{const t=r.response;n(new ly(r,t))},r.onerror=i,r.onabort=()=>i(new Qm("Request aborted")),r.send(),e&&(e.aborted&&r.abort(),e.addEventListener("abort",(()=>r.abort())))}))}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}var cy=s(3752),hy=s(3640),fy=s(2630);class dy extends ry{constructor(t,e){super(),this.response=t,this.dataPromise=e}get status(){return this.response.statusCode}getHeader(t){return this.response.headers[t]}async getData(){return await this.dataPromise}}class py extends oy{constructor(t){super(t),this.parsedUrl=fy.parse(this.url),this.httpApi="http:"===this.parsedUrl.protocol?cy:hy}constructRequest(t,e){return new Promise(((n,i)=>{const r=this.httpApi.get({...this.parsedUrl,headers:t},(t=>{const e=new Promise((e=>{const n=[];t.on("data",(t=>{n.push(t)})),t.on("end",(()=>{const t=Buffer.concat(n).buffer;e(t)})),t.on("error",i)}));n(new dy(t,e))}));r.on("error",i),e&&(e.aborted&&r.destroy(new Qm("Request aborted")),e.addEventListener("abort",(()=>r.destroy(new Qm("Request aborted")))))}))}async request({headers:t,signal:e}={}){return await this.constructRequest(t,e)}}class gy extends Km{constructor(t,e,n,i){super(),this.client=t,this.headers=e,this.maxRanges=n,this.allowFullFile=i,this._fileSize=null}async fetch(t,e){return this.maxRanges>=t.length?this.fetchSlices(t,e):(this.maxRanges>0&&t.length,Promise.all(t.map((t=>this.fetchSlice(t,e)))))}async fetchSlices(t,e){const n=await this.client.request({headers:{...this.headers,Range:`bytes=${t.map((({offset:t,length:e})=>`${t}-${t+e}`)).join(",")}`},signal:e});if(n.ok){if(206===n.status){const{type:i,params:r}=function(t){const[e,...n]=t.split(";").map((t=>t.trim()));return{type:e,params:Xm(n.map((t=>t.split("="))))}}(n.getHeader("content-type"));if("multipart/byteranges"===i){const t=function(t,e){let n=null;const i=new TextDecoder("ascii"),r=[],o=`--${e}`,s=`${o}--`;for(let e=0;e<10;++e)i.decode(new Uint8Array(t,e,o.length))===o&&(n=e);if(null===n)throw new Error("Could not find initial boundary");for(;n<t.byteLength;){const e=i.decode(new Uint8Array(t,n,Math.min(o.length+1024,t.byteLength-n)));if(0===e.length||e.startsWith(s))break;if(!e.startsWith(o))throw new Error("Part does not start with boundary");const a=e.substr(o.length+2);if(0===a.length)break;const l=a.indexOf(Hm),u=Ym(a.substr(0,l)),{start:c,end:h,total:f}=Zm(u["content-range"]),d=n+o.length+l+Hm.length,p=parseInt(h,10)+1-parseInt(c,10);r.push({headers:u,data:t.slice(d,d+p),offset:c,length:p,fileSize:f}),n=d+p+4}return r}(await n.getData(),r.boundary);return this._fileSize=t[0].fileSize||null,t}const o=await n.getData(),{start:s,end:a,total:l}=Zm(n.getHeader("content-range"));this._fileSize=l||null;const u=[{data:o,offset:s,length:a-s}];if(t.length>1){const n=await Promise.all(t.slice(1).map((t=>this.fetchSlice(t,e))));return u.concat(n)}return u}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await n.getData();return this._fileSize=t.byteLength,[{data:t,offset:0,length:t.byteLength}]}}throw new Error("Error fetching data.")}async fetchSlice(t,e){const{offset:n,length:i}=t,r=await this.client.request({headers:{...this.headers,Range:`bytes=${n}-${n+i}`},signal:e});if(r.ok){if(206===r.status){const t=await r.getData(),{total:e}=Zm(r.getHeader("content-range"));return this._fileSize=e||null,{data:t,offset:n,length:i}}{if(!this.allowFullFile)throw new Error("Server responded with full file");const t=await r.getData();return this._fileSize=t.byteLength,{data:t,offset:0,length:t.byteLength}}}throw new Error("Error fetching data.")}get fileSize(){return this._fileSize}}function my(t,{blockSize:e,cacheSize:n}){return null===e?t:new iy(t,{blockSize:e,cacheSize:n})}function yy(t){switch(t){case Fm.sf.BYTE:case Fm.sf.ASCII:case Fm.sf.SBYTE:case Fm.sf.UNDEFINED:return 1;case Fm.sf.SHORT:case Fm.sf.SSHORT:return 2;case Fm.sf.LONG:case Fm.sf.SLONG:case Fm.sf.FLOAT:case Fm.sf.IFD:return 4;case Fm.sf.RATIONAL:case Fm.sf.SRATIONAL:case Fm.sf.DOUBLE:case Fm.sf.LONG8:case Fm.sf.SLONG8:case Fm.sf.IFD8:return 8;default:throw new RangeError(`Invalid field type: ${t}`)}}function vy(t,e,n,i){let r=null,o=null;const s=yy(e);switch(e){case Fm.sf.BYTE:case Fm.sf.ASCII:case Fm.sf.UNDEFINED:r=new Uint8Array(n),o=t.readUint8;break;case Fm.sf.SBYTE:r=new Int8Array(n),o=t.readInt8;break;case Fm.sf.SHORT:r=new Uint16Array(n),o=t.readUint16;break;case Fm.sf.SSHORT:r=new Int16Array(n),o=t.readInt16;break;case Fm.sf.LONG:case Fm.sf.IFD:r=new Uint32Array(n),o=t.readUint32;break;case Fm.sf.SLONG:r=new Int32Array(n),o=t.readInt32;break;case Fm.sf.LONG8:case Fm.sf.IFD8:r=new Array(n),o=t.readUint64;break;case Fm.sf.SLONG8:r=new Array(n),o=t.readInt64;break;case Fm.sf.RATIONAL:r=new Uint32Array(2*n),o=t.readUint32;break;case Fm.sf.SRATIONAL:r=new Int32Array(2*n),o=t.readInt32;break;case Fm.sf.FLOAT:r=new Float32Array(n),o=t.readFloat32;break;case Fm.sf.DOUBLE:r=new Float64Array(n),o=t.readFloat64;break;default:throw new RangeError(`Invalid field type: ${e}`)}if(e!==Fm.sf.RATIONAL&&e!==Fm.sf.SRATIONAL)for(let e=0;e<n;++e)r[e]=o.call(t,i+e*s);else for(let e=0;e<n;e+=2)r[e]=o.call(t,i+e*s),r[e+1]=o.call(t,i+(e*s+4));return e===Fm.sf.ASCII?new TextDecoder("utf-8").decode(r):r}class _y{constructor(t,e,n){this.fileDirectory=t,this.geoKeyDirectory=e,this.nextIFDByteOffset=n}}class by extends Error{constructor(t){super(`No image at index ${t}`),this.index=t}}class xy{async readRasters(t={}){const{window:e,width:n,height:i}=t;let{resX:r,resY:o,bbox:s}=t;const a=await this.getImage();let l=a;const u=await this.getImageCount(),c=a.getBoundingBox();if(e&&s)throw new Error('Both "bbox" and "window" passed.');if(n||i){if(e){const[t,n]=a.getOrigin(),[i,r]=a.getResolution();s=[t+e[0]*i,n+e[1]*r,t+e[2]*i,n+e[3]*r]}const t=s||c;if(n){if(r)throw new Error("Both width and resX passed");r=(t[2]-t[0])/n}if(i){if(o)throw new Error("Both width and resY passed");o=(t[3]-t[1])/i}}if(r||o){const t=[];for(let e=0;e<u;++e){const n=await this.getImage(e),{SubfileType:i,NewSubfileType:r}=n.fileDirectory;(0===e||2===i||1&r)&&t.push(n)}t.sort(((t,e)=>t.getWidth()-e.getWidth()));for(let e=0;e<t.length;++e){const n=t[e],i=(c[2]-c[0])/n.getWidth(),s=(c[3]-c[1])/n.getHeight();if(l=n,r&&r>i||o&&o>s)break}}let h=e;if(s){const[t,e]=a.getOrigin(),[n,i]=l.getResolution(a);h=[Math.round((s[0]-t)/n),Math.round((s[1]-e)/i),Math.round((s[2]-t)/n),Math.round((s[3]-e)/i)],h=[Math.min(h[0],h[2]),Math.min(h[1],h[3]),Math.max(h[0],h[2]),Math.max(h[1],h[3])]}return l.readRasters({...t,window:h})}}class wy extends xy{constructor(t,e,n,i,r={}){super(),this.source=t,this.littleEndian=e,this.bigTiff=n,this.firstIFDOffset=i,this.cache=r.cache||!1,this.ifdRequests=[],this.ghostValues=null}async getSlice(t,e){const n=this.bigTiff?4048:1024;return new Wm((await this.source.fetch([{offset:t,length:void 0!==e?e:n}]))[0],t,this.littleEndian,this.bigTiff)}async parseFileDirectoryAt(t){const e=this.bigTiff?20:12,n=this.bigTiff?8:2;let i=await this.getSlice(t);const r=this.bigTiff?i.readUint64(t):i.readUint16(t),o=r*e+(this.bigTiff?16:6);i.covers(t,o)||(i=await this.getSlice(t,o));const s={};let a=t+(this.bigTiff?8:2);for(let t=0;t<r;a+=e,++t){const t=i.readUint16(a),e=i.readUint16(a+2),n=this.bigTiff?i.readUint64(a+4):i.readUint32(a+4);let r,o;const l=yy(e),u=a+(this.bigTiff?12:8);if(l*n<=(this.bigTiff?8:4))r=vy(i,e,n,u);else{const t=i.readOffset(u),o=yy(e)*n;r=i.covers(t,o)?vy(i,e,n,t):vy(await this.getSlice(t,o),e,n,t)}o=1===n&&-1===Fm.It.indexOf(t)&&e!==Fm.sf.RATIONAL&&e!==Fm.sf.SRATIONAL?r[0]:r,s[Fm.L[t]]=o}const l=function(t){const e=t.GeoKeyDirectory;if(!e)return null;const n={};for(let i=4;i<=4*e[3];i+=4){const r=Fm.P1[e[i]],o=e[i+1]?Fm.L[e[i+1]]:null,s=e[i+2],a=e[i+3];let l=null;if(o){if(l=t[o],null==l)throw new Error(`Could not get value of geoKey '${r}'.`);"string"==typeof l?l=l.substring(a,a+s-1):l.subarray&&(l=l.subarray(a,a+s),1===s&&(l=l[0]))}else l=a;n[r]=l}return n}(s),u=i.readOffset(t+n+e*r);return new _y(s,l,u)}async requestIFD(t){if(this.ifdRequests[t])return this.ifdRequests[t];if(0===t)return this.ifdRequests[t]=this.parseFileDirectoryAt(this.firstIFDOffset),this.ifdRequests[t];if(!this.ifdRequests[t-1])try{this.ifdRequests[t-1]=this.requestIFD(t-1)}catch(e){if(e instanceof by)throw new by(t);throw e}return this.ifdRequests[t]=(async()=>{const e=await this.ifdRequests[t-1];if(0===e.nextIFDByteOffset)throw new by(t);return this.parseFileDirectoryAt(e.nextIFDByteOffset)})(),this.ifdRequests[t]}async getImage(t=0){const e=await this.requestIFD(t);return new class{constructor(t,e,n,i,r,o){this.fileDirectory=t,this.geoKeys=e,this.dataView=n,this.littleEndian=i,this.tiles=r?{}:null,this.isTiled=!t.StripOffsets;const s=t.PlanarConfiguration;if(this.planarConfiguration=void 0===s?1:s,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.");this.source=o}getFileDirectory(){return this.fileDirectory}getGeoKeys(){return this.geoKeys}getWidth(){return this.fileDirectory.ImageWidth}getHeight(){return this.fileDirectory.ImageLength}getSamplesPerPixel(){return void 0!==this.fileDirectory.SamplesPerPixel?this.fileDirectory.SamplesPerPixel:1}getTileWidth(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()}getTileHeight(){return this.isTiled?this.fileDirectory.TileLength:void 0!==this.fileDirectory.RowsPerStrip?Math.min(this.fileDirectory.RowsPerStrip,this.getHeight()):this.getHeight()}getBlockWidth(){return this.getTileWidth()}getBlockHeight(t){return this.isTiled||(t+1)*this.getTileHeight()<=this.getHeight()?this.getTileHeight():this.getHeight()-t*this.getTileHeight()}getBytesPerPixel(){let t=0;for(let e=0;e<this.fileDirectory.BitsPerSample.length;++e)t+=this.getSampleByteSize(e);return t}getSampleByteSize(t){if(t>=this.fileDirectory.BitsPerSample.length)throw new RangeError(`Sample index ${t} is out of range.`);return Math.ceil(this.fileDirectory.BitsPerSample[t]/8)}getReaderForSample(t){const e=this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1,n=this.fileDirectory.BitsPerSample[t];switch(e){case 1:if(n<=8)return DataView.prototype.getUint8;if(n<=16)return DataView.prototype.getUint16;if(n<=32)return DataView.prototype.getUint32;break;case 2:if(n<=8)return DataView.prototype.getInt8;if(n<=16)return DataView.prototype.getInt16;if(n<=32)return DataView.prototype.getInt32;break;case 3:switch(n){case 16:return function(t,e){return Rm(this,t,e)};case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}throw Error("Unsupported data format/bitsPerSample")}getSampleFormat(t=0){return this.fileDirectory.SampleFormat?this.fileDirectory.SampleFormat[t]:1}getBitsPerSample(t=0){return this.fileDirectory.BitsPerSample[t]}getArrayForSample(t,e){return Gm(this.getSampleFormat(t),this.getBitsPerSample(t),e)}async getTileOrStrip(t,e,n,i,r){const o=Math.ceil(this.getWidth()/this.getTileWidth()),s=Math.ceil(this.getHeight()/this.getTileHeight());let a;const{tiles:l}=this;let u,c;1===this.planarConfiguration?a=e*o+t:2===this.planarConfiguration&&(a=n*o*s+e*o+t),this.isTiled?(u=this.fileDirectory.TileOffsets[a],c=this.fileDirectory.TileByteCounts[a]):(u=this.fileDirectory.StripOffsets[a],c=this.fileDirectory.StripByteCounts[a]);const h=(await this.source.fetch([{offset:u,length:c}],r))[0];let f;return null!==l&&l[a]?f=l[a]:(f=(async()=>{let t=await i.decode(this.fileDirectory,h);const n=this.getSampleFormat(),r=this.getBitsPerSample();return function(t,e){return(1!==t&&2!==t||!(e<=32)||e%8!=0)&&(3!==t||16!==e&&32!==e&&64!==e)}(n,r)&&(t=function(t,e,n,i,r,o,s){const a=new DataView(t),l=2===n?1:i,u=Gm(e,r,2===n?s*o:s*o*i),c=parseInt("1".repeat(r),2);if(1===e){let t;t=1===n?i*r:r;let e=o*t;0!=(7&e)&&(e=e+7&-8);for(let t=0;t<s;++t){const n=t*e;for(let e=0;e<o;++e){const i=n+e*l*r;for(let n=0;n<l;++n){const s=i+n*r,h=(t*o+e)*l+n,f=Math.floor(s/8),d=s%8;if(d+r<=8)u[h]=a.getUint8(f)>>8-r-d&c;else if(d+r<=16)u[h]=a.getUint16(f)>>16-r-d&c;else if(d+r<=24){const t=a.getUint16(f)<<8|a.getUint8(f+2);u[h]=t>>24-r-d&c}else u[h]=a.getUint32(f)>>32-r-d&c}}}}return u.buffer}(t,n,this.planarConfiguration,this.getSamplesPerPixel(),r,this.getTileWidth(),this.getBlockHeight(e))),t})(),null!==l&&(l[a]=f)),{x:t,y:e,sample:n,data:await f}}async _readRaster(t,e,n,i,r,o,s,a,l){const u=this.getTileWidth(),c=this.getTileHeight(),h=this.getWidth(),f=this.getHeight(),d=Math.max(Math.floor(t[0]/u),0),p=Math.min(Math.ceil(t[2]/u),Math.ceil(h/u)),g=Math.max(Math.floor(t[1]/c),0),m=Math.min(Math.ceil(t[3]/c),Math.ceil(f/c)),y=t[2]-t[0];let v=this.getBytesPerPixel();const _=[],b=[];for(let t=0;t<e.length;++t)1===this.planarConfiguration?_.push(Vm(this.fileDirectory.BitsPerSample,0,e[t])/8):_.push(0),b.push(this.getReaderForSample(e[t]));const x=[],{littleEndian:w}=this;for(let o=g;o<m;++o)for(let s=d;s<p;++s)for(let a=0;a<e.length;++a){const d=a,p=e[a];2===this.planarConfiguration&&(v=this.getSampleByteSize(a));const g=this.getTileOrStrip(s,o,p,r,l).then((r=>{const o=r.data,s=new DataView(o),a=this.getBlockHeight(r.y),l=r.y*c,p=r.x*u,g=l+a,m=(r.x+1)*u,x=b[d],E=Math.min(a,a-(g-t[3]),f-l),S=Math.min(u,u-(m-t[2]),h-p);for(let r=Math.max(0,t[1]-l);r<E;++r)for(let o=Math.max(0,t[0]-p);o<S;++o){const a=(r*u+o)*v,c=x.call(s,a+_[d],w);let h;i?(h=(r+l-t[1])*y*e.length+(o+p-t[0])*e.length+d,n[h]=c):(h=(r+l-t[1])*y+o+p-t[0],n[d][h]=c)}}));x.push(g)}if(await Promise.all(x),o&&t[2]-t[0]!==o||s&&t[3]-t[1]!==s){let r;return r=i?function(t,e,n,i,r,o,s="nearest"){switch(s.toLowerCase()){case"nearest":return function(t,e,n,i,r,o){const s=e/i,a=n/r,l=jm(t,i,r,o);for(let u=0;u<r;++u){const r=Math.min(Math.round(a*u),n-1);for(let n=0;n<i;++n){const a=Math.min(Math.round(s*n),e-1);for(let s=0;s<o;++s){const c=t[r*e*o+a*o+s];l[u*i*o+n*o+s]=c}}}return l}(t,e,n,i,r,o);case"bilinear":case"linear":return function(t,e,n,i,r,o){const s=e/i,a=n/r,l=jm(t,i,r,o);for(let u=0;u<r;++u){const r=a*u,c=Math.floor(r),h=Math.min(Math.ceil(r),n-1);for(let n=0;n<i;++n){const a=s*n,f=a%1,d=Math.floor(a),p=Math.min(Math.ceil(a),e-1);for(let s=0;s<o;++s){const a=t[c*e*o+d*o+s],g=t[c*e*o+p*o+s],m=t[h*e*o+d*o+s],y=t[h*e*o+p*o+s],v=Um(Um(a,g,f),Um(m,y,f),r%1);l[u*i*o+n*o+s]=v}}}return l}(t,e,n,i,r,o);default:throw new Error(`Unsupported resampling method: '${s}'`)}}(n,t[2]-t[0],t[3]-t[1],o,s,e.length,a):function(t,e,n,i,r,o="nearest"){switch(o.toLowerCase()){case"nearest":return function(t,e,n,i,r){const o=e/i,s=n/r;return t.map((t=>{const a=jm(t,i,r);for(let l=0;l<r;++l){const r=Math.min(Math.round(s*l),n-1);for(let n=0;n<i;++n){const s=Math.min(Math.round(o*n),e-1),u=t[r*e+s];a[l*i+n]=u}}return a}))}(t,e,n,i,r);case"bilinear":case"linear":return function(t,e,n,i,r){const o=e/i,s=n/r;return t.map((t=>{const a=jm(t,i,r);for(let l=0;l<r;++l){const r=s*l,u=Math.floor(r),c=Math.min(Math.ceil(r),n-1);for(let n=0;n<i;++n){const s=o*n,h=s%1,f=Math.floor(s),d=Math.min(Math.ceil(s),e-1),p=t[u*e+f],g=t[u*e+d],m=t[c*e+f],y=t[c*e+d],v=Um(Um(p,g,h),Um(m,y,h),r%1);a[l*i+n]=v}}return a}))}(t,e,n,i,r);default:throw new Error(`Unsupported resampling method: '${o}'`)}}(n,t[2]-t[0],t[3]-t[1],o,s,a),r.width=o,r.height=s,r}return n.width=o||t[2]-t[0],n.height=s||t[3]-t[1],n}async readRasters({window:t,samples:e=[],interleave:n,pool:i=null,width:r,height:o,resampleMethod:s,fillValue:a,signal:l}={}){const u=t||[0,0,this.getWidth(),this.getHeight()];if(u[0]>u[2]||u[1]>u[3])throw new Error("Invalid subsets");const c=(u[2]-u[0])*(u[3]-u[1]),h=this.getSamplesPerPixel();if(e&&e.length){for(let t=0;t<e.length;++t)if(e[t]>=h)return Promise.reject(new RangeError(`Invalid sample index '${e[t]}'.`))}else for(let t=0;t<h;++t)e.push(t);let f;if(n)f=Gm(this.fileDirectory.SampleFormat?Math.max.apply(null,this.fileDirectory.SampleFormat):1,Math.max.apply(null,this.fileDirectory.BitsPerSample),c*e.length),a&&f.fill(a);else{f=[];for(let t=0;t<e.length;++t){const n=this.getArrayForSample(e[t],c);Array.isArray(a)&&t<a.length?n.fill(a[t]):a&&!Array.isArray(a)&&n.fill(a),f.push(n)}}const d=i||await async function(t){const e=zm.get(t.Compression);if(!e)throw new Error(`Unknown compression method identifier: ${t.Compression}`);return new(await e())(t)}(this.fileDirectory);return await this._readRaster(u,e,f,n,d,r,o,s,l)}async readRGB({window:t,interleave:e=!0,pool:n=null,width:i,height:r,resampleMethod:o,enableAlpha:s=!1,signal:a}={}){const l=t||[0,0,this.getWidth(),this.getHeight()];if(l[0]>l[2]||l[1]>l[3])throw new Error("Invalid subsets");const u=this.fileDirectory.PhotometricInterpretation;if(u===Fm.Ie.RGB){let l=[0,1,2];if(this.fileDirectory.ExtraSamples!==Fm.pd.Unspecified&&s){l=[];for(let t=0;t<this.fileDirectory.BitsPerSample.length;t+=1)l.push(t)}return this.readRasters({window:t,interleave:e,samples:l,pool:n,width:i,height:r,resampleMethod:o,signal:a})}let c;switch(u){case Fm.Ie.WhiteIsZero:case Fm.Ie.BlackIsZero:case Fm.Ie.Palette:c=[0];break;case Fm.Ie.CMYK:c=[0,1,2,3];break;case Fm.Ie.YCbCr:case Fm.Ie.CIELab:c=[0,1,2];break;default:throw new Error("Invalid or unsupported photometric interpretation.")}const h={window:l,interleave:!0,samples:c,pool:n,width:i,height:r,resampleMethod:o,signal:a},{fileDirectory:f}=this,d=await this.readRasters(h),p=2**this.fileDirectory.BitsPerSample[0];let g;switch(u){case Fm.Ie.WhiteIsZero:g=function(t,e){const{width:n,height:i}=t,r=new Uint8Array(n*i*3);let o;for(let n=0,i=0;n<t.length;++n,i+=3)o=256-t[n]/e*256,r[i]=o,r[i+1]=o,r[i+2]=o;return r}(d,p);break;case Fm.Ie.BlackIsZero:g=function(t,e){const{width:n,height:i}=t,r=new Uint8Array(n*i*3);let o;for(let n=0,i=0;n<t.length;++n,i+=3)o=t[n]/e*256,r[i]=o,r[i+1]=o,r[i+2]=o;return r}(d,p);break;case Fm.Ie.Palette:g=function(t,e){const{width:n,height:i}=t,r=new Uint8Array(n*i*3),o=e.length/3,s=e.length/3*2;for(let n=0,i=0;n<t.length;++n,i+=3){const a=t[n];r[i]=e[a]/65536*256,r[i+1]=e[a+o]/65536*256,r[i+2]=e[a+s]/65536*256}return r}(d,f.ColorMap);break;case Fm.Ie.CMYK:g=function(t){const{width:e,height:n}=t,i=new Uint8Array(e*n*3);for(let e=0,n=0;e<t.length;e+=4,n+=3){const r=t[e],o=t[e+1],s=t[e+2],a=t[e+3];i[n]=(255-r)/256*255*((255-a)/256),i[n+1]=(255-o)/256*255*((255-a)/256),i[n+2]=(255-s)/256*255*((255-a)/256)}return i}(d);break;case Fm.Ie.YCbCr:g=function(t){const{width:e,height:n}=t,i=new Uint8ClampedArray(e*n*3);for(let e=0,n=0;e<t.length;e+=3,n+=3){const r=t[e],o=t[e+1],s=t[e+2];i[n]=r+1.402*(s-128),i[n+1]=r-.34414*(o-128)-.71414*(s-128),i[n+2]=r+1.772*(o-128)}return i}(d);break;case Fm.Ie.CIELab:g=function(t){const{width:e,height:n}=t,i=new Uint8Array(e*n*3);for(let e=0,n=0;e<t.length;e+=3,n+=3){let r,o,s,a=(t[e+0]+16)/116,l=(t[e+1]<<24>>24)/500+a,u=a-(t[e+2]<<24>>24)/200;l=.95047*(l*l*l>.008856?l*l*l:(l-16/116)/7.787),a=1*(a*a*a>.008856?a*a*a:(a-16/116)/7.787),u=1.08883*(u*u*u>.008856?u*u*u:(u-16/116)/7.787),r=3.2406*l+-1.5372*a+-.4986*u,o=-.9689*l+1.8758*a+.0415*u,s=.0557*l+-.204*a+1.057*u,r=r>.0031308?1.055*r**(1/2.4)-.055:12.92*r,o=o>.0031308?1.055*o**(1/2.4)-.055:12.92*o,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,i[n]=255*Math.max(0,Math.min(1,r)),i[n+1]=255*Math.max(0,Math.min(1,o)),i[n+2]=255*Math.max(0,Math.min(1,s))}return i}(d);break;default:throw new Error("Unsupported photometric interpretation.")}if(!e){const t=new Uint8Array(g.length/3),e=new Uint8Array(g.length/3),n=new Uint8Array(g.length/3);for(let i=0,r=0;i<g.length;i+=3,++r)t[r]=g[i],e[r]=g[i+1],n[r]=g[i+2];g=[t,e,n]}return g.width=d.width,g.height=d.height,g}getTiePoints(){if(!this.fileDirectory.ModelTiepoint)return[];const t=[];for(let e=0;e<this.fileDirectory.ModelTiepoint.length;e+=6)t.push({i:this.fileDirectory.ModelTiepoint[e],j:this.fileDirectory.ModelTiepoint[e+1],k:this.fileDirectory.ModelTiepoint[e+2],x:this.fileDirectory.ModelTiepoint[e+3],y:this.fileDirectory.ModelTiepoint[e+4],z:this.fileDirectory.ModelTiepoint[e+5]});return t}getGDALMetadata(t=null){const e={};if(!this.fileDirectory.GDAL_METADATA)return null;const n=this.fileDirectory.GDAL_METADATA;let i=Dm(n,"Item");i=null===t?i.filter((t=>void 0===km(t,"sample"))):i.filter((e=>Number(km(e,"sample"))===t));for(let t=0;t<i.length;++t){const n=i[t];e[km(n,"name")]=n.inner}return e}getGDALNoData(){if(!this.fileDirectory.GDAL_NODATA)return null;const t=this.fileDirectory.GDAL_NODATA;return Number(t.substring(0,t.length-1))}getOrigin(){const t=this.fileDirectory.ModelTiepoint,e=this.fileDirectory.ModelTransformation;if(t&&6===t.length)return[t[3],t[4],t[5]];if(e)return[e[3],e[7],e[11]];throw new Error("The image does not have an affine transformation.")}getResolution(t=null){const e=this.fileDirectory.ModelPixelScale,n=this.fileDirectory.ModelTransformation;if(e)return[e[0],-e[1],e[2]];if(n)return[n[0],n[5],n[10]];if(t){const[e,n,i]=t.getResolution();return[e*t.getWidth()/this.getWidth(),n*t.getHeight()/this.getHeight(),i*t.getWidth()/this.getWidth()]}throw new Error("The image does not have an affine transformation.")}pixelIsArea(){return 1===this.geoKeys.GTRasterTypeGeoKey}getBoundingBox(){const t=this.getOrigin(),e=this.getResolution(),n=t[0],i=t[1],r=n+e[0]*this.getWidth(),o=i+e[1]*this.getHeight();return[Math.min(n,r),Math.min(i,o),Math.max(n,r),Math.max(i,o)]}}(e.fileDirectory,e.geoKeyDirectory,this.dataView,this.littleEndian,this.cache,this.source)}async getImageCount(){let t=0,e=!0;for(;e;)try{await this.requestIFD(t),++t}catch(t){if(!(t instanceof by))throw t;e=!1}return t}async getGhostValues(){const t=this.bigTiff?16:8;if(this.ghostValues)return this.ghostValues;const e="GDAL_STRUCTURAL_METADATA_SIZE=",n=e.length+100;let i=await this.getSlice(t,n);if(e===vy(i,Fm.sf.ASCII,e.length,t)){const e=vy(i,Fm.sf.ASCII,n,t).split("\n")[0],r=Number(e.split("=")[1].split(" ")[0])+e.length;r>n&&(i=await this.getSlice(t,r));const o=vy(i,Fm.sf.ASCII,r,t);this.ghostValues={},o.split("\n").filter((t=>t.length>0)).map((t=>t.split("="))).forEach((([t,e])=>{this.ghostValues[t]=e}))}return this.ghostValues}static async fromSource(t,e,n){const i=(await t.fetch([{offset:0,length:1024}],n))[0],r=new qm(i),o=r.getUint16(0,0);let s;if(18761===o)s=!0;else{if(19789!==o)throw new TypeError("Invalid byte order value.");s=!1}const a=r.getUint16(2,s);let l;if(42===a)l=!1;else{if(43!==a)throw new TypeError("Invalid magic number.");if(l=!0,8!==r.getUint16(4,s))throw new Error("Unsupported offset byte-size.")}const u=l?r.getUint64(8,s):r.getUint32(4,s);return new wy(t,s,l,u,e)}close(){return"function"==typeof this.source.close&&this.source.close()}}async function Ey(t,e={},n){return wy.fromSource(function(t,{forceXHR:e=!1,...n}={}){return"function"!=typeof fetch||e?"undefined"!=typeof XMLHttpRequest?function(t,{headers:e={},maxRanges:n=0,allowFullFile:i=!1,...r}={}){const o=new uy(t);return my(new gy(o,e,n,i),r)}(t,n):function(t,{headers:e={},maxRanges:n=0,allowFullFile:i=!1,...r}={}){const o=new py(t);return my(new gy(o,e,n,i),r)}(t,n):function(t,{headers:e={},credentials:n,maxRanges:i=0,allowFullFile:r=!1,...o}={}){const s=new ay(t,n);return my(new gy(s,e,i,r),o)}(t,n)}(t,e),n)}const Sy=t.createContext(null);function Py(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function Cy(t,e){const n=e.viewState||e;let i=!1;if("longitude"in n&&"latitude"in n){const e=t.center;t.center=new e.constructor(n.longitude,n.latitude),i=i||e!==t.center}if("zoom"in n){const e=t.zoom;t.zoom=n.zoom,i=i||e!==t.zoom}if("bearing"in n){const e=t.bearing;t.bearing=n.bearing,i=i||e!==t.bearing}if("pitch"in n){const e=t.pitch;t.pitch=n.pitch,i=i||e!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(i=!0,t.padding=n.padding),i}const Iy=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Ty(t){if(!t)return null;if("string"==typeof t)return t;if("toJS"in t&&(t=t.toJS()),!t.layers)return t;const e={};for(const n of t.layers)e[n.id]=n;const n=t.layers.map((t=>{const n=e[t.ref];let i=null;if("interactive"in t&&(i={...t},delete i.interactive),n){i=i||{...t},delete i.ref;for(const t of Iy)t in n&&(i[t]=n[t])}return i||t}));return{...t,layers:n}}function My(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!My(t[n],e[n]))return!1;return!0}if(Array.isArray(e))return!1;if("object"==typeof t&&"object"==typeof e){const n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(const i of n){if(!e.hasOwnProperty(i))return!1;if(!My(t[i],e[i]))return!1}return!0}return!1}const Ly={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Ay={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Oy={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Ny=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Ry=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class ky{constructor(t,e,n){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=t=>{const e=this.props[Oy[t.type]];e&&e(t)},this._onPointerEvent=t=>{"mousemove"!==t.type&&"mouseout"!==t.type||this._updateHover(t);const e=this.props[Ly[t.type]];if(e){if(this.props.interactiveLayerIds&&"mouseover"!==t.type&&"mouseout"!==t.type){const e=this._hoveredFeatures||this._map.queryRenderedFeatures(t.point,{layers:this.props.interactiveLayerIds});t.features=e}e(t),delete t.features}},this._onCameraEvent=t=>{if(!this._internalUpdate){const e=this.props[Ay[t.type]];e&&e(t)}t.type in this._deferredEvents&&(this._deferredEvents[t.type]=!1)},this._MapClass=t,this.props=e,this._initialize(n)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const e=this.props;this.props=t;const n=this._updateSettings(t,e);n&&this._createShadowTransform(this._map);const i=this._updateSize(t),r=this._updateViewState(t,!0);this._updateStyle(t,e),this._updateStyleComponents(t,e),this._updateHandlers(t,e),(n||i||r&&!this._map.isMoving())&&this.redraw()}static reuse(t,e){const n=ky.savedMaps.pop();if(!n)return null;const i=n.map,r=i.getContainer();for(e.className=r.className;r.childNodes.length>0;)e.appendChild(r.childNodes[0]);i._container=e,n.setProps({...t,styleDiffing:!1}),i.resize();const{initialViewState:o}=t;return o&&(o.bounds?i.fitBounds(o.bounds,{...o.fitBoundsOptions,duration:0}):n._updateViewState(o,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",(()=>i.fire("load"))),n}_initialize(t){const{props:e}=this,n={...e,...e.initialViewState,accessToken:e.mapboxAccessToken||Dy()||null,container:t,style:Ty(e.mapStyle)},i=n.initialViewState||n.viewState||n;if(Object.assign(n,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),e.gl){const t=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=t,e.gl)}const r=new this._MapClass(n);i.padding&&r.setPadding(i.padding),e.cursor&&(r.getCanvas().style.cursor=e.cursor),this._createShadowTransform(r);const o=r._render;r._render=t=>{this._inRender=!0,o.call(r,t),this._inRender=!1};const s=r._renderTaskQueue.run;r._renderTaskQueue.run=t=>{s.call(r._renderTaskQueue,t),this._onBeforeRepaint()},r.on("render",(()=>this._onAfterRepaint()));const a=r.fire;r.fire=this._fireEvent.bind(this,a),r.on("resize",(()=>{this._renderTransform.resize(r.transform.width,r.transform.height)})),r.on("styledata",(()=>this._updateStyleComponents(this.props,{}))),r.on("sourcedata",(()=>this._updateStyleComponents(this.props,{})));for(const t in Ly)r.on(t,this._onPointerEvent);for(const t in Ay)r.on(t,this._onCameraEvent);for(const t in Oy)r.on(t,this._onEvent);this._map=r}recycle(){const t=this.map.getContainer().querySelector("[mapboxgl-children]");null==t||t.remove(),ky.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const e=function(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}(t.transform);t.painter.transform=e,this._renderTransform=e}_updateSize(t){const{viewState:e}=t;if(e){const t=this._map;if(e.width!==t.transform.width||e.height!==t.transform.height)return t.resize(),!0}return!1}_updateViewState(t,e){if(this._internalUpdate)return!1;const n=this._map,i=this._renderTransform,{zoom:r,pitch:o,bearing:s}=i,a=n.isMoving();a&&(i.cameraElevationReference="sea");const l=Cy(i,{...Py(n.transform),...t});if(a&&(i.cameraElevationReference="ground"),l&&e){const t=this._deferredEvents;t.move=!0,t.zoom||(t.zoom=r!==i.zoom),t.rotate||(t.rotate=s!==i.bearing),t.pitch||(t.pitch=o!==i.pitch)}return a||Cy(n.transform,t),l}_updateSettings(t,e){const n=this._map;let i=!1;for(const r of Ny)r in t&&!My(t[r],e[r])&&(i=!0,n[`set${r[0].toUpperCase()}${r.slice(1)}`](t[r]));return i}_updateStyle(t,e){if(t.cursor!==e.cursor&&(this._map.getCanvas().style.cursor=t.cursor),t.mapStyle!==e.mapStyle){const e={diff:t.styleDiffing};return"localIdeographFontFamily"in t&&(e.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(Ty(t.mapStyle),e),!0}return!1}_updateStyleComponents(t,e){const n=this._map;let i=!1;return n.style.loaded()&&("light"in t&&!My(t.light,e.light)&&(i=!0,n.setLight(t.light)),"fog"in t&&!My(t.fog,e.fog)&&(i=!0,n.setFog(t.fog)),"terrain"in t&&!My(t.terrain,e.terrain)&&(t.terrain&&!n.getSource(t.terrain.source)||(i=!0,n.setTerrain(t.terrain)))),i}_updateHandlers(t,e){const n=this._map;let i=!1;for(const r of Ry){const o=t[r];My(o,e[r])||(i=!0,o?n[r].enable(o):n[r].disable())}return i}_updateHover(t){var e;const{props:n}=this;if(n.interactiveLayerIds&&(n.onMouseMove||n.onMouseEnter||n.onMouseLeave)){const i=t.type,r=(null===(e=this._hoveredFeatures)||void 0===e?void 0:e.length)>0;let o;if("mousemove"===i)try{o=this._map.queryRenderedFeatures(t.point,{layers:n.interactiveLayerIds})}catch(t){o=[]}else o=[];const s=o.length>0;!s&&r&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=o,s&&!r&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=i}else this._hoveredFeatures=null}_fireEvent(t,e,n){const i=this._map,r=i.transform,o="string"==typeof e?e:e.type;return"move"===o&&this._updateViewState(this.props,!1),o in Ay&&("object"==typeof e&&(e.viewState=Py(r)),this._map.isMoving())?(i.transform=this._renderTransform,t.call(i,e,n),i.transform=r,i):(t.call(i,e,n),i)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const e in this._deferredEvents)this._deferredEvents[e]&&t.fire(e);this._internalUpdate=!1;const e=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=e}}}function Dy(){let t=null;if("undefined"!=typeof location){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||"MISSING_ENV_VAR".MapboxAccessToken}catch(t){}try{t=t||"MISSING_ENV_VAR".REACT_APP_MAPBOX_ACCESS_TOKEN}catch(t){}return t}ky.savedMaps=[];const Fy=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];const zy="undefined"!=typeof document?t.useLayoutEffect:t.useEffect,By=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"],jy=t.createContext(null),Uy={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:t=>console.error(t.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},Vy=(0,t.forwardRef)(((e,n)=>{const i=(0,t.useContext)(Sy),[r,o]=(0,t.useState)(null),a=(0,t.useRef)(),{current:l}=(0,t.useRef)({mapLib:null,map:null});(0,t.useEffect)((()=>{const t=e.mapLib;let n,r=!0;return Promise.resolve(t||s.e(158).then(s.t.bind(s,6158,23))).then((t=>{if(r){if(t.Map||(t=t.default),!t||!t.Map)throw new Error("Invalid mapLib");if(!t.supported(e))throw new Error("Map is not supported by this browser");!function(t,e){for(const n of By)n in e&&(t[n]=e[n]);e.RTLTextPlugin&&t.getRTLTextPluginStatus&&"unavailable"===t.getRTLTextPluginStatus()&&t.setRTLTextPlugin(e.RTLTextPlugin,(t=>{t&&console.error(t)}),!1)}(t,e),e.reuseMaps&&(n=ky.reuse(e,a.current)),n||(n=new ky(t.Map,e,a.current)),l.map=function(t,e){if(!t)return null;const n=t.map,i={getMap:()=>n,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:n=>t.transform.locationPoint(e.LngLat.convert(n)),unproject:n=>t.transform.pointLocation(e.Point.convert(n)),queryTerrainElevation:(e,i)=>{const r=n.transform;n.transform=t.transform;const o=n.queryTerrainElevation(e,i);return n.transform=r,o}};for(const t of function(t){const e=new Set;let n=t;for(;n;){for(const i of Object.getOwnPropertyNames(n))"_"!==i[0]&&"function"==typeof t[i]&&"fire"!==i&&"setEventedParent"!==i&&e.add(i);n=Object.getPrototypeOf(n)}return Array.from(e)}(n))t in i||Fy.includes(t)||(i[t]=n[t].bind(n));return i}(n,t),l.mapLib=t,o(n),null==i||i.onMapMount(l.map,e.id)}})).catch((t=>{e.onError({type:"error",target:null,originalEvent:null,error:t})})),()=>{r=!1,n&&(null==i||i.onMapUnmount(e.id),e.reuseMaps?n.recycle():n.destroy())}}),[]),zy((()=>{r&&r.setProps(e)})),(0,t.useImperativeHandle)(n,(()=>l.map),[r]);const u=(0,t.useMemo)((()=>({position:"relative",width:"100%",height:"100%",...e.style})),[e.style]);return t.createElement("div",{id:e.id,ref:a,style:u},r&&t.createElement(jy.Provider,{value:l},t.createElement("div",{"mapboxgl-children":""},e.children)))}));Vy.displayName="Map",Vy.defaultProps=Uy;const Gy=Vy;var qy=s(3935);const Wy=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function Hy(t,e){if(!t||!e)return;const n=t.style;for(const t in e){const i=e[t];Number.isFinite(i)&&!Wy.test(t)?n[t]=`${i}px`:n[t]=i}}function Xy(e){const{map:n,mapLib:i}=(0,t.useContext)(jy),r=(0,t.useRef)({props:e});r.current.props=e;const o=(0,t.useMemo)((()=>{let n=!1;t.Children.forEach(e.children,(t=>{t&&(n=!0)}));const s={...e,element:n?document.createElement("div"):null},a=new i.Marker(s).setLngLat([e.longitude,e.latitude]);return a.getElement().addEventListener("click",(t=>{var e,n;null===(n=(e=r.current.props).onClick)||void 0===n||n.call(e,{type:"click",target:a,originalEvent:t})})),a.on("dragstart",(t=>{var e,n;const i=t;i.lngLat=o.getLngLat(),null===(n=(e=r.current.props).onDragStart)||void 0===n||n.call(e,i)})),a.on("drag",(t=>{var e,n;const i=t;i.lngLat=o.getLngLat(),null===(n=(e=r.current.props).onDrag)||void 0===n||n.call(e,i)})),a.on("dragend",(t=>{var e,n;const i=t;i.lngLat=o.getLngLat(),null===(n=(e=r.current.props).onDragEnd)||void 0===n||n.call(e,i)})),a}),[]);return(0,t.useEffect)((()=>(o.addTo(n.getMap()),()=>{o.remove()})),[]),(0,t.useEffect)((()=>{Hy(o.getElement(),e.style)}),[e.style]),o.getLngLat().lng===e.longitude&&o.getLngLat().lat===e.latitude||o.setLngLat([e.longitude,e.latitude]),e.offset&&!function(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0,r=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0;return n===r&&i===o}(o.getOffset(),e.offset)&&o.setOffset(e.offset),o.isDraggable()!==e.draggable&&o.setDraggable(e.draggable),o.getRotation()!==e.rotation&&o.setRotation(e.rotation),o.getRotationAlignment()!==e.rotationAlignment&&o.setRotationAlignment(e.rotationAlignment),o.getPitchAlignment()!==e.pitchAlignment&&o.setPitchAlignment(e.pitchAlignment),o.getPopup()!==e.popup&&o.setPopup(e.popup),(0,qy.createPortal)(e.children,o.getElement())}function Yy(t){return new Set(t?t.trim().split(/\s+/):[])}Xy.defaultProps={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"},t.memo(Xy),t.memo((function(e){const{map:n,mapLib:i}=(0,t.useContext)(jy),r=(0,t.useMemo)((()=>document.createElement("div")),[]),o=(0,t.useRef)({props:e});o.current.props=e;const s=(0,t.useMemo)((()=>{const t={...e},n=new i.Popup(t).setLngLat([e.longitude,e.latitude]);return n.once("open",(t=>{var e,n;null===(n=(e=o.current.props).onOpen)||void 0===n||n.call(e,t)})),n}),[]);if((0,t.useEffect)((()=>{const t=t=>{var e,n;null===(n=(e=o.current.props).onClose)||void 0===n||n.call(e,t)};return s.on("close",t),s.setDOMContent(r).addTo(n.getMap()),()=>{s.off("close",t),s.isOpen()&&s.remove()}}),[]),(0,t.useEffect)((()=>{Hy(s.getElement(),e.style)}),[e.style]),s.isOpen()&&(s.getLngLat().lng===e.longitude&&s.getLngLat().lat===e.latitude||s.setLngLat([e.longitude,e.latitude]),e.offset&&!My(s.options.offset,e.offset)&&s.setOffset(e.offset),s.options.anchor===e.anchor&&s.options.maxWidth===e.maxWidth||(s.options.anchor=e.anchor,s.setMaxWidth(e.maxWidth)),s.options.className!==e.className)){const t=Yy(s.options.className),n=Yy(e.className);for(const e of t)n.has(e)||s.removeClassName(e);for(const e of n)t.has(e)||s.addClassName(e);s.options.className=e.className}return(0,qy.createPortal)(e.children,r)}));const Zy=function(e,n,i,r){const o=(0,t.useContext)(jy),s=(0,t.useMemo)((()=>e(o)),[]);return(0,t.useEffect)((()=>{const t=r||i||n,e="function"==typeof n&&"function"==typeof i?n:null,a="function"==typeof i?i:"function"==typeof n?n:null,{map:l}=o;return l.hasControl(s)||(l.addControl(s,null==t?void 0:t.position),e&&e(o)),()=>{a&&a(o),l.hasControl(s)&&l.removeControl(s)}}),[]),s};t.memo((function(e){const n=Zy((({mapLib:t})=>new t.AttributionControl(e)),{position:e.position});return(0,t.useEffect)((()=>{Hy(n._container,e.style)}),[e.style]),null})),t.memo((function(e){const n=Zy((({mapLib:t})=>new t.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)})),{position:e.position});return(0,t.useEffect)((()=>{Hy(n._controlContainer,e.style)}),[e.style]),null}));const Ky=(0,t.forwardRef)(((e,n)=>{const i=(0,t.useRef)({props:e}),r=Zy((({mapLib:t})=>{const n=new t.GeolocateControl(e),r=n._setupUI;return n._setupUI=t=>{n._container.hasChildNodes()||r(t)},n.on("geolocate",(t=>{var e,n;null===(n=(e=i.current.props).onGeolocate)||void 0===n||n.call(e,t)})),n.on("error",(t=>{var e,n;null===(n=(e=i.current.props).onError)||void 0===n||n.call(e,t)})),n.on("outofmaxbounds",(t=>{var e,n;null===(n=(e=i.current.props).onOutOfMaxBounds)||void 0===n||n.call(e,t)})),n.on("trackuserlocationstart",(t=>{var e,n;null===(n=(e=i.current.props).onTrackUserLocationStart)||void 0===n||n.call(e,t)})),n.on("trackuserlocationend",(t=>{var e,n;null===(n=(e=i.current.props).onTrackUserLocationEnd)||void 0===n||n.call(e,t)})),n}),{position:e.position});return i.current.props=e,(0,t.useImperativeHandle)(n,(()=>({trigger:()=>r.trigger()})),[]),(0,t.useEffect)((()=>{Hy(r._container,e.style)}),[e.style]),null}));function $y(e){const n=Zy((({mapLib:t})=>new t.ScaleControl(e)),{position:e.position});return n.options.unit===e.unit&&n.options.maxWidth===e.maxWidth||(n.options.maxWidth=e.maxWidth,n.setUnit(e.unit)),(0,t.useEffect)((()=>{Hy(n._container,e.style)}),[e.style]),null}Ky.displayName="GeolocateControl",t.memo(Ky),t.memo((function(e){const n=Zy((({mapLib:t})=>new t.NavigationControl(e)),{position:e.position});return(0,t.useEffect)((()=>{Hy(n._container,e.style)}),[e.style]),null})),$y.defaultProps={unit:"metric",maxWidth:100},t.memo($y);const Qy={name:"project32",dependencies:[ca],vs:"\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition\n) {\n  vec3 projectedPosition = project_position(position, position64Low);\n  mat3 rotation;\n  if (project_needs_rotation(projectedPosition, rotation)) {\n    // offset is specified as ENU\n    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe\n    offset = rotation * offset;\n  }\n  commonPosition = vec4(projectedPosition + offset, 1.0);\n  return project_common_position_to_clipspace(commonPosition);\n}\n\nvec4 project_position_to_clipspace(\n  vec3 position, vec3 position64Low, vec3 offset\n) {\n  vec4 commonPosition;\n  return project_position_to_clipspace(position, position64Low, offset, commonPosition);\n}\n"},Jy={pickingSelectedColor:null,pickingHighlightColor:new Uint8Array([0,255,255,255]),pickingActive:!1,pickingAttribute:!1},tv={name:"picking",vs:"uniform bool picking_uActive;\nuniform bool picking_uAttribute;\nuniform vec3 picking_uSelectedColor;\nuniform bool picking_uSelectedColorValid;\n\nout vec4 picking_vRGBcolor_Avalid;\n\nconst float COLOR_SCALE = 1. / 255.;\n\nbool picking_isColorValid(vec3 color) {\n  return dot(color, vec3(1.0)) > 0.001;\n}\n\nbool isVertexPicked(vec3 vertexColor) {\n  return\n    picking_uSelectedColorValid &&\n    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));\n}\n\nvoid picking_setPickingColor(vec3 pickingColor) {\n  if (picking_uActive) {\n    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));\n\n    if (!picking_uAttribute) {\n      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;\n    }\n  } else {\n    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));\n  }\n}\n\nvoid picking_setPickingAttribute(float value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.r = value;\n  }\n}\nvoid picking_setPickingAttribute(vec2 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rg = value;\n  }\n}\nvoid picking_setPickingAttribute(vec3 value) {\n  if (picking_uAttribute) {\n    picking_vRGBcolor_Avalid.rgb = value;\n  }\n}\n",fs:"uniform bool picking_uActive;\nuniform vec3 picking_uSelectedColor;\nuniform vec4 picking_uHighlightColor;\n\nin vec4 picking_vRGBcolor_Avalid;\nvec4 picking_filterHighlightColor(vec4 color) {\n  if (picking_uActive) {\n    return color;\n  }\n  bool selected = bool(picking_vRGBcolor_Avalid.a);\n\n  if (selected) {\n    float highLightAlpha = picking_uHighlightColor.a;\n    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);\n    float highLightRatio = highLightAlpha / blendedAlpha;\n\n    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);\n    return vec4(blendedRGB, blendedAlpha);\n  } else {\n    return color;\n  }\n}\nvec4 picking_filterPickingColor(vec4 color) {\n  if (picking_uActive) {\n    if (picking_vRGBcolor_Avalid.a == 0.0) {\n      discard;\n    }\n    return picking_vRGBcolor_Avalid;\n  }\n  return color;\n}\nvec4 picking_filterColor(vec4 color) {\n  vec4 highightColor = picking_filterHighlightColor(color);\n  return picking_filterPickingColor(highightColor);\n}\n\n",getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Jy;const e={};if(void 0!==t.pickingSelectedColor)if(t.pickingSelectedColor){const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}else e.picking_uSelectedColorValid=0;if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,(t=>t/255));Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return void 0!==t.pickingActive&&(e.picking_uActive=Boolean(t.pickingActive),e.picking_uAttribute=Boolean(t.pickingAttribute)),e}},ev={inject:{"vs:DECKGL_FILTER_GL_POSITION":"\n    // for picking depth values\n    picking_setPickingAttribute(position.z / position.w);\n  ","vs:DECKGL_FILTER_COLOR":"\n  picking_setPickingColor(geometry.pickingColor);\n  ","fs:#decl":"\nuniform bool picking_uAttribute;\n  ","fs:DECKGL_FILTER_COLOR":{order:99,injection:"\n  // use highlight color if this fragment belongs to the selected object.\n  color = picking_filterHighlightColor(color);\n\n  // use picking color if rendering to picking FBO.\n  color = picking_filterPickingColor(color);\n    "}},...tv},nv={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};class iv{static get DRAW_MODE(){return nv}constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{id:e=no("geometry"),drawMode:n=nv.TRIANGLES,attributes:i={},indices:r=null,vertexCount:o=null}=t;this.id=e,this.drawMode=0|n,this.attributes={},this.userData={},this._setAttributes(i,r),this.vertexCount=o||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return"Geometry ".concat(this.id," attribute ").concat(t)}_setAttributes(t,e){e&&(this.indices=ArrayBuffer.isView(e)?{value:e,size:1}:e);for(const e in t){let n=t[e];n=ArrayBuffer.isView(n)?{value:n}:n,Qr(ArrayBuffer.isView(n.value),"".concat(this._print(e),": must be typed array or object with value as typed array")),"POSITION"!==e&&"positions"!==e||n.size||(n.size=3),"indices"===e?(Qr(!this.indices),this.indices=n):this.attributes[e]=n}return this.indices&&void 0!==this.indices.isIndexed&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(t,e){if(e)return e.value.length;let n=1/0;for(const e in t){const i=t[e],{value:r,size:o,constant:s}=i;!s&&r&&o>=1&&(n=Math.min(n,r.length/o))}return Qr(Number.isFinite(n)),n}}const rv=new Uint16Array([0,2,1,0,3,2]),ov=new Float32Array([0,1,0,0,1,0,1,1]);function sv(t,e,n){return p(p(t[0],t[1],n),p(t[3],t[2],n),e)}const av="\n#define SHADER_NAME bitmap-layer-fragment-shader\n\n#ifdef GL_ES\nprecision highp float;\n#endif\n\nuniform sampler2D bitmapTexture;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float desaturate;\nuniform vec4 transparentColor;\nuniform vec3 tintColor;\nuniform float opacity;\n\nuniform float coordinateConversion;\nuniform vec4 bounds;\n\n/* projection utils */\nconst float TILE_SIZE = 512.0;\nconst float PI = 3.1415926536;\nconst float WORLD_SCALE = TILE_SIZE / PI / 2.0;\n\n// from degrees to Web Mercator\nvec2 lnglat_to_mercator(vec2 lnglat) {\n  float x = lnglat.x;\n  float y = clamp(lnglat.y, -89.9, 89.9);\n  return vec2(\n    radians(x) + PI,\n    PI + log(tan(PI * 0.25 + radians(y) * 0.5))\n  ) * WORLD_SCALE;\n}\n\n// from Web Mercator to degrees\nvec2 mercator_to_lnglat(vec2 xy) {\n  xy /= WORLD_SCALE;\n  return degrees(vec2(\n    xy.x - PI,\n    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5\n  ));\n}\n/* End projection utils */\n\n// apply desaturation\nvec3 color_desaturate(vec3 color) {\n  float luminance = (color.r + color.g + color.b) * 0.333333333;\n  return mix(color, vec3(luminance), desaturate);\n}\n\n// apply tint\nvec3 color_tint(vec3 color) {\n  return color * tintColor;\n}\n\n// blend with background color\nvec4 apply_opacity(vec3 color, float alpha) {\n  if (transparentColor.a == 0.0) {\n    return vec4(color, alpha);\n  }\n  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);\n  float highLightRatio = alpha / blendedAlpha;\n  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);\n  return vec4(blendedRGB, blendedAlpha);\n}\n\nvec2 getUV(vec2 pos) {\n  return vec2(\n    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),\n    (pos.y - bounds[3]) / (bounds[1] - bounds[3])\n  );\n}\n\n".concat("\nvec3 packUVsIntoRGB(vec2 uv) {\n  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction\n  vec2 uv8bit = floor(uv * 256.);\n\n  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits\n  // Scale and clamp to 0-1 range\n  vec2 uvFraction = fract(uv * 256.);\n  vec2 uvFraction4bit = floor(uvFraction * 16.);\n\n  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates\n  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;\n\n  return vec3(uv8bit, fractions) / 255.;\n}\n","\n\nvoid main(void) {\n  vec2 uv = vTexCoord;\n  if (coordinateConversion < -0.5) {\n    vec2 lnglat = mercator_to_lnglat(vTexPos);\n    uv = getUV(lnglat);\n  } else if (coordinateConversion > 0.5) {\n    vec2 commonPos = lnglat_to_mercator(vTexPos);\n    uv = getUV(commonPos);\n  }\n  vec4 bitmapColor = texture2D(bitmapTexture, uv);\n\n  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);\n\n  geometry.uv = uv;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n\n  if (picking_uActive && !picking_uAttribute) {\n    // Since instance information is not used, we can use picking color for pixel index\n    gl_FragColor.rgb = packUVsIntoRGB(uv);\n  }\n}\n"),lv={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:ri.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class uv extends Uh{constructor(...t){super(...t),u(this,"state",void 0)}getShaders(){return super.getShaders({vs:"\n#define SHADER_NAME bitmap-layer-vertex-shader\n\nattribute vec2 texCoords;\nattribute vec3 positions;\nattribute vec3 positions64Low;\n\nvarying vec2 vTexCoord;\nvarying vec2 vTexPos;\n\nuniform float coordinateConversion;\n\nconst vec3 pickingColor = vec3(1.0, 0.0, 0.0);\n\nvoid main(void) {\n  geometry.worldPosition = positions;\n  geometry.uv = texCoords;\n  geometry.pickingColor = pickingColor;\n\n  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  vTexCoord = texCoords;\n\n  if (coordinateConversion < -0.5) {\n    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;\n  } else if (coordinateConversion > 0.5) {\n    vTexPos = geometry.worldPosition.xy;\n  }\n\n  vec4 color = vec4(0.0);\n  DECKGL_FILTER_COLOR(color, geometry);\n}\n",fs:av,modules:[Qy,ev]})}initializeState(){const t=this.getAttributeManager();t.remove(["instancePickingColors"]);const e=!0;t.add({indices:{size:1,isIndexed:!0,update:t=>t.value=this.state.mesh.indices,noAlloc:e},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:t=>t.value=this.state.mesh.positions,noAlloc:e},texCoords:{size:2,update:t=>t.value=this.state.mesh.texCoords,noAlloc:e}})}updateState({props:t,oldProps:e,changeFlags:n}){const i=this.getAttributeManager();if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),i.invalidateAll()}if(t.bounds!==e.bounds){const t=this.state.mesh,e=this._createMesh();this.state.model.setVertexCount(e.vertexCount);for(const n in e)t&&t[n]!==e[n]&&i.invalidate(n);this.setState({mesh:e,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==e._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(t){const{image:e}=this.props,n=t.info;if(!n.color||!e)return n.bitmap=null,n;const{width:i,height:r}=e;n.index=0;const o=function(t){const[e,n,i]=t;return[(e+(15&i)/16)/256,(n+(240&i)/256)/256]}(n.color),s=[Math.floor(o[0]*i),Math.floor(o[1]*r)];return n.bitmap={size:{width:i,height:r},uv:o,pixel:s},n}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:t}=this.props;let e=t;return cv(t)&&(e=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),function(t,e){if(!e)return function(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[3*n+0]=t[n][0],e[3*n+1]=t[n][1],e[3*n+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:rv,texCoords:ov}}(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),i=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),r=Math.ceil(n/e)+1,o=Math.ceil(i/e)+1,s=(r-1)*(o-1)*6,a=new Uint32Array(s),l=new Float32Array(r*o*2),u=new Float64Array(r*o*3);let c=0,h=0;for(let e=0;e<r;e++){const n=e/(r-1);for(let i=0;i<o;i++){const r=i/(o-1),s=sv(t,n,r);u[3*c+0]=s[0],u[3*c+1]=s[1],u[3*c+2]=s[2]||0,l[2*c+0]=n,l[2*c+1]=1-r,e>0&&i>0&&(a[h++]=c-o,a[h++]=c-o-1,a[h++]=c-1,a[h++]=c-o,a[h++]=c-1,a[h++]=c),c++}}return{vertexCount:s,positions:u,indices:a,texCoords:l}}(e,this.context.viewport.resolution)}_getModel(t){return t?new $c(t,{...this.getShaders(),id:this.props.id,geometry:new iv({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(t){const{uniforms:e,moduleParameters:n}=t,{model:i,coordinateConversion:r,bounds:o,disablePicking:s}=this.state,{image:a,desaturate:l,transparentColor:u,tintColor:c}=this.props;n.pickingActive&&s||a&&i&&i.setUniforms(e).setUniforms({bitmapTexture:a,desaturate:l,transparentColor:u.map((t=>t/255)),tintColor:c.slice(0,3).map((t=>t/255)),coordinateConversion:r,bounds:o}).draw()}_getCoordinateUniforms(){const{LNGLAT:t,CARTESIAN:e,DEFAULT:n}=ri;let{_imageCoordinateSystem:i}=this.props;if(i!==n){const{bounds:n}=this.props;if(!cv(n))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const r=this.context.viewport.resolution?t:e;if(i=i===t?t:e,i===t&&r===e)return{coordinateConversion:-1,bounds:n};if(i===e&&r===t){const t=it([n[0],n[1]]),e=it([n[2],n[3]]);return{coordinateConversion:1,bounds:[t[0],t[1],e[0],e[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}function cv(t){return Number.isFinite(t[0])}u(uv,"layerName","BitmapLayer"),u(uv,"defaultProps",lv);class hv extends Uh{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every((t=>t.isLoaded))}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){const{object:e}=t;return e&&e.__source&&e.__source.parent&&e.__source.parent.id===this.id?(t.object=e.__source.object,t.index=e.__source.index,t):t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,e){return e&&e.length}getSubLayerClass(t,e){const{_subLayerProps:n}=this.props;return n&&n[t]&&n[t].type||e}getSubLayerRow(t,e,n){return t.__source={parent:this,object:e,index:n},t}getSubLayerAccessor(t){if("function"==typeof t){const e={index:-1,data:this.props.data,target:[]};return(n,i)=>n&&n.__source?(e.index=n.__source.index,t(n.__source.object,e)):t(n,i)}return t}getSubLayerProps(t={}){var e;const{opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:l,highlightColor:u,coordinateSystem:c,coordinateOrigin:h,wrapLongitude:f,positionFormat:d,modelMatrix:p,extensions:g,fetch:m,operation:y,_subLayerProps:v}=this.props,_={id:"",updateTriggers:{},opacity:n,pickable:i,visible:r,parameters:o,getPolygonOffset:s,highlightedObjectIndex:a,autoHighlight:l,highlightColor:u,coordinateSystem:c,coordinateOrigin:h,wrapLongitude:f,positionFormat:d,modelMatrix:p,extensions:g,fetch:m,operation:y},b=v&&t.id&&v[t.id],x=b&&b.updateTriggers,w=t.id||"sublayer";if(b){const e=this.props[Pt],n=t.type?t.type._propTypes:{};for(const t in b){const i=n[t]||e[t];i&&"accessor"===i.type&&(b[t]=this.getSubLayerAccessor(b[t]))}}Object.assign(_,t,b),_.id="".concat(this.props.id,"-").concat(w),_.updateTriggers={all:null===(e=this.props.updateTriggers)||void 0===e?void 0:e.all,...t.updateTriggers,...x};for(const t of g){const e=t.getSubLayerProps.call(this,t);e&&Object.assign(_,e,{updateTriggers:Object.assign(_.updateTriggers,e.updateTriggers)})}return _}_updateAutoHighlight(t){for(const e of this.getSubLayers())e.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,e){let n=this.internalState.subLayers;const i=!n||this.needsUpdate();i&&(n=ee(this.renderLayers(),Boolean),this.internalState.subLayers=n),te("compositeLayer.renderLayers",this,i,n);for(const t of n)t.parent=this}}function fv({data:t,getIndex:e,dataRange:n,replace:i}){const{startRow:r=0,endRow:o=1/0}=n,s=t.length;let a=s,l=s;for(let n=0;n<s;n++){const i=e(t[n]);if(a>n&&i>=r&&(a=n),i>=o){l=n;break}}let u=a;const c=l-a!==i.length?t.slice(l):void 0;for(let e=0;e<i.length;e++)t[u++]=i[e];if(c){for(let e=0;e<c.length;e++)t[u++]=c[e];t.length=u}return{startRow:a,endRow:a+i.length}}u(hv,"layerName","CompositeLayer");const dv=()=>{},pv={10241:9987,10240:9729,10242:33071,10243:33071};function gv(t,e,n,i){const r=Math.min(n/e.width,i/e.height),o=Math.floor(e.width*r),s=Math.floor(e.height*r);return 1===r?{data:e,width:o,height:s}:(t.canvas.height=s,t.canvas.width=o,t.clearRect(0,0,o,s),t.drawImage(e,0,0,e.width,e.height,0,0,o,s),{data:t.canvas,width:o,height:s})}function mv(t){return t&&(t.id||t.url)}function yv(t,e,n){for(let i=0;i<e.length;i++){const{icon:r,xOffset:o}=e[i];t[mv(r)]={...r,x:o,y:n}}}class vv{constructor(t,{onUpdate:e=dv,onError:n=dv}){u(this,"gl",void 0),u(this,"onUpdate",void 0),u(this,"onError",void 0),u(this,"_loadOptions",null),u(this,"_texture",null),u(this,"_externalTexture",null),u(this,"_mapping",{}),u(this,"_textureParameters",null),u(this,"_pendingCount",0),u(this,"_autoPacking",!1),u(this,"_xOffset",0),u(this,"_yOffset",0),u(this,"_rowHeight",0),u(this,"_buffer",4),u(this,"_canvasWidth",1024),u(this,"_canvasHeight",0),u(this,"_canvas",null),this.gl=t,this.onUpdate=e,this.onError=n}finalize(){var t;null===(t=this._texture)||void 0===t||t.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){const e=this._autoPacking?mv(t):t;return this._mapping[e]||{}}setProps({loadOptions:t,autoPacking:e,iconAtlas:n,iconMapping:i,textureParameters:r}){var o;t&&(this._loadOptions=t),void 0!==e&&(this._autoPacking=e),i&&(this._mapping=i),n&&(null===(o=this._texture)||void 0===o||o.delete(),this._texture=null,this._externalTexture=n),r&&(this._textureParameters=r)}get isLoaded(){return 0===this._pendingCount}packIcons(t,e){if(!this._autoPacking||"undefined"==typeof document)return;const n=Object.values(function(t,e,n){if(!t||!e)return null;n=n||{};const i={},{iterable:r,objectInfo:o}=ac(t);for(const t of r){o.index++;const r=e(t,o),s=mv(r);if(!r)throw new Error("Icon is missing.");if(!r.url)throw new Error("Icon url is missing.");i[s]||n[s]&&r.url===n[s].url||(i[s]={...r,source:t,sourceIndex:o.index})}return i}(t,e,this._mapping)||{});if(n.length>0){const{mapping:t,xOffset:e,yOffset:i,rowHeight:r,canvasHeight:o}=function({icons:t,buffer:e,mapping:n={},xOffset:i=0,yOffset:r=0,rowHeight:o=0,canvasWidth:s}){let a=[];for(let l=0;l<t.length;l++){const u=t[l];if(!n[mv(u)]){const{height:t,width:l}=u;i+l+e>s&&(yv(n,a,r),i=0,r=o+r+e,o=0,a=[]),a.push({icon:u,xOffset:i}),i=i+l+e,o=Math.max(o,t)}}return a.length>0&&yv(n,a,r),{mapping:n,rowHeight:o,xOffset:i,yOffset:r,canvasWidth:s,canvasHeight:(l=o+r+e,Math.pow(2,Math.ceil(Math.log2(l))))};var l}({icons:n,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=r,this._mapping=t,this._xOffset=e,this._yOffset=i,this._canvasHeight=o,this._texture||(this._texture=new Io(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||pv})),this._texture.height!==this._canvasHeight&&(this._texture=function(t,e,n,i){const r=t.width,o=t.height,s=new Io(t.gl,{width:e,height:n,parameters:i});return function(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{sourceX:i=0,sourceY:r=0,targetMipmaplevel:o=0,targetInternalFormat:s=6408}=n;let{targetX:a,targetY:l,targetZ:u,width:c,height:h}=n;const{framebuffer:f,deleteFramebuffer:d}=Ho(t);Qr(f);const{gl:p,handle:g}=f,m=void 0!==a||void 0!==l||void 0!==u;a=a||0,l=l||0,u=u||0;const y=p.bindFramebuffer(36160,g);Qr(e);let v=null;if(e instanceof Co&&(v=e,c=Number.isFinite(c)?c:v.width,h=Number.isFinite(h)?h:v.height,v.bind(0),e=v.target),m)switch(e){case 3553:case 34067:p.copyTexSubImage2D(e,o,a,l,i,r,c,h);break;case 35866:case 32879:lr(p).copyTexSubImage3D(e,o,a,l,u,i,r,c,h)}else p.copyTexImage2D(e,o,s,i,r,c,h,0);v&&v.unbind(),p.bindFramebuffer(36160,y||null),d&&f.delete()}(t,s,{targetY:0,width:r,height:o}),t.delete(),s}(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||pv)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(n)}}_loadIcons(t){const e=this._canvas.getContext("2d",{willReadFrequently:!0});for(const n of t)this._pendingCount++,Tn(n.url,this._loadOptions).then((t=>{const i=mv(n),r=this._mapping[i],{x:o,y:s,width:a,height:l}=r,{data:u,width:c,height:h}=gv(e,t,a,l);this._texture.setSubImageData({data:u,x:o+(a-c)/2,y:s+(l-h)/2,width:c,height:h}),r.width=c,r.height=h,this._texture.generateMipmap(),this.onUpdate()})).catch((t=>{this.onError({url:n.url,source:n.source,sourceIndex:n.sourceIndex,loadOptions:this._loadOptions,error:t})})).finally((()=>{this._pendingCount--}))}}const _v=[0,0,0,255],bv={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:_v},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class xv extends Uh{constructor(...t){super(...t),u(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME icon-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\nattribute vec4 instanceIconFrames;\nattribute float instanceColorModes;\nattribute vec2 instanceOffsets;\nattribute vec2 instancePixelOffset;\n\nuniform float sizeScale;\nuniform vec2 iconsTextureDim;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform bool billboard;\nuniform int sizeUnits;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = angle * PI / 180.0;\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n\n  vec2 iconSize = instanceIconFrames.zw;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), \n    sizeMinPixels, sizeMaxPixels\n  );\n  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;\n  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;\n  pixelOffset += instancePixelOffset;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); \n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n\n  vTextureCoords = mix(\n    instanceIconFrames.xy,\n    instanceIconFrames.xy + iconSize,\n    (positions.xy + 1.0) / 2.0\n  ) / iconsTextureDim;\n\n  vColor = instanceColors;\n  DECKGL_FILTER_COLOR(vColor, geometry);\n\n  vColorMode = instanceColorModes;\n}\n",fs:"#define SHADER_NAME icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float alphaCutoff;\n\nvarying float vColorMode;\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec4 texColor = texture2D(iconsTexture, vTextureCoords);\n  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);\n  float a = texColor.a * opacity * vColor.a;\n\n  if (a < alphaCutoff) {\n    discard;\n  }\n\n  gl_FragColor = vec4(color, a);\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Qy,ev]})}initializeState(){this.state={iconManager:new vv(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:_v},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(t){super.updateState(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager(),{iconAtlas:o,iconMapping:s,data:a,getIcon:l,textureParameters:u}=e,{iconManager:c}=this.state,h=o||this.internalState.isAsyncPropLoading("iconAtlas");if(c.setProps({loadOptions:e.loadOptions,autoPacking:!h,iconAtlas:o,iconMapping:h?s:null,textureParameters:u}),h?n.iconMapping!==e.iconMapping&&r.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&c.packIcons(a,l),i.extensionsChanged){var f;const{gl:t}=this.context;null===(f=this.state.model)||void 0===f||f.delete(),this.state.model=this._getModel(t),r.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(t){super.finalizeState(t),this.state.iconManager.finalize()}draw({uniforms:t}){const{sizeScale:e,sizeMinPixels:n,sizeMaxPixels:i,sizeUnits:r,billboard:o,alphaCutoff:s}=this.props,{iconManager:a}=this.state,l=a.getTexture();l&&this.state.model.setUniforms(t).setUniforms({iconsTexture:l,iconsTextureDim:[l.width,l.height],sizeUnits:si[r],sizeScale:e,sizeMinPixels:n,sizeMaxPixels:i,billboard:o,alphaCutoff:s}).draw()}_getModel(t){return new $c(t,{...this.getShaders(),id:this.props.id,geometry:new iv({drawMode:6,attributes:{positions:{size:2,value:new Float32Array([-1,-1,-1,1,1,1,1,-1])}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){var e;const n=null===(e=this.getCurrentLayer())||void 0===e?void 0:e.props.onIconError;n?n(t):$t.error(t.error.message)()}getInstanceOffset(t){const{width:e,height:n,anchorX:i=e/2,anchorY:r=n/2}=this.state.iconManager.getIconMapping(t);return[e/2-i,n/2-r]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){const{x:e,y:n,width:i,height:r}=this.state.iconManager.getIconMapping(t);return[e,n,i,r]}}u(xv,"defaultProps",bv),u(xv,"layerName","IconLayer");const wv=[0,0,0,255],Ev={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:wv},getLineColor:{type:"accessor",value:wv},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class Sv extends Uh{getShaders(){return super.getShaders({vs:"#define SHADER_NAME scatterplot-layer-vertex-shader\n\nattribute vec3 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute float instanceRadius;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform float opacity;\nuniform float radiusScale;\nuniform float radiusMinPixels;\nuniform float radiusMaxPixels;\nuniform float lineWidthScale;\nuniform float lineWidthMinPixels;\nuniform float lineWidthMaxPixels;\nuniform float stroked;\nuniform bool filled;\nuniform bool antialiasing;\nuniform bool billboard;\nuniform int radiusUnits;\nuniform int lineWidthUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  outerRadiusPixels = clamp(\n    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),\n    radiusMinPixels, radiusMaxPixels\n  );\n  float lineWidthPixels = clamp(\n    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),\n    lineWidthMinPixels, lineWidthMaxPixels\n  );\n  outerRadiusPixels += stroked * lineWidthPixels / 2.0;\n  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;\n  unitPosition = edgePadding * positions.xy;\n  geometry.uv = unitPosition;\n  geometry.pickingColor = instancePickingColors;\n\n  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;\n  \n  if (billboard) {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = edgePadding * positions * outerRadiusPixels;\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME scatterplot-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool filled;\nuniform float stroked;\nuniform bool antialiasing;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying vec2 unitPosition;\nvarying float innerUnitRadius;\nvarying float outerRadiusPixels;\n\nvoid main(void) {\n  geometry.uv = unitPosition;\n\n  float distToCenter = length(unitPosition) * outerRadiusPixels;\n  float inCircle = antialiasing ? \n    smoothedge(distToCenter, outerRadiusPixels) : \n    step(distToCenter, outerRadiusPixels);\n\n  if (inCircle == 0.0) {\n    discard;\n  }\n\n  if (stroked > 0.5) {\n    float isLine = antialiasing ? \n      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :\n      step(innerUnitRadius * outerRadiusPixels, distToCenter);\n\n    if (filled) {\n      gl_FragColor = mix(vFillColor, vLineColor, isLine);\n    } else {\n      if (isLine == 0.0) {\n        discard;\n      }\n      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);\n    }\n  } else if (filled) {\n    gl_FragColor = vFillColor;\n  } else {\n    discard;\n  }\n\n  gl_FragColor.a *= inCircle;\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Qy,ev]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){if(super.updateState(t),t.changeFlags.extensionsChanged){var e;const{gl:t}=this.context;null===(e=this.state.model)||void 0===e||e.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{radiusUnits:e,radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,stroked:o,filled:s,billboard:a,antialiasing:l,lineWidthUnits:u,lineWidthScale:c,lineWidthMinPixels:h,lineWidthMaxPixels:f}=this.props;this.state.model.setUniforms(t).setUniforms({stroked:o?1:0,filled:s,billboard:a,antialiasing:l,radiusUnits:si[e],radiusScale:n,radiusMinPixels:i,radiusMaxPixels:r,lineWidthUnits:si[u],lineWidthScale:c,lineWidthMinPixels:h,lineWidthMaxPixels:f}).draw()}_getModel(t){return new $c(t,{...this.getShaders(),id:this.props.id,geometry:new iv({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array([-1,-1,0,1,-1,0,1,1,0,-1,1,0])}}}),isInstanced:!0})}}u(Sv,"defaultProps",Ev),u(Sv,"layerName","ScatterplotLayer");const Pv=.75,Cv=[];class Iv extends xv{constructor(...t){super(...t),u(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:"#define SHADER_NAME multi-icon-layer-fragment-shader\n\nprecision highp float;\n\nuniform float opacity;\nuniform sampler2D iconsTexture;\nuniform float gamma;\nuniform bool sdf;\nuniform float alphaCutoff;\nuniform float sdfBuffer;\nuniform float outlineBuffer;\nuniform vec4 outlineColor;\n\nvarying vec4 vColor;\nvarying vec2 vTextureCoords;\nvarying vec2 uv;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  if (!picking_uActive) {\n    float alpha = texture2D(iconsTexture, vTextureCoords).a;\n    vec4 color = vColor;\n    if (sdf) {\n      float distance = alpha;\n      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);\n\n      if (outlineBuffer > 0.0) {\n        float inFill = alpha;\n        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);\n        color = mix(outlineColor, vColor, inFill);\n        alpha = inBorder;\n      }\n    }\n    float a = alpha * color.a;\n    \n    if (a < alphaCutoff) {\n      discard;\n    }\n\n    gl_FragColor = vec4(color.rgb, a * opacity);\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n"}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(t,{index:e,target:n})=>this.encodePickingColor(e,n)}})}updateState(t){super.updateState(t);const{props:e,oldProps:n}=t;let{outlineColor:i}=e;i!==n.outlineColor&&(i=i.map((t=>t/255)),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!e.sdf&&e.outlineWidth&&$t.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(t){const{sdf:e,smoothing:n,outlineWidth:i}=this.props,{outlineColor:r}=this.state,o=i?Math.max(n,Pv*(1-i)):-1;if(t.uniforms={...t.uniforms,sdfBuffer:Pv,outlineBuffer:o,gamma:n,sdf:Boolean(e),outlineColor:r},super.draw(t),e&&i){const{iconManager:t}=this.state;t.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:Pv}})}}getInstanceOffset(t){return t?Array.from(t).flatMap((t=>super.getInstanceOffset(t))):Cv}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).flatMap((t=>super.getInstanceIconFrame(t))):Cv}}u(Iv,"defaultProps",{getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}}),u(Iv,"layerName","MultiIconLayer");const Tv=1e20;class Mv{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:i=.25,fontFamily:r="sans-serif",fontWeight:o="normal",fontStyle:s="normal"}={}){this.buffer=e,this.cutoff=i,this.radius=n;const a=this.size=t+4*e,l=this._createCanvas(a),u=this.ctx=l.getContext("2d",{willReadFrequently:!0});u.font=`${s} ${o} ${t}px ${r}`,u.textBaseline="alphabetic",u.textAlign="left",u.fillStyle="black",this.gridOuter=new Float64Array(a*a),this.gridInner=new Float64Array(a*a),this.f=new Float64Array(a),this.z=new Float64Array(a+1),this.v=new Uint16Array(a)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:i,actualBoundingBoxLeft:r,actualBoundingBoxRight:o}=this.ctx.measureText(t),s=Math.ceil(n),a=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-r))),l=Math.min(this.size-this.buffer,s+Math.ceil(i)),u=a+2*this.buffer,c=l+2*this.buffer,h=Math.max(u*c,0),f=new Uint8ClampedArray(h),d={data:f,width:u,height:c,glyphWidth:a,glyphHeight:l,glyphTop:s,glyphLeft:0,glyphAdvance:e};if(0===a||0===l)return d;const{ctx:p,buffer:g,gridInner:m,gridOuter:y}=this;p.clearRect(g,g,a,l),p.fillText(t,g,g+s);const v=p.getImageData(g,g,a,l);y.fill(Tv,0,h),m.fill(0,0,h);for(let t=0;t<l;t++)for(let e=0;e<a;e++){const n=v.data[4*(t*a+e)+3]/255;if(0===n)continue;const i=(t+g)*u+e+g;if(1===n)y[i]=0,m[i]=Tv;else{const t=.5-n;y[i]=t>0?t*t:0,m[i]=t<0?t*t:0}}Lv(y,0,0,u,c,u,this.f,this.v,this.z),Lv(m,g,g,a,l,u,this.f,this.v,this.z);for(let t=0;t<h;t++){const e=Math.sqrt(y[t])-Math.sqrt(m[t]);f[t]=Math.round(255-255*(e/this.radius+this.cutoff))}return d}}function Lv(t,e,n,i,r,o,s,a,l){for(let u=e;u<e+i;u++)Av(t,n*o+u,o,r,s,a,l);for(let u=n;u<n+r;u++)Av(t,u*o+e,1,i,s,a,l)}function Av(t,e,n,i,r,o,s){o[0]=0,s[0]=-Tv,s[1]=Tv,r[0]=t[e];for(let a=1,l=0,u=0;a<i;a++){r[a]=t[e+a*n];const i=a*a;do{const t=o[l];u=(r[a]-r[t]+i-t*t)/(a-t)/2}while(u<=s[l]&&--l>-1);l++,o[l]=a,s[l]=u,s[l+1]=Tv}for(let a=0,l=0;a<i;a++){for(;s[l+1]<a;)l++;const i=o[l],u=a-i;t[e+a*n]=r[i]+u*u}}const Ov=32,Nv=[];function Rv(t,e,n,i){let r=0;for(let s=e;s<n;s++){var o;r+=(null===(o=i[t[s]])||void 0===o?void 0:o.layoutWidth)||0}return r}function kv(t,e,n,i,r,o){let s=e,a=0;for(let l=e;l<n;l++){const e=Rv(t,l,l+1,r);a+e>i&&(s<l&&o.push(l),s=l,a=0),a+=e}return a}function Dv(t,e,n,i,r=0,o){void 0===o&&(o=t.length);const s=[];return"break-all"===e?kv(t,r,o,n,i,s):function(t,e,n,i,r,o){let s=e,a=e,l=e,u=0;for(let c=e;c<n;c++)if(" "===t[c]?l=c+1:" "!==t[c+1]&&c+1!==n||(l=c+1),l>a){let e=Rv(t,a,l,r);u+e>i&&(s<a&&(o.push(a),s=a,u=0),e>i&&(e=kv(t,a,l,i,r,o),s=o[o.length-1])),a=l,u+=e}}(t,r,o,n,i,s),s}function Fv(t,e,n,i,r,o){let s=0,a=0;for(let o=e;o<n;o++){const e=t[o],n=i[e];n?(a||(a=n.layoutHeight),r[o]=s+n.layoutWidth/2,s+=n.layoutWidth):($t.warn("Missing character: ".concat(e," (").concat(e.codePointAt(0),")"))(),r[o]=s,s+=Ov)}o[0]=s,o[1]=a}class zv{constructor(t=5){u(this,"limit",void 0),u(this,"_cache",{}),u(this,"_order",[]),this.limit=t}get(t){const e=this._cache[t];return e&&(this._deleteOrder(t),this._appendOrder(t)),e}set(t,e){this._cache[t]?(this.delete(t),this._cache[t]=e,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=e,this._appendOrder(t))}delete(t){this._cache[t]&&(delete this._cache[t],this._deleteOrder(t))}_deleteOrder(t){const e=this._order.indexOf(t);e>=0&&this._order.splice(e,1)}_appendOrder(t){this._order.push(t)}}const Bv={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:function(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1};let jv=new zv(3);function Uv(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function Vv(t,e,n,i){t.font="".concat(i," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}class Gv{constructor(){u(this,"props",{...Bv}),u(this,"_key",void 0),u(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:t,buffer:e}=this.props;return(1.2*t+2*e)/t}setProps(t={}){Object.assign(this.props,t),this._key=this._getKey();const e=function(t,e){let n;n="string"==typeof e?new Set(Array.from(e)):new Set(e);const i=jv.get(t);if(!i)return n;for(const t in i.mapping)n.has(t)&&n.delete(t);return n}(this._key,this.props.characterSet),n=jv.get(this._key);if(n&&0===e.size)return void(this._atlas!==n&&(this._atlas=n));const i=this._generateFontAtlas(e,n);this._atlas=i,jv.set(this._key,i)}_generateFontAtlas(t,e){const{fontFamily:n,fontWeight:i,fontSize:r,buffer:o,sdf:s,radius:a,cutoff:l}=this.props;let u=e&&e.data;u||(u=document.createElement("canvas"),u.width=1024);const c=u.getContext("2d",{willReadFrequently:!0});Vv(c,n,r,i);const{mapping:h,canvasHeight:f,xOffset:d,yOffset:p}=function({characterSet:t,getFontWidth:e,fontHeight:n,buffer:i,maxCanvasWidth:r,mapping:o={},xOffset:s=0,yOffset:a=0}){let l=0,u=s;const c=n+2*i;for(const s of t)if(!o[s]){const t=e(s);u+t+2*i>r&&(u=0,l++),o[s]={x:u+i,y:a+l*c+i,width:t,height:c,layoutWidth:t,layoutHeight:n},u+=t+2*i}return{mapping:o,xOffset:u,yOffset:a+l*c,canvasHeight:(h=a+(l+1)*c,Math.pow(2,Math.ceil(Math.log2(h))))};var h}({getFontWidth:t=>c.measureText(t).width,fontHeight:1.2*r,buffer:o,characterSet:t,maxCanvasWidth:1024,...e&&{mapping:e.mapping,xOffset:e.xOffset,yOffset:e.yOffset}});if(u.height!==f){const t=c.getImageData(0,0,u.width,u.height);u.height=f,c.putImageData(t,0,0)}if(Vv(c,n,r,i),s){const e=new Mv({fontSize:r,buffer:o,radius:a,cutoff:l,fontFamily:n,fontWeight:"".concat(i)});for(const n of t){const{data:t,width:i,height:o,glyphTop:s}=e.draw(n);h[n].width=i,h[n].layoutOffsetY=.9*r-s;const a=c.createImageData(i,o);Uv(t,a),c.putImageData(a,h[n].x,h[n].y)}}else for(const e of t)c.fillText(e,h[e].x,h[e].y+o+.9*r);return{xOffset:d,yOffset:p,mapping:h,data:u,width:u.width,height:u.height}}_getKey(){const{fontFamily:t,fontWeight:e,fontSize:n,buffer:i,sdf:r,radius:o,cutoff:s}=this.props;return r?"".concat(t," ").concat(e," ").concat(n," ").concat(i," ").concat(o," ").concat(s):"".concat(t," ").concat(e," ").concat(n," ").concat(i)}}const qv={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class Wv extends Uh{constructor(...t){super(...t),u(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME text-background-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute vec3 instancePositions;\nattribute vec3 instancePositions64Low;\nattribute vec4 instanceRects;\nattribute float instanceSizes;\nattribute float instanceAngles;\nattribute vec2 instancePixelOffsets;\nattribute float instanceLineWidths;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\nuniform bool billboard;\nuniform float opacity;\nuniform float sizeScale;\nuniform float sizeMinPixels;\nuniform float sizeMaxPixels;\nuniform vec4 padding;\nuniform int sizeUnits;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvec2 rotate_by_angle(vec2 vertex, float angle) {\n  float angle_radian = radians(angle);\n  float cos_angle = cos(angle_radian);\n  float sin_angle = sin(angle_radian);\n  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);\n  return rotationMatrix * vertex;\n}\n\nvoid main(void) {\n  geometry.worldPosition = instancePositions;\n  geometry.uv = positions;\n  geometry.pickingColor = instancePickingColors;\n  uv = positions;\n  vLineWidth = instanceLineWidths;\n  float sizePixels = clamp(\n    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),\n    sizeMinPixels, sizeMaxPixels\n  );\n\n  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;\n\n  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);\n  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);\n  pixelOffset += instancePixelOffsets;\n  pixelOffset.y *= -1.0;\n\n  if (billboard)  {\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n    vec3 offset = vec3(pixelOffset, 0.0);\n    DECKGL_FILTER_SIZE(offset, geometry);\n    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);\n  } else {\n    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);\n    DECKGL_FILTER_SIZE(offset_common, geometry);\n    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);\n  DECKGL_FILTER_COLOR(vFillColor, geometry);\n  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);\n  DECKGL_FILTER_COLOR(vLineColor, geometry);\n}\n",fs:"#define SHADER_NAME text-background-layer-fragment-shader\n\nprecision highp float;\n\nuniform bool stroked;\n\nvarying vec4 vFillColor;\nvarying vec4 vLineColor;\nvarying float vLineWidth;\nvarying vec2 uv;\nvarying vec2 dimensions;\n\nvoid main(void) {\n  geometry.uv = uv;\n\n  vec2 pixelPosition = uv * dimensions;\n  if (stroked) {\n    float distToEdge = min(\n      min(pixelPosition.x, dimensions.x - pixelPosition.x),\n      min(pixelPosition.y, dimensions.y - pixelPosition.y)\n    );\n    float isBorder = smoothedge(distToEdge, vLineWidth);\n    gl_FragColor = mix(vFillColor, vLineColor, isBorder);\n  } else {\n    gl_FragColor = vFillColor;\n  }\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Qy,ev]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t);const{changeFlags:e}=t;if(e.extensionsChanged){var n;const{gl:t}=this.context;null===(n=this.state.model)||void 0===n||n.delete(),this.state.model=this._getModel(t),this.getAttributeManager().invalidateAll()}}draw({uniforms:t}){const{billboard:e,sizeScale:n,sizeUnits:i,sizeMinPixels:r,sizeMaxPixels:o,getLineWidth:s}=this.props;let{padding:a}=this.props;a.length<4&&(a=[a[0],a[1],a[0],a[1]]),this.state.model.setUniforms(t).setUniforms({billboard:e,stroked:Boolean(s),padding:a,sizeUnits:si[i],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:o}).draw()}_getModel(t){return new $c(t,{...this.getShaders(),id:this.props.id,geometry:new iv({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array([0,0,1,0,1,1,0,1])}}}),isInstanced:!0})}}u(Wv,"defaultProps",qv),u(Wv,"layerName","TextBackgroundLayer");const Hv={start:1,middle:0,end:-1},Xv={top:1,center:0,bottom:-1},Yv=[0,0,0,255],Zv={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:Yv},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:Bv.characterSet},fontFamily:Bv.fontFamily,fontWeight:Bv.fontWeight,lineHeight:1,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:Yv},fontSettings:{},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Yv},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class Kv extends hv{constructor(...t){super(...t),u(this,"state",void 0),u(this,"getBoundingRect",((t,e)=>{let{size:[n,i]}=this.transformParagraph(t,e);const{fontSize:r}=this.state.fontAtlasManager.props;n/=r,i/=r;const{getTextAnchor:o,getAlignmentBaseline:s}=this.props;return[(Hv["function"==typeof o?o(t,e):o]-1)*n/2,(Xv["function"==typeof s?s(t,e):s]-1)*i/2,n,i]})),u(this,"getIconOffsets",((t,e)=>{const{getTextAnchor:n,getAlignmentBaseline:i}=this.props,{x:r,y:o,rowWidth:s,size:[a,l]}=this.transformParagraph(t,e),u=Hv["function"==typeof n?n(t,e):n],c=Xv["function"==typeof i?i(t,e):i],h=r.length,f=new Array(2*h);let d=0;for(let t=0;t<h;t++){const e=(1-u)*(a-s[t])/2;f[d++]=(u-1)*a/2+e+r[t],f[d++]=(c-1)*l/2+o[t]}return f}))}initializeState(){this.state={styleVersion:0,fontAtlasManager:new Gv},this.props.maxWidth>0&&$t.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(t){const{props:e,oldProps:n,changeFlags:i}=t;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||e.lineHeight!==n.lineHeight||e.wordBreak!==n.wordBreak||e.maxWidth!==n.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){const{fontSettings:t,fontFamily:e,fontWeight:n}=this.props,{fontAtlasManager:i,characterSet:r}=this.state,o={...t,characterSet:r,fontFamily:e,fontWeight:n};if(!i.mapping)return i.setProps(o),!0;for(const t in o)if(o[t]!==i.props[t])return i.setProps(o),!0;return!1}_updateText(){var t;const{data:e,characterSet:n}=this.props,i=null===(t=e.attributes)||void 0===t?void 0:t.getText;let r,{getText:o}=this.props,s=e.startIndices;const a="auto"===n&&new Set;if(i&&s){const{texts:t,characterCount:n}=function({value:t,length:e,stride:n,offset:i,startIndices:r,characterSet:o}){const s=t.BYTES_PER_ELEMENT,a=n?n/s:1,l=i?i/s:0,u=r[e]||Math.ceil((t.length-l)/a),c=o&&new Set,h=new Array(e);let f=t;if(a>1||l>0){f=new(0,t.constructor)(u);for(let e=0;e<u;e++)f[e]=t[e*a+l]}for(let t=0;t<e;t++){const e=r[t],n=r[t+1]||u,i=f.subarray(e,n);h[t]=String.fromCodePoint.apply(null,i),c&&i.forEach(c.add,c)}if(c)for(const t of c)o.add(String.fromCodePoint(t));return{texts:h,characterCount:u}}({...ArrayBuffer.isView(i)?{value:i}:i,length:e.length,startIndices:s,characterSet:a});r=n,o=(e,{index:n})=>t[n]}else{const{iterable:t,objectInfo:n}=ac(e);s=[0],r=0;for(const e of t){n.index++;const t=Array.from(o(e,n)||"");a&&t.forEach(a.add,a),r+=t.length,s.push(r)}}this.setState({getText:o,startIndices:s,numInstances:r,characterSet:a||n})}transformParagraph(t,e){const{fontAtlasManager:n}=this.state,i=n.mapping,r=this.state.getText,{wordBreak:o,lineHeight:s,maxWidth:a}=this.props;return function(t,e,n,i,r){const o=Array.from(t),s=o.length,a=new Array(s),l=new Array(s),u=new Array(s),c=("break-word"===n||"break-all"===n)&&isFinite(i)&&i>0,h=[0,0],f=[0,0];let d=0,p=0,g=0;for(let t=0;t<=s;t++){const y=o[t];if("\n"!==y&&t!==s||(g=t),g>p){const t=c?Dv(o,n,i,r,p,g):Nv;for(let n=0;n<=t.length;n++){const i=0===n?p:t[n-1],s=n<t.length?t[n]:g;Fv(o,i,s,r,a,f);for(let t=i;t<s;t++){var m;const e=(null===(m=r[o[t]])||void 0===m?void 0:m.layoutOffsetY)||0;l[t]=d+f[1]/2+e,u[t]=f[0]}d+=f[1]*e,h[0]=Math.max(h[0],f[0])}p=g}"\n"===y&&(a[p]=0,l[p]=0,u[p]=0,p++)}return h[1]=d,{x:a,y:l,rowWidth:u,size:h}}(r(t,e)||"",s,o,a*n.props.fontSize,i)}renderLayers(){const{startIndices:t,numInstances:e,getText:n,fontAtlasManager:{scale:i,texture:r,mapping:o},styleVersion:s}=this.state,{data:a,_dataDiff:l,getPosition:u,getColor:c,getSize:h,getAngle:f,getPixelOffset:d,getBackgroundColor:p,getBorderColor:g,getBorderWidth:m,backgroundPadding:y,background:v,billboard:_,fontSettings:b,outlineWidth:x,outlineColor:w,sizeScale:E,sizeUnits:S,sizeMinPixels:P,sizeMaxPixels:C,transitions:I,updateTriggers:T}=this.props,M=this.getSubLayerClass("characters",Iv),L=this.getSubLayerClass("background",Wv);return[v&&new L({getFillColor:p,getLineColor:g,getLineWidth:m,padding:y,getPosition:u,getSize:h,getAngle:f,getPixelOffset:d,billboard:_,sizeScale:E,sizeUnits:S,sizeMinPixels:P,sizeMaxPixels:C,transitions:I&&{getPosition:I.getPosition,getAngle:I.getAngle,getSize:I.getSize,getFillColor:I.getBackgroundColor,getLineColor:I.getBorderColor,getLineWidth:I.getBorderWidth,getPixelOffset:I.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:T.getPosition,getAngle:T.getAngle,getSize:T.getSize,getFillColor:T.getBackgroundColor,getLineColor:T.getBorderColor,getLineWidth:T.getBorderWidth,getPixelOffset:T.getPixelOffset,getBoundingRect:{getText:T.getText,getTextAnchor:T.getTextAnchor,getAlignmentBaseline:T.getAlignmentBaseline,styleVersion:s}}}),{data:a.attributes&&a.attributes.background?{length:a.length,attributes:a.attributes.background}:a,_dataDiff:l,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new M({sdf:b.sdf,smoothing:Number.isFinite(b.smoothing)?b.smoothing:Bv.smoothing,outlineWidth:x/(b.radius||Bv.radius),outlineColor:w,iconAtlas:r,iconMapping:o,getPosition:u,getColor:c,getSize:h,getAngle:f,getPixelOffset:d,billboard:_,sizeScale:E*i,sizeUnits:S,sizeMinPixels:P*i,sizeMaxPixels:C*i,transitions:I&&{getPosition:I.getPosition,getAngle:I.getAngle,getColor:I.getColor,getSize:I.getSize,getPixelOffset:I.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{getIcon:T.getText,getPosition:T.getPosition,getAngle:T.getAngle,getColor:T.getColor,getSize:T.getSize,getPixelOffset:T.getPixelOffset,getIconOffsets:{getText:T.getText,getTextAnchor:T.getTextAnchor,getAlignmentBaseline:T.getAlignmentBaseline,styleVersion:s}}}),{data:a,_dataDiff:l,startIndices:t,numInstances:e,getIconOffsets:this.getIconOffsets,getIcon:n})]}static set fontAtlasCacheLimit(t){!function(t){$t.assert(Number.isFinite(t)&&t>=3,"Invalid cache limit"),jv=new zv(t)}(t)}}u(Kv,"defaultProps",Zv),u(Kv,"layerName","TextLayer");class $v{constructor(t){u(this,"opts",void 0),u(this,"typedArrayManager",void 0),u(this,"indexStarts",[0]),u(this,"vertexStarts",[0]),u(this,"vertexCount",0),u(this,"instanceCount",0),u(this,"attributes",void 0),u(this,"_attributeDefs",void 0),u(this,"data",void 0),u(this,"getGeometry",void 0),u(this,"geometryBuffer",void 0),u(this,"buffers",void 0),u(this,"positionSize",void 0),u(this,"normalize",void 0);const{attributes:e={}}=t;this.typedArrayManager=An,this.attributes={},this._attributeDefs=e,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);const{data:e,buffers:n={},getGeometry:i,geometryBuffer:r,positionFormat:o,dataChanged:s,normalize:a=!0}=this.opts;if(this.data=e,this.getGeometry=i,this.positionSize=r&&r.size||("XY"===o?2:3),this.buffers=n,this.normalize=a,r&&(m(e.startIndices),this.getGeometry=this.getGeometryFromBuffer(r),a||(n.positions=r)),this.geometryBuffer=n.positions,Array.isArray(s))for(const t of s)this._rebuildGeometry(t);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:e}){this._rebuildGeometry({startRow:t,endRow:e})}getGeometryFromBuffer(t){const e=t.value||t;return ArrayBuffer.isView(e)?uc(e,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,e){const{attributes:n,buffers:i,_attributeDefs:r,typedArrayManager:o}=this;for(const s in r)if(s in i)o.release(n[s]),n[s]=null;else{const i=r[s];i.copy=e,n[s]=o.allocate(n[s],t,i)}}_forEachGeometry(t,e,n){const{data:i,getGeometry:r}=this,{iterable:o,objectInfo:s}=ac(i,e,n);for(const e of o)s.index++,t(r?r(e,s):null,s.index)}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:e,vertexStarts:n,instanceCount:i}=this;const{data:r,geometryBuffer:o}=this,{startRow:s=0,endRow:a=1/0}=t||{},l={};if(t||(e=[0],n=[0]),this.normalize||!o)this._forEachGeometry(((t,e)=>{const i=t&&this.normalizeGeometry(t);l[e]=i,n[e+1]=n[e]+(i?this.getGeometrySize(i):0)}),s,a),i=n[n.length-1];else if(n=r.startIndices,i=n[r.length]||0,ArrayBuffer.isView(o))i=i||o.length/this.positionSize;else if(o instanceof bo){const t=o.accessor.stride||4*this.positionSize;i=i||o.byteLength/t}else if(o.buffer){const t=o.stride||4*this.positionSize;i=i||o.buffer.byteLength/t}else if(o.value){const t=o.value,e=o.stride/t.BYTES_PER_ELEMENT||this.positionSize;i=i||t.length/e}this._allocate(i,Boolean(t)),this.indexStarts=e,this.vertexStarts=n,this.instanceCount=i;const u={};this._forEachGeometry(((t,r)=>{const o=l[r]||t;u.vertexStart=n[r],u.indexStart=e[r];const s=r<n.length-1?n[r+1]:i;u.geometrySize=s-n[r],u.geometryIndex=r,this.updateGeometryAttributes(o,u)}),s,a),this.vertexCount=e[e.length-1]}}function Qv(t,e,n={}){const i=function(t,e={}){return Math.sign(function(t,e={}){const{start:n=0,end:i=t.length}=e,r=e.size||2;let o=0;for(let e=n,s=i-r;e<i;e+=r)o+=(t[e]-t[s])*(t[e+1]+t[s+1]),s=e;return o/2}(t,e))}(t,n);return i!==e&&(function(t,e){const{start:n=0,end:i=t.length,size:r=2}=e,o=(i-n)/r,s=Math.floor(o/2);for(let e=0;e<s;++e){const i=n+e*r,s=n+(o-1-e)*r;for(let e=0;e<r;++e){const n=t[i+e];t[i+e]=t[s+e],t[s+e]=n}}}(t,n),!0)}function Jv(t,e,n,i,r=[]){let o,s;if(8&n)o=(i[3]-t[1])/(e[1]-t[1]),s=3;else if(4&n)o=(i[1]-t[1])/(e[1]-t[1]),s=1;else if(2&n)o=(i[2]-t[0])/(e[0]-t[0]),s=2;else{if(!(1&n))return null;o=(i[0]-t[0])/(e[0]-t[0]),s=0}for(let n=0;n<t.length;n++)r[n]=(1&s)===n?i[s]:o*(e[n]-t[n])+t[n];return r}function t_(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function e_(t,e){const n=e.length,i=t.length;if(i>0){let r=!0;for(let o=0;o<n;o++)if(t[i-n+o]!==e[o]){r=!1;break}if(r)return!1}for(let r=0;r<n;r++)t[i+r]=e[r];return!0}function n_(t,e){const n=e.length;for(let i=0;i<n;i++)t[i]=e[i]}function i_(t,e,n,i,r=[]){const o=i+e*n;for(let e=0;e<n;e++)r[e]=t[o+e];return r}function r_(t,e){const{size:n=2,broken:i=!1,gridResolution:r=10,gridOffset:o=[0,0],startIndex:s=0,endIndex:a=t.length}=e||{},l=(a-s)/n;let u=[];const c=[u],h=i_(t,0,n,s);let f,d;const p=c_(h,r,o,[]),g=[];e_(u,h);for(let e=1;e<l;e++){for(f=i_(t,e,n,s,f),d=t_(f,p);d;){Jv(h,f,d,p,g);const t=t_(g,p);t&&(Jv(h,g,t,p,g),d=t),e_(u,g),n_(h,g),h_(p,r,d),i&&u.length>n&&(u=[],c.push(u),e_(u,h)),d=t_(f,p)}e_(u,f),n_(h,f)}return i?c:c[0]}const o_=0,s_=1;function a_(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function l_(t,e=null,n){if(!t.length)return[];const{size:i=2,gridResolution:r=10,gridOffset:o=[0,0],edgeTypes:s=!1}=n||{},a=[],l=[{pos:t,types:s?new Array(t.length/i).fill(s_):null,holes:e||[]}],u=[[],[]];let c=[];for(;l.length;){const{pos:t,types:e,holes:n}=l.shift();f_(t,i,n[0]||t.length,u),c=c_(u[0],r,o,c);const h=t_(u[1],c);if(h){let r=u_(t,e,i,0,n[0]||t.length,c,h);const o={pos:r[0].pos,types:r[0].types,holes:[]},a={pos:r[1].pos,types:r[1].types,holes:[]};l.push(o,a);for(let l=0;l<n.length;l++)r=u_(t,e,i,n[l],n[l+1]||t.length,c,h),r[0]&&(o.holes.push(o.pos.length),o.pos=a_(o.pos,r[0].pos),s&&(o.types=a_(o.types,r[0].types))),r[1]&&(a.holes.push(a.pos.length),a.pos=a_(a.pos,r[1].pos),s&&(a.types=a_(a.types,r[1].types)))}else{const i={positions:t};s&&(i.edgeTypes=e),n.length&&(i.holeIndices=n),a.push(i)}}return a}function u_(t,e,n,i,r,o,s){const a=(r-i)/n,l=[],u=[],c=[],h=[],f=[];let d,p,g;const m=i_(t,a-1,n,i);let y=Math.sign(8&s?m[1]-o[3]:m[0]-o[2]),v=e&&e[a-1],_=0,b=0;for(let r=0;r<a;r++)d=i_(t,r,n,i,d),p=Math.sign(8&s?d[1]-o[3]:d[0]-o[2]),g=e&&e[i/n+r],p&&y&&y!==p&&(Jv(m,d,s,o,f),e_(l,f)&&c.push(v),e_(u,f)&&h.push(v)),p<=0?(e_(l,d)&&c.push(g),_-=p):c.length&&(c[c.length-1]=o_),p>=0?(e_(u,d)&&h.push(g),b+=p):h.length&&(h[h.length-1]=o_),n_(m,d),y=p,v=g;return[_?{pos:l,types:e&&c}:null,b?{pos:u,types:e&&h}:null]}function c_(t,e,n,i){const r=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return i[0]=r,i[1]=o,i[2]=r+e,i[3]=o+e,i}function h_(t,e,n){8&n?(t[1]+=e,t[3]+=e):4&n?(t[1]-=e,t[3]-=e):2&n?(t[0]+=e,t[2]+=e):1&n&&(t[0]-=e,t[2]-=e)}function f_(t,e,n,i){let r=1/0,o=-1/0,s=1/0,a=-1/0;for(let i=0;i<n;i+=e){const e=t[i],n=t[i+1];r=e<r?e:r,o=e>o?e:o,s=n<s?n:s,a=n>a?n:a}return i[0][0]=r,i[0][1]=s,i[1][0]=o,i[1][1]=a,i}const d_=85.051129;function p_(t,e,n,i){let r=-1,o=-1;for(let s=n+1;s<i;s+=e){const e=Math.abs(t[s]);e>r&&(r=e,o=s-1)}return o}function g_(t,e,n,i,r=d_){const o=t[n],s=t[i-e];if(Math.abs(o-s)>180){const i=i_(t,0,e,n);i[0]+=360*Math.round((s-o)/360),e_(t,i),i[1]=Math.sign(i[1])*r,e_(t,i),i[0]=o,e_(t,i)}}function m_(t,e,n,i){let r,o=t[0];for(let s=n;s<i;s+=e){r=t[s];const e=r-o;(e>180||e<-180)&&(r-=360*Math.round(e/360)),t[s]=o=r}}function y_(t,e){let n;const i=t.length/e;for(let r=0;r<i&&(n=t[r*e],(n+180)%360==0);r++);const r=360*-Math.round(n/360);if(0!==r)for(let n=0;n<i;n++)t[n*e]+=r}class v_ extends $v{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?function(t,e,n,i){let r;if(Array.isArray(t[0])){const n=t.length*e;r=new Array(n);for(let n=0;n<t.length;n++)for(let i=0;i<e;i++)r[n*e+i]=t[n][i]||0}else r=t;return n?r_(r,{size:e,gridResolution:n}):i?function(t,e){const{size:n=2,startIndex:i=0,endIndex:r=t.length,normalize:o=!0}=e||{},s=t.slice(i,r);m_(s,n,0,r-i);const a=r_(s,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const t of a)y_(t,n);return a}(r,{size:e}):r}(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(__(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}const e=this.getPathLength(t);return e<2?0:this.isClosed(t)?e<3?0:e+2:e}updateGeometryAttributes(t,e){if(0!==e.geometrySize)if(t&&__(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t}else this._updateSegmentTypes(t,e),this._updatePositions(t,e)}_updateSegmentTypes(t,e){const n=this.attributes.segmentTypes,i=!!t&&this.isClosed(t),{vertexStart:r,geometrySize:o}=e;n.fill(0,r,r+o),i?(n[r]=4,n[r+o-2]=4):(n[r]+=1,n[r+o-2]+=2),n[r+o-1]=4}_updatePositions(t,e){const{positions:n}=this.attributes;if(!n||!t)return;const{vertexStart:i,geometrySize:r}=e,o=new Array(3);for(let e=i,s=0;s<r;e++,s++)this.getPointOnPath(t,s,o),n[3*e]=o[0],n[3*e+1]=o[1],n[3*e+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,e,n=[]){const{positionSize:i}=this;e*i>=t.length&&(e+=1-t.length/i);const r=e*i;return n[0]=t[r],n[1]=t[r+1],n[2]=3===i&&t[r+2]||0,n}isClosed(t){if(!this.normalize)return Boolean(this.opts.loop);const{positionSize:e}=this,n=t.length-e;return t[0]===t[n]&&t[1]===t[n+1]&&(2===e||t[2]===t[n+2])}}function __(t){return Array.isArray(t[0])}const b_=[0,0,0,255],x_={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:b_},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},w_={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class E_ extends Uh{constructor(...t){super(...t),u(this,"state",void 0)}getShaders(){return super.getShaders({vs:"#define SHADER_NAME path-layer-vertex-shader\n\nattribute vec2 positions;\n\nattribute float instanceTypes;\nattribute vec3 instanceStartPositions;\nattribute vec3 instanceEndPositions;\nattribute vec3 instanceLeftPositions;\nattribute vec3 instanceRightPositions;\nattribute vec3 instanceLeftPositions64Low;\nattribute vec3 instanceStartPositions64Low;\nattribute vec3 instanceEndPositions64Low;\nattribute vec3 instanceRightPositions64Low;\nattribute float instanceStrokeWidths;\nattribute vec4 instanceColors;\nattribute vec3 instancePickingColors;\n\nuniform float widthScale;\nuniform float widthMinPixels;\nuniform float widthMaxPixels;\nuniform float jointType;\nuniform float capType;\nuniform float miterLimit;\nuniform bool billboard;\nuniform int widthUnits;\n\nuniform float opacity;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nconst float EPSILON = 0.001;\nconst vec3 ZERO_OFFSET = vec3(0.0);\n\nfloat flipIfTrue(bool flag) {\n  return -(float(flag) * 2. - 1.);\n}\nvec3 getLineJoinOffset(\n  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,\n  vec2 width\n) {\n  bool isEnd = positions.x > 0.0;\n  float sideOfPath = positions.y;\n  float isJoint = float(sideOfPath == 0.0);\n\n  vec3 deltaA3 = (currPoint - prevPoint);\n  vec3 deltaB3 = (nextPoint - currPoint);\n\n  mat3 rotationMatrix;\n  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);\n  if (needsRotation) {\n    deltaA3 = deltaA3 * rotationMatrix;\n    deltaB3 = deltaB3 * rotationMatrix;\n  }\n  vec2 deltaA = deltaA3.xy / width;\n  vec2 deltaB = deltaB3.xy / width;\n\n  float lenA = length(deltaA);\n  float lenB = length(deltaB);\n\n  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);\n  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);\n\n  vec2 perpA = vec2(-dirA.y, dirA.x);\n  vec2 perpB = vec2(-dirB.y, dirB.x);\n  vec2 tangent = dirA + dirB;\n  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;\n  vec2 miterVec = vec2(-tangent.y, tangent.x);\n  vec2 dir = isEnd ? dirA : dirB;\n  vec2 perp = isEnd ? perpA : perpB;\n  float L = isEnd ? lenA : lenB;\n  float sinHalfA = abs(dot(miterVec, perp));\n  float cosHalfA = abs(dot(dirA, miterVec));\n  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);\n  float cornerPosition = sideOfPath * turnDirection;\n\n  float miterSize = 1.0 / max(sinHalfA, EPSILON);\n  miterSize = mix(\n    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),\n    miterSize,\n    step(0.0, cornerPosition)\n  );\n\n  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))\n    * (sideOfPath + isJoint * turnDirection);\n  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));\n  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));\n  bool isCap = isStartCap || isEndCap;\n  if (isCap) {\n    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);\n    vJointType = capType;\n  } else {\n    vJointType = jointType;\n  }\n  vPathLength = L;\n  vCornerOffset = offsetVec;\n  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);\n  vMiterLength = isCap ? isJoint : vMiterLength;\n\n  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);\n  vPathPosition = vec2(\n    dot(offsetFromStartOfPath, perp),\n    dot(offsetFromStartOfPath, dir)\n  );\n  geometry.uv = vPathPosition;\n\n  float isValid = step(instanceTypes, 3.5);\n  vec3 offset = vec3(offsetVec * width * isValid, 0.0);\n\n  if (needsRotation) {\n    offset = rotationMatrix * offset;\n  }\n  return offset;\n}\nvoid clipLine(inout vec4 position, vec4 refPosition) {\n  if (position.w < EPSILON) {\n    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);\n    position = refPosition + (position - refPosition) * r;\n  }\n}\n\nvoid main() {\n  geometry.pickingColor = instancePickingColors;\n\n  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);\n\n  float isEnd = positions.x;\n\n  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);\n  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);\n\n  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);\n  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);\n\n  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);\n  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);\n\n  geometry.worldPosition = currPosition;\n  vec2 widthPixels = vec2(clamp(\n    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\n    widthMinPixels, widthMaxPixels) / 2.0);\n  vec3 width;\n\n  if (billboard) {\n    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);\n    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);\n    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);\n\n    clipLine(prevPositionScreen, currPositionScreen);\n    clipLine(nextPositionScreen, currPositionScreen);\n    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));\n\n    width = vec3(widthPixels, 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(\n      prevPositionScreen.xyz / prevPositionScreen.w,\n      currPositionScreen.xyz / currPositionScreen.w,\n      nextPositionScreen.xyz / nextPositionScreen.w,\n      project_pixel_size_to_clipspace(width.xy)\n    );\n\n    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);\n    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);\n  } else {\n    prevPosition = project_position(prevPosition, prevPosition64Low);\n    currPosition = project_position(currPosition, currPosition64Low);\n    nextPosition = project_position(nextPosition, nextPosition64Low);\n\n    width = vec3(project_pixel_size(widthPixels), 0.0);\n    DECKGL_FILTER_SIZE(width, geometry);\n\n    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);\n    geometry.position = vec4(currPosition + offset, 1.0);\n    gl_Position = project_common_position_to_clipspace(geometry.position);\n    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",fs:"#define SHADER_NAME path-layer-fragment-shader\n\nprecision highp float;\n\nuniform float miterLimit;\n\nvarying vec4 vColor;\nvarying vec2 vCornerOffset;\nvarying float vMiterLength;\nvarying vec2 vPathPosition;\nvarying float vPathLength;\nvarying float vJointType;\n\nvoid main(void) {\n  geometry.uv = vPathPosition;\n\n  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {\n    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {\n      discard;\n    }\n    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {\n      discard;\n    }\n  }\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",modules:[Qy,ev]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:w_,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:w_,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:w_,defaultValue:b_},instancePickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n)}}),this.setState({pathTesselator:new v_({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);const{props:e,changeFlags:n}=t,i=this.getAttributeManager();if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPath)){const{pathTesselator:t}=this.state,r=e.data.attributes||{};t.updateGeometry({data:e.data,geometryBuffer:r.getPath,buffers:r,normalize:!e._pathType,loop:"loop"===e._pathType,getGeometry:e.getPath,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:n.dataChanged}),this.setState({numInstances:t.instanceCount,startIndices:t.vertexStarts}),n.dataChanged||i.invalidateAll()}if(n.extensionsChanged){var r;const{gl:t}=this.context;null===(r=this.state.model)||void 0===r||r.delete(),this.state.model=this._getModel(t),i.invalidateAll()}}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{jointRounded:e,capRounded:n,billboard:i,miterLimit:r,widthUnits:o,widthScale:s,widthMinPixels:a,widthMaxPixels:l}=this.props;this.state.model.setUniforms(t).setUniforms({jointType:Number(e),capType:Number(n),billboard:i,widthUnits:si[o],widthScale:s,miterLimit:r,widthMinPixels:a,widthMaxPixels:l}).draw()}_getModel(t){return new $c(t,{...this.getShaders(),id:this.props.id,geometry:new iv({drawMode:4,attributes:{indices:new Uint16Array([0,1,2,1,4,2,1,3,4,3,5,4]),positions:{value:new Float32Array([0,0,0,-1,0,1,1,-1,1,1,1,0]),size:2}}}),isInstanced:!0})}calculatePositions(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateSegmentTypes(t){const{pathTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("segmentTypes")}}u(E_,"defaultProps",x_),u(E_,"layerName","PathLayer");const S_="#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))\n\nstruct AmbientLight {\n vec3 color;\n};\n\nstruct PointLight {\n vec3 color;\n vec3 position;\n vec3 attenuation;\n};\n\nstruct DirectionalLight {\n  vec3 color;\n  vec3 direction;\n};\n\nuniform AmbientLight lighting_uAmbientLight;\nuniform PointLight lighting_uPointLight[MAX_LIGHTS];\nuniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];\nuniform int lighting_uPointLightCount;\nuniform int lighting_uDirectionalLightCount;\n\nuniform bool lighting_uEnabled;\n\nfloat getPointLightAttenuation(PointLight pointLight, float distance) {\n  return pointLight.attenuation.x\n       + pointLight.attenuation.y * distance\n       + pointLight.attenuation.z * distance * distance;\n}\n\n#endif\n",P_={lightSources:{}};function C_(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.map((t=>t*e/255))}const I_={};const T_={name:"gouraud-lighting",dependencies:[{name:"lights",vs:S_,fs:S_,getUniforms:function t(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P_;if("lightSources"in e){const{ambientLight:t,pointLights:n,directionalLights:i}=e.lightSources||{};return t||n&&n.length>0||i&&i.length>0?Object.assign({},function(t){let{ambientLight:e,pointLights:n=[],directionalLights:i=[]}=t;const r={};return r["lighting_uAmbientLight.color"]=e?C_(e):[0,0,0],n.forEach(((t,e)=>{r["lighting_uPointLight[".concat(e,"].color")]=C_(t),r["lighting_uPointLight[".concat(e,"].position")]=t.position,r["lighting_uPointLight[".concat(e,"].attenuation")]=t.attenuation||[1,0,0]})),r.lighting_uPointLightCount=n.length,i.forEach(((t,e)=>{r["lighting_uDirectionalLight[".concat(e,"].color")]=C_(t),r["lighting_uDirectionalLight[".concat(e,"].direction")]=t.direction})),r.lighting_uDirectionalLightCount=i.length,r}({ambientLight:t,pointLights:n,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){const n={pointLights:[],directionalLights:[]};for(const t of e.lights||[])switch(t.type){case"ambient":n.ambientLight=t;break;case"directional":n.directionalLights.push(t);break;case"point":n.pointLights.push(t)}return t({lightSources:n})}return{}},defines:{MAX_LIGHTS:3}}],vs:"\nuniform float lighting_uAmbient;\nuniform float lighting_uDiffuse;\nuniform float lighting_uShininess;\nuniform vec3  lighting_uSpecularColor;\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {\n    vec3 halfway_direction = normalize(light_direction + view_direction);\n    float lambertian = dot(light_direction, normal_worldspace);\n    float specular = 0.0;\n    if (lambertian > 0.0) {\n      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);\n      specular = pow(specular_angle, lighting_uShininess);\n    }\n    lambertian = max(lambertian, 0.0);\n    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;\n}\n\nvec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = surfaceColor;\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n\nvec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {\n  vec3 lightColor = vec3(0, 0, 0);\n  vec3 surfaceColor = vec3(0, 0, 0);\n\n  if (lighting_uEnabled) {\n    vec3 view_direction = normalize(cameraPosition - position_worldspace);\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uPointLightCount) {\n        break;\n      }\n      PointLight pointLight = lighting_uPointLight[i];\n      vec3 light_position_worldspace = pointLight.position;\n      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);\n      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);\n    }\n\n    for (int i = 0; i < MAX_LIGHTS; i++) {\n      if (i >= lighting_uDirectionalLightCount) {\n        break;\n      }\n      DirectionalLight directionalLight = lighting_uDirectionalLight[i];\n      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);\n    }\n  }\n  return lightColor;\n}\n",defines:{LIGHTING_VERTEX:1},getUniforms:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I_;if(!("material"in t))return{};const{material:e}=t;return e?function(t){const{ambient:e=.35,diffuse:n=.6,shininess:i=32,specularColor:r=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:i,lighting_uSpecularColor:r.map((t=>t/255))}}(e):{lighting_uEnabled:!1}}},M_=1,L_=-1,A_={isClosed:!0};function O_(t){return"positions"in t?t.positions:t}function N_(t){return"holeIndices"in t?t.holeIndices:null}function R_(t,e,n,i,r){let o=e;const s=n.length;for(let e=0;e<s;e++)for(let r=0;r<i;r++)t[o++]=n[e][r]||0;if(!function(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}(n))for(let e=0;e<i;e++)t[o++]=n[0][e]||0;return A_.start=e,A_.end=o,A_.size=i,Qv(t,r,A_),o}function k_(t,e,n,i,r=0,o,s){const a=(o=o||n.length)-r;if(a<=0)return e;let l=e;for(let e=0;e<a;e++)t[l++]=n[r+e];if(!function(t,e,n,i){for(let r=0;r<e;r++)if(t[n+r]!==t[i-e+r])return!1;return!0}(n,i,r,o))for(let e=0;e<i;e++)t[l++]=n[r+e];return A_.start=e,A_.end=l,A_.size=i,Qv(t,s,A_),l}function D_(t,e,n){const i=t.length/3;let r=0;for(let o=0;o<i;o++){const s=(o+1)%i;r+=t[3*o+e]*t[3*s+n],r-=t[3*s+e]*t[3*o+n]}return Math.abs(r/2)}function F_(t,e,n,i){const r=t.length/3;for(let o=0;o<r;o++){const r=3*o,s=t[r+0],a=t[r+1],l=t[r+2];t[r+e]=s,t[r+n]=a,t[r+i]=l}}class z_ extends $v{constructor(t){const{fp64:e,IndexType:n=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:e?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:n,size:1}}})}get(t){const{attributes:e}=this;return"indices"===t?e.indices&&e.indices.subarray(0,this.vertexCount):e[t]}updateGeometry(t){super.updateGeometry(t);const e=this.buffers.indices;if(e)this.vertexCount=(e.value||e).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){const e=function(t,e){!function(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}(t);const n=[],i=[];if("positions"in t){const{positions:r,holeIndices:o}=t;if(o){let t=0;for(let s=0;s<=o.length;s++)t=k_(n,t,r,e,o[s-1],o[s],0===s?M_:L_),i.push(t);return i.pop(),{positions:n,holeIndices:i}}t=r}if(!function(t){return Array.isArray(t[0])}(t))return k_(n,0,t,e,0,n.length,M_),n;if(!function(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}(t)){let r=0;for(const[o,s]of t.entries())r=R_(n,r,s,e,0===o?M_:L_),i.push(r);return i.pop(),{positions:n,holeIndices:i}}return R_(n,0,t,e,M_),n}(t,this.positionSize);return this.opts.resolution?l_(O_(e),N_(e),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?function(t,e=null,n){const{size:i=2,normalize:r=!0,edgeTypes:o=!1}=n||{};e=e||[];const s=[],a=[];let l=0,u=0;for(let r=0;r<=e.length;r++){const o=e[r]||t.length,c=u,h=p_(t,i,l,o);for(let e=h;e<o;e++)s[u++]=t[e];for(let e=l;e<h;e++)s[u++]=t[e];m_(s,i,c,u),g_(s,i,c,u,null==n?void 0:n.maxLatitude),l=o,a[r]=u}a.pop();const c=l_(s,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(r)for(const t of c)y_(t.positions,i);return c}(O_(e),N_(e),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):e}return t}getGeometrySize(t){if(B_(t)){let e=0;for(const n of t)e+=this.getGeometrySize(n);return e}return O_(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,e){if(t&&B_(t))for(const n of t){const t=this.getGeometrySize(n);e.geometrySize=t,this.updateGeometryAttributes(n,e),e.vertexStart+=t,e.indexStart=this.indexStarts[e.geometryIndex+1]}else this._updateIndices(t,e),this._updatePositions(t,e),this._updateVertexValid(t,e)}_updateIndices(t,{geometryIndex:e,vertexStart:n,indexStart:i}){const{attributes:r,indexStarts:o,typedArrayManager:s}=this;let a=r.indices;if(!a||!t)return;let l=i;const u=function(t,e,n,i){let r=N_(t);r&&(r=r.map((t=>t/e)));let o=O_(t);const s=i&&3===e;if(n){const t=o.length;o=o.slice();const i=[];for(let r=0;r<t;r+=e){i[0]=o[r],i[1]=o[r+1],s&&(i[2]=o[r+2]);const t=n(i);o[r]=t[0],o[r+1]=t[1],s&&(o[r+2]=t[2])}}if(s){const t=D_(o,0,1),e=D_(o,0,2),i=D_(o,1,2);if(!t&&!e&&!i)return[];t>e&&t>i||(e>i?(n||(o=o.slice()),F_(o,0,2,1)):(n||(o=o.slice()),F_(o,1,2,0)))}return af()(o,r,e)}(t,this.positionSize,this.opts.preproject,this.opts.full3d);a=s.allocate(a,i+u.length,{copy:!0});for(let t=0;t<u.length;t++)a[l++]=u[t]+n;o[e+1]=i+u.length,r.indices=a}_updatePositions(t,{vertexStart:e,geometrySize:n}){const{attributes:{positions:i},positionSize:r}=this;if(!i||!t)return;const o=O_(t);for(let t=e,s=0;s<n;t++,s++){const e=o[s*r],n=o[s*r+1],a=r>2?o[s*r+2]:0;i[3*t]=e,i[3*t+1]=n,i[3*t+2]=a}}_updateVertexValid(t,{vertexStart:e,geometrySize:n}){const{positionSize:i}=this,r=this.attributes.vertexValid,o=t&&N_(t);if(t&&t.edgeTypes?r.set(t.edgeTypes,e):r.fill(1,e,e+n),o)for(let t=0;t<o.length;t++)r[e+o[t]/i-1]=0;r[e+n-1]=0}}function B_(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const j_="\nattribute vec2 vertexPositions;\nattribute float vertexValid;\n\nuniform bool extruded;\nuniform bool isWireframe;\nuniform float elevationScale;\nuniform float opacity;\n\nvarying vec4 vColor;\n\nstruct PolygonProps {\n  vec4 fillColors;\n  vec4 lineColors;\n  vec3 positions;\n  vec3 nextPositions;\n  vec3 pickingColors;\n  vec3 positions64Low;\n  vec3 nextPositions64Low;\n  float elevations;\n};\n\nvec3 project_offset_normal(vec3 vector) {\n  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||\n    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {\n    return normalize(vector * project_uCommonUnitsPerWorldUnit);\n  }\n  return project_normal(vector);\n}\n\nvoid calculatePosition(PolygonProps props) {\n#ifdef IS_SIDE_VERTEX\n  if(vertexValid < 0.5){\n    gl_Position = vec4(0.);\n    return;\n  }\n#endif\n\n  vec3 pos;\n  vec3 pos64Low;\n  vec3 normal;\n  vec4 colors = isWireframe ? props.lineColors : props.fillColors;\n\n  geometry.worldPosition = props.positions;\n  geometry.worldPositionAlt = props.nextPositions;\n  geometry.pickingColor = props.pickingColors;\n\n#ifdef IS_SIDE_VERTEX\n  pos = mix(props.positions, props.nextPositions, vertexPositions.x);\n  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);\n#else\n  pos = props.positions;\n  pos64Low = props.positions64Low;\n#endif\n\n  if (extruded) {\n    pos.z += props.elevations * vertexPositions.y * elevationScale;\n  }\n  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);\n\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\n\n  if (extruded) {\n  #ifdef IS_SIDE_VERTEX\n    normal = vec3(\n      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),\n      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),\n      0.0);\n    normal = project_offset_normal(normal);\n  #else\n    normal = project_normal(vec3(0.0, 0.0, 1.0));\n  #endif\n    geometry.normal = normal;\n    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);\n    vColor = vec4(lightColor, colors.a * opacity);\n  } else {\n    vColor = vec4(colors.rgb, colors.a * opacity);\n  }\n  DECKGL_FILTER_COLOR(vColor, geometry);\n}\n",U_="#define SHADER_NAME solid-polygon-layer-vertex-shader\n\nattribute vec3 positions;\nattribute vec3 positions64Low;\nattribute float elevations;\nattribute vec4 fillColors;\nattribute vec4 lineColors;\nattribute vec3 pickingColors;\n\n".concat(j_,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  props.positions = positions;\n  props.positions64Low = positions64Low;\n  props.elevations = elevations;\n  props.fillColors = fillColors;\n  props.lineColors = lineColors;\n  props.pickingColors = pickingColors;\n\n  calculatePosition(props);\n}\n"),V_="#define SHADER_NAME solid-polygon-layer-vertex-shader-side\n#define IS_SIDE_VERTEX\n\n\nattribute vec3 instancePositions;\nattribute vec3 nextPositions;\nattribute vec3 instancePositions64Low;\nattribute vec3 nextPositions64Low;\nattribute float instanceElevations;\nattribute vec4 instanceFillColors;\nattribute vec4 instanceLineColors;\nattribute vec3 instancePickingColors;\n\n".concat(j_,"\n\nvoid main(void) {\n  PolygonProps props;\n\n  #if RING_WINDING_ORDER_CW == 1\n    props.positions = instancePositions;\n    props.positions64Low = instancePositions64Low;\n    props.nextPositions = nextPositions;\n    props.nextPositions64Low = nextPositions64Low;\n  #else\n    props.positions = nextPositions;\n    props.positions64Low = nextPositions64Low;\n    props.nextPositions = instancePositions;\n    props.nextPositions64Low = instancePositions64Low;\n  #endif\n  props.elevations = instanceElevations;\n  props.fillColors = instanceFillColors;\n  props.lineColors = instanceLineColors;\n  props.pickingColors = instancePickingColors;\n\n  calculatePosition(props);\n}\n"),G_=[0,0,0,255],q_={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:G_},getLineColor:{type:"accessor",value:G_},material:!0},W_={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class H_ extends Uh{constructor(...t){super(...t),u(this,"state",void 0)}getShaders(t){return super.getShaders({vs:"top"===t?U_:V_,fs:"#define SHADER_NAME solid-polygon-layer-fragment-shader\n\nprecision highp float;\n\nvarying vec4 vColor;\n\nvoid main(void) {\n  gl_FragColor = vColor;\n\n  DECKGL_FILTER_COLOR(gl_FragColor, geometry);\n}\n",defines:{RING_WINDING_ORDER_CW:this.props._normalize||"CCW"!==this.props._windingOrder?1:0},modules:[Qy,T_,ev]})}get wrapLongitude(){return!1}initializeState(){const{gl:t,viewport:e}=this.context;let{coordinateSystem:n}=this.props;const{_full3d:i}=this.props;let r;e.isGeospatial&&n===ri.DEFAULT&&(n=ri.LNGLAT),n===ri.LNGLAT&&(r=i?e.projectPosition.bind(e):e.projectFlat.bind(e)),this.setState({numInstances:0,polygonTesselator:new z_({preproject:r,fp64:this.use64bitPositions(),IndexType:!t||$o(t,Yo)?Uint32Array:Uint16Array})});const o=this.getAttributeManager(),s=!0;o.remove(["instancePickingColors"]),o.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:W_,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:W_,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:W_,accessor:"getFillColor",defaultValue:G_,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:W_,accessor:"getLineColor",defaultValue:G_,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(t,{index:e,target:n})=>this.encodePickingColor(t&&t.__source?t.__source.index:e,n),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n}=e,{data:i}=this.props;return i[0]&&i[0].__source&&(e.object=i.find((t=>t.__source.index===n))),e}disablePickingIndex(t){const{data:e}=this.props;if(e[0]&&e[0].__source)for(let n=0;n<e.length;n++)e[n].__source.index===t&&this._disablePickingIndex(n);else this._disablePickingIndex(t)}draw({uniforms:t}){const{extruded:e,filled:n,wireframe:i,elevationScale:r}=this.props,{topModel:o,sideModel:s,polygonTesselator:a}=this.state,l={...t,extruded:Boolean(e),elevationScale:r};s&&(s.setInstanceCount(a.instanceCount-1),s.setUniforms(l),i&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),n&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),o&&(o.setVertexCount(a.vertexCount),o.setUniforms(l).draw())}updateState(t){super.updateState(t),this.updateGeometry(t);const{props:e,oldProps:n,changeFlags:i}=t,r=this.getAttributeManager();var o;(i.extensionsChanged||e.filled!==n.filled||e.extruded!==n.extruded)&&(null===(o=this.state.models)||void 0===o||o.forEach((t=>t.delete())),this.setState(this._getModels(this.context.gl)),r.invalidateAll())}updateGeometry({props:t,oldProps:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&(n.updateTriggersChanged.all||n.updateTriggersChanged.getPolygon)){const{polygonTesselator:e}=this.state,i=t.data.attributes||{};e.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:i.getPolygon,buffers:i,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:n.dataChanged,full3d:t._full3d}),this.setState({numInstances:e.instanceCount,startIndices:e.vertexStarts}),n.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(t){const{id:e,filled:n,extruded:i}=this.props;let r,o;if(n){const n=this.getShaders("top");n.defines.NON_INSTANCED_MODEL=1,r=new $c(t,{...n,id:"".concat(e,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(o=new $c(t,{...this.getShaders("side"),id:"".concat(e,"-side"),geometry:new iv({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),o.userData.excludeAttributes={indices:!0}),{models:[o,r].filter(Boolean),topModel:r,sideModel:o}}calculateIndices(t){const{polygonTesselator:e}=this.state;t.startIndices=e.indexStarts,t.value=e.get("indices")}calculatePositions(t){const{polygonTesselator:e}=this.state;t.startIndices=e.vertexStarts,t.value=e.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}}u(H_,"defaultProps",q_),u(H_,"layerName","SolidPolygonLayer");const X_={circle:{type:Sv,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:xv,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:Kv,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},Y_={type:E_,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},Z_={type:H_,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function K_({type:t,props:e}){const n={};for(const i in e)n[i]=t.defaultProps[e[i]];return n}function $_(t,e){const{transitions:n,updateTriggers:i}=t.props,r={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const s=e[o];let a=t.props[o];o.startsWith("get")&&(a=t.getSubLayerAccessor(a),r.updateTriggers[s]=i[o],n&&(r.transitions[s]=n[o])),r[s]=a}return r}function Q_(t,e,n={}){const i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:r=0,endRow:o=t.length}=n;for(let n=r;n<o;n++){const r=t[n],{geometry:o}=r;if(o)if("GeometryCollection"===o.type){$t.assert(Array.isArray(o.geometries),"GeoJSON does not have geometries array");const{geometries:t}=o;for(let o=0;o<t.length;o++)J_(t[o],i,e,r,n)}else J_(o,i,e,r,n)}return i}function J_(t,e,n,i,r){const{type:o,coordinates:s}=t,{pointFeatures:a,lineFeatures:l,polygonFeatures:u,polygonOutlineFeatures:c}=e;if(function(t,e){let n=tb[t];for($t.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}(o,s))switch(o){case"Point":a.push(n({geometry:t},i,r));break;case"MultiPoint":s.forEach((t=>{a.push(n({geometry:{type:"Point",coordinates:t}},i,r))}));break;case"LineString":l.push(n({geometry:t},i,r));break;case"MultiLineString":s.forEach((t=>{l.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"Polygon":u.push(n({geometry:t},i,r)),s.forEach((t=>{c.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}));break;case"MultiPolygon":s.forEach((t=>{u.push(n({geometry:{type:"Polygon",coordinates:t}},i,r)),t.forEach((t=>{c.push(n({geometry:{type:"LineString",coordinates:t}},i,r))}))}))}else $t.warn("".concat(o," coordinates are malformed"))()}const tb={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function eb(t){return t.geometry.coordinates}const nb=["points","linestrings","polygons"],ib={...K_(X_.circle),...K_(X_.icon),...K_(X_.text),...K_(Y_),...K_(Z_),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class rb extends hv{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:t,changeFlags:e}){if(!e.dataChanged)return;const{data:n}=this.props,i=n&&"points"in n&&"polygons"in n&&"lines"in n;this.setState({binary:i}),i?this._updateStateBinary({props:t,changeFlags:e}):this._updateStateJSON({props:t,changeFlags:e})}_updateStateBinary({props:t,changeFlags:e}){const n=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{points:i,lines:r,polygons:o}=t,s=function(t,e){const n={points:null,lines:null,polygons:null};for(const i in n){const r=t[i].globalFeatureIds.value;n[i]=new Uint8ClampedArray(3*r.length);const o=[];for(let t=0;t<r.length;t++)e(r[t],o),n[i][3*t+0]=o[0],n[i][3*t+1]=o[1],n[i][3*t+2]=o[2]}return n}(t,e);return n.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:s.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines.data={length:r.pathIndices.value.length-1,startIndices:r.pathIndices.value,attributes:{...r.attributes,getPath:r.positions,instancePickingColors:{size:3,value:s.lines}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:s.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}(t.data,this.encodePickingColor);this.setState({layerProps:n})}_updateStateJSON({props:t,changeFlags:e}){const n=function(t){if(Array.isArray(t))return t;switch($t.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return $t.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}(t.data),i=this.getSubLayerRow.bind(this);let r={};const o={};if(Array.isArray(e.dataChanged)){const t=this.state.features;for(const e in t)r[e]=t[e].slice(),o[e]=[];for(const s of e.dataChanged){const e=Q_(n,i,s);for(const n in t)o[n].push(fv({data:r[n],getIndex:t=>t.__source.index,dataRange:s,replace:e[n]}))}}else r=Q_(n,i);const s=function(t,e){const n={points:{},lines:{},polygons:{},polygonsOutline:{}},{pointFeatures:i,lineFeatures:r,polygonFeatures:o,polygonOutlineFeatures:s}=t;return n.points.data=i,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=eb,n.lines.data=r,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=eb,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=eb,n.polygonsOutline.data=s,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=eb,n}(r,o);this.setState({features:r,featuresDiff:o,layerProps:s})}getPickingInfo(t){const e=super.getPickingInfo(t),{index:n,sourceLayer:i}=e;return e.featureType=nb.find((t=>i.id.startsWith("".concat(this.id,"-").concat(t,"-")))),n>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(e.index=this.props.data.points.globalFeatureIds.value[n]),e}_updateAutoHighlight(t){const e="".concat(this.id,"-points-"),n="points"===t.featureType;for(const i of this.getSubLayers())i.id.startsWith(e)===n&&i.updateAutoHighlight(t)}_renderPolygonLayer(){const{extruded:t,wireframe:e}=this.props,{layerProps:n}=this.state,i="polygons-fill",r=this.shouldRenderSubLayer(i,n.polygons.data)&&this.getSubLayerClass(i,Z_.type);if(r){const o=$_(this,Z_.props),s=t&&e;return s||delete o.getLineColor,o.updateTriggers.lineColors=s,new r(o,this.getSubLayerProps({id:i,updateTriggers:o.updateTriggers}),n.polygons)}return null}_renderLineLayers(){const{extruded:t,stroked:e}=this.props,{layerProps:n}=this.state,i="polygons-stroke",r="linestrings",o=!t&&e&&this.shouldRenderSubLayer(i,n.polygonsOutline.data)&&this.getSubLayerClass(i,Y_.type),s=this.shouldRenderSubLayer(r,n.lines.data)&&this.getSubLayerClass(r,Y_.type);if(o||s){const t=$_(this,Y_.props);return[o&&new o(t,this.getSubLayerProps({id:i,updateTriggers:t.updateTriggers}),n.polygonsOutline),s&&new s(t,this.getSubLayerProps({id:r,updateTriggers:t.updateTriggers}),n.lines)]}return null}_renderPointLayers(){const{pointType:t}=this.props,{layerProps:e,binary:n}=this.state;let{highlightedObjectIndex:i}=this.props;!n&&Number.isFinite(i)&&(i=e.points.data.findIndex((t=>t.__source.index===i)));const r=new Set(t.split("+")),o=[];for(const t of r){const r="points-".concat(t),s=X_[t],a=s&&this.shouldRenderSubLayer(r,e.points.data)&&this.getSubLayerClass(r,s.type);if(a){const l=$_(this,s.props);let u=e.points;if("text"===t&&n){const{instancePickingColors:t,...e}=u.data.attributes;u={...u,data:{...u.data,attributes:e}}}o.push(new a(l,this.getSubLayerProps({id:r,updateTriggers:l.updateTriggers,highlightedObjectIndex:i}),u))}}return o}renderLayers(){const{extruded:t}=this.props,e=this._renderPolygonLayer();return[!t&&e,this._renderLineLayers(),this._renderPointLayers(),t&&e]}getSubLayerAccessor(t){const{binary:e}=this.state;return e&&"function"==typeof t?(e,n)=>{const{data:i,index:r}=n,o=function(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,i=t.featureIds.value[n];return-1!==n?function(t,e,n){const i={properties:{...t.properties[e]}};for(const e in t.numericProps)i.properties[e]=t.numericProps[e].value[n];return i}(t,i,n):null}(i,r);return t(o,n)}:super.getSubLayerAccessor(t)}}u(rb,"layerName","GeoJsonLayer"),u(rb,"defaultProps",ib);const ob={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class sb{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};u(this,"props",void 0),u(this,"stats",void 0),u(this,"activeRequestCount",0),u(this,"requestQueue",[]),u(this,"requestMap",new Map),u(this,"deferredUpdate",null),this.props={...ob,...t},this.stats=new se({id:this.props.id}),this.stats.get("Queued Requests"),this.stats.get("Active Requests"),this.stats.get("Cancelled Requests"),this.stats.get("Queued Requests Ever"),this.stats.get("Active Requests Ever")}scheduleRequest(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const n={handle:t,priority:0,getPriority:e},i=new Promise((t=>(n.resolve=t,n)));return this.requestQueue.push(n),this.requestMap.set(t,i),this._issueNewRequests(),i}_issueRequest(t){const{handle:e,resolve:n}=t;let i=!1;const r=()=>{i||(i=!0,this.requestMap.delete(e),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,n?n({done:r}):Promise.resolve({done:r})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout((()=>this._issueNewRequestsAsync()),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(0!==t){this._updateAllRequests();for(let e=0;e<t;++e){const t=this.requestQueue.shift();t&&this._issueRequest(t)}}}_updateAllRequests(){const t=this.requestQueue;for(let e=0;e<t.length;++e){const n=t[e];this._updateRequest(n)||(t.splice(e,1),this.requestMap.delete(n.handle),e--)}t.sort(((t,e)=>t.priority-e.priority))}_updateRequest(t){return t.priority=t.getPriority(t.handle),!(t.priority<0&&(t.resolve(null),1))}}class ab{constructor(t){u(this,"index",void 0),u(this,"isVisible",void 0),u(this,"isSelected",void 0),u(this,"parent",void 0),u(this,"children",void 0),u(this,"content",void 0),u(this,"state",void 0),u(this,"layers",void 0),u(this,"id",void 0),u(this,"bbox",void 0),u(this,"zoom",void 0),u(this,"userData",void 0),u(this,"_abortController",void 0),u(this,"_loader",void 0),u(this,"_loaderId",void 0),u(this,"_isLoaded",void 0),u(this,"_isCancelled",void 0),u(this,"_needsReload",void 0),this.index=t,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get data(){return this.isLoading&&this._loader?this._loader.then((()=>this.data)):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return Boolean(this._loader)&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const t=this.content?this.content.byteLength:0;return Number.isFinite(t)||console.error("byteLength not defined in tile data"),t}async _loadData({getData:t,requestScheduler:e,onLoad:n,onError:i}){const{index:r,id:o,bbox:s,userData:a,zoom:l}=this,u=this._loaderId;this._abortController=new AbortController;const{signal:c}=this._abortController,h=await e.scheduleRequest(this,(t=>t.isSelected?1:-1));if(!h)return void(this._isCancelled=!0);if(this._isCancelled)return void h.done();let f,d=null;try{d=await t({index:r,id:o,bbox:s,userData:a,zoom:l,signal:c})}catch(t){f=t||!0}finally{h.done()}u===this._loaderId&&(this._loader=void 0,this.content=d,!this._isCancelled||d?(this._isLoaded=!0,this._isCancelled=!1,f?i(f,this):n(this)):this._isLoaded=!1)}loadData(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var t;this.isLoaded||(this._isCancelled=!0,null===(t=this._abortController)||void 0===t||t.abort())}}const lb=Math.PI/180,ub=180/Math.PI,cb=6370972,hb=256;function fb(){const t=hb/cb,e=Math.PI/180*hb;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class db extends fi{constructor(t={}){const{latitude:e=0,longitude:n=0,zoom:i=0,nearZMultiplier:r=.1,farZMultiplier:o=2,resolution:s=10}=t;let{height:a,altitude:l=1.5}=t;a=a||1,l=Math.max(.75,l);const c=(new ti).lookAt({eye:[0,-l,0],up:[0,0,1]}),h=Math.pow(2,i);c.rotateX(e*lb),c.rotateZ(-n*lb),c.scale(h/a);const f=Math.atan(.5/l),d=2*hb*h/a;super({...t,height:a,viewMatrix:c,longitude:n,latitude:e,zoom:i,distanceScales:fb(),fovyRadians:2*f,focalDistance:l,near:r,far:Math.min(2,1/d+1)*l*o}),u(this,"longitude",void 0),u(this,"latitude",void 0),u(this,"resolution",void 0),this.latitude=e,this.longitude=n,this.resolution=s}get projectionMode(){return oi.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){const e={targetZ:t.z||0},n=this.unproject([0,this.height/2],e),i=this.unproject([this.width/2,0],e),r=this.unproject([this.width,this.height/2],e),o=this.unproject([this.width/2,this.height],e);return r[0]<this.longitude&&(r[0]+=360),n[0]>this.longitude&&(n[0]-=360),[Math.min(n[0],r[0],i[0],o[0]),Math.min(n[1],r[1],i[1],o[1]),Math.max(n[0],r[0],i[0],o[0]),Math.max(n[1],r[1],i[1],o[1])]}unproject(t,{topLeft:e=!0,targetZ:n}={}){const[i,r,o]=t,s=e?r:this.height-r,{pixelUnprojectionMatrix:a}=this;let l;if(Number.isFinite(o))l=pb(a,[i,s,o,1]);else{const t=pb(a,[i,s,-1,1]),e=pb(a,[i,s,1,1]),r=((n||0)/cb+1)*hb,o=W(G([],t,e)),u=W(t),c=W(e),h=(4*u*c-(o-u-c)**2)/16*4/o;l=function(t,e,n,i){var r=e[0],o=e[1],s=e[2];return t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t}([],t,e,(Math.sqrt(u-h)-Math.sqrt(Math.max(0,r*r-h)))/Math.sqrt(o))}const[u,c,h]=this.unprojectPosition(l);return Number.isFinite(o)?[u,c,h]:Number.isFinite(n)?[u,c,n]:[u,c]}projectPosition(t){const[e,n,i=0]=t,r=e*lb,o=n*lb,s=Math.cos(o),a=(i/cb+1)*hb;return[Math.sin(r)*s*a,-Math.cos(r)*s*a,Math.sin(o)*a]}unprojectPosition(t){const[e,n,i]=t,r=q(t),o=Math.asin(i/r);return[Math.atan2(e,-n)*ub,o*ub,(r/hb-1)*cb]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,e){const n=this.unproject(e);return{longitude:t[0]-n[0]+this.longitude,latitude:t[1]-n[1]+this.latitude}}}function pb(t,e){const n=w([],e,t);return x(n,n,1/n[3]),n}const gb=-1,mb=new Un,yb=new Un;class vb{constructor(t=[0,0,0],e=[0,0,0],n){u(this,"center",void 0),u(this,"halfDiagonal",void 0),u(this,"minimum",void 0),u(this,"maximum",void 0),n=n||mb.copy(t).add(e).scale(.5),this.center=new Un(n),this.halfDiagonal=new Un(e).subtract(this.center),this.minimum=new Un(t),this.maximum=new Un(e)}clone(){return new vb(this.minimum,this.maximum,this.center)}equals(t){return this===t||Boolean(t)&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}transform(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}intersectPlane(t){const{halfDiagonal:e}=this,n=yb.from(t.normal),i=e.x*Math.abs(n.x)+e.y*Math.abs(n.y)+e.z*Math.abs(n.z),r=this.center.dot(n)+t.distance;return r-i>0?1:r+i<0?gb:0}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=mb.from(t).subtract(this.center),{halfDiagonal:n}=this;let i,r=0;return i=Math.abs(e.x)-n.x,i>0&&(r+=i*i),i=Math.abs(e.y)-n.y,i>0&&(r+=i*i),i=Math.abs(e.z)-n.z,i>0&&(r+=i*i),r}}const _b=new Un,bb=new Un;class xb{constructor(t=[0,0,0],e=0){u(this,"center",void 0),u(this,"radius",void 0),this.radius=-0,this.center=new Un,this.fromCenterRadius(t,e)}fromCenterRadius(t,e){return this.center.from(t),this.radius=e,this}fromCornerPoints(t,e){return e=_b.from(e),this.center=(new Un).from(t).add(e).scale(.5),this.radius=this.center.distance(e),this}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new xb(this.center,this.radius)}union(t){const e=this.center,n=this.radius,i=t.center,r=t.radius,o=_b.copy(i).subtract(e),s=o.magnitude();if(n>=s+r)return this.clone();if(r>=s+n)return t.clone();const a=.5*(n+s+r);return bb.copy(o).scale((-n+a)/s).add(e),this.center.copy(bb),this.radius=a,this}expand(t){const e=_b.from(t).subtract(this.center).magnitude();return e>this.radius&&(this.radius=e),this}transform(t){this.center.transform(t);const e=function(t,e){var n=e[0],i=e[1],r=e[2],o=e[4],s=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.hypot(n,i,r),t[1]=Math.hypot(o,s,a),t[2]=Math.hypot(l,u,c),t}(_b,t);return this.radius=Math.max(e[0],Math.max(e[1],e[2]))*this.radius,this}distanceSquaredTo(t){const e=this.distanceTo(t);return e*e}distanceTo(t){const e=_b.from(t).subtract(this.center);return Math.max(0,e.len()-this.radius)}intersectPlane(t){const e=this.center,n=this.radius,i=t.normal.dot(e)+t.distance;return i<-n?gb:i<n?0:1}}function wb(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=n[0],d=n[1],p=n[2],g=n[3],m=n[4],y=n[5],v=n[6],_=n[7],b=n[8];return t[0]=f*i+d*s+p*u,t[1]=f*r+d*a+p*c,t[2]=f*o+d*l+p*h,t[3]=g*i+m*s+y*u,t[4]=g*r+m*a+y*c,t[5]=g*o+m*l+y*h,t[6]=v*i+_*s+b*u,t[7]=v*r+_*a+b*c,t[8]=v*o+_*l+b*h,t}function Eb(t,e,n){var i=n[0],r=n[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}var Sb;!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"}(Sb||(Sb={}));const Pb=Object.freeze([1,0,0,0,1,0,0,0,1]);class Cb extends Xn{static get IDENTITY(){return Tb||(Tb=new Cb,Object.freeze(Tb)),Tb}static get ZERO(){return Ib||(Ib=new Cb([0,0,0,0,0,0,0,0,0]),Object.freeze(Ib)),Ib}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Sb}constructor(t,...e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):e.length>0?this.copy([t,...e]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(Pb)}fromObject(t){return this.check()}fromQuaternion(t){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n+n,a=i+i,l=r+r,u=n*s,c=i*s,h=i*a,f=r*s,d=r*a,p=r*l,g=o*s,m=o*a,y=o*l;t[0]=1-h-p,t[3]=c-y,t[6]=f+m,t[1]=c+y,t[4]=1-u-p,t[7]=d-g,t[2]=f-m,t[5]=d+g,t[8]=1-u-h}(this,t),this.check()}set(t,e,n,i,r,o,s,a,l){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this[4]=r,this[5]=o,this[6]=s,this[7]=a,this[8]=l,this.check()}setRowMajor(t,e,n,i,r,o,s,a,l){return this[0]=t,this[1]=i,this[2]=s,this[3]=e,this[4]=r,this[5]=a,this[6]=n,this[7]=o,this[8]=l,this.check()}determinant(){return e=(t=this)[0],n=t[1],i=t[2],r=t[3],o=t[4],s=t[5],a=t[6],l=t[7],e*((u=t[8])*o-s*l)+n*(-u*r+s*a)+i*(l*r-o*a);var t,e,n,i,r,o,s,a,l,u}transpose(){return function(t,e){if(t===e){var n=e[1],i=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=i,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(this,this),this.check()}invert(){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*s-a*u,f=-c*o+a*l,d=u*o-s*l,p=n*h+i*f+r*d;p&&(p=1/p,t[0]=h*p,t[1]=(-c*i+r*u)*p,t[2]=(a*i-r*s)*p,t[3]=f*p,t[4]=(c*n-r*l)*p,t[5]=(-a*n+r*o)*p,t[6]=d*p,t[7]=(-u*n+i*l)*p,t[8]=(s*n-i*o)*p)}(this,this),this.check()}multiplyLeft(t){return wb(this,t,this),this.check()}multiplyRight(t){return wb(this,this,t),this.check()}rotate(t){return function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=Math.sin(n),d=Math.cos(n);t[0]=d*i+f*s,t[1]=d*r+f*a,t[2]=d*o+f*l,t[3]=d*s-f*i,t[4]=d*a-f*r,t[5]=d*l-f*o,t[6]=u,t[7]=c,t[8]=h}(this,this,t),this.check()}scale(t){return Array.isArray(t)?Eb(this,this,t):Eb(this,this,[t,t]),this.check()}translate(t){return function(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],f=n[0],d=n[1];t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=l,t[6]=f*i+d*s+u,t[7]=f*r+d*a+c,t[8]=f*o+d*l+h}(this,this,t),this.check()}transform(t,e){let n;switch(t.length){case 2:n=function(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[3]*r+n[6],t[1]=n[1]*i+n[4]*r+n[7],t}(e||[-0,-0],t,this);break;case 3:n=U(e||[-0,-0,-0],t,this);break;case 4:n=zn(e||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Rn(n,t.length),n}transformVector(t,e){return this.transform(t,e)}transformVector2(t,e){return this.transform(t,e)}transformVector3(t,e){return this.transform(t,e)}}let Ib,Tb,Mb;class Lb extends Dn{static get ZERO(){return Mb||(Mb=new Lb(0,0,0,0),Object.freeze(Mb)),Mb}constructor(t=0,e=0,n=0,i=0){super(-0,-0,-0,-0),f(t)&&1===arguments.length?this.copy(t):(c.debug&&(Nn(t),Nn(e),Nn(n),Nn(i)),this[0]=t,this[1]=e,this[2]=n,this[3]=i)}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return c.debug&&(Nn(t.x),Nn(t.y),Nn(t.z),Nn(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=Nn(t)}get w(){return this[3]}set w(t){this[3]=Nn(t)}transform(t){return j(this,this,t),this.check()}transformByMatrix3(t){return zn(this,this,t),this.check()}transformByMatrix2(t){return function(t,e,n){const i=e[0],r=e[1];t[0]=n[0]*i+n[2]*r,t[1]=n[1]*i+n[3]*r,t[2]=e[2],t[3]=e[3]}(this,this,t),this.check()}transformByQuaternion(t){return V(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}function Ab(){var t=new b(4);return b!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ob(t,e,n){n*=.5;var i=Math.sin(n);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(n),t}function Nb(t,e,n){var i=e[0],r=e[1],o=e[2],s=e[3],a=n[0],l=n[1],u=n[2],c=n[3];return t[0]=i*c+s*a+r*u-o*l,t[1]=r*c+s*l+o*a-i*u,t[2]=o*c+s*u+i*l-r*a,t[3]=s*c-i*a-r*l-o*u,t}var Rb,kb,Db,Fb=x,zb=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return Math.hypot(e,n,i,r)},Bb=function(t){var e=t[0],n=t[1],i=t[2],r=t[3];return e*e+n*n+i*i+r*r},jb=(Rb=D(),kb=F(1,0,0),Db=F(0,1,0),function(t,e,n){var i=z(e,n);return i<-.999999?(B(Rb,kb,e),q(Rb)<1e-6&&B(Rb,Db,e),function(t,e){var n=e[0],i=e[1],r=e[2],o=n*n+i*i+r*r;o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o}(Rb,Rb),Ob(t,Rb,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(B(Rb,e,n),t[0]=Rb[0],t[1]=Rb[1],t[2]=Rb[2],t[3]=1+i,function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=i*s,t[2]=r*s,t[3]=o*s,t}(t,t))});Ab(),Ab(),function(){var t=new b(9);b!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1}();const Ub=[0,0,0,1];class Vb extends On{constructor(t=0,e=0,n=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,e,n,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,e,n,i){return this[0]=t,this[1]=e,this[2]=n,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return function(t,e){var n,i=e[0]+e[4]+e[8];if(i>0)n=Math.sqrt(i+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var o=(r+1)%3,s=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*o+o]-e[3*s+s]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*o+s]-e[3*s+o])*n,t[o]=(e[3*o+r]+e[3*r+o])*n,t[s]=(e[3*s+r]+e[3*r+s])*n}}(this,t),this.check()}fromAxisRotation(t,e){return Ob(this,t,e),this.check()}identity(){return function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}setAxisAngle(t,e){return this.fromAxisRotation(t,e)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=Nn(t)}get y(){return this[1]}set y(t){this[1]=Nn(t)}get z(){return this[2]}set z(t){this[2]=Nn(t)}get w(){return this[3]}set w(t){this[3]=Nn(t)}len(){return zb(this)}lengthSquared(){return Bb(this)}dot(t){return function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}(this,t)}rotationTo(t,e){return jb(this,t,e),this.check()}add(t){return function(t,e,n){t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3]}(this,this,t),this.check()}calculateW(){return function(t,e){var n=e[0],i=e[1],r=e[2];t[0]=n,t[1]=i,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r))}(this,this),this.check()}conjugate(){return function(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}invert(){return function(t,e){var n=e[0],i=e[1],r=e[2],o=e[3],s=n*n+i*i+r*r+o*o,a=s?1/s:0;t[0]=-n*a,t[1]=-i*a,t[2]=-r*a,t[3]=o*a}(this,this),this.check()}lerp(t,e,n){return void 0===n?this.lerp(this,t,e):(function(t,e,n,i){var r=e[0],o=e[1],s=e[2],a=e[3];t[0]=r+i*(n[0]-r),t[1]=o+i*(n[1]-o),t[2]=s+i*(n[2]-s),t[3]=a+i*(n[3]-a)}(this,t,e,n),this.check())}multiplyRight(t){return Nb(this,this,t),this.check()}multiplyLeft(t){return Nb(this,t,this),this.check()}normalize(){const t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}rotateX(t){return function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l+s*a,t[1]=r*l+o*a,t[2]=o*l-r*a,t[3]=s*l-i*a}(this,this,t),this.check()}rotateY(t){return function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l-o*a,t[1]=r*l+s*a,t[2]=o*l+i*a,t[3]=s*l-r*a}(this,this,t),this.check()}rotateZ(t){return function(t,e,n){n*=.5;var i=e[0],r=e[1],o=e[2],s=e[3],a=Math.sin(n),l=Math.cos(n);t[0]=i*l+r*a,t[1]=r*l-i*a,t[2]=o*l+s*a,t[3]=s*l-o*a}(this,this,t),this.check()}scale(t){return Fb(this,this,t),this.check()}slerp(t,e,n){let i,r,o;switch(arguments.length){case 1:({start:i=Ub,target:r,ratio:o}=t);break;case 2:i=this,r=t,o=e;break;default:i=t,r=e,o=n}return function(t,e,n,i){var r,o,s,a,l,u=e[0],c=e[1],h=e[2],f=e[3],d=n[0],p=n[1],g=n[2],m=n[3];(o=u*d+c*p+h*g+f*m)<0&&(o=-o,d=-d,p=-p,g=-g,m=-m),1-o>_?(r=Math.acos(o),s=Math.sin(r),a=Math.sin((1-i)*r)/s,l=Math.sin(i*r)/s):(a=1-i,l=i),t[0]=a*u+l*d,t[1]=a*c+l*p,t[2]=a*h+l*g,t[3]=a*f+l*m}(this,i,r,o),this.check()}transformVector4(t,e=new Lb){return function(t,e,n){var i=e[0],r=e[1],o=e[2],s=n[0],a=n[1],l=n[2],u=n[3],c=u*i+a*o-l*r,h=u*r+l*i-s*o,f=u*o+s*r-a*i,d=-s*i-a*r-l*o;t[0]=c*u+d*-s+h*-l-f*-a,t[1]=h*u+d*-a+f*-s-c*-l,t[2]=f*u+d*-l+c*-a-h*-s,t[3]=e[3]}(e,t,this),Rn(e,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,e){return this.setAxisAngle(t,e)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}const Gb=new Un,qb=new Un,Wb=new Un,Hb=new Un,Xb=new Un,Yb=new Un,Zb=new Un;class Kb{constructor(t=[0,0,0],e=[0,0,0,0,0,0,0,0,0]){u(this,"center",void 0),u(this,"halfAxes",void 0),this.center=(new Un).from(t),this.halfAxes=new Cb(e)}get halfSize(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2);return[new Un(t).len(),new Un(e).len(),new Un(n).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),e=this.halfAxes.getColumn(1),n=this.halfAxes.getColumn(2),i=new Un(t).normalize(),r=new Un(e).normalize(),o=new Un(n).normalize();return(new Vb).fromMatrix3(new Cb([...i,...r,...o]))}fromCenterHalfSizeQuaternion(t,e,n){const i=new Vb(n),r=(new Cb).fromQuaternion(i);return r[0]=r[0]*e[0],r[1]=r[1]*e[0],r[2]=r[2]*e[0],r[3]=r[3]*e[1],r[4]=r[4]*e[1],r[5]=r[5]*e[1],r[6]=r[6]*e[2],r[7]=r[7]*e[2],r[8]=r[8]*e[2],this.center=(new Un).from(t),this.halfAxes=r,this}clone(){return new Kb(this.center,this.halfAxes)}equals(t){return this===t||Boolean(t)&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new xb){const e=this.halfAxes,n=e.getColumn(0,Wb),i=e.getColumn(1,Hb),r=e.getColumn(2,Xb),o=Gb.copy(n).add(i).add(r);return t.center.copy(this.center),t.radius=o.magnitude(),t}intersectPlane(t){const e=this.center,n=t.normal,i=this.halfAxes,r=n.x,o=n.y,s=n.z,a=Math.abs(r*i[0]+o*i[1]+s*i[2])+Math.abs(r*i[3]+o*i[4]+s*i[5])+Math.abs(r*i[6]+o*i[7]+s*i[8]),l=n.dot(e)+t.distance;return l<=-a?gb:l>=a?1:0}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const e=qb.from(t).subtract(this.center),n=this.halfAxes,i=n.getColumn(0,Wb),r=n.getColumn(1,Hb),o=n.getColumn(2,Xb),s=i.magnitude(),a=r.magnitude(),l=o.magnitude();i.normalize(),r.normalize(),o.normalize();let u,c=0;return u=Math.abs(e.dot(i))-s,u>0&&(c+=u*u),u=Math.abs(e.dot(r))-a,u>0&&(c+=u*u),u=Math.abs(e.dot(o))-l,u>0&&(c+=u*u),c}computePlaneDistances(t,e,n=[-0,-0]){let i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;const o=this.center,s=this.halfAxes,a=s.getColumn(0,Wb),l=s.getColumn(1,Hb),u=s.getColumn(2,Xb),c=Yb.copy(a).add(l).add(u).add(o),h=Zb.copy(c).subtract(t);let f=e.dot(h);return i=Math.min(f,i),r=Math.max(f,r),c.copy(o).add(a).add(l).subtract(u),h.copy(c).subtract(t),f=e.dot(h),i=Math.min(f,i),r=Math.max(f,r),c.copy(o).add(a).subtract(l).add(u),h.copy(c).subtract(t),f=e.dot(h),i=Math.min(f,i),r=Math.max(f,r),c.copy(o).add(a).subtract(l).subtract(u),h.copy(c).subtract(t),f=e.dot(h),i=Math.min(f,i),r=Math.max(f,r),o.copy(c).subtract(a).add(l).add(u),h.copy(c).subtract(t),f=e.dot(h),i=Math.min(f,i),r=Math.max(f,r),o.copy(c).subtract(a).add(l).subtract(u),h.copy(c).subtract(t),f=e.dot(h),i=Math.min(f,i),r=Math.max(f,r),o.copy(c).subtract(a).subtract(l).add(u),h.copy(c).subtract(t),f=e.dot(h),i=Math.min(f,i),r=Math.max(f,r),o.copy(c).subtract(a).subtract(l).subtract(u),h.copy(c).subtract(t),f=e.dot(h),i=Math.min(f,i),r=Math.max(f,r),n[0]=i,n[1]=r,n}transform(t){this.center.transformAsPoint(t);const e=this.halfAxes.getColumn(0,Wb);e.transformAsPoint(t);const n=this.halfAxes.getColumn(1,Hb);n.transformAsPoint(t);const i=this.halfAxes.getColumn(2,Xb);return i.transformAsPoint(t),this.halfAxes=new Cb([...e,...n,...i]),this}getTransform(){throw new Error("not implemented")}}const $b=new Un,Qb=new Un;class Jb{constructor(t=[0,0,1],e=0){u(this,"normal",void 0),u(this,"distance",void 0),this.normal=new Un,this.distance=-0,this.fromNormalDistance(t,e)}fromNormalDistance(t,e){return kn(Number.isFinite(e)),this.normal.from(t).normalize(),this.distance=e,this}fromPointNormal(t,e){t=$b.from(t),this.normal.from(e).normalize();const n=-this.normal.dot(t);return this.distance=n,this}fromCoefficients(t,e,n,i){return this.normal.set(t,e,n),kn(g(this.normal.len(),1)),this.distance=i,this}clone(){return new Jb(this.normal,this.distance)}equals(t){return g(this.distance,t.distance)&&g(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const e=Qb.copy(this.normal).transformAsVector(t).normalize(),n=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(n,e)}projectPointOntoPlane(t,e=[0,0,0]){t=$b.from(t);const n=this.getPointDistance(t),i=Qb.copy(this.normal).scale(n);return t.subtract(i).to(e)}}const tx=[new Un([1,0,0]),new Un([0,1,0]),new Un([0,0,1])],ex=new Un,nx=new Un;new Jb(new Un(1,0,0),0);class ix{constructor(t=[]){u(this,"planes",void 0),this.planes=t}fromBoundingSphere(t){this.planes.length=2*tx.length;const e=t.center,n=t.radius;let i=0;for(const t of tx){let r=this.planes[i],o=this.planes[i+1];r||(r=this.planes[i]=new Jb),o||(o=this.planes[i+1]=new Jb);const s=ex.copy(t).scale(-n).add(e);t.dot(s),r.fromPointNormal(s,t);const a=ex.copy(t).scale(n).add(e),l=nx.copy(t).negate();l.dot(a),o.fromPointNormal(a,l),i+=2}return this}computeVisibility(t){let e=1;for(const n of this.planes)switch(t.intersectPlane(n)){case gb:return gb;case 0:e=0}return e}computeVisibilityWithPlaneMask(t,e){if(kn(Number.isFinite(e),"parentPlaneMask is required."),e===ix.MASK_OUTSIDE||e===ix.MASK_INSIDE)return e;let n=ix.MASK_INSIDE;const i=this.planes;for(let r=0;r<this.planes.length;++r){const o=r<31?1<<r:0;if(r<31&&0==(e&o))continue;const s=i[r],a=t.intersectPlane(s);if(a===gb)return ix.MASK_OUTSIDE;0===a&&(n|=o)}return n}}u(ix,"MASK_OUTSIDE",4294967295),u(ix,"MASK_INSIDE",0),u(ix,"MASK_INDETERMINATE",2147483647),new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,new Un,Math.PI;const rx={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI},ox=new Cb,sx=new Cb,ax=new Cb,lx=new Cb,ux=new Cb;const cx=[1,0,0],hx=[2,2,1];function fx(t){let e=0;for(let n=0;n<3;++n){const i=t[ox.getElementIndex(hx[n],cx[n])];e+=2*i*i}return Math.sqrt(e)}function dx(t,e){const n=rx.EPSILON15;let i=0,r=1;for(let e=0;e<3;++e){const n=Math.abs(t[ox.getElementIndex(hx[e],cx[e])]);n>i&&(r=e,i=n)}const o=cx[r],s=hx[r];let a=1,l=0;if(Math.abs(t[ox.getElementIndex(s,o)])>n){const e=(t[ox.getElementIndex(s,s)]-t[ox.getElementIndex(o,o)])/2/t[ox.getElementIndex(s,o)];let n;n=e<0?-1/(-e+Math.sqrt(1+e*e)):1/(e+Math.sqrt(1+e*e)),a=1/Math.sqrt(1+n*n),l=n*a}return Cb.IDENTITY.to(e),e[ox.getElementIndex(o,o)]=e[ox.getElementIndex(s,s)]=a,e[ox.getElementIndex(s,o)]=l,e[ox.getElementIndex(o,s)]=-l,e}const px=new Un,gx=new Un,mx=new Un,yx=new Un,vx=new Un,_x=new Cb,bx={diagonal:new Cb,unitary:new Cb},xx=512,wx=3,Ex=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Sx=Ex.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),Px=Sx.concat([[.25,.5],[.75,.5]]);class Cx{constructor(t,e,n){u(this,"x",void 0),u(this,"y",void 0),u(this,"z",void 0),u(this,"childVisible",void 0),u(this,"selected",void 0),u(this,"_children",void 0),this.x=t,this.y=e,this.z=n}get children(){if(!this._children){const t=2*this.x,e=2*this.y,n=this.z+1;this._children=[new Cx(t,e,n),new Cx(t,e+1,n),new Cx(t+1,e,n),new Cx(t+1,e+1,n)]}return this._children}update(t){const{viewport:e,cullingVolume:n,elevationBounds:i,minZ:r,maxZ:o,bounds:s,offset:a,project:l}=t,u=this.getBoundingVolume(i,a,l);if(s&&!this.insideBounds(s))return!1;if(n.computeVisibility(u)<0)return!1;if(!this.childVisible){let{z:t}=this;if(t<o&&t>=r){const n=u.distanceTo(e.cameraPosition)*e.scale/e.height;t+=Math.floor(Math.log2(n))}if(t>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const e of this.children)e.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(const e of this._children)e.getSelected(t);return t}insideBounds([t,e,n,i]){const r=Math.pow(2,this.z),o=xx/r;return this.x*o<n&&this.y*o<i&&(this.x+1)*o>t&&(this.y+1)*o>e}getBoundingVolume(t,e,n){if(n){const e=this.z<1?Px:this.z<2?Sx:Ex,i=[];for(const r of e){const e=Rx(this.x+r[0],this.y+r[1],this.z);e[2]=t[0],i.push(n(e)),t[0]!==t[1]&&(e[2]=t[1],i.push(n(e)))}return function(t,e=new Kb){if(!t||0===t.length)return e.halfAxes=new Cb([0,0,0,0,0,0,0,0,0]),e.center=new Un,e;const n=t.length,i=new Un(0,0,0);for(const e of t)i.add(e);const r=1/n;i.multiplyByScalar(r);let o=0,s=0,a=0,l=0,u=0,c=0;for(const e of t){const t=px.copy(e).subtract(i);o+=t.x*t.x,s+=t.x*t.y,a+=t.x*t.z,l+=t.y*t.y,u+=t.y*t.z,c+=t.z*t.z}o*=r,s*=r,a*=r,l*=r,u*=r,c*=r;const h=_x;h[0]=o,h[1]=s,h[2]=a,h[3]=s,h[4]=l,h[5]=u,h[6]=a,h[7]=u,h[8]=c;const{unitary:f}=function(t,e={}){const n=rx.EPSILON20;let i=0,r=0;const o=sx,s=ax;o.identity(),s.copy(t);const a=n*function(t){let e=0;for(let n=0;n<9;++n){const i=t[n];e+=i*i}return Math.sqrt(e)}(s);for(;r<10&&fx(s)>a;)dx(s,lx),ux.copy(lx).transpose(),s.multiplyRight(lx),s.multiplyLeft(ux),o.multiplyRight(lx),++i>2&&(++r,i=0);return e.unitary=o.toTarget(e.unitary),e.diagonal=s.toTarget(e.diagonal),e}(h,bx),d=e.halfAxes.copy(f);let p=d.getColumn(0,mx),g=d.getColumn(1,yx),m=d.getColumn(2,vx),y=-Number.MAX_VALUE,v=-Number.MAX_VALUE,_=-Number.MAX_VALUE,b=Number.MAX_VALUE,x=Number.MAX_VALUE,w=Number.MAX_VALUE;for(const e of t)px.copy(e),y=Math.max(px.dot(p),y),v=Math.max(px.dot(g),v),_=Math.max(px.dot(m),_),b=Math.min(px.dot(p),b),x=Math.min(px.dot(g),x),w=Math.min(px.dot(m),w);p=p.multiplyByScalar(.5*(b+y)),g=g.multiplyByScalar(.5*(x+v)),m=m.multiplyByScalar(.5*(w+_)),e.center.copy(p).add(g).add(m);const E=gx.set(y-b,v-x,_-w).multiplyByScalar(.5),S=new Cb([E[0],0,0,0,E[1],0,0,0,E[2]]);return e.halfAxes.multiplyRight(S),e}(i)}const i=Math.pow(2,this.z),r=xx/i,o=this.x*r+e*xx,s=xx-(this.y+1)*r;return new vb([o,s,t[0]],[o+r,s+r,t[1]])}}const Ix=512,Tx=[-1/0,-1/0,1/0,1/0],Mx={type:"object",value:null,validate:(t,e)=>e.optional&&null===t||"string"==typeof t||Array.isArray(t)&&t.every((t=>"string"==typeof t)),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}};function Lx(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map((t=>t[0]))),Math.min(...n.map((t=>t[1]))),Math.max(...n.map((t=>t[0]))),Math.max(...n.map((t=>t[1])))]}function Ax({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map((t=>Ox(t,e,n)))}function Ox(t,e,n){if(!Array.isArray(e)){const i=n.x-t.x,r=n.y-t.y,{width:o,height:s}=n,a={targetZ:e},l=t.unproject([i,r],a),u=t.unproject([i+o,r],a),c=t.unproject([i,r+s],a),h=t.unproject([i+o,r+s],a);return[Math.min(l[0],u[0],c[0],h[0]),Math.min(l[1],u[1],c[1],h[1]),Math.max(l[0],u[0],c[0],h[0]),Math.max(l[1],u[1],c[1],h[1])]}const i=Ox(t,e[0],n),r=Ox(t,e[1],n);return[Math.min(i[0],r[0]),Math.min(i[1],r[1]),Math.max(i[2],r[2]),Math.max(i[3],r[3])]}function Nx(t,e){return Math.pow(2,t)*Ix/e}function Rx(t,e,n){const i=Nx(n,Ix),r=t/i*360-180,o=Math.PI-2*Math.PI*e/i;return[r,180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)))]}function kx(t,e,n,i){const r=Nx(n,i);return[t/r*Ix,e/r*Ix]}function Dx(t,e,n,i,r=Ix){if(t.isGeospatial){const[t,r]=Rx(e,n,i),[o,s]=Rx(e+1,n+1,i);return{west:t,north:r,east:o,south:s}}const[o,s]=kx(e,n,i,r),[a,l]=kx(e+1,n+1,i,r);return{left:o,top:s,right:a,bottom:l}}function Fx({viewport:t,maxZoom:e,minZoom:n,zRange:i,extent:r,tileSize:o=Ix,modelMatrix:s,modelMatrixInverse:a,zoomOffset:l=0}){let u=t.isGeospatial?Math.round(t.zoom+Math.log2(Ix/o))+l:Math.ceil(t.zoom)+l;if("number"==typeof n&&Number.isFinite(n)&&u<n){if(!r)return[];u=n}"number"==typeof e&&Number.isFinite(e)&&u>e&&(u=e);let c=r;return s&&a&&r&&!t.isGeospatial&&(c=Lx(r,s)),t.isGeospatial?function(t,e,n,i){const r=t instanceof db&&t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map((({normal:t,distance:e})=>new Jb(t.clone().negate(),e))),s=new ix(o),a=t.distanceScales.unitsPerMeter[2],l=n&&n[0]*a||0,u=n&&n[1]*a||0,c=t instanceof xa&&t.pitch<=60?e:0;if(i){const[t,e,n,r]=i,o=it([t,r]),s=it([n,e]);i=[o[0],xx-o[1],s[0],xx-s[1]]}const h=new Cx(0,0,0),f={viewport:t,project:r,cullingVolume:s,elevationBounds:[l,u],minZ:c,maxZ:e,bounds:i,offset:0};if(h.update(f),t instanceof xa&&t.subViewports&&t.subViewports.length>1){for(f.offset=-1;h.update(f)&&!(--f.offset<-wx););for(f.offset=1;h.update(f)&&!(++f.offset>wx););}return h.getSelected()}(t,u,i,r):function(t,e,n,i,r){const o=function(t,e,n){let i;return i=t.getBounds(),t.isGeospatial?[Math.max(i[0],n[0]),Math.max(i[1],n[1]),Math.min(i[2],n[2]),Math.min(i[3],n[3])]:[Math.max(Math.min(i[0],n[2]),n[0]),Math.max(Math.min(i[1],n[3]),n[1]),Math.min(Math.max(i[2],n[0]),n[2]),Math.min(Math.max(i[3],n[1]),n[3])]}(t,0,i),s=Nx(e,n),[a,l,u,c]=function(t,e,n){return n?Lx(t,n).map((t=>t*e/Ix)):t.map((t=>t*e/Ix))}(o,s,r),h=[];for(let t=Math.floor(a);t<u;t++)for(let n=Math.floor(l);n<c;n++)h.push({x:t,y:n,z:e});return h}(t,u,o,c||Tx,a)}function zx(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0}return!1}const Bx=2,jx="best-available",Ux={[jx]:function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!Gx(e)&&qx(e);for(const e of t)e.isVisible=Boolean(e.state&Bx)},"no-overlap":function(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&Gx(e);const e=Array.from(t).sort(((t,e)=>t.zoom-e.zoom));for(const t of e)if(t.isVisible=Boolean(t.state&Bx),t.children&&(t.isVisible||1&t.state))for(const e of t.children)e.state=1;else t.isSelected&&qx(t)},never:()=>{}},Vx={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};function Gx(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=Bx,!0;e=e.parent}return!1}function qx(t){for(const e of t.children)e.isLoaded||e.content?e.state|=Bx:qx(e)}const Wx={TilesetClass:class{constructor(t){u(this,"opts",void 0),u(this,"_requestScheduler",void 0),u(this,"_cache",void 0),u(this,"_dirty",void 0),u(this,"_tiles",void 0),u(this,"_cacheByteSize",void 0),u(this,"_viewport",void 0),u(this,"_zRange",void 0),u(this,"_selectedTiles",void 0),u(this,"_frameNumber",void 0),u(this,"_modelMatrix",void 0),u(this,"_modelMatrixInverse",void 0),u(this,"_maxZoom",void 0),u(this,"_minZoom",void 0),u(this,"onTileLoad",void 0),u(this,"_getCullBounds",function(t){let e,n={};return i=>{for(const r in i)if(!zx(i[r],n[r])){e=t(i),n=i;break}return e}}(Ax)),this.opts={...Vx,...t},this.onTileLoad=t=>{var e,n;null===(e=(n=this.opts).onTileLoad)||void 0===e||e.call(n,t),this.opts.maxCacheByteSize&&(this._cacheByteSize+=t.byteLength,this._resizeCache())},this._requestScheduler=new sb({maxRequests:t.maxRequests,throttleRequests:Boolean(t.maxRequests&&t.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new ti,this._modelMatrixInverse=new ti,this.setOptions(t)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return null!==this._selectedTiles&&this._selectedTiles.every((t=>t.isLoaded))}get needsReload(){return null!==this._selectedTiles&&this._selectedTiles.some((t=>t.needsReload))}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(const t of this._cache.values())t.isLoading&&t.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const t of this._cache.keys()){const e=this._cache.get(t);this._selectedTiles&&this._selectedTiles.includes(e)?e.setNeedsReload():this._cache.delete(t)}}update(t,{zRange:e,modelMatrix:n}={}){const i=new ti(n),r=!i.equals(this._modelMatrix);if(this._viewport&&t.equals(this._viewport)&&g(this._zRange,e)&&!r)this.needsReload&&(this._selectedTiles=this._selectedTiles.map((t=>this._getTile(t.index,!0))));else{r&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=t,this._zRange=e;const n=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:e,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=n.map((t=>this._getTile(t,!0))),this._dirty&&this._rebuildTree()}const o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(t,e){if(!t.isVisible)return!1;if(e&&this._viewport){const n=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:e}),{bbox:i}=t;for(const[t,e,r,o]of n){let n;if("west"in i)n=i.west<r&&i.east>t&&i.south<o&&i.north>e;else{const s=Math.min(i.top,i.bottom),a=Math.max(i.top,i.bottom);n=i.left<r&&i.right>t&&s<o&&a>e}if(n)return!0}return!1}return!0}getTileIndices({viewport:t,maxZoom:e,minZoom:n,zRange:i,modelMatrix:r,modelMatrixInverse:o}){const{tileSize:s,extent:a,zoomOffset:l}=this.opts;return Fx({viewport:t,maxZoom:e,minZoom:n,zRange:i,tileSize:s,extent:a,modelMatrix:r,modelMatrixInverse:o,zoomOffset:l})}getTileId(t){return"".concat(t.x,"-").concat(t.y,"-").concat(t.z)}getTileZoom(t){return t.z}getTileMetadata(t){const{tileSize:e}=this.opts;return{bbox:Dx(this._viewport,t.x,t.y,t.z,e)}}getParentIndex(t){return{x:Math.floor(t.x/2),y:Math.floor(t.y/2),z:t.z-1}}updateTileStates(){const t=this.opts.refinementStrategy||jx,e=new Array(this._cache.size);let n=0;for(const t of this._cache.values())e[n++]=t.isVisible,t.isSelected=!1,t.isVisible=!1;for(const t of this._selectedTiles)t.isSelected=!0,t.isVisible=!0;("function"==typeof t?t:Ux[t])(Array.from(this._cache.values())),n=0;for(const t of this._cache.values())if(e[n++]!==t.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:t=0}=this.opts,e=[];let n=0;for(const t of this._cache.values())t.isLoading&&(n++,t.isSelected||t.isVisible||e.push(t));for(;t>0&&n>t&&e.length>0;)e.shift().abort(),n--}_rebuildTree(){const{_cache:t}=this;for(const e of t.values())e.parent=null,e.children&&(e.children.length=0);for(const e of t.values()){const t=this._getNearestAncestor(e);e.parent=t,null!=t&&t.children&&t.children.push(e)}}_resizeCache(){const{_cache:t,opts:e}=this,n=e.maxCacheSize||(e.maxCacheByteSize?1/0:5*this.selectedTiles.length),i=e.maxCacheByteSize||1/0;if(t.size>n||this._cacheByteSize>i){for(const[s,a]of t){var r,o;if(a.isVisible||a.isSelected||(this._cacheByteSize-=e.maxCacheByteSize?a.byteLength:0,t.delete(s),null===(r=(o=this.opts).onTileUnload)||void 0===r||r.call(o,a)),t.size<=n&&this._cacheByteSize<=i)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort(((t,e)=>t.zoom-e.zoom)),this._dirty=!1)}_getTile(t,e){const n=this.getTileId(t);let i=this._cache.get(n),r=!1;return!i&&e?(i=new ab(t),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:n,zoom:this.getTileZoom(i.index)}),r=!0,this._cache.set(n,i),this._dirty=!0):i&&i.needsReload&&(r=!0),i&&r&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(t){const{_minZoom:e=0}=this;let n=t.index;for(;this.getTileZoom(n)>e;){n=this.getParentIndex(n);const t=this._getTile(n);if(t)return t}return null}},data:{type:"data",value:[]},dataComparator:Mx.equal,renderSubLayers:{type:"function",value:t=>new rb(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:jx,zRange:null,maxRequests:6,zoomOffset:0};class Hx extends hv{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var t,e;null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e||e.finalize()}get isLoaded(){var t,e;return null===(t=this.state)||void 0===t||null===(e=t.tileset)||void 0===e?void 0:e.selectedTiles.every((t=>t.isLoaded&&t.layers&&t.layers.every((t=>t.isLoaded))))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({changeFlags:t}){let{tileset:e}=this.state;const n=t.propsOrDataChanged||t.updateTriggersChanged,i=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);e?n&&(e.setOptions(this._getTilesetOptions()),i?e.reloadAll():this.state.tileset.tiles.forEach((t=>{t.layers=null}))):(e=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:e})),this._updateTileset()}_getTilesetOptions(){const{tileSize:t,maxCacheSize:e,maxCacheByteSize:n,refinementStrategy:i,extent:r,maxZoom:o,minZoom:s,maxRequests:a,zoomOffset:l}=this.props;return{maxCacheSize:e,maxCacheByteSize:n,maxZoom:o,minZoom:s,tileSize:t,refinementStrategy:i,extent:r,maxRequests:a,zoomOffset:l,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:t}=this.state,{zRange:e,modelMatrix:n}=this.props,i=t.update(this.context.viewport,{zRange:e,modelMatrix:n}),{isLoaded:r}=t,o=this.state.isLoaded!==r,s=this.state.frameNumber!==i;r&&(o||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:i}),this.state.isLoaded=r}_onViewportLoad(){const{tileset:t}=this.state,{onViewportLoad:e}=this.props;e&&e(t.selectedTiles)}_onTileLoad(t){this.props.onTileLoad(t),t.layers=null,this.setNeedsUpdate()}_onTileError(t,e){this.props.onTileError(t),e.layers=null,this.setNeedsUpdate()}_onTileUnload(t){this.props.onTileUnload(t)}getTileData(t){const{data:e,getTileData:n,fetch:i}=this.props,{signal:r}=t;return t.url="string"==typeof e||Array.isArray(e)?function(t,e){if(!t||!t.length)return null;const{index:n,id:i}=e;var r;Array.isArray(t)&&(t=t[(r=i,Math.abs(r.split("").reduce(((t,e)=>(t<<5)-t+e.charCodeAt(0)|0),0))%t.length)]);let o=t;for(const t of Object.keys(n)){const e=new RegExp("{".concat(t,"}"),"g");o=o.replace(e,String(n[t]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(o=o.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),o}(e,t):null,n?n(t):i&&t.url?i(t.url,{propName:"data",layer:this,signal:r}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getSubLayerPropsByTile(t){return null}getPickingInfo({info:t,sourceLayer:e}){const n=e.props.tile;return t.picked&&(t.tile=n),t.sourceTile=n,t}_updateAutoHighlight(t){const e=t.sourceTile;if(e&&e.layers)for(const n of e.layers)n.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map((t=>{const e=this.getSubLayerPropsByTile(t);if(t.isLoaded||t.content)if(t.layers)e&&t.layers[0]&&Object.keys(e).some((n=>t.layers[0].props[n]!==e[n]))&&(t.layers=t.layers.map((t=>t.clone(e))));else{const n=this.renderSubLayers({...this.props,id:"".concat(this.id,"-").concat(t.id),data:t.content,_offset:0,tile:t});t.layers=ee(n,Boolean).map((n=>n.clone({tile:t,...e})))}return t.layers}))}filterSubLayer({layer:t,cullRect:e}){const{tile:n}=t.props;return this.state.tileset.isTileVisible(n,e)}}function Xx(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Yx(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Zx(){}u(Hx,"defaultProps",Wx),u(Hx,"layerName","TileLayer");var Kx=.7,$x=1/Kx,Qx="\\s*([+-]?\\d+)\\s*",Jx="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",ew=/^#([0-9a-f]{3,8})$/,nw=new RegExp(`^rgb\\(${Qx},${Qx},${Qx}\\)$`),iw=new RegExp(`^rgb\\(${tw},${tw},${tw}\\)$`),rw=new RegExp(`^rgba\\(${Qx},${Qx},${Qx},${Jx}\\)$`),ow=new RegExp(`^rgba\\(${tw},${tw},${tw},${Jx}\\)$`),sw=new RegExp(`^hsl\\(${Jx},${tw},${tw}\\)$`),aw=new RegExp(`^hsla\\(${Jx},${tw},${tw},${Jx}\\)$`),lw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function uw(){return this.rgb().formatHex()}function cw(){return this.rgb().formatRgb()}function hw(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=ew.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?fw(e):3===n?new pw(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?dw(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?dw(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=nw.exec(t))?new pw(e[1],e[2],e[3],1):(e=iw.exec(t))?new pw(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=rw.exec(t))?dw(e[1],e[2],e[3],e[4]):(e=ow.exec(t))?dw(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=sw.exec(t))?bw(e[1],e[2]/100,e[3]/100,1):(e=aw.exec(t))?bw(e[1],e[2]/100,e[3]/100,e[4]):lw.hasOwnProperty(t)?fw(lw[t]):"transparent"===t?new pw(NaN,NaN,NaN,0):null}function fw(t){return new pw(t>>16&255,t>>8&255,255&t,1)}function dw(t,e,n,i){return i<=0&&(t=e=n=NaN),new pw(t,e,n,i)}function pw(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function gw(){return`#${_w(this.r)}${_w(this.g)}${_w(this.b)}`}function mw(){const t=yw(this.opacity);return`${1===t?"rgb(":"rgba("}${vw(this.r)}, ${vw(this.g)}, ${vw(this.b)}${1===t?")":`, ${t})`}`}function yw(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function vw(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function _w(t){return((t=vw(t))<16?"0":"")+t.toString(16)}function bw(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new ww(t,e,n,i)}function xw(t){if(t instanceof ww)return new ww(t.h,t.s,t.l,t.opacity);if(t instanceof Zx||(t=hw(t)),!t)return new ww;if(t instanceof ww)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),s=NaN,a=o-r,l=(o+r)/2;return a?(s=e===o?(n-i)/a+6*(n<i):n===o?(i-e)/a+2:(e-n)/a+4,a/=l<.5?o+r:2-o-r,s*=60):a=l>0&&l<1?0:s,new ww(s,a,l,t.opacity)}function ww(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Ew(t){return(t=(t||0)%360)<0?t+360:t}function Sw(t){return Math.max(0,Math.min(1,t||0))}function Pw(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Xx(Zx,hw,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:uw,formatHex:uw,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return xw(this).formatHsl()},formatRgb:cw,toString:cw}),Xx(pw,(function(t,e,n,i){return 1===arguments.length?((r=t)instanceof Zx||(r=hw(r)),r?new pw((r=r.rgb()).r,r.g,r.b,r.opacity):new pw):new pw(t,e,n,null==i?1:i);var r}),Yx(Zx,{brighter(t){return t=null==t?$x:Math.pow($x,t),new pw(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Kx:Math.pow(Kx,t),new pw(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new pw(vw(this.r),vw(this.g),vw(this.b),yw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gw,formatHex:gw,formatHex8:function(){return`#${_w(this.r)}${_w(this.g)}${_w(this.b)}${_w(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:mw,toString:mw})),Xx(ww,(function(t,e,n,i){return 1===arguments.length?xw(t):new ww(t,e,n,null==i?1:i)}),Yx(Zx,{brighter(t){return t=null==t?$x:Math.pow($x,t),new ww(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Kx:Math.pow(Kx,t),new ww(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new pw(Pw(t>=240?t-240:t+120,r,i),Pw(t,r,i),Pw(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new ww(Ew(this.h),Sw(this.s),Sw(this.l),yw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=yw(this.opacity);return`${1===t?"hsl(":"hsla("}${Ew(this.h)}, ${100*Sw(this.s)}%, ${100*Sw(this.l)}%${1===t?")":`, ${t})`}`}})),hw.prototype.toArray=function(){return[this.r,this.g,this.b]};var Cw=function(t){if(!t)return null;var e=r(t,1)[0],n=t.width,i=t.height,o=document.createElement("canvas");o.width=n,o.height=i;for(var s=o.getContext("2d"),a=s.getImageData(0,0,n,i).data,l=0;l<e.length;l++){var u=e[l];a[4*l]=u>0?255:0,a[4*l+1]=0,a[4*l+2]=0,a[4*l+3]=u>0?255:0}var c=new ImageData(a,n,i);return s.putImageData(c,0,0),o};function Iw(t){var e=t.data,n=t.rasterData,i=t.cogBbox,r=t.cogBboxPoly,o=t.onClick,s=(e.filter((function(t){return"Brazil"==t.Country||"Malaysia"==t.Country})),Cw(n)),a=null;s&&(a=new uv({id:"cog-layer_"+~~(1e3*Math.random()),data:null,image:s,bounds:i}));var l=new rb({id:"geojson-layer",data:r,pickable:!1,stroked:!0,filled:!1,extruded:!1,lineWidthMinPixels:2,getLineColor:[255,0,0]}),u=new rb({id:"point-layer",data:e,pickable:!0,opacity:.8,stroked:!0,filled:!0,pointRadiusScale:100,pointRadiusMinPixels:6,pointRadiusMaxPixels:100,lineWidthMinPixels:1,getPointRadius:10,getPosition:function(t){return[t.lon,t.lat]},getFillColor:[255,160,0],getLineColor:[0,0,0],onClick:function(t){var e=t.object.properties,n=t.object.geometry.coordinates,i={id:e.id,lon:n[0],lat:n[1]};o(i)}});return new Hx({id:"tile-layer",data:"https://c.tile.openstreetmap.org/{z}/{x}/{y}.png",minZoom:0,maxZoom:19,tileSize:256,renderSubLayers:function(t){var e=t.tile.bbox,n=e.west,i=e.south,r=e.east,o=e.north;return new uv(t,{data:null,image:t.data,bounds:[n,i,r,o]})}}),[a,u,l]}const Tw=JSON.parse('{"514":{"latitude":14.458248,"longitude":-91.294307},"562":{"latitude":-3.674261,"longitude":38.785508},"576":{"latitude":7.587132,"longitude":-75.251756},"594":{"latitude":0.072169,"longitude":37.659891},"595":{"latitude":0.141267,"longitude":37.693258},"596":{"latitude":0.012579,"longitude":37.648572},"597":{"latitude":0.14305,"longitude":36.819042},"612":{"latitude":-3.917672,"longitude":38.805574},"658":{"longitude":-74.76996068271113,"latitude":-8.585644596610171},"665":{"longitude":-58.21222,"latitude":-9.79861,"comp_kml":true},"672":{"longitude":117.803684,"latitude":5.027872},"673":{"latitude":0.35975,"longitude":30.38852},"674":{"longitude":112.299244,"latitude":-3.106367},"687":{"longitude":-78.36429801079237,"latitude":-7.437877575542979},"689":{"latitude":21.543921,"longitude":81.25426},"737":{"latitude":0.033785,"longitude":37.653227},"738":{"longitude":-53.04198365992571,"latitude":-17.8663590907318,"comp_kml":true},"796":{"longitude":-76.824622,"latitude":-7.316239},"799":{"latitude":0.368811,"longitude":33.415542},"824":{"latitude":0.557316,"longitude":30.176894},"825":{"latitude":0.362074,"longitude":30.156234},"826":{"latitude":0.786174,"longitude":29.635165},"827":{"latitude":0.91059,"longitude":29.759588},"832":{"longitude":-48.58293504155984,"latitude":-3.6271326591692827},"844":{"longitude":-70.00722178717204,"latitude":-11.092496140774678},"856":{"latitude":8.468405,"longitude":-77.341723},"868":{"longitude":-69.63523717092077,"latitude":-12.194504163199806},"875":{"longitude":-59.35049710937412,"latitude":-9.170750583108793},"899":{"latitude":-1.012116,"longitude":33.928857},"920":{"latitude":-34.606943,"longitude":-55.7475},"922":{"latitude":26.2115,"longitude":87.229132},"944":{"longitude":-77.547634,"latitude":-5.780293},"958":{"longitude":-77.36346879636169,"latitude":-7.114483287042477},"959":{"latitude":-33.114938,"longitude":-54.575457},"960":{"latitude":-32.69112,"longitude":-54.449345},"961":{"latitude":-32.789946,"longitude":-55.23134},"962":{"latitude":-32.80862,"longitude":-55.263686},"963":{"longitude":-69.472926,"latitude":-8.977771,"comp_kml":true},"965":{"latitude":-33.649003,"longitude":-54.863857},"977":{"longitude":-51.07737624580678,"latitude":-2.564183115926981},"981":{"longitude":-51.30844030964836,"latitude":-2.0080083852239055},"985":{"longitude":-75.98607061692672,"latitude":-7.689735316035307},"993":{"latitude":0,"longitude":30.176389},"994":{"latitude":12.510175,"longitude":79.66785},"995":{"latitude":-1.228393,"longitude":30.129882},"996":{"latitude":0.005999,"longitude":37.809196},"1015":{"latitude":26.49741,"longitude":81.74648},"1027":{"longitude":-48.480833,"latitude":-3.245556},"1067":{"longitude":-69.5270083744959,"latitude":-12.8943461791114},"1094":{"longitude":-50.276273910627516,"latitude":-1.1640106207290655},"1112":{"longitude":-72.6419924249548,"latitude":-8.095106969258591},"1113":{"longitude":-72.61015835546165,"latitude":-8.11173666083284},"1115":{"longitude":-52.372455,"latitude":0.816536,"comp_kml":true},"1118":{"longitude":-61.15148,"latitude":-11.009945,"comp_kml":true},"1133":{"longitude":-73.409591,"latitude":-4.60025},"1147":{"longitude":-61.557634,"latitude":-5.996664,"comp_kml":true},"1153":{"longitude":-74.789132,"latitude":-11.184106},"1162":{"latitude":27.321388,"longitude":115.952777},"1176":{"latitude":24.695378,"longitude":84.991111},"1218":{"longitude":-69.214939,"latitude":-12.687075},"1225":{"latitude":0.129314,"longitude":34.394044},"1233":{"latitude":4.900273,"longitude":-70.345494},"1317":{"longitude":-39.310303,"latitude":-13.905615,"comp_kml":true},"1322":{"latitude":29.74884,"longitude":102.436547},"1328":{"latitude":18.310476,"longitude":82.552448},"1329":{"longitude":-49.38585091764243,"latitude":-3.236972056447478,"comp_kml":true},"1332":{"latitude":29.74884,"longitude":102.436547},"1351":{"longitude":-73.34782020600242,"latitude":-3.909094535432583},"1360":{"longitude":-74.7844136251969,"latitude":-8.738638619705885},"1361":{"latitude":35.608519,"longitude":101.244206},"1378":{"latitude":4.5613,"longitude":-75.21},"1382":{"longitude":-70.177176,"latitude":-8.847445,"comp_kml":true},"1384":{"latitude":17.209557,"longitude":-89.631297},"1389":{"latitude":1.6428,"longitude":-78.892797},"1390":{"latitude":6.87222,"longitude":-77.126089},"1391":{"latitude":4.915528,"longitude":-77.359746},"1392":{"latitude":3.292599,"longitude":-77.128245},"1395":{"latitude":4.005277,"longitude":-77.159722},"1396":{"latitude":5.117203,"longitude":-76.93361},"1397":{"longitude":-77.869052,"latitude":-7.781896},"1399":{"latitude":7.298886,"longitude":-76.487774},"1400":{"latitude":4.704722,"longitude":-77.221667},"1408":{"latitude":-2.806913,"longitude":37.687994},"1429":{"latitude":8.3005,"longitude":-76.425},"1434":{"latitude":6.167856,"longitude":-75.670507},"1455":{"longitude":-79.73957,"latitude":-5.857984},"1463":{"latitude":21.905499,"longitude":88.44651},"1468":{"latitude":0.819519,"longitude":37.664315},"1477":{"longitude":113.26739369744178,"latitude":-2.3825331776905583},"1493":{"longitude":97.77216084640959,"latitude":4.6651080044924615},"1496":{"longitude":-76.498,"latitude":-6.4207},"1498":{"longitude":102.49801829598462,"latitude":0.6813214249489539},"1503":{"longitude":-62.288229,"latitude":-8.863412,"comp_kml":true},"1529":{"latitude":47.5,"longitude":120.283},"1530":{"latitude":5.542937,"longitude":-68.340479},"1538":{"latitude":14.435594,"longitude":-91.290772},"1541":{"latitude":16.642129,"longitude":-90.566631},"1542":{"latitude":25.908866,"longitude":102.968453},"1543":{"latitude":-33.114938,"longitude":-54.575457},"1558":{"latitude":15.636744,"longitude":-89.001654},"1561":{"longitude":-52.972458133319186,"latitude":-4.499874496543721},"1566":{"latitude":4.244444,"longitude":-68.393333},"1571":{"longitude":-62.534638,"latitude":-8.995663,"comp_kml":true},"1577":{"latitude":25.980851,"longitude":117.375759},"1596":{"longitude":-60.267794,"latitude":-5.853733,"comp_kml":true},"1622":{"latitude":15.216831,"longitude":-88.891564},"1644":{"latitude":22.042861,"longitude":100.919376},"1654":{"longitude":-66.155054,"latitude":-8.909852,"comp_kml":true},"1657":{"latitude":6.551636,"longitude":-72.955734},"1663":{"longitude":-54.296596,"latitude":-20.717074,"comp_kml":true},"1664":{"latitude":22.042861,"longitude":100.919376},"1682":{"latitude":6.497593,"longitude":-75.012988},"1686":{"longitude":-69.03284926246933,"latitude":-8.660307354374263},"1695":{"latitude":4.888858,"longitude":-73.366905},"1704":{"latitude":19.061066,"longitude":75.467382},"1711":{"latitude":17.803056,"longitude":78.816665},"1715":{"latitude":49.6036,"longitude":121.794499},"1718":{"latitude":50.149999,"longitude":122.216666},"1765":{"latitude":1.764026,"longitude":-76.259782},"1769":{"latitude":6.313054,"longitude":-73.9475},"1799":{"longitude":-70.001908,"latitude":-11.101058},"1806":{"latitude":5.690137,"longitude":-77.312893},"1811":{"longitude":-52.853549,"latitude":-1.56661,"comp_kml":true},"1821":{"latitude":2.613478,"longitude":-69.154694},"1825":{"latitude":37.138395,"longitude":101.271653},"1826":{"latitude":36.448753,"longitude":101.121908},"1832":{"latitude":36.409328,"longitude":102.799029},"1847":{"latitude":25.093239,"longitude":104.903125},"1855":{"latitude":31.397928,"longitude":117.62894},"1864":{"latitude":26.203682,"longitude":105.761167},"1865":{"latitude":26.246009,"longitude":105.995906},"1866":{"latitude":38.858983,"longitude":77.806055},"1869":{"latitude":5.245,"longitude":-74.006},"1882":{"longitude":-77.52980371251184,"latitude":-7.208178215980757},"1895":{"latitude":41.676586,"longitude":127.11862},"1896":{"latitude":28.562083,"longitude":110.575276},"1899":{"longitude":104.1383,"latitude":-2.019124},"1930":{"latitude":33.46421,"longitude":112.398086},"1935":{"latitude":31.66985,"longitude":112.881155},"1944":{"latitude":0.427248,"longitude":34.3632},"1953":{"longitude":-47.1905738890871,"latitude":-3.6392215239502868},"1969":{"longitude":-47.1845286403163,"latitude":-3.6368464731376524},"2010":{"latitude":27.533333,"longitude":118.183333},"2070":{"latitude":25.949248,"longitude":106.499752},"2071":{"latitude":6.252258,"longitude":-76.804568},"2075":{"latitude":12.98,"longitude":77.182777},"2079":{"longitude":-53.41700172398825,"latitude":-18.571722662219695},"2082":{"latitude":27.702303,"longitude":106.543891},"2083":{"latitude":25.999721,"longitude":105.149999},"2084":{"latitude":2.94206,"longitude":-73.208302},"2087":{"latitude":32.734206,"longitude":111.421621},"2249":{"latitude":33.066665,"longitude":112.633322},"2251":{"latitude":1.139052,"longitude":-70.605548},"2252":{"longitude":-51.27765232827451,"latitude":-2.7115994082266033},"2262":{"latitude":-73.574749,"longitude":1.761024},"2278":{"longitude":-69.83731253013784,"latitude":-11.597301574320303},"2290":{"latitude":9.324177,"longitude":-75.725577},"2297":{"latitude":-1.342811,"longitude":-72.425359},"2298":{"latitude":3.696826,"longitude":-77.129521},"2301":{"latitude":39.66667,"longitude":114.93333},"2305":{"latitude":39.566667,"longitude":114.216667},"2310":{"latitude":26.908051,"longitude":107.12805},"2317":{"latitude":7.034051,"longitude":-75.295203},"2326":{"latitude":23.724686,"longitude":109.840797},"2327":{"latitude":25.529157,"longitude":108.699007},"2330":{"latitude":8.105304,"longitude":-76.960277},"2338":{"latitude":0.0722,"longitude":37.6597},"2339":{"latitude":3.073811,"longitude":32.237527},"2343":{"latitude":21.014077,"longitude":110.209333},"2345":{"longitude":-73.7271261511339,"latitude":-2.753347780073498},"2346":{"latitude":17.794,"longitude":74.493},"2356":{"latitude":8.625021,"longitude":-77.373911},"2359":{"latitude":-31.0125,"longitude":-53.571111},"2362":{"latitude":30.66666,"longitude":116.666666},"2363":{"latitude":-3.429,"longitude":39.123},"2370":{"latitude":39.1548,"longitude":100.5085},"2373":{"latitude":-5.628332,"longitude":-59.686387,"comp_kml":true},"2374":{"latitude":42.2875,"longitude":127.036388},"2375":{"latitude":42.0775,"longitude":126.307499},"2376":{"latitude":42.333333,"longitude":127.483333},"2377":{"latitude":41.85,"longitude":126.783332},"2378":{"latitude":25.322499,"longitude":107.289163},"2379":{"latitude":26.350276,"longitude":103.600273},"2387":{"latitude":22.333331,"longitude":108.416666},"2391":{"latitude":34.75,"longitude":105.5},"2392":{"latitude":4.739131,"longitude":-75.52596},"2395":{"longitude":105.6,"latitude":-2.565},"2396":{"latitude":30.650271,"longitude":117.966943},"2397":{"latitude":29.566942,"longitude":117.116925},"2398":{"latitude":30.466921,"longitude":116.250275},"2399":{"latitude":29.800276,"longitude":116.88361},"2403":{"longitude":102.66481881414873,"latitude":0.4462471029560577},"2404":{"latitude":19.156157,"longitude":82.616999},"2405":{"latitude":35.15,"longitude":104.5},"2408":{"latitude":30.541664,"longitude":102.773054},"2411":{"latitude":-33.19147,"longitude":-54.873508},"2413":{"latitude":40.95,"longitude":114.166666},"2418":{"latitude":36.05,"longitude":104.05},"2420":{"latitude":39.677495,"longitude":114.591943},"2451":{"latitude":38.05,"longitude":111.83},"2458":{"latitude":34.5,"longitude":100.25},"2459":{"latitude":3.059431,"longitude":-77.165316},"2465":{"latitude":-14.464866,"longitude":-48.457224},"2471":{"latitude":0.169899,"longitude":30.078078},"2474":{"latitude":26.890352,"longitude":117.860955},"2476":{"latitude":30.483602,"longitude":116.483598},"2477":{"latitude":30.966929,"longitude":118.300269},"2479":{"latitude":18.473,"longitude":74.518},"2482":{"latitude":-8.536883,"longitude":-60.039798},"2497":{"latitude":0.145476,"longitude":30.078576},"2502":{"longitude":69.973701,"latitude":11.359047},"2504":{"latitude":30.933468,"longitude":118.766793},"2506":{"latitude":31.250271,"longitude":117.300269},"2507":{"latitude":31.033608,"longitude":117.283591},"2508":{"latitude":-9.13167,"longitude":-66.13797},"2512":{"latitude":6.0902,"longitude":-68.5006},"2515":{"latitude":22.6,"longitude":75.3},"2526":{"latitude":31.259428,"longitude":77.054507},"2531":{"latitude":17.22,"longitude":16.96},"2532":{"latitude":3.624693,"longitude":-72.379105},"2539":{"latitude":-7.471899,"longitude":-59.521522,"comp_kml":true},"2551":{"latitude":-10.265973,"longitude":-69.532794,"comp_kml":true},"2552":{"latitude":30.974985,"longitude":76.527219},"2553":{"latitude":22.453181,"longitude":42.775278},"2555":{"latitude":31.856387,"longitude":75.875546},"2558":{"latitude":-2.631825,"longitude":-50.343443},"2565":{"latitude":23.75,"longitude":103.566665},"2566":{"latitude":-17.908324,"longitude":-57.580553},"2568":{"latitude":18.430089,"longitude":110.016442},"2569":{"latitude":29.613841,"longitude":102.458866},"2570":{"latitude":32.85,"longitude":111.966666},"2576":{"latitude":-32.38,"longitude":-54.169},"2584":{"latitude":22.7196,"longitude":75.8577},"2586":{"latitude":-60.760809,"longitude":-5.963038},"2587":{"latitude":-60.962586,"longitude":-6.522687},"2590":{"latitude":28.6448,"longitude":77.216721},"2598":{"longitude":-74.92488899602391,"latitude":-9.623197350030484},"2606":{"latitude":25.783331,"longitude":116.633322},"2609":{"latitude":5.2,"longitude":117.333331},"2620":{"latitude":2.195816,"longitude":50.862498},"2621":{"latitude":25.545276,"longitude":100.888333},"2622":{"latitude":25.686039,"longitude":106.384439},"2623":{"latitude":-3.508129,"longitude":39.909047},"2626":{"latitude":25.419371,"longitude":105.251103},"2627":{"latitude":24.669342,"longitude":104.884326},"2628":{"latitude":28.200986,"longitude":108.050899},"2629":{"latitude":28.586005,"longitude":105.917681},"2630":{"latitude":28.951757,"longitude":105.667315},"2631":{"latitude":29.435089,"longitude":105.534784},"2632":{"latitude":29.88509,"longitude":105.985071},"2633":{"latitude":28.834785,"longitude":106.935147},"2634":{"latitude":29.83436,"longitude":105.550905},"2637":{"latitude":22.444444,"longitude":102.525833},"2638":{"latitude":31.066666,"longitude":110.416666},"2651":{"latitude":33.549996,"longitude":111.666666},"2652":{"latitude":34.25,"longitude":111.75},"2661":{"latitude":42.21,"longitude":128.54},"2674":{"latitude":51.546271,"longitude":120.888659},"2694":{"latitude":25.65,"longitude":117.98},"2698":{"latitude":42.69,"longitude":122.88},"2699":{"latitude":24.35,"longitude":103.88},"2709":{"latitude":-9.406582,"longitude":-58.552965},"2715":{"latitude":47.057219,"longitude":119.607219},"2719":{"latitude":30.27,"longitude":109.57},"2721":{"latitude":28.962498,"longitude":108.808329},"2722":{"latitude":51.73976,"longitude":121.6368},"2723":{"latitude":5.089546,"longitude":-76.652079},"2724":{"latitude":30.991944,"longitude":105.338886},"2726":{"latitude":-26.126667,"longitude":-50.316763},"2727":{"latitude":23.938887,"longitude":107.32222},"2729":{"latitude":25.49,"longitude":104.98},"2730":{"latitude":21.97,"longitude":110.21},"2733":{"latitude":24.47,"longitude":103.78},"2743":{"latitude":25.55,"longitude":104.99},"2745":{"latitude":37.5,"longitude":103.5},"2748":{"latitude":38.75,"longitude":100.9},"2756":{"latitude":23.58676,"longitude":72.369942},"2757":{"latitude":22.563199,"longitude":72.960278},"2758":{"latitude":22.84374,"longitude":74.23878},"2759":{"latitude":21.170238,"longitude":72.831062},"2769":{"latitude":30.619371,"longitude":120.984239},"2770":{"latitude":30.184238,"longitude":119.701757},"2771":{"latitude":29.634349,"longitude":119.250657},"2790":{"latitude":-20.4056,"longitude":-53.6008,"comp_kml":true},"2833":{"latitude":15.3173,"longitude":75.7139},"2843":{"latitude":27.167321,"longitude":105.835087},"2845":{"latitude":27.085086,"longitude":104.884236},"2847":{"latitude":26.38399,"longitude":105.368392},"2849":{"latitude":27.684238,"longitude":106.783991},"2850":{"latitude":28.267571,"longitude":105.618423},"2851":{"latitude":25.117322,"longitude":105.852601},"2852":{"latitude":48.777022,"longitude":87.347239},"2853":{"latitude":27.167321,"longitude":107.45071},"2854":{"latitude":27.568121,"longitude":106.701491},"2855":{"latitude":27.967569,"longitude":106.46732},"2856":{"latitude":28.200654,"longitude":107.534238},"2867":{"latitude":31.959167,"longitude":77.064722},"2870":{"latitude":-11.085855,"longitude":-58.173096},"2871":{"latitude":-10.28682,"longitude":-58.280127},"2872":{"latitude":0.698333,"longitude":-75.253889},"2877":{"latitude":30.685089,"longitude":114.168126},"2878":{"latitude":-9.678115,"longitude":-64.827933},"2882":{"latitude":22.01,"longitude":108.513333},"2884":{"latitude":39.316472,"longitude":100.131706},"2889":{"latitude":14.6819,"longitude":77.6006},"2891":{"latitude":29.984349,"longitude":114.035088},"2892":{"latitude":29.834329,"longitude":115.384236},"2893":{"latitude":42.635089,"longitude":124.884793},"2894":{"latitude":30.602658,"longitude":114.518118},"2906":{"latitude":30.800903,"longitude":113.851562},"2907":{"latitude":29.518397,"longitude":114.73511},"2910":{"latitude":30.38511,"longitude":119.251564},"2911":{"latitude":30.367571,"longitude":120.734824},"2933":{"latitude":15,"longitude":75},"2934":{"latitude":27.3965,"longitude":80.125},"2950":{"latitude":-25.658203,"longitude":-48.735255,"comp_kml":true},"2959":{"latitude":25.467,"longitude":91.3662},"2972":{"latitude":21.2787,"longitude":81.8661},"2980":{"latitude":-8.436576,"longitude":-69.844838},"2992":{"latitude":-32.84,"longitude":-55},"3002":{"latitude":-9.066861,"longitude":-68.076172},"3012":{"latitude":4.586507,"longitude":96.895223},"3049":{"latitude":-14.368885,"longitude":-57.189008},"3050":{"latitude":-7.551746,"longitude":-43.421767,"comp_kml":true},"3053":{"latitude":31.1471,"longitude":75.3412},"3055":{"latitude":-11.1328,"longitude":-54.5969},"3065":{"latitude":29.3,"longitude":73.55},"3067":{"latitude":19.7515,"longitude":75.7139},"3093":{"latitude":30.403648,"longitude":74.027962},"3114":{"latitude":28.516666,"longitude":80.683333},"3115":{"latitude":14.705197,"longitude":76.166398},"3141":{"latitude":-10.231087,"longitude":-67.656339},"3152":{"latitude":-12.606213,"longitude":-54.108496},"3156":{"latitude":23.473319,"longitude":77.947997},"3166":{"latitude":-9.450792,"longitude":-63.13637,"comp_kml":true},"3172":{"latitude":23.1765,"longitude":75.7885},"3174":{"latitude":11.6854,"longitude":76.132},"3180":{"latitude":20.5937,"longitude":78.9629},"3226":{"latitude":0.831275,"longitude":109.313833},"3238":{"latitude":16.8679,"longitude":79.4359},"3243":{"latitude":17.143908,"longitude":79.623924},"3248":{"latitude":17.6868,"longitude":83.2185},"3295":{"latitude":29.649995,"longitude":79.42},"3296":{"latitude":29.380275,"longitude":79.463569},"3299":{"latitude":31.24105,"longitude":53.574455},"3304":{"latitude":-1.859012,"longitude":-59.810152},"3306":{"latitude":-11.947426,"longitude":-46.374113},"3324":{"latitude":5.517869,"longitude":59.766812},"3332":{"latitude":-7.461289,"longitude":-67.50414},"3335":{"latitude":21.719439,"longitude":79.413888},"3340":{"latitude":-1.8997,"longitude":36.301},"3344":{"latitude":-8.559732,"longitude":-74.57334},"3346":{"latitude":28.582001,"longitude":77.247414},"3347":{"latitude":9.6195,"longitude":77.418199},"3350":{"latitude":20.803902,"longitude":52.235565},"3360":{"latitude":25.05748,"longitude":88.282611},"3361":{"latitude":14.793708,"longitude":74.68688},"3365":{"latitude":21.838052,"longitude":88.885277},"3380":{"latitude":-8.2333,"longitude":-72.4314},"3430":{"latitude":-8.2333,"longitude":-72.4314},"3431":{"latitude":76.44,"longitude":14.16},"3451":{"latitude":-9.388579,"longitude":-58.859413},"3452":{"latitude":26.0826,"longitude":101.8333},"3456":{"latitude":25.9771,"longitude":116.8273},"3458":{"latitude":35.183332,"longitude":116.016666},"3459":{"latitude":34.766666,"longitude":115.016666},"3461":{"latitude":29.207,"longitude":113.327387},"3462":{"latitude":29.363638,"longitude":113.330359},"3463":{"latitude":29.575444,"longitude":113.415361},"3464":{"latitude":47.2,"longitude":124.2},"3469":{"latitude":46.963532,"longitude":127.624245},"3472":{"latitude":35.916665,"longitude":106.283332},"3476":{"latitude":23.75,"longitude":85.5},"3477":{"latitude":21.5,"longitude":89.9},"3478":{"latitude":15.8,"longitude":81.833331},"3480":{"latitude":21.949998,"longitude":87.966666},"3481":{"latitude":17.833331,"longitude":87.38333},"3486":{"latitude":21.616665,"longitude":86.716666},"3487":{"latitude":47.693811,"longitude":134.073371},"3491":{"latitude":8.083332,"longitude":89.9},"3501":{"latitude":18.016666,"longitude":82.083331},"3507":{"latitude":15.8,"longitude":81.833331},"3518":{"latitude":22.438894,"longitude":81.339608},"3535":{"latitude":13.216666,"longitude":84.733333},"3554":{"latitude":17.8,"longitude":87.483333},"3555":{"latitude":26.851209,"longitude":95.074905},"3558":{"latitude":21.5,"longitude":89.9},"3560":{"latitude":22.601,"longitude":75.3025},"3561":{"latitude":8.083332,"longitude":80.333331},"3563":{"latitude":30.377776,"longitude":79.07222},"3564":{"latitude":6.711769,"longitude":-74.34295},"3565":{"latitude":21.949998,"longitude":87.966666},"3566":{"latitude":19.997451,"longitude":73.789799},"3568":{"latitude":21.616665,"longitude":86.716666},"3570":{"latitude":23.015,"longitude":78.153},"3572":{"latitude":21.962825,"longitude":79.042304},"3575":{"latitude":0.145005,"longitude":23.051708},"3576":{"latitude":17.833331,"longitude":87.383328},"3577":{"latitude":17.833332,"longitude":87.383332},"3578":{"latitude":17.833332,"longitude":87.383332},"3579":{"latitude":17.833332,"longitude":87.383332},"3580":{"latitude":17.833332,"longitude":87.383332},"3582":{"latitude":17.833332,"longitude":87.383332},"3583":{"latitude":17.833332,"longitude":87.383332},"3584":{"latitude":17.833332,"longitude":87.383332},"3585":{"latitude":17.833332,"longitude":87.383332},"3586":{"latitude":17.833332,"longitude":87.383332},"3588":{"latitude":29.1044,"longitude":73.135},"3590":{"latitude":-2.971811,"longitude":-50.041705},"3601":{"latitude":3.046199,"longitude":48.196213},"3602":{"latitude":-8.21409,"longitude":36.08993},"3623":{"latitude":-32.5,"longitude":-54.2},"3627":{"latitude":33.239615,"longitude":26.335131},"3628":{"latitude":32.800055,"longitude":25.694728}}');Tw=Object.keys(Tw).map((function(t){return pf([Tw[t].longitude,Tw[t].latitude],{id:t})}));var Mw={latitude:35.73202612464274,longitude:137.53268402693763,zoom:1};const Lw=function(){var e=r((0,t.useState)("https://assets-rating-platform-dev-geo.dev-vcc.sustainacraft.com/cog/cog-Hansen_GFC-2021-v1.9_lossyear.tif"),2),i=e[0],o=e[1],s=r((0,t.useState)("pointer"),2),l=s[0],u=(s[1],r((0,t.useState)(Mw),2)),c=u[0],h=u[1],f=r((0,t.useState)(null),2),d=f[0],p=f[1],g=r((0,t.useState)(null),2),m=g[0],y=g[1],v=r((0,t.useState)(null),2),_=v[0],b=v[1];return(0,t.useEffect)((function(){if(d&&i){var t=function(){var t,e=(t=a().mark((function t(){var e,n;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ey(i);case 2:return e=t.sent,t.next=5,e.readRasters({bbox:d,resX:.01,resY:.01});case 5:n=t.sent,b(n);case 7:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(r,o){var s=t.apply(e,i);function a(t){n(s,r,o,a,l,"next",t)}function l(t){n(s,r,o,a,l,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}}();t()}}),[d,i]),t.createElement("div",null,t.createElement("h1",null,"cloud optimized geotiff(COG)リクエストテスト"),t.createElement("p",null,"下記URLを変更して地図上マーカーをクリックしてください。正しくCOGが読み込めている場合、地図上にデータが可視化されます"),t.createElement("label",null,"COG URL:",t.createElement("input",{style:{width:"600px",marginBottom:"1em"},type:"text",defaultValue:i,onChange:function(t){b(null),o(t.target.value)}})),t.createElement("div",{style:{position:"relative",width:"100%",height:"600px",marigin:"10px"}},t.createElement(Zh,{views:new Va({repeat:!0}),initialViewState:c,controller:!0,getCursor:function(){return l},layers:Iw({data:Tw,rasterData:_,cogBbox:d,cogBboxPoly:m,onClick:function(t){var e=function(t,e,n){var i=(n=n||{}).units||"kilometers",r=n.steps||8;if(!t)throw new Error("geojson is required");if("object"!=typeof n)throw new Error("options must be an object");if("number"!=typeof r)throw new Error("steps must be an number");if(void 0===e)throw new Error("radius is required");if(r<=0)throw new Error("steps must be greater than 0");var o=[];switch(t.type){case"GeometryCollection":return op(t,(function(t){var n=Pg(t,e,i,r);n&&o.push(n)})),ip(o);case"FeatureCollection":return rp(t,(function(t){var n=Pg(t,e,i,r);n&&rp(n,(function(t){t&&o.push(t)}))})),ip(o)}return Pg(t,e,i,r)}(pf([t.lon,t.lat]),200,{units:"kilometers"}),n=Qh(e);p(n);var i=nf(n);y(i),h((function(e){return{longitude:t.lon,latitude:t.lat,zoom:7,transitionDuration:1e3,transitionInterpolator:new bt}}))}})},t.createElement(Gy,{mapStyle:"mapbox://styles/mapbox/light-v10",mapboxAccessToken:"pk.eyJ1Ijoic2hpbWl6dSIsImEiOiJjbGViajl1bWwxOW04M3Zwa2Uxc3J4eTNoIn0.Z3KLWOUk9-rr9qGvQsNOPw"}))))};function Aw(){return t.createElement(Lw,null)}var Ow=document.getElementById("app");(0,e.s)(Ow).render(t.createElement(Aw,{tab:"home"}))})()})();
//# sourceMappingURL=app.js.map